<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Real Application Clusters and Global Data Services</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Developer's Guide ">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Developer's Guide for Microsoft Windows">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="oracle-data-provider-net.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2018-08-24T00:49:54-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="2002, 2018">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E90593-02">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/18">
      
      <link rel="prev" href="featConnecting.html" title="Previous" type="text/html">
      <link rel="next" href="featTG.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"18","element_name":"Release 18","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="OracleÂ® Data Provider for .NET">
    <meta name="dcterms.isVersionOf" content="ODPNT">
    <meta name="dcterms.release" content="Release 18">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="featConnecting.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="featTG.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Developer's Guide </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="features.html" property="item" typeof="WebPage"><span property="name">Features of Oracle Data Provider for .NET</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Real Application Clusters and Global Data Services</li>
            </ol>
            <a id="GUID-BAF145C1-33A9-45C7-9ED5-FB4563B274CA" name="GUID-BAF145C1-33A9-45C7-9ED5-FB4563B274CA"></a><a id="ODPNT8176"></a>
            
            <h2 id="ODPNT-GUID-BAF145C1-33A9-45C7-9ED5-FB4563B274CA" class="sect2"><span class="enumeration_section">3.4 </span>Real Application Clusters and Global Data Services
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>This section discusses optimizations for the following products: </p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p>Oracle Real Application Clusters (Oracle RAC) is a cluster database with a shared cache architecture that overcomes the limitations of traditional shared-nothing and shared-disk approaches to provide highly scalable and available database solutions for business applications.</p>
                  </li>
                  <li>
                     <p>Oracle Data Guard provides one or more standby databases to protect Oracle data from failures, disasters, human error, and data corruptions for high availability in mission critical applications. </p>
                  </li>
                  <li>
                     <p>Oracle GoldenGate replicates data among heterogeneous data environments. It enables high availability solutions, real-time data integration, transactional change data capture, data replication, transformations, and verification between operational and analytical enterprise systems. </p>
                  </li>
                  <li>
                     <p>Global Data Services (GDS), new in Oracle Database 12<span class="italic">c</span>, provides database workload management features across replicated databases, such as Data Guard and GoldenGate.
                     </p>
                  </li>
               </ul>
               <p>ODP.NET supports Oracle Real Application Clusters (Oracle RAC), Data Guard, and GoldenGate transparently, meaning you do not need to change ODP.NET code to use these Oracle components. To further take advantage of these technologies, ODP.NET offers connection pooling optimization features for achieving better application high availability and performance. You can do this through configuring ODP.NET to receive, respond, and send database status messages to .NET applications.</p>
               <p>These optimization configurations include the use of features such as Fast Application Notification (FAN), Runtime Connection Load Balancing, and Fast Connection Failover (FCF).</p>
               <p>These connection pooling optimizations can improve high availability and performance for Oracle Real Application Clusters and Global Data Services products:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="featRAC.html#GUID-3A7979D7-4AD3-4846-ADC8-A141DA089C8A">Fast Application Notification</a></p>
                  </li>
                  <li>
                     <p><a href="featRAC.html#GUID-3515AA3B-9F5E-4FA4-8550-7908F26794D1">Runtime Connection Load Balancing</a></p>
                  </li>
                  <li>
                     <p><a href="featRAC.html#GUID-1A97AEAF-BAAD-4705-8DD5-E1297A0FD591">Fast Connection Failover (FCF)</a></p>
                  </li>
               </ul>
               <div class="infoboxnotealso" id="GUID-BAF145C1-33A9-45C7-9ED5-FB4563B274CA__GUID-BF9B4707-8677-41A4-9FD0-5C9BAF8BE47C">
                  <p class="notep1">See Also:</p>
                  <ul style="list-style-type: disc;">
                     <li> <a href="../racad/introduction-to-oracle-rac.html#RACAD1111" target="_blank"><span><cite>Oracle Real Application Clusters Administration and Deployment Guide</cite></span></a>.
                     </li>
                     <li><a href="../sbydb/introduction-to-oracle-data-guard-concepts.html#SBYDB00010" target="_blank"><span><cite>Oracle Data Guard Concepts and Administration</cite></span></a>.
                        <p></p>
                     </li>
                     <li><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/odpnt&amp;id=HAOVW11977" target="_blank"><span><cite>Oracle Database High Availability Overview</cite></span></a>.
                        <p></p>
                     </li>
                  </ul>
               </div>
            </div><a id="ODPNT8178"></a><a id="ODPNT8177"></a><div class="props_rev_3"><a id="GUID-3A7979D7-4AD3-4846-ADC8-A141DA089C8A" name="GUID-3A7979D7-4AD3-4846-ADC8-A141DA089C8A"></a><h3 id="ODPNT-GUID-3A7979D7-4AD3-4846-ADC8-A141DA089C8A" class="sect3"><span class="enumeration_section">3.4.1 </span>Fast Application Notification
               </h3>
               <div>
                  <p>Fast Application Notification (FAN) is a high availability and load balancing notification mechanism that Oracle RAC, Data Guard, and GoldenGate use to notify ODP.NET applications about cluster configuration and service-level information, including status changes such as UP or DOWN events and server load. FAN UP and DOWN events can apply to instances, services, and nodes. Based on information received, ODP.NET can adjust its connection pool accordingly to improve application availability and performance. </p>
                  <p>With FAN, Oracle RAC, Data Guard, and GoldenGate use one of two Oracle messaging infrastructures to send notifications to ODP.NET applications:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Oracle Notification Service (ONS) </p>
                     </li>
                     <li>
                        <p>Oracle Streams Advanced Queueing (AQ).</p>
                     </li>
                  </ul>
                  <p><a href="featRAC.html#GUID-3A7979D7-4AD3-4846-ADC8-A141DA089C8A__CIHIBAIA" title="The first columns lists the ODP.NET driver type and second to fifth columns list its corresponding database server version, FAN infrastructure, configuration type, and the manual ONS configuration locations respectively.">Table 3-5</a> describes when each messaging system is used and the ODP.NET-related client configuration.
                  </p>
                  <div class="tblformal" id="GUID-3A7979D7-4AD3-4846-ADC8-A141DA089C8A__CIHIBAIA">
                     <p class="titleintable">Table 3-5 Configurations for ODP.NET Driver Types</p>
                     <table cellpadding="4" cellspacing="0" class="Formal" title="Configurations for ODP.NET Driver Types" summary="The first columns lists the ODP.NET driver type and second to fifth columns list its corresponding database server version, FAN infrastructure, configuration type, and the manual ONS configuration locations respectively." width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="16%" id="d65386e132">ODP.NET Driver Type</th>
                              <th align="left" valign="bottom" width="18%" id="d65386e135">Database Server Version</th>
                              <th align="left" valign="bottom" width="18%" id="d65386e138">FAN Infrastructure </th>
                              <th align="left" valign="bottom" width="17%" id="d65386e141">Configuration</th>
                              <th align="left" valign="bottom" width="32%" id="d65386e144">Manual ONS Configuration Locations</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d65386e149" headers="d65386e132 ">
                                 <p>managed </p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d65386e149 d65386e135 ">
                                 <p>12.1 and later</p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d65386e149 d65386e138 ">
                                 <p>ONS </p>
                              </td>
                              <td align="left" valign="top" width="17%" headers="d65386e149 d65386e141 ">
                                 <p>Automatic or Manual</p>
                              </td>
                              <td align="left" valign="top" width="32%" headers="d65386e149 d65386e144 ">
                                 <p>Either of these two files:</p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>.NET configuration file </p>
                                    </li>
                                    <li>
                                       <p>ONS configuration file</p>
                                    </li>
                                 </ul>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d65386e172" headers="d65386e132 ">
                                 <p>managed</p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d65386e172 d65386e135 ">
                                 <p>11.2 and earlier </p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d65386e172 d65386e138 ">
                                 <p>ONS</p>
                              </td>
                              <td align="left" valign="top" width="17%" headers="d65386e172 d65386e141 ">
                                 <p>Manual</p>
                              </td>
                              <td align="left" valign="top" width="32%" headers="d65386e172 d65386e144 ">
                                 <p>Either of these two files:</p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>.NET configuration file </p>
                                    </li>
                                    <li>
                                       <p>ONS configuration file</p>
                                    </li>
                                 </ul>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d65386e195" headers="d65386e132 ">
                                 <p>unmanaged</p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d65386e195 d65386e135 ">
                                 <p>12.1 and later </p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d65386e195 d65386e138 ">
                                 <p>ONS</p>
                              </td>
                              <td align="left" valign="top" width="17%" headers="d65386e195 d65386e141 ">
                                 <p>Automatic or Manual</p>
                              </td>
                              <td align="left" valign="top" width="32%" headers="d65386e195 d65386e144 ">
                                 <p><code class="codeph">oraaccess.xml</code> file 
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="16%" id="d65386e213" headers="d65386e132 ">
                                 <p>unmanaged</p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d65386e213 d65386e135 ">
                                 <p>11.2 and earlier </p>
                              </td>
                              <td align="left" valign="top" width="18%" headers="d65386e213 d65386e138 ">
                                 <p>AQ</p>
                              </td>
                              <td align="left" valign="top" width="17%" headers="d65386e213 d65386e141 ">
                                 <p>Automatic</p>
                              </td>
                              <td align="left" valign="top" width="32%" headers="d65386e213 d65386e144 ">
                                 <p>N/A</p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
                  <p>For automatic ONS configuration, developers can add more nodes and ports for ODP.NET to listen to, in addition to the nodes and ports that ODP.NET obtains from the database automatically.</p>
                  <p>ODP.NET applications do not require code changes to migrate from the AQ to ONS FAN infrastructure. However, some ODP.NET client configuration changes may be necessary when migrating to ONS, a newer database server version, or from ODP.NET, Unmanaged Driver to the managed driver, as documented above. </p>
                  <p>On the database server side, FAN must be set up and configured.</p>
                  <p>Using FAN Messages from the database, ODP.NET can do the following:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>With Runtime Connection Load Balancing, ODP.NET load balances connections among Oracle RAC nodes, services, and service members and GDS resources. This feature improves ODP.NET response time and ensures better resource allocation of server resources.</p>
                     </li>
                     <li>
                        <p>With the Fast Connection Failover (FCF) feature, Oracle RAC, Data Guard, and GoldenGate can inform the ODP.NET connection pool if database nodes, services, service members, or the databases have gone down. These DOWN messages indicate which connections in the pool are invalid and must be removed.</p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-3A7979D7-4AD3-4846-ADC8-A141DA089C8A__GUID-39009A6F-F243-4EAE-B18B-9377C50DF6E2">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="InstallManagedConfig.html#GUID-2E8B177B-A7C7-416C-8F9F-BD73E3A59409">onsConfig section</a> to configure the .NET configuration file.
                           </p>
                        </li>
                        <li>
                           <p><a href="InstallManagedConfig.html#GUID-0796272B-9536-4B95-8FEA-0E12C3015C8E">Client Side ONS Daemon Configuration</a> to configure the ONS configuration file.
                           </p>
                        </li>
                        <li>
                           <p><a href="InstallConfiguringPort.html#GUID-95E53037-AEAA-4AFD-A8C5-CA25A3555D40">Configuring a Port to Listen for Database Notifications</a> for more information on AQ configuration for FAN.
                           </p>
                        </li>
                        <li>
                           <p><a href="featRAC.html#GUID-3515AA3B-9F5E-4FA4-8550-7908F26794D1">Runtime Connection Load Balancing</a></p>
                        </li>
                        <li>
                           <p><a href="../racad/ensuring-application-continuity.html#RACAD7128" target="_blank"><span class="italic">Oracle Real Application Clusters Administration and Deployment Guide</span></a> for more information about FAN.
                           </p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/odpnt&amp;id=LNOCI73052" target="_blank"><span class="italic">Oracle Call Interface Programmer's Guide</span></a> to configure <code class="codeph">oraaccess.xml</code>.
                           </p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/odpnt&amp;id=ADFNS539" target="_blank"><span class="italic">Oracle Database Development Guide</span></a></p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="ODPNT8179"></a><div class="props_rev_3"><a id="GUID-3515AA3B-9F5E-4FA4-8550-7908F26794D1" name="GUID-3515AA3B-9F5E-4FA4-8550-7908F26794D1"></a><h3 id="ODPNT-GUID-3515AA3B-9F5E-4FA4-8550-7908F26794D1" class="sect3"><span class="enumeration_section">3.4.2 </span><span>Runtime Connection Load Balancing</span></h3>
               <div>
                  <p>With Runtime Connection Load Balancing, Oracle Data Provider for .NET balances work requests across Oracle RAC instances based on the load balancing advisory and service goal. Because workloads can constantly change, load balancing occurs when the application requests a new connection. Thus, ODP.NET optimizes service levels by connecting users to the least loaded nodes in real-time.</p>
                  <p>In Oracle Database 12<span class="italic">c</span>, Runtime Connection Load Balancing has been extended to Oracle Data Guard and Oracle GoldenGate so that ODP.NET 12<span class="italic">c</span> connections can be load balanced with these two database services as part of Global Data Services. No ODP.NET applications require code changes to use Global Data Services if they are already using Runtime Connection Load Balancing.
                  </p>
                  <p>When Runtime Connection Load Balancing is enabled:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>The ODP.NET connection pool dispenses connections based on the load balancing advisory and service goal.</p>
                     </li>
                     <li>
                        <p>The ODP.NET connection pool also balances the number of connections to each service member providing the service, based on the load balancing advisory and service goal.</p>
                     </li>
                  </ul>
                  <p>By default, ODP.NET is enabled to receive Runtime Connection Load Balancing FAN messages from the server. The feature has been enabled via the "<code class="codeph">Load Balancing=true</code>" and "<code class="codeph">pooling=true</code>" settings in the connection string, which are the default values. This feature can only be used if "<code class="codeph">pooling=true</code>". In order to use Runtime Connection Load Balancing, specific Oracle server configurations must be set.
                  </p>
                  <p>The following connection string example enables Runtime Connection Load Balancing:</p>
                  <p><code class="codeph">"user id=scott;password=tiger;data source=erp;load balancing=true;"</code></p>
                  <div class="infoboxnotealso" id="GUID-3515AA3B-9F5E-4FA4-8550-7908F26794D1__GUID-C3E3BD18-95DE-4822-876A-52F32A68D97A">
                     <p class="notep1">See Also:</p>
                     <p></p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="featConnecting.html#GUID-0CFEB161-68EF-4BC2-8943-3BDFFB878602__CJAEDBGH" title="The first column lists connection string attribute, second column lists its corresponding description, and third column lists the default value.">Table 3-2</a></p>
                        </li>
                        <li>
                           <p><span class="q">"<a href="InstallConfiguringPort.html#GUID-95E53037-AEAA-4AFD-A8C5-CA25A3555D40">Configuring a Port to Listen for Database Notifications</a>"</span></p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/odpnt&amp;id=NETAG335" target="_blank"><span><cite>Oracle Database Net Services Administrator's Guide</cite></span></a> to set up the Oracle Net configuration that Runtime Connection Load Balancing requires
                           </p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/odpnt&amp;id=RACAD7122" target="_blank"><span><cite>Oracle Real Application Clusters Administration and Deployment Guide</cite></span></a> for the required Oracle RAC configuration
                           </p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/odpnt&amp;id=GSMUG134" target="_blank"><span><cite>Oracle Database Global Data Services Concepts and Administration Guide</cite></span></a></p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="ODPNT8180"></a><div class="props_rev_3"><a id="GUID-1A97AEAF-BAAD-4705-8DD5-E1297A0FD591" name="GUID-1A97AEAF-BAAD-4705-8DD5-E1297A0FD591"></a><h3 id="ODPNT-GUID-1A97AEAF-BAAD-4705-8DD5-E1297A0FD591" class="sect3"><span class="enumeration_section">3.4.3 </span>Fast Connection Failover (FCF)
               </h3>
               <div>
                  <p>When an Oracle RAC service, service member, node, or a Data Guard database fails, the severed ODP.NET connection objects may continue to exist in the application. If users attempt to use these invalid connections, they will encounter errors. FCF enables ODP.NET to free these severed connections proactively and quickly. Users then will be able to use the application after a server side failure without manual intervention from an administrator.</p>
                  <p>In Oracle Database 12<span class="italic">c</span>, FCF has been extended to Oracle Data Guard and Oracle GoldenGate for ODP.NET 12<span class="italic">c</span> connections through Global Data Services. No ODP.NET applications require code changes to use Global Data Services if they already use FCF.
                  </p>
                  <p>ODP.NET applications can enable FCF through the High Availability Events, <code class="codeph">"HA Events"</code>, connection string attribute. When HA Events are enabled:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>ODP.NET connection pool proactively removes connections from the pool when a Global Data Service or Oracle RAC service, service member, node, or database goes down.</p>
                     </li>
                     <li>
                        <p>ODP.NET proactively forces threads waiting for responses from the downed database to exit out from the existing call to avoid any hangs. When such a connection is then returned to the pool, any resource associated with that connection is freed.</p>
                     </li>
                     <li>
                        <p>ODP.NET establishes connections to existing Oracle instances if the removal of severed connections brings the total number of connections below the  "<code class="codeph">min pool size</code>", upon the next connection request.
                        </p>
                     </li>
                  </ul>
                  <p>By default, ODP.NET is enabled to receive FCF FAN messages from the server. This feature have been enabled via the <code class="codeph">HA Events=true</code> and <code class="codeph">pooling=true</code> settings in the connection string, which are the default values.
                  </p>
                  <p>The following connection string example enables HA Events:</p>
                  <p><code class="codeph">"user id=scott;password=tiger;data source=erp;HA events=true;"</code></p>
                  <div class="infoboxnotealso" id="GUID-1A97AEAF-BAAD-4705-8DD5-E1297A0FD591__GUID-53C5EFF1-0D42-4093-8929-9E5BC3D6EFCB">
                     <p class="notep1">See Also:</p>
                     <p></p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="featConnecting.html#GUID-0CFEB161-68EF-4BC2-8943-3BDFFB878602__CJAEDBGH" title="The first column lists connection string attribute, second column lists its corresponding description, and third column lists the default value.">Table 3-2</a></p>
                        </li>
                        <li>
                           <p><a href="InstallConfiguringPort.html#GUID-95E53037-AEAA-4AFD-A8C5-CA25A3555D40">Configuring a Port to Listen for Database Notifications</a></p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/odpnt&amp;id=NETAG005" target="_blank"><span><cite>Oracle Database Net Services Administrator's Guide</cite></span></a> to set up the Oracle Net configuration that FCF requires
                           </p>
                        </li>
                        <li>
                           <p><a href="../racad/workload-management-with-dynamic-database-services.html#RACAD7134" target="_blank"><span><cite>Oracle Real Application Clusters Administration and Deployment Guide</cite></span></a> for the required Oracle RAC configuration
                           </p>
                        </li>
                        <li>
                           <p><a href="../gsmug/intro-global-data-services.html#GSMUG107" target="_blank"><span><cite>Oracle Database Global Data Services Concepts and Administration Guide</cite></span></a></p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="ODPNT8181"></a><div class="props_rev_3"><a id="GUID-181D506F-26F9-4F06-819E-004332279ACB" name="GUID-181D506F-26F9-4F06-819E-004332279ACB"></a><h3 id="ODPNT-GUID-181D506F-26F9-4F06-819E-004332279ACB" class="sect3"><span class="enumeration_section">3.4.4 </span>Using FCF Planned Outage to Minimize Service Disruption
               </h3>
               <div>
                  <p>FCF not only provides high availability services for unplanned outages, such as node failures, but also for planned outages, such as server repairs, upgrades, and changes, to minimize service disruption to ODP.NET application users.</p>
                  <p>When a database service is set to be stopped or relocated, a FAN message is published with a planned reason code. A FCF-aware ODP.NET connection pool (<code class="codeph">HA Events=true</code>) receives the notification and commences to close idle connections, no longer allowing new connections to that specific database service. Active connections to that specific database service remain until users complete their tasks and the connection is returned to the pool. Thus, no users must stop work mid-stream due to a planned outage.
                  </p>
                  <p>Eventually, all users complete their tasks and no connections remain to that database service. The database administrator can then stop the service for the planned outage task. This feature allows the database service to be stopped as quickly as possible without end user disruption.</p>
                  <p>Oracle planned outage support works with Oracle Real Application Clusters (Oracle RAC), Oracle Data Guard, and some single instance scenarios. </p>
                  <div class="section">
                     <p class="subhead2">Oracle RAC Planned Outage</p>
                     <p>A typical planned outage scenario for Oracle RAC follows below. Note that the database server commands apply to Oracle RAC 12<span class="italic">c</span> Release 2 or higher. Commands for earlier releases may be different.
                     </p>
                     <ol>
                        <li>
                           <p>There is a need to upgrade, patch, or repair a software or hardware issue on a database server. Stop the instance gracefully such that existing users experience no to few errors. You can wait until all users complete their work before doing so. Business requirements will dictate whether you wait for all users to log out or begin the planned outage after a set time. An administrator could issue the following command line operation using Oracle Server Control Utility (<code class="codeph">srvctl</code>):
                           </p><pre class="oac_no_warn" dir="ltr">srvctl relocate service &#x2013;database &lt;unique database name&gt; &#x2013;service &lt;service name&gt; &#x2013;drain_timeout 120 &#x2013;stopoption IMMEDIATE &#x2013;oldinst &lt;existing instance&gt;</pre><p>This command relocates the database service from the existing instance to any instance it is configured to run on. Oracle Cluster Ready Services (CRS) will choose this instance, as the command line specifies no target. CRS will wait 120 seconds <code class="codeph">(&#x2013;drain_timeout 120</code>) for any active sessions to drain, after which any sessions remaining on the existing instance will be forcibly disconnected (<code class="codeph">&#x2013;stopoption IMMEDIATE</code>). If Application Continuity is used in conjunction with planned outage, an attempt is made to recover these killed sessions, masking the outage from end users.
                           </p>
                           <p>The relocate operation starts the service in the new location prior to stopping the service in its existing location. Immediate relocation allows draining with no brownout. If the service cannot be started, it is not stopped at the original location to maintain availability.</p>
                        </li>
                        <li>
                           <p>Meanwhile in the connection pool, the FAN planned DOWN event clears idle sessions for the instance being shutdown from the ODP.NET connection pool immediately and marks that instanceâs active sessions to be released at the next check-in. These FAN actions drain the sessions from this instance without disrupting the users.</p>
                           <p>Existing connections on other instances remain usable, and new connections can be opened to these other instances.</p>
                        </li>
                        <li>
                           <p>Not all sessions will check their connections into the pool immediately. The timeout period specified by <code class="codeph">&#x2013;drain_timeout</code> after which the instance is forcibly shut down, evicting any remaining client connections. Administrators can check whether any active sessions to the instance remain by querying the <code class="codeph">v$session</code> table.
                           </p>
                        </li>
                        <li>
                           <p>Once the upgrade, patch, or repair is complete, restart the instance and the service on the original node. The FAN UP event will inform the ODP.NET pool that it can now use the original machine again.</p>
                        </li>
                     </ol>
                     <div class="infoboxnotealso" id="GUID-181D506F-26F9-4F06-819E-004332279ACB__GUID-BCD6D869-BD60-4F51-BC5E-61D31DD9270F">
                        <p class="notep1">See Also:</p>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/odpnt&amp;id=HABPT044" target="_blank"><span><cite>Oracle Database High Availability Best Practices</cite></span></a></p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2">Oracle Data Guard Planned Outage</p>
                     <p>Oracle Data Guard performs switchovers from primary databases to standby databases in planned failover scenarios. During the switchover, administrators will want to limit end user disruptions. In Oracle Database 12<span class="italic">c</span> Release 2 and higher, these administrators can use the Data Guard command-line interface (<code class="codeph">DGMGRL</code>) command to switch roles between primary and standby databases:
                     </p><pre class="oac_no_warn" dir="ltr">SWITCHOVER TO &lt;database name&gt; [WAIT &lt;timeout in seconds&gt; ];&nbsp;&nbsp;</pre><p>The <code class="codeph">WAIT</code> option specifies to wait for sessions to drain before proceeding with the switchover.
                     </p>
                     <p>Similar to the Oracle RAC scenario, FAN informs the ODP.NET to remove idle connections from the pool. Connections subsequently checked in are destroyed until no active connections remain to that primary database, which will allow the switchover to begin.</p>
                     <p>When switchover to the standby completes, a FAN UP event informs ODP.NET that it can start creating connections to the standby instance.</p>
                     <p>During the Data Guard service relocation process, new incoming connection requests will not be accepted until the service has fully relocated. Incoming connection requests arriving during the interim, such as in the middle of an Oracle Data Guard switchover, will receive connectivity errors.</p>
                     <p>To prevent these errors, ODP.NET can pause connection attempts until the new database service is available. ODP.NET, Managed and Unmanaged Drivers block any connection attempts until the service is up or until the configured time limit expires from the time when the service DOWN event was received. This feature is useful for planned outages and service relocations. It works with Oracle RAC and Oracle Data Guard.</p>
                     <p>This time limit is the <code class="codeph">ServiceRelocationConnectionTimeout</code> setting, which can be set in the .NET configuration file.
                     </p>
                     <div class="infoboxnotealso" id="GUID-181D506F-26F9-4F06-819E-004332279ACB__GUID-1303BD9A-9ADB-4F6F-B216-99A5B83B7332">
                        <p class="notep1">See Also:</p>
                        <p><a href="InstallManagedConfig.html#GUID-A9EF5624-1828-46DD-84D1-CC5F40BFB6F5__CBHFDHHJ"><code class="codeph">ServiceRelocationConnectionTimeout</code></a></p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="ODPNT8182"></a><div class="props_rev_3"><a id="GUID-2882B01C-19BC-409A-8B5E-95D0AF95B3B0" name="GUID-2882B01C-19BC-409A-8B5E-95D0AF95B3B0"></a><h3 id="ODPNT-GUID-2882B01C-19BC-409A-8B5E-95D0AF95B3B0" class="sect3"><span class="enumeration_section">3.4.5 </span>Pool Behavior in an Oracle RAC Database
               </h3>
               <div>
                  <p>When connection pools are created for a single-instance database, pool size attributes are applied to the single service. Similarly, when connection pools are created for an Oracle RAC database, the pool size attributes are applied to a service and not to service members. For example, if "<code class="codeph">Min Pool Size</code>" is set to <span class="italic"><code class="codeph">N</code></span>, then ODP.NET does not create <span class="italic"><code class="codeph">N</code></span> connections for each service member. Instead, it creates, at minimum, <span class="italic"><code class="codeph">N</code></span> connections for the entire service, where <span class="italic"><code class="codeph">N</code></span> connections are distributed among the service members.
                  </p>
                  <p>The following pool size connection string attributes are applied to a service.</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><code class="codeph">Min Pool Size</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">Max Pool Size</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">Incr Pool Size</code></p>
                     </li>
                     <li>
                        <p><code class="codeph">Decr Pool Size</code></p>
                     </li>
                  </ul>
                  <p>ODP.NET connects to the same Oracle RAC node when required by a distributed transaction that has already begun on a particular node, by an Oracle runtime connection load balancing advisory, or by Oracle RAC load balancing gravitation in which connections will gravitate to an under utilized node. If the connection pool has no idle connections to this particular node, then ODP.NET will create a new connection to this node. Node affinity is honored even when the connection pool runs out of idle connections to dispense.</p>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>