<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>ExecuteNonQuery</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Developer's Guide ">
      <meta property="og:description" content>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Developer's Guide for Microsoft Windows">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="oracle-data-provider-net.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2018-08-24T00:49:54-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="2002, 2018">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E90593-02">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/18">
      
      <link rel="prev" href="CommandDispose.html" title="Previous" type="text/html">
      <link rel="next" href="CommandExecuteReaderOverloads.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"18","element_name":"Release 18","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="OracleÂ® Data Provider for .NET">
    <meta name="dcterms.isVersionOf" content="ODPNT">
    <meta name="dcterms.release" content="Release 18">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="CommandDispose.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="CommandExecuteReaderOverloads.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Developer's Guide </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="odp-dot-net-classes.html" property="item" typeof="WebPage"><span property="name">Oracle Data Provider for .NET Classes</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="OracleCommandClass.html" property="item" typeof="WebPage"><span property="name">OracleCommand Class</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="CommandPublicMethods.html" property="item" typeof="WebPage"><span property="name">OracleCommand Public Methods</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">ExecuteNonQuery</li>
            </ol>
            <a id="GUID-E1E79471-6037-4490-BDE7-ADE252922C83" name="GUID-E1E79471-6037-4490-BDE7-ADE252922C83"></a><a id="ODPNT613"></a><a id="ODPNT614"></a><a id="ODPNT615"></a><a id="ODPNT616"></a><a id="ODPNT617"></a><a id="ODPNT618"></a><a id="ODPNT619"></a><a id="ODPNT612"></a>
            
            <h2 id="ODPNT-GUID-E1E79471-6037-4490-BDE7-ADE252922C83" class="sect2"><span class="enumeration_section">6.2.5.5 </span>ExecuteNonQuery
            </h2>
         </header>
         <div class="ind">
            <div>
               <div class="section">
                  <p>This method executes a SQL statement or a command using the <code class="codeph">XmlCommandType</code> and <code class="codeph">CommandText</code> properties and returns the number of rows affected. 
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1">Declaration</p>
               </div>
               <!-- class="section" -->
               <div class="section"><pre class="oac_no_warn" dir="ltr">// C#
public override int ExecuteNonQuery();</pre></div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1">Return Value</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p>The number of rows affected. </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1">Implements</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p><code class="codeph">IDbCommand</code> 
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1">Exceptions</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p><code class="codeph">InvalidOperationException</code> - The command cannot be executed.
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1">Remarks</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p><code class="codeph">ExecuteNonQuery</code> returns the number of rows affected, for the following:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>If the command is <code class="codeph">UPDATE</code>, <code class="codeph">INSERT</code>, or <code class="codeph">DELETE</code> and the <code class="codeph">XmlCommandType</code> property is set to <code class="codeph">OracleXmlCommandType.None</code>. 
                        </p>
                     </li>
                     <li>
                        <p>If the <code class="codeph">XmlCommandType</code> property is set to <code class="codeph">OracleXmlCommandType.Insert</code>, <code class="codeph">OracleXmlCommandType.Update</code>, <code class="codeph">OracleXmlCommandType.Delete</code>. 
                        </p>
                     </li>
                  </ul>
                  <p>For all other types of statements, the return value is <code class="codeph">-1</code>.
                  </p>
                  <p><code class="codeph">ExecuteNonQuery</code> is used for either of the following:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Catalog operations (for example, querying the structure of a database or creating database objects such as tables).</p>
                     </li>
                     <li>
                        <p>Changing the data in a database without using a <code class="codeph">DataSet</code>, by executing <code class="codeph">UPDATE</code>, <code class="codeph">INSERT</code>, or <code class="codeph">DELETE</code> statements.
                        </p>
                     </li>
                     <li>
                        <p>Changing the data in a database using an XML document.</p>
                     </li>
                  </ul>
                  <p>Although <code class="codeph">ExecuteNonQuery</code> does not return any rows, it populates any output parameters or return values mapped to parameters with data.
                  </p>
                  <p>If the <code class="codeph">XmlCommandType</code> property is set to <code class="codeph">OracleXmlCommandType.Query</code> then <code class="codeph">ExecuteNonQuery</code> executes the select statement in the <code class="codeph">CommandText</code> property, and if successful, returns <code class="codeph">-1</code>. The XML document that is generated is discarded. This is useful for determining if the operation completes successfully without getting the XML document back as a result.
                  </p>
                  <p>If the <code class="codeph">XmlCommandType</code> property is set to <code class="codeph">OracleXmlCommandType.Insert</code>, <code class="codeph">OracleXmlCommandType.Update</code>, or <code class="codeph">OracleXmlCommandType.Delete</code>, then the value of the <code class="codeph">CommandText</code> property is an XML document. <code class="codeph">ExecuteNonQuery</code> saves the changes in that XML document to the table or view that is specified in the <code class="codeph">XmlSaveProperties</code> property. The return value is the number of rows that are processed in the XML document. Also, each row in the XML document could affect multiple rows in the database, but the return value is still the number of rows in the XML document.
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1">Example</p>
               </div>
               <!-- class="section" -->
               <div class="section"><pre class="oac_no_warn" dir="ltr">// C#
 
using System;
using System.Data;
using Oracle.DataAccess.Client; 
 
class ExecuteNonQuerySample
{
  static void Main()
  {
    string constr = "User Id=scott;Password=tiger;Data Source=oracle";
    OracleConnection con = new OracleConnection(constr);
    con.Open();
 
    OracleCommand cmd = new OracleCommand(
      "select sal from emp where empno=7934", con);
 
    object sal = cmd.ExecuteScalar();
    Console.WriteLine("Employee sal before update: " + sal);
 
    cmd.CommandText = "update emp set sal = sal + .01 where empno=7934";
 
    // Auto-commit changes
    int rowsUpdated = cmd.ExecuteNonQuery();
 
    if (rowsUpdated &gt; 0)
    {
      cmd.CommandText = "select sal from emp where empno=7934";
      sal = cmd.ExecuteScalar();
      Console.WriteLine("Employee sal after update: " + sal);
    }
 
    // Clean up
    cmd.Dispose();
    con.Dispose();
  }
}</pre></div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1">Requirements</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p>For XML support, this method requires Oracle9<span class="italic">i</span> XML Developer's Kits (Oracle XDK) or later, to be installed in the database. Oracle XDK can be downloaded from Oracle Technology Network (OTN).
                  </p>
                  <div class="infoboxnotealso" id="GUID-E1E79471-6037-4490-BDE7-ADE252922C83__GUID-F450C951-679E-4088-9762-213B0805EDF5">
                     <p class="notep1">See Also:</p>
                     <p></p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><span class="q">"<a href="intro003.html#GUID-2A5A5F0B-E6C9-45AF-9477-FBD55F7FCDC5">Oracle.DataAccess.Client and Oracle.ManagedDataAccess.Client Namespaces</a>"</span></p>
                        </li>
                        <li>
                           <p><a href="OracleCommandClass.html#GUID-7C1D5BCC-0268-4F1B-A583-F401F30EB9C0">OracleCommand Class</a></p>
                        </li>
                        <li>
                           <p><a href="OracleCommandMembers.html#GUID-675EB077-B6E5-4922-AA2B-407AC5DDCD66">OracleCommand Members</a></p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/odpnt&amp;id=otn_index" target="_blank"><code class="codeph">http://www.oracle.com/technetwork/index.html</code></a></p>
                        </li>
                     </ul>
                  </div>
               </div>
               <!-- class="section" -->
            </div>
         </div>
      </article>
   </body>
</html>