<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>OracleConnectionStringBuilder Class</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Developer's Guide ">
      <meta property="og:description" content>
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Developer's Guide for Microsoft Windows">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="oracle-data-provider-net.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2018-08-24T00:49:54-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="2002, 2018">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E90593-02">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/18">
      
      <link rel="prev" href="OracleConnectionOpenEventHandlerDelegate.html" title="Previous" type="text/html">
      <link rel="next" href="OracleConnectionStringBuilderMembers.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"18","element_name":"Release 18","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="OracleÂ® Data Provider for .NET">
    <meta name="dcterms.isVersionOf" content="ODPNT">
    <meta name="dcterms.release" content="Release 18">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="OracleConnectionOpenEventHandlerDelegate.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="OracleConnectionStringBuilderMembers.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Developer's Guide </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="odp-dot-net-classes.html" property="item" typeof="WebPage"><span property="name">Oracle Data Provider for .NET Classes</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">OracleConnectionStringBuilder Class</li>
            </ol>
            <a id="GUID-81FD2CFC-D2CE-47A8-BF0A-2F18428A6D5F" name="GUID-81FD2CFC-D2CE-47A8-BF0A-2F18428A6D5F"></a><a id="ODPNT2684"></a><a id="ODPNT2685"></a><a id="ODPNT8209"></a><a id="ODPNT2686"></a><a id="ODPNT2687"></a><a id="ODPNT2688"></a><a id="ODPNT2683"></a>
            
            <h2 id="ODPNT-GUID-81FD2CFC-D2CE-47A8-BF0A-2F18428A6D5F" class="sect2"><span class="enumeration_section">6.7 </span>OracleConnectionStringBuilder Class
            </h2>
         </header>
         <div class="ind">
            <div>
               <div class="section">
                  <p>An <code class="codeph">OracleConnectionStringBuilder</code> object allows applications to create or modify connection strings.
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1">Class Inheritance</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p><code class="codeph">System.Object</code></p>
                  <p><code class="codeph">&nbsp;&nbsp;System.Data.Common.DbConnectionStringBuilder</code> 
                  </p>
                  <p><code class="codeph">&nbsp;&nbsp;&nbsp;&nbsp;Oracle.DataAccess.Client.OracleConnectionStringBuilder</code></p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1">Declaration</p>
               </div>
               <!-- class="section" -->
               <div class="section"><pre class="oac_no_warn" dir="ltr">// C#
public sealed class OracleConnectionStringBuilder : DbConnectionStringBuilder
</pre></div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1">Requirements</p>
               </div>
               <!-- class="section" -->
               <div class="tblformal" id="GUID-81FD2CFC-D2CE-47A8-BF0A-2F18428A6D5F__GUID-7174F134-6714-4238-8B6D-BB35D22D21DD">
                  <table cellpadding="4" cellspacing="0" class="Formal" title summary="requirements" width="100%" frame="hsides" border="1" rules="rows">
                     <thead>
                        <tr align="left" valign="top">
                           <th align="left" valign="bottom" width="24%" id="d168907e102">Provider</th>
                           <th align="left" valign="bottom" width="36%" id="d168907e106">ODP.NET, Unmanaged Driver</th>
                           <th align="left" valign="bottom" width="40%" id="d168907e110">ODP.NET, Managed Driver</th>
                        </tr>
                     </thead>
                     <tbody>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="24%" id="d168907e116" headers="d168907e102 ">
                              <p><span class="bold">Assembly</span></p>
                           </td>
                           <td align="left" valign="top" width="36%" headers="d168907e116 d168907e106 ">
                              <p><code class="codeph">Oracle.DataAccess.dll</code></p>
                           </td>
                           <td align="left" valign="top" width="40%" headers="d168907e116 d168907e110 ">
                              <p><code class="codeph">Oracle.ManagedDataAccess.dll</code></p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="24%" id="d168907e129" headers="d168907e102 ">
                              <p><span class="bold">Namespace</span></p>
                           </td>
                           <td align="left" valign="top" width="36%" headers="d168907e129 d168907e106 ">
                              <p><code class="codeph">Oracle.DataAccess.Client</code></p>
                           </td>
                           <td align="left" valign="top" width="40%" headers="d168907e129 d168907e110 ">
                              <p><code class="codeph">Oracle.ManagedDataAccess.Client</code></p>
                           </td>
                        </tr>
                        <tr align="left" valign="top">
                           <td align="left" valign="top" width="24%" id="d168907e142" headers="d168907e102 ">
                              <p><span class="bold">.NET Framework</span></p>
                           </td>
                           <td align="left" valign="top" width="36%" headers="d168907e142 d168907e106 ">
                              <p>3.5, 4.5, 4.6, 4.7</p>
                           </td>
                           <td align="left" valign="top" width="40%" headers="d168907e142 d168907e110 ">
                              <p>4.5, 4.6, 4.7</p>
                           </td>
                        </tr>
                     </tbody>
                  </table>
               </div>
               <!-- class="inftblhruleinformal" -->
               <div class="section">
                  <p class="subhead1">Thread Safety</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p>All public static methods are thread-safe, although instance methods do not guarantee thread safety.</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1">Remarks</p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p>The following rules must be followed for setting values with reserved characters:</p>
                  <ol>
                     <li>
                        <p>Values containing characters enclosed within single quotes</p>
                        <p>If the value contains characters that are enclosed within single quotation marks, then the entire value must be enclosed within double quotation marks.</p>
                        <p>For example, <code class="codeph">password =</code> <code class="codeph">"'scoTT'"</code> where the value is <code class="codeph">'scoTT'</code>.
                        </p>
                     </li>
                     <li>
                        <p>Values containing characters enclosed within double quotes</p>
                        <p>Values should be enclosed in double quotation marks to preserve the case and to avoid the upper casing of values.</p>
                        <p>If the value contains characters enclosed in double quotation marks, then it must be enclosed in single quotation marks.</p>
                        <p>For example, <code class="codeph">password =</code> '<code class="codeph">"scoTT"'</code> where the value is <code class="codeph">"scoTT"</code>.
                        </p>
                     </li>
                     <li>
                        <p>Values containing characters enclosed in both single and double quotes</p>
                        <p>If the value contains characters enclosed in both single and double quotation marks, the quotation mark used to enclose the value must be doubled each time it occurs within the value.</p>
                        <p>For example, <code class="codeph">password = </code><code class="codeph">'"sco''TT"'</code> where the value is <code class="codeph">"sco'TT"</code>.
                        </p>
                     </li>
                     <li>
                        <p>Values containing spaces</p>
                        <p>All leading and trailing spaces are ignored, but the spaces between the value are recognized. If the value needs to have leading or trailing spaces then it must be enclosed in double quotation marks.</p>
                        <p>For example, <code class="codeph">User ID =</code> <code class="codeph">Sco</code> <code class="codeph">TT</code> where the value is <code class="codeph">&lt;Sco</code> <code class="codeph">TT&gt;</code>.
                        </p>
                        <p>For example, <code class="codeph">User ID =</code> <code class="codeph">"Sco</code> <code class="codeph">TT "</code> where the value is <code class="codeph">&lt;Sco</code> <code class="codeph">TT&gt;</code>.
                        </p>
                     </li>
                     <li>
                        <p>Keywords occurring multiple times in a connection string </p>
                        <p>If a specific keyword occurs multiple times in a connection string, the last occurrence listed is used in the value set.</p>
                        <p>For example, with <code class="codeph">"User ID = scott; password = tiger; User ID = david"</code> connection string, <code class="codeph">User ID</code> value is <code class="codeph">david</code>.
                        </p>
                     </li>
                  </ol>
                  <p>To limit malicious access, the APIs of <code class="codeph">OracleConnectionStringBuilder</code>, <code class="codeph">Add</code> and <code class="codeph">Item</code>, insert double quotes around connection string attributes that use special characters. Using special characters in strings can be a format string attack method. Adding double quotes for attributes will not affect database access in most cases. However, there are attributes that require exact string matching, such as passwords. <code class="codeph">OracleConnectionStringBuilder</code>'s addition of double quotes to a password with special characters may result in a generation of a connection string that fails to authenticate against the database.
                  </p>
               </div>
               <!-- class="section" -->
               <div class="section">
                  <p class="subhead1">Example </p>
               </div>
               <!-- class="section" -->
               <div class="section"><pre class="oac_no_warn" dir="ltr">// C#
 
using System;
using System.Data;
using System.Data.Common;
using Oracle.DataAccess.Client;
using System.Collections;
 
class ConnectionStringBuilderSample
{
static void Main(string[] args)
  {
    bool bRet = false;
    
    // Create an instance of OracleConnectionStringBuilder
    OracleConnectionStringBuilder connStrBuilder =
      new OracleConnectionStringBuilder();

    // Add new key/value pairs to the connection string
    connStrBuilder.Add("User Id", "scott");
    connStrBuilder.Add("Password", "tiger");
    connStrBuilder.Add("Data Source", "oracle");    
    connStrBuilder.Add("pooling", false);
    
    // Modify the existing value
    connStrBuilder["Data source"] = "inst1";
    
    // Remove an entry from the connection string
    bRet = connStrBuilder.Remove("pooling");
 
    //ContainsKey indicates whether or not the specific key exist
    //returns true even if the user has not specified it explicitly
    Console.WriteLine("Enlist exist: " + 
              connStrBuilder.ContainsKey("Enlist"));
 
    //returns false
    connStrBuilder.ContainsKey("Invalid");
 
    // ShouldSerialize indicates whether or not a specific key 
    // exists in connection string inherited from DbConnectionStringBuilder.
    // returns true if the key is explicitly added the user otherwise false;
    // this will return false as this key doesn't exists.
    connStrBuilder.ShouldSerialize("user"); 
 
    // returns false because this key is nott added by user explicitly.
    connStrBuilder.ShouldSerialize("Enlist");
 
    // IsFixedSize [read-only property]
    Console.WriteLine("Connection String is fixed size only: "
                            + connStrBuilder.IsFixedSize);
    Console.WriteLine("Key/Value Pair Count: " + connStrBuilder.Count);
 
    //adding a new key which is not supported by the provider 
    //is not allowed.
    try
    {
      //this will throw an exception.
      connStrBuilder.Add("NewKey", "newValue");
    }
    catch (Exception ex)
    {
      Console.WriteLine(ex.Message);
    }
 
    Console.WriteLine("Key/Value Pair Count: " + connStrBuilder.Count);
 
    //modifying a existing key is allowed.
    connStrBuilder.Add("Enlist", false);
    Console.WriteLine("Key/Value Pair Count: " + connStrBuilder.Count);
 
    // Get all the keys and values supported by the provider.
    ICollection keyCollection = connStrBuilder.Keys;
    ICollection valueCollection = connStrBuilder.Values;
 
    IEnumerator keys = keyCollection.GetEnumerator();
    IEnumerator values = valueCollection.GetEnumerator();
    
    while (keys.MoveNext())
    {
      values.MoveNext();
      Console.WriteLine("Key: {0}     Value: {1} \n" 
        ,keys.Current ,values.Current);
    }
  }
}</pre><div class="infoboxnotealso" id="GUID-81FD2CFC-D2CE-47A8-BF0A-2F18428A6D5F__GUID-965E6B35-53B9-4483-AA66-8472969497EB">
                     <p class="notep1">See Also:</p>
                     <p></p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><span class="q">"<a href="intro003.html#GUID-2A5A5F0B-E6C9-45AF-9477-FBD55F7FCDC5">Oracle.DataAccess.Client and Oracle.ManagedDataAccess.Client Namespaces</a>"</span></p>
                        </li>
                        <li>
                           <p><a href="OracleConnectionStringBuilderMembers.html#GUID-E30D3C68-7BD3-4850-A9C8-DCFD59FFD6C6">OracleConnectionStringBuilder Members</a></p>
                        </li>
                        <li>
                           <p><a href="ConnectionStringBuilderConstructors.html#GUID-B5D76ECB-61C5-4493-A08F-420BA64D9B1A">OracleConnectionStringBuilder Constructors</a></p>
                        </li>
                        <li>
                           <p><a href="ConnectionStringBuilderPublicProperties.html#GUID-CA97ACE9-ABE9-4804-BEA9-25398C07552E">OracleConnectionStringBuilder Public Properties</a></p>
                        </li>
                        <li>
                           <p><a href="ConnectionStringBuilderPublicMethods.html#GUID-4DE4CABC-5A2E-4ADB-A8D0-A4EB1BF7770D">OracleConnectionStringBuilder Public Methods</a></p>
                        </li>
                     </ul>
                  </div>
               </div>
               <!-- class="section" -->
            </div>
         </div>
      </article>
   </body>
</html>