<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- Part number: F12654-01 -->
        <!-- Published date: November 2018 -->
        <!-- See this link for directions on getting a part number: https://confluence.oraclecorp.com/confluence/display/DLPP/Archive+an+OBE -->
        <!-- Template date: October 15, 2018 -->
        <meta name="contentid" content="25730">
        <meta content="text/html; charset=utf-8" http-equiv="content-type">
        <title>Create a SQL Performance Analyzer Report</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="robots" content="INDEX, FOLLOW">
        <meta name="description" content="Learn how to create a SQL Performance Analyzer report.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="css/normalize.min.css">
        <link rel="stylesheet" href="css/font-awesome.min.css">
        <link rel="stylesheet" href="css/obe-lite.css">
        <script src="js/jquery-1.11.0.min.js"></script>
        <script src="js/jquery-ui-1.10.4.custom.js"></script>
        <script src="js/jquery.tocify.jd.js"></script>
        <script src="js/leftnav.js"></script>
    
    <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
    <meta name="dcterms.created" content="2018-11-29T04:13:14+00:00">
    <meta name="dcterms.title" content="Oracle Database OBE Create a SQL Performance Analyzer Report">
    <meta name="dcterms.category" content="database">
    <meta name="dcterms.isVersionOf" content="OBEYC">
    <meta name="dcterms.product" content="en/database/oracle/oracle-database/18">
    <meta name="dcterms.identifier" content="F12654-01">
    <meta name="dcterms.release" content="Release 18">
  <script id="ssot-metadata" type="application/json"> {"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"18","element_name":"Release 18","display_in_url":true}}} </script>
    </head>
    <body>
        <header>
            <div class="w1024" style="min-height:55px; display:block;"> <a href="https://docs.oracle.com" class="oracle-logo">
              <img src="./img/oracle_doc_logo.png" alt="Oracle Documentation" style="max-width: none;" height="22" width="236"></a>
            </div>
        </header>
        <!--end header-->

        <div id="content">

            <h1><img src="./img/obe_tag.png" align="middle" alt="Oracle by Example branding">Create a SQL Performance Analyzer Report</h1>
            <div class="w1024" style="clear:both; position:relative; margin-top:40px;">
                <div class="navbackwide border-right"><!-- --></div>
                <div id="shownav" title="Show Navigation" tabindex="0"><span class="fa fa-list"></span></div>
                <div id="sidebar"><!-- -->
                    <div class="left-nav-tut"><!-- -->
                        <div id="hidenavw" title="Hide Navigation" tabindex="0"><span class="fa fa-close"></span></div>
                        <div id="navbar" class="left-nav-w"><!-- -->
                            <div id="toc" class="tocify"><!-- --></div>
                        </div>
                    </div>
                </div>
                <div id="bookContainer">
                    <article>
                        <section>
                            <h2><img src="./img/32_begin.png" alt="section 0" height="32" width="32" class="num_circ">Before You Begin</h2>
                            <p>This 15-minute tutorial shows you how to create a SQL Performance Analyzer report, which compares SQL performance on two Oracle databases.</p>
                            <h3>Background</h3>
                            <p>You can use SQL Performance Analyzer to analyze and compare the performance of a SQL workload on two different Oracle databases. This procedure assumes that a SQL tuning set was created on one Oracle database and then transferred to another Oracle database. The SQL tuning set contains a SQL workload. Create a SQL Performance Analyzer task, and then populate it with two trials: a pre-change trial, which describes the performance of the workload on the original database, and a post-change trial, which describes the performance of the same workload on the current database.</p>
                            <h3>What Do You Need?</h3>
                            <ul>
                                <li>An Oracle database</li>   
                                <li>The <code>SYSDBA</code> administrative privilege</li>
                                <li>A SQL tuning set, which was created on another Oracle database and then transferred to the Oracle database used in this tutorial. This tutorial assumes that the SQL tuning set is named <code>MY_WORKLOAD_STS</code>.</li>
                            </ul>
                        </section>

                        <!-- ========================================================================================================================= -->
                        <section>
                            <hr>
                            <h2 id="section_1" role="button" style="text-align: left;"><img src="./img/32_1.png" alt="section 1" height="32" width="32" class="num_circ">Create a SQL Performance Analyzer Task</h2>
                            <ol>
                                <li>Use SQL*Plus to log in to the database as a user who has the <code>SYSDBA</code> administrative privilege.<pre>$ sqlplus / as sysdba</pre></li>
                                <li>Create SQL Performance Analyzer task <code>MY_WORKLOAD_TASK</code>. The task uses the SQL tuning set <code>MY_WORKLOAD_STS</code>, which was created on another database, and then transferred to the current database.</li>
                                    <pre>SQL> VARIABLE task_name VARCHAR2(100);<br>SQL> EXEC :task_name := DBMS_SQLPA.CREATE_ANALYSIS_TASK( -<br>> sqlset_name => 'MY_WORKLOAD_STS', -<br>> task_name   => 'MY_WORKLOAD_TASK', -<br>> description => 'Peak Usage Workload');</pre>
                            </ol>
                        </section>
                        <hr>
                        <section>
                            <h2 id="section_2" role="button" style="text-align: left;"><img src="./img/32_2.png" alt="section 2" height="32" width="32" class="num_circ">Create a Pre-Change Trial and a Post-Change Trial</h2>
                            <ol>
                                <li>Create a pre-change trial, which represents workload performance on the <i>original</i> database, by converting the SQL tuning set <code>MY_WORKLOAD_STS</code>.</li> 
                                    <pre>SQL> BEGIN<br>  2  DBMS_SQLPA.EXECUTE_ANALYSIS_TASK(<br>  3  task_name      => 'MY_WORKLOAD_TASK',<br>  4  execution_type => 'CONVERT SQLSET',<br>  5  execution_name => 'PRE_CHANGE_TRIAL');<br>  6  END;<br>  7  /</pre>
                                <li>Create a post-change trial, which represents workload performance on the <i>current</i> database, by executing the SQL statements from SQL tuning set <code>MY_WORKLOAD_STS</code>.
                                    <pre>SQL> BEGIN<br>  2  DBMS_SQLPA.EXECUTE_ANALYSIS_TASK(<br>  3  task_name      => 'MY_WORKLOAD_TASK',<br>  4  execution_type => 'TEST EXECUTE',<br>  5  execution_name => 'POST_CHANGE_TRIAL');<br>  6  END;<br>  7  /</pre></li>
                            </ol>
                        </section>
                        <hr>
                        <section>
                            <h2 id="section_3" role="button" style="text-align: left;"><img src="./img/32_3.png" alt="section 3" height="32" width="32" class="num_circ">Create a SQL Performance Analyzer Report</h2>
                            <ol>
                                <li>Use SQL Performance Analyzer to analyze and compare the performance of the pre-change trial and the post-change trial. For a comparison metric, this report uses <code>buffer_gets</code>, which represents the number of times the database accessed a block.
                                    <pre>SQL> BEGIN<br>  2  DBMS_SQLPA.EXECUTE_ANALYSIS_TASK(<br>  3  task_name        => 'MY_WORKLOAD_TASK',<br>  4  execution_type   => 'COMPARE PERFORMANCE',<br>  5  execution_params => DBMS_ADVISOR.ARGLIST(<br>  6    'execution_name1', 'PRE_CHANGE_TRIAL', 'execution_name2',<br>  7    'POST_CHANGE_TRIAL', 'comparison_metric', 'buffer_gets'),<br>  8  execution_desc  => 'Compare buffer_gets');<br>  9  END;<br> 10  /</pre></li>
                                <li>Produce a SQL Performance Analyzer Report in HTML.<p></p>
                                <pre>SQL> SET LONG 100000 LONGCHUNKSIZE 100000 LINESIZE 130 PAGESIZE 0 ECHO OFF<br>SQL> spool my_workload_spa_report.html<br>SQL> SELECT DBMS_SQLPA.REPORT_ANALYSIS_TASK('MY_WORKLOAD_TASK', 'html') FROM DUAL;<br>SQL> spool off</pre></li>
                                <li>Exit SQL*Plus.<pre>SQL> exit</pre></li>
                                <li>Open in an editor the file <code>my_workload_spa_report.html</code>. If the following is the first line in the file, remove it:<pre>SQL> SELECT DBMS_SQLPA.REPORT_ANALYSIS_TASK('MY_WORKLOAD_TASK', 'html') FROM DUAL;</pre>The first line of the file should be:<pre>&lt;html&gt;</pre></li>
                                <li>Save the file <code>my_workload_spa_report.html</code>.</li>
                                <li>Open <code>my_workload_spa_report.html</code> in a web browser.<br>If you cannot open this file in a browser on the database host, transfer the file to a system on which you are able to open it in a browser.
                                    <figure><img src="./img/spa_report.png" alt="SQL Performance Analyzer report" class="ScreenShot">
                                        <figcaption><a href="files/spa_report.txt">Description of the illustration spa_report.png</a></figcaption>
                                    </figure></li>
                                <li>Review the report to identify any regressions.</li>
                                <li>Tune any regressed SQL statements.</li>
                            </ol>
                        </section>
                        <hr>
                        <section>
                            <!-- Include the More Information section only in a single or the final lab or tutorial in a series -->
                            <h2 id="more_info" role="button" style="text-align: left;"><img src="./img/32_more.png" alt="more information" height="32" width="32" class="num_circ">Want to Learn More?</h2>
                            <ul>
                                <li><a class="external-link" href="../ratug/creating-an-analysis-task.html#RATUG-GUID-A00000CF-F2DA-4138-BBFB-6FA03D889EBA" rel="nofollow" target="_blank">Creating an Analysis Task Using APIs</a></li>
                                <li><a class="external-link" href="../ratug/creating-a-pre-change-sql-trial.html#RATUG-GUID-93D5C8A9-7E85-4467-B3E4-323B1732BA5D" rel="nofollow" target="_blank">Creating a Pre-Change SQL Trial Using APIs</a></li>
                                <li><a class="external-link" href="../ratug/creating-a-post-change-sql-trial.html#RATUG-GUID-0C96536D-8129-4794-8527-1AA9FD240E2C" rel="nofollow" target="_blank">Creating a Post-Change SQL Trial Using APIs</a></li>
                                <li><a class="external-link" href="../ratug/comparing-sql-trials.html#RATUG-GUID-1B56ACA0-7C76-4963-B645-E90FB1968840" rel="nofollow" target="_blank">Reviewing the SQL Performance Analyzer Report in Command-Line</a></li>
                                <li><a class="external-link" href="../ratug/comparing-sql-trials.html#RATUG-GUID-B85471DE-CC06-4E02-AFA6-AD207D94C8C8" rel="nofollow" target="_blank">Tuning Regressed SQL Statements Using APIs</a></li>
                            </ul>
                        </section>
                        <hr>
                    </article>
                </div>
                <br class="clearfloat">
            </div>
        </div>
        <!--close main--> 
        <!--end content-->
        <div class="footer-container ">
            <div style="max-width: 994px; padding:10px 0 0 17px;">
                <footer class="footer-list">
                    <ul>
                        <li> <a href="https://www.oracle.com/corporate/index.html" target="_blank">About Oracle</a> </li>
                        <li> <a href="https://www.oracle.com/us/corporate/contact/index.html" target="_blank">Contact Us</a> </li>
                        <li> <a href="https://www.oracle.com/us/legal/index.html" target="_blank">Legal Notices</a> </li>
                        <li> <a href="https://www.oracle.com/us/legal/terms/index.html" target="_blank">Terms of Use</a> </li>
                        <li> <a href="https://www.oracle.com/us/legal/privacy/index.html" target="_blank">Your Privacy Rights</a> </li>
                        <li><a href="https://www.oracle.com/pls/topic/lookup?ctx=cpyr&id=en">Copyright © 2018, Oracle and/or its affiliates. All rights reserved.</a></li>
                    </ul>
                </footer>
            </div>
            <script type="text/javascript" src="https://www.oracleimg.com/us/assets/metrics/ora_docs.js"></script>
        </div>
        <!-- OBE Dialog Box code 5/31/2018 -->
        <div id="lpModal" class="modal">
            <!-- Modal hdr and body -->
            <div id="obe_dialog" class="modal-content">
                <div class="modal-header">
                    <a href="#" class="close">  
                        <span class="close">&times;</span>
                    </a>
                    <h1>Associated Learning Paths</h1>
                </div>
                <div id="dialog-content">
                </div>
                <div id="dialog-close" class="closeBtn">
                    <a href="#" class="close2">  
                        <p class="close2"> 
                            <span>&nbsp;&nbsp;Got It! &nbsp;</span> 
                        </p>
                    </a>  
                </div>
            </div>   
        </div>
    </body>
</html>
