<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="You can use Oracle Database Vault in a multitenant container database (CDB).">
      <meta name="description" content="You can use Oracle Database Vault in a multitenant container database (CDB).">
      <title>Using Oracle Database Vault with a CDB</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Administrator’s Guide ">
      <meta property="og:description" content="You can use Oracle Database Vault in a multitenant container database (CDB).">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Administrator’s Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="multitenant-administrators-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-03-20T07:27:44-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="2017, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E84914-08">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/18">
      
      <link rel="prev" href="using-oracle-scheduler-with-a-cdb.html" title="Previous" type="text/html">
      <link rel="next" href="using-xstream-with-a-cdb.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"18","element_name":"Release 18","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Multitenant Administrator's Guide">
    <meta name="dcterms.isVersionOf" content="MULTI">
    <meta name="dcterms.release" content="Release 18">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="using-oracle-scheduler-with-a-cdb.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="using-xstream-with-a-cdb.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Administrator’s Guide </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="using-oracle-features-in-a-multitenant-environment.html" property="item" typeof="WebPage"><span property="name">Using Oracle Features in a Multitenant Environment</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem"> Using Oracle Database Vault with a CDB</li>
            </ol>
            <a id="GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" name="GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3"></a>
            
            <h2 id="MULTI-GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" class="sect2"><span class="enumeration_chapter">23 </span> Using Oracle Database Vault with a CDB
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>You can use Oracle Database Vault in a multitenant container database (CDB).</p>
               <p>This section contains the following topics:</p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-59526942-DC4F-489B-819E-D4F33BA17F9D">About Oracle Database Vault</a><br>The Oracle Database Vault security controls protect application data from unauthorized access, and comply with privacy and regulatory requirements. 
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-F4182518-DEFF-4433-9593-0D73315DF661">How Oracle Database Vault Works in a Multitenant Environment</a><br>To provide increased security for consolidation, you can use Oracle Database Vault with Oracle Multitenant.
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-9D1223B5-3B22-4343-B9DA-05B4BC72F260">Manually Installing Oracle Database Vault in a Multitenant Environment</a><br>Under certain conditions, for a multitenant environment, you must manually install Oracle Database Vault. 
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-B5569AED-AC16-482C-BA6D-34E275F016D2">Verifying That Database Vault Is Configured and Enabled</a><br>The <code class="codeph">DBA_DV_STATUS</code>, <code class="codeph">CDB_DV_STATUS</code>, <code class="codeph">DBA_OLS_STATUS</code>, and <code class="codeph">CDB_OLS_STATUS</code> data dictionary views verify if Oracle Database is configured and enabled. 
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CC1B6F0-FDDB-4183-8233-0AC6B208667A">Registering Database Vault in the CDB Root</a><br>In a multitenant environment, you register Oracle Database Vault with common users who will use the Database Vault-enforced roles in the CDB root.
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-E30BC167-13D6-4C84-ABCC-28CBFF704193">Registering Database Vault Common Users to Manage Specific PDBs</a><br>In a multitenant environment, you must register Oracle Database Vault in the root first, then in the PDBs afterward.
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-C6218DD3-BB78-40F7-8BE2-7391D3BF6418">Creating Common Database Vault Accounts for a Plugged in Database Vault PDB</a><br>From SQL*Plus, in a multitenant environment, you can plug in a database that already has Database Vault enabled.
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-72403156-3E91-43FD-8D06-859DBBC10568">Realms in a Multitenant Environment</a><br>In a multitenant environment, you can create a realm to protect common objects in the application root.
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-DA60AF6B-D669-4E17-94B4-043BB41FC673">Realm Authorizations in a Multitenant Environment</a><br>In a multitenant environment, the rules and behavior for common realm authorizations are similar to the authorizations for other common objects. 
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-6308CB8B-6777-44AF-A523-F1A956591F6D">Rule Sets and Rules in a Multitenant Environment</a><br>In a multitenant environment, you can create a rule set and its associated rules in the application root.
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-571C5AF1-909C-4A76-BE2B-9BAC5232FE84">Command Rules in a Multitenant Environment</a><br>In a multitenant environment, you can create common and local command rules in either the CDB root or the application root.
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-07513135-CB45-4788-A596-E5A71879BB81">Oracle Database Vault Policies in a Multitenant Environment</a><br>Oracle Database Vault policies are only local to the pluggable database (PDB) in which they were created. 
                  </li>
                  <li class="ulchildlink"><a href="using-oracle-database-vault-with-a-cdb.html#GUID-517E9611-546B-43D9-8C54-37037AF0B198">Converting a Standalone Oracle Database to a PDB and Plugging It into a CDB</a><br>You can convert a standalone Oracle Database Release 12c or later database to a PDB, and then plug this PDB into a CDB.
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>Parent topic:</strong> <a href="using-oracle-features-in-a-multitenant-environment.html#GUID-CE922DAA-66FB-430B-96E5-29FF50BFD2FF" title="You can use Oracle Database features in a multitenant environment.">Using Oracle Features in a Multitenant Environment</a></p>
                  </div>
               </div>
            </div>
            
            <div class="props_rev_3"><a id="GUID-59526942-DC4F-489B-819E-D4F33BA17F9D" name="GUID-59526942-DC4F-489B-819E-D4F33BA17F9D"></a><h3 id="MULTI-GUID-59526942-DC4F-489B-819E-D4F33BA17F9D" class="sect3"><span class="enumeration_section">23.1 </span>About Oracle Database Vault
               </h3>
               <div>
                  <p>The Oracle Database Vault security controls protect application data from unauthorized access, and comply with privacy and regulatory requirements. </p>
                  <p>You can deploy controls to block privileged account access to application data and control sensitive operations inside the database using trusted path authorization. Through the analysis of privileges and roles, you can increase the security of existing applications by using least privilege best practices. Oracle Database Vault secures existing database environments transparently, eliminating costly and time consuming application changes.</p>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="../dvadm/introduction-to-oracle-database-vault.html#DVADM-GUID-0C8AF1B2-6CE9-4408-BFB3-7B2C7F9E7284" target="_blank"><span><cite>Oracle Database Vault Administrator’s Guide</cite></span></a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="You can use Oracle Database Vault in a multitenant container database (CDB).">Using Oracle Database Vault with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-F4182518-DEFF-4433-9593-0D73315DF661" name="GUID-F4182518-DEFF-4433-9593-0D73315DF661"></a><h3 id="MULTI-GUID-F4182518-DEFF-4433-9593-0D73315DF661" class="sect3"><span class="enumeration_section">23.2 </span>How Oracle Database Vault Works in a Multitenant Environment
               </h3>
               <div>
                  <p>To provide increased security for consolidation, you can use Oracle Database Vault with Oracle Multitenant.</p>
                  <p>Oracle Database Vault can prevent privileged user access inside a pluggable database (PDB) and between the PDB and the common privileged user at the container database. Each PDB has its own Database Vault metadata, such as realms, rule sets, command rules, default policies (such as default realms), and so on. In addition, the objects within the <code class="codeph">DVSYS</code> and <code class="codeph">DVF</code> schemas are automatically available to any child PDBs. Both schemas are common user schemas. 
                  </p>
                  <p>You can configure common realms in the application root only, but you can create common rule sets and command rules in either the application root or the CDB root. A common command rule in the application root applies to its associated PDBs, and common command rules in the CDB root apply to all PDBs in the CDB environment. The ability to create common realms and command rules enables you to create policies that use a shared set of realms, rule sets, or command rules throughout the CDB environments, rather than having to create these same components for every PDB in the multitenant environment. The common protection applies for all PDBs associated with the application root that have Oracle Database Vault enabled.</p>
                  <p>You can create individual local policies for each PDB. When you use Database Vault to protect an object, Database Vault subjects common privileges for common objects to the same enforcement rules as local system privileges. </p>
                  <p>When you configure a PDB that has Database Vault enabled, the <code class="codeph">DVSYS</code> schema is a common user schema that is stored in the root. This means that all the objects within the <code class="codeph">DVSYS</code> schema (tables, data dictionary views, user accounts, PL/SQL packages, default policies, and so on) are subject to the common privileges available for this schema. In other words, you can create realms, factors, and so on in the root to protect the schema in the root. Ensure that you configure Database Vault in the root first, before you configure it in the associated PDBs.
                  </p>
                  <p>When you enable Oracle Database Vault in the CDB root, you can choose either regular mode or strict mode. The settings propagate throughout the CDB based on the setting you choose. For example, suppose a CDB contains both Database Vault-enabled PDBs and PDBs in which Database Vault is not enabled. If you enable Database Vault using regular mode, then both types of PDBs continue to function normally. If you enable Database Vault using strict mode, then the Database Vault-disabled PDBs operate in restricted mode. </p>
                  <p><a href="using-oracle-database-vault-with-a-cdb.html#GUID-F4182518-DEFF-4433-9593-0D73315DF661__CHDGHEHH">Figure 23-1</a> illustrates how the database in regular mode allows different access for common and local database administrators depending if Database Vault is enabled. In this scenario, neither the common user nor the local users have access to the realms in PDB1 and PDB2. Both the common user and the PDB3 local user have access to the Custom App application in PDB3, where Database Vault is not enabled.
                  </p>
                  <div class="figure" id="GUID-F4182518-DEFF-4433-9593-0D73315DF661__CHDGHEHH">
                     <p class="titleinfigure">Figure 23-1 Oracle Database Vault in a Multitenant Environment with Regular Mode</p><img src="img/dvadm_vm_005c.png" alt="Description of Figure 23-1 follows" title="Description of Figure 23-1 follows" longdesc="img_text/dvadm_vm_005c.html"><br><a href="img_text/dvadm_vm_005c.html">Description of "Figure 23-1 Oracle Database Vault in a Multitenant Environment with Regular Mode"</a></div>
                  <!-- class="figure" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="using-oracle-database-vault-with-a-cdb.html#GUID-72403156-3E91-43FD-8D06-859DBBC10568" title="In a multitenant environment, you can create a realm to protect common objects in the application root.">Realms in a Multitenant Environment</a></li>
                        <li><a href="using-oracle-database-vault-with-a-cdb.html#GUID-6308CB8B-6777-44AF-A523-F1A956591F6D" title="In a multitenant environment, you can create a rule set and its associated rules in the application root.">Rule Sets and Rules in a Multitenant Environment</a></li>
                        <li><a href="using-oracle-database-vault-with-a-cdb.html#GUID-571C5AF1-909C-4A76-BE2B-9BAC5232FE84" title="In a multitenant environment, you can create common and local command rules in either the CDB root or the application root.">Command Rules in a Multitenant Environment</a></li>
                        <li><a href="using-oracle-database-vault-with-a-cdb.html#GUID-517E9611-546B-43D9-8C54-37037AF0B198" title="You can convert a standalone Oracle Database Release 12c or later database to a PDB, and then plug this PDB into a CDB.">Converting a Standalone Oracle Database to a PDB and Plugging It into a CDB</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="You can use Oracle Database Vault in a multitenant container database (CDB).">Using Oracle Database Vault with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-9D1223B5-3B22-4343-B9DA-05B4BC72F260" name="GUID-9D1223B5-3B22-4343-B9DA-05B4BC72F260"></a><h3 id="MULTI-GUID-9D1223B5-3B22-4343-B9DA-05B4BC72F260" class="sect3"><span class="enumeration_section">23.3 </span>Manually Installing Oracle Database Vault in a Multitenant Environment
               </h3>
               <div>
                  <p>Under certain conditions, for a multitenant environment, you must manually install Oracle Database Vault. </p>
                  <div class="section">For example, you must manually install Oracle Database Vault if a release 11g Oracle database without Database Vault is upgraded to release 12c, then converted to a PDB to be plugged into a 12c Database Vault-enabled database. In addition, you must manually install Oracle Database Vault (and Oracle Label Security) in a PDB if this PDB does not have these products when the PDB has been plugged into a CDB where Database Vault and Label Security are installed.</div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>As user who has been granted the <code class="codeph">SYSDBA</code> administrative privilege, log in to the PDB in which you want to install Oracle Database Vault. </span><div>
                           <p>For example, to log in to a PDB named <code class="codeph">hr_pdb</code>:
                           </p><pre class="pre codeblock"><code>sqlplus sec_admin@hr_pdb as sysdba
Enter password: <span class="italic">password</span></code></pre><p>To find the available PDBs, run the <code class="codeph">show pdbs</code> command. To check the current PDB, run the <code class="codeph">show con_name</code> command.
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>If necessary, check if Oracle Database Vault and Oracle Label Security are already installed on this PDB.</span><div>If the <code class="codeph">DVSYS</code> account (for Database Vault) and the <code class="codeph"> LBACSYS</code> account (for Label Security) exist, then Database Vault and Label Security exist on the PDB. 
                        </div>
                        <div><pre class="pre codeblock"><code>SELECT USERNAME FROM DBA_USERS WHERE USERNAME IN ('DVSYS', 'LBACSYS');</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>If neither Database Vault nor Label Security have been installed, then install Oracle Label Security by executing the <code class="codeph">catols.sql</code> script.</span><div><pre class="pre codeblock"><code>@$ORACLE_HOME/rdbms/admin/catols.sql</code></pre><p>Oracle Label Security must be installed before you can install Oracle Database Vault.</p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>Install Oracle Database Vault by executing the <code class="codeph">catmac.sql</code> script.</span><div><pre class="pre codeblock"><code>@$ORACLE_HOME/rdbms/admin/catmac.sql</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>At the <code class="codeph">Enter value for 1</code> prompt, enter <code class="codeph">SYSTEM</code> as the tablespace to install <code class="codeph">DVSYS</code>.</span></li>
                     <li class="stepexpand"><span>At the <code class="codeph">Enter value for 2</code> prompt, enter the temporary tablespace for the PDB.</span></li>
                  </ol>
                  <div class="section">After the installation is complete, you can register Oracle Database Vault in the PDB. If Database Vault is not registered in the CDB already, you must close the PDB before you can register Database Vault in the CDB root. Database Vault must be registered in CDB root before it can be registered in the PDB. After Database Vault is registered in the CDB root and the database has been restarted, then you can open the PDB and register Database Vault.</div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="../dvadm/getting-started-with-oracle-database-vault.html#DVADM-GUID-68558E32-ABD0-4495-8677-4F9E09283E5D" target="_blank"><span><cite>Oracle Database Vault Administrator’s Guide</cite></span></a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="You can use Oracle Database Vault in a multitenant container database (CDB).">Using Oracle Database Vault with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-B5569AED-AC16-482C-BA6D-34E275F016D2" name="GUID-B5569AED-AC16-482C-BA6D-34E275F016D2"></a><h3 id="MULTI-GUID-B5569AED-AC16-482C-BA6D-34E275F016D2" class="sect3"><span class="enumeration_section">23.4 </span>Verifying That Database Vault Is Configured and Enabled
               </h3>
               <div>
                  <p>The <code class="codeph">DBA_DV_STATUS</code>, <code class="codeph">CDB_DV_STATUS</code>, <code class="codeph">DBA_OLS_STATUS</code>, and <code class="codeph">CDB_OLS_STATUS</code> data dictionary views verify if Oracle Database is configured and enabled. 
                  </p>
                  <div class="section">In addition to Oracle Database Vault administrators, the Oracle Database <code class="codeph">SYS</code> user and users who have been granted the <code class="codeph">DBA</code> role can query these views. 
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>For Database Vault: </p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>If you want to find the Database Vault status for a non-multitenant database, or in a multitenant environment for the root only or an individual PDB, then query <code class="codeph">DBA_DV_STATUS</code>. For example:
                                 </p><pre class="pre codeblock"><code>SELECT * FROM DBA_DV_STATUS;</code></pre><p>Output similar to the following appears:</p><pre class="pre codeblock"><code>NAME                 STATUS
-------------------- -----------
DV_CONFIGURE_STATUS  TRUE
DV_ENABLE_STATUS     TRUE</code></pre></li>
                              <li>
                                 <p>If you want to find the Database Vault status of all PDBs in a multitenant environment, as a common user with administrative privileges, then query <code class="codeph">CDB_DV_STATUS</code>, which provides the addition of a container ID (<code class="codeph">CON_ID</code>) field.
                                 </p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>For Oracle Label Security, query the following data dictionary views, which are similar to their Database Vault equivalent views:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><code class="codeph">DBA_OLS_STATUS</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">CDB_OLS_STATUS</code></p>
                              </li>
                           </ul>
                        </li>
                     </ul>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="You can use Oracle Database Vault in a multitenant container database (CDB).">Using Oracle Database Vault with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-5CC1B6F0-FDDB-4183-8233-0AC6B208667A" name="GUID-5CC1B6F0-FDDB-4183-8233-0AC6B208667A"></a><h3 id="MULTI-GUID-5CC1B6F0-FDDB-4183-8233-0AC6B208667A" class="sect3"><span class="enumeration_section">23.5 </span>Registering Database Vault in the CDB Root
               </h3>
               <div>
                  <p>In a multitenant environment, you register Oracle Database Vault with common users who will use the Database Vault-enforced roles in the CDB root.</p>
                  <ol>
                     <li class="stepexpand"><span>In a multitenant environment, log into the root of the database instance as a user who has privileges to create users and grant the <code class="codeph">CREATE SESSION</code> and <code class="codeph">SET CONTAINER</code> privileges.</span><div>
                           <p>For example:</p><pre class="pre codeblock"><code>sqlplus c##dba_debra
Enter password: <span class="italic">password</span>
</code></pre></div>
                     </li>
                     <li class="stepexpand" id="GUID-5CC1B6F0-FDDB-4183-8233-0AC6B208667A__CHDGDEIB"><span>Select user accounts (or create new users) that will be used for the Database Vault Owner (<code class="codeph">DV_OWNER</code> role) and Database Vault Account Manager (<code class="codeph">DV_ACCTMGR</code> role) accounts. </span><div>
                           <p>Oracle strongly recommends that you maintain two accounts for each role. One account, the primary named user account, will be used on a day-to-day basis and the other account will be used as a backup account in case the password of the primary account is lost and must be reset.</p>
                        </div>
                        <div>
                           <p>Prepend the names of these accounts with <code class="codeph">c##</code> or <code class="codeph">C##</code>. For example: 
                           </p><pre class="pre codeblock"><code>GRANT CREATE SESSION, SET CONTAINER TO c##sec_admin_owen IDENTIFIED BY <span class="italic">password</span> CONTAINER = ALL;
GRANT CREATE SESSION, SET CONTAINER TO c##dbv_owner_root_backup IDENTIFIED BY <span class="italic">password</span> CONTAINER = ALL;
GRANT CREATE SESSION, SET CONTAINER TO c##accts_admin_ace IDENTIFIED BY <span class="italic">password</span> CONTAINER = ALL;
GRANT CREATE SESSION, SET CONTAINER TO c##dbv_acctmgr_root_backup IDENTIFIED BY <span class="italic">password</span> CONTAINER = ALL;
</code></pre><p>In this specification: </p>
                           <ul style="list-style-type: disc;" id="GUID-5CC1B6F0-FDDB-4183-8233-0AC6B208667A__UL_EFL_1LP_GFB">
                              <li>Create the primary accounts (<code class="codeph">c##sec_admin_owen</code> and<code class="codeph"> c##accts_admin_ace</code>) if these do not already exist for the new roles, <code class="codeph">DV_ADMIN</code> and <code class="codeph">DV_ACCTMGR</code>.
                              </li>
                              <li>Replace <span class="italic"><code class="codeph">password</code></span> with a password that is secure. 
                              </li>
                           </ul>
                        </div>
                     </li>
                     <li class="stepexpand"><span>Connect to the root as user <code class="codeph">SYS</code> with the <code class="codeph">SYSDBA</code> administrative privilege </span><div><pre class="pre codeblock"><code>CONNECT SYS AS SYSDBA
Enter password: <span class="italic">password</span>
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Configure the two backup Database Vault user accounts. </span><div>For example:<pre class="pre codeblock"><code>BEGIN
 CONFIGURE_DV (
 &nbsp;&nbsp;dvowner_uname         =&gt; 'c##dbv_owner_root_backup',
 &nbsp;&nbsp;dvacctmgr_uname       =&gt; 'c##dbv_acctmgr_root_backup',
   force_local_dvowner   =&gt; FALSE);
 END;
/
</code></pre></div>
                        <div>In this example, setting <code class="codeph">force_local_dvowner</code> to <code class="codeph">FALSE</code> enables the common users to have <code class="codeph">DV_OWNER</code> privileges for the PDBs that are associated with this CDB root. Setting it to <code class="codeph">TRUE</code> restricts the common <code class="codeph">DV_OWNER</code> user to have the <code class="codeph">DV_OWNER</code> role privileges for the CDB root only. If you grant <code class="codeph">DV_OWNER</code> locally to the CDB root common user, then that user cannot grant the <code class="codeph">DV_OWNER</code> role commonly to any other user. 
                        </div>
                     </li>
                     <li class="stepexpand"><span>Run the <code class="codeph">utlrp.sql</code> script to recompile invalidated objects in the root. </span><div><pre class="pre codeblock"><code>@?/rdbms/admin/utlrp.sql
</code></pre><p>If the script provides instructions, follow them, and then run the script again. If the script terminates abnormally without giving any instructions, then run it again.</p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>Connect to the root as the primary Database Vault Owner user that you just configured. </span><div>
                           <p>For example:</p><pre class="pre codeblock"><code>CONNECT c##dbv_owner_root_backup
Enter password: <span class="italic">password</span>
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Enable Oracle Database Vault using one of the following commands:</span><div>
                           <ul style="list-style-type: disc;" id="GUID-5CC1B6F0-FDDB-4183-8233-0AC6B208667A__UL_LYQ_35D_R2B">
                              <li>
                                 <p>To enable Oracle Database Vault to use regular mode:</p><pre class="pre codeblock"><code>EXEC DBMS_MACADM.ENABLE_DV;</code></pre></li>
                              <li>
                                 <p>If every associated PDB will need to have Database Vault enabled in this database, then use the following command. (You will need to enable each of these PDBs after you complete this procedure.) PDBs that do not have Database Vault enabled will be in restricted mode after the database is restarted and until Database Vault is enabled in the PDB:</p><pre class="pre codeblock"><code>EXEC DBMS_MACADM.ENABLE_DV (strict_mode =&gt; 'y');</code></pre></li>
                           </ul>
                        </div>
                     </li>
                     <li class="stepexpand"><span>Connect with the <code class="codeph">SYSDBA</code> administrative privilege.</span><div><pre class="pre codeblock"><code>CONNECT / AS SYSDBA
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Restart the database. </span><div><pre class="pre codeblock"><code>SHUTDOWN IMMEDIATE
STARTUP
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Verify that Oracle Database Vault and Oracle Label Security are installed and enabled.</span><div><pre class="pre codeblock"><code>SELECT * FROM DBA_DV_STATUS;
SELECT * FROM DBA_OLS_STATUS;
SELECT * FROM CDB_DV_STATUS;
SELECT * FROM CDB_OLS_STATUS;</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Connect as the backup <code class="codeph">DV_OWNER</code> user and then grant the <code class="codeph">DV_OWNER</code> role to the primary <code class="codeph">DV_OWNER</code> user that you created earlier.</span><div>
                           <p>For example:</p><pre class="pre codeblock"><code>CONNECT c##dbv_owner_root_backup
Enter password: <span class="italic">password</span>

GRANT DV_OWNER TO c##sec_admin_owen WITH ADMIN OPTION;
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Connect as the backup <code class="codeph">DV_ACCTMGR</code> user and then grant the <code class="codeph">DV_ACCTMGR</code> role to the backup <code class="codeph">DV_ACCTMGR</code> user. </span><div>
                           <p>For example:</p><pre class="pre codeblock"><code>CONNECT c##dbv_acctmgr_root_backup
Enter password: <span class="italic">password</span>

GRANT DV_ACCTMGR TO c##accts_admin_ace WITH ADMIN OPTION;</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Store the two backup account passwords in a safe location such as a privileged account management (PAM) system in case they are needed in the future.</span></li>
                  </ol>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="using-oracle-database-vault-with-a-cdb.html#GUID-B5569AED-AC16-482C-BA6D-34E275F016D2" title="The DBA_DV_STATUS, CDB_DV_STATUS, DBA_OLS_STATUS, and CDB_OLS_STATUS data dictionary views verify if Oracle Database is configured and enabled.">Verifying That Database Vault Is Configured and Enabled</a></li>
                        <li><a href="../dvadm/oracle-database-vault-schemas-roles-and-accounts.html#DVADM-GUID-4E1707B4-F9BB-4131-9D3E-90BB273F2832" target="_blank"><span><cite>Oracle Database Vault Administrator’s Guide</cite></span></a></li>
                        <li><a href="../dvadm/getting-started-with-oracle-database-vault.html#DVADM-GUID-FD5C6859-EF01-49F7-B6D6-4E5ACB7FC0C6" target="_blank"><span><cite>Oracle Database Vault Administrator’s Guide</cite></span></a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="You can use Oracle Database Vault in a multitenant container database (CDB).">Using Oracle Database Vault with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-E30BC167-13D6-4C84-ABCC-28CBFF704193" name="GUID-E30BC167-13D6-4C84-ABCC-28CBFF704193"></a><h3 id="MULTI-GUID-E30BC167-13D6-4C84-ABCC-28CBFF704193" class="sect3"><span class="enumeration_section">23.6 </span>Registering Database Vault Common Users to Manage Specific PDBs
               </h3>
               <div>
                  <p>In a multitenant environment, you must register Oracle Database Vault in the root first, then in the PDBs afterward.</p>
                  <div class="section"> If you try to register in a PDB first, then an <code class="codeph">ORA-47503: Database Vault is not enabled on CDB$ROOT</code> error appears.
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>If you have not already done so, then identify or create named common user accounts to be used as the Database Vault accounts along with associated backup accounts. </span></li>
                     <li class="stepexpand"><span>Ensure that you have registered Oracle Database Vault in the CDB root and that the <code class="codeph">DV_OWNER</code> role was granted commonly to the common user.</span></li>
                     <li class="stepexpand"><span>Connect to the PDB as an administrator who is local to the PDB. </span><div>For example:<pre class="pre codeblock"><code>CONNECT dba_debra@<span class="italic">pdb_name</span>
Enter password: <span class="italic">password</span>
</code></pre><p>To find the available PDBs, query the <code class="codeph">DBA_PDBS</code> data dictionary view. To check the current PDB, run the <code class="codeph">show con_name</code> command.
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>Grant the <code class="codeph">CREATE SESSION</code> and <code class="codeph">SET CONTAINER</code> privileges to the users for this PDB. </span><div>For example: <pre class="pre codeblock"><code>GRANT CREATE SESSION, SET CONTAINER TO c##sec_admin_owen CONTAINER = CURRENT;
GRANT CREATE SESSION, SET CONTAINER TO c##accts_admin_ace CONTAINER = CURRENT;
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Connect as user <code class="codeph">SYS</code> with the <code class="codeph">SYSDBA</code> administrative privilege </span><div><pre class="pre codeblock"><code>CONNECT SYS@<span class="italic">pdb_name</span> AS SYSDBA
Enter password: <span class="italic">password</span>
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>While still in the PDB, configure the two backup Database Vault user accounts. </span><div><pre class="pre codeblock"><code>BEGIN
 CONFIGURE_DV (
 &nbsp;&nbsp;dvowner_uname         =&gt; 'c##dbv_owner_root_backup',
 &nbsp;&nbsp;dvacctmgr_uname       =&gt; 'c##dbv_acctmgr_root_backup');
 END;
/
</code></pre><p>In this example, the <code class="codeph">force_local_dvowner</code> parameter is omitted because it is unnecessary. All common users who are configured within a PDB are restricted to the scope of the PDB.
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>Run the <code class="codeph">utlrp.sql</code> script to recompile invalidated objects in this PDB. </span><div><pre class="pre codeblock"><code>@?/rdbms/admin/utlrp.sql
</code></pre><p>If the script provides instructions, follow them, and then run the script again. If the script terminates abnormally without giving any instructions, then run it again.</p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>Connect to the PDB as the backup Database Vault Owner user that you just configured. </span><div>For example:<pre class="pre codeblock"><code>CONNECT c##dbv_owner_root_backup@<span class="italic">pdb_name</span>
Enter password: <span class="italic">password</span>
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Enable Oracle Database Vault in this PDB.</span><div><pre class="pre codeblock"><code>EXEC DBMS_MACADM.ENABLE_DV;
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Connect to the CDB with the <code class="codeph">SYSDBA</code> administrative privilege.</span><div><pre class="pre codeblock"><code>CONNECT / AS SYSDBA
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Close and reopen the PDB. </span><div>For example:<pre class="pre codeblock"><code>ALTER PLUGGABLE DATABASE <span class="italic">pdb_name</span> CLOSE IMMEDIATE;

ALTER PLUGGABLE DATABASE <span class="italic">pdb_name</span> OPEN;
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Verify that the PDB is configured and enabled for Database Vault.</span><div><pre class="pre codeblock"><code>CONNECT SYS@<span class="italic">pdb_name</span> AS SYSDBA
Enter password: <span class="italic">password</span>

SELECT * FROM DBA_DV_STATUS;</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Connect as the backup <code class="codeph">DV_OWNER</code> user and then grant the <code class="codeph">DV_OWNER</code> role to the primary <code class="codeph">DV_OWNER</code> user that you created earlier.</span><div>
                           <p>For example:</p><pre class="pre codeblock"><code>CONNECT c##dbv_owner_root_backup
Enter password: <span class="italic">password</span>

GRANT DV_OWNER TO c##sec_admin_owen WITH ADMIN OPTION;
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Connect as the backup <code class="codeph">DV_ACCTMGR</code> user and then grant the <code class="codeph">DV_ACCTMGR</code> role to the primary <code class="codeph">DV_ACCTMGR</code> user. </span><div>
                           <p>For example:</p><pre class="pre codeblock"><code>CONNECT c##dbv_acctmgr_root_backup
Enter password: <span class="italic">password</span>

GRANT DV_ACCTMGR TO c##accts_admin_ace WITH ADMIN OPTION;</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Store the two backup account passwords in a safe location such as a privileged account management (PAM) system in case they are needed in the future.</span></li>
                  </ol>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="using-oracle-database-vault-with-a-cdb.html#GUID-B5569AED-AC16-482C-BA6D-34E275F016D2" title="The DBA_DV_STATUS, CDB_DV_STATUS, DBA_OLS_STATUS, and CDB_OLS_STATUS data dictionary views verify if Oracle Database is configured and enabled.">Verifying That Database Vault Is Configured and Enabled</a></li>
                        <li><a href="../dvadm/oracle-database-vault-schemas-roles-and-accounts.html#DVADM-GUID-4E1707B4-F9BB-4131-9D3E-90BB273F2832" target="_blank"><span><cite>Oracle Database Vault Administrator’s Guide</cite></span></a></li>
                        <li><a href="../dvadm/getting-started-with-oracle-database-vault.html#DVADM-GUID-FD5C6859-EF01-49F7-B6D6-4E5ACB7FC0C6" target="_blank"><span><cite>Oracle Database Vault Administrator’s Guide</cite></span></a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="You can use Oracle Database Vault in a multitenant container database (CDB).">Using Oracle Database Vault with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-C6218DD3-BB78-40F7-8BE2-7391D3BF6418" name="GUID-C6218DD3-BB78-40F7-8BE2-7391D3BF6418"></a><h3 id="MULTI-GUID-C6218DD3-BB78-40F7-8BE2-7391D3BF6418" class="sect3"><span class="enumeration_section">23.7 </span>Creating Common Database Vault Accounts for a Plugged in Database Vault PDB
               </h3>
               <div>
                  <p>From SQL*Plus, in a multitenant environment, you can plug in a database that already has Database Vault enabled.</p>
                  <div class="section">In this scenario, the plugged-in PDB has its own local Database Vault accounts. Be aware that if you plug a Database Vault-enabled database into a CDB that is not Database Vault enabled, then the PDB will remain in restricted mode until you enable Database Vault in the CDB and then restart the CDB. If you plug a non-Database Vault-enabled PDB into a CDB that is Database Vault enabled, then the PDB remains in restricted mode until you enable Database Vault in the PDB and then restart the PDB. This plugged-in non-Database Vault enabled PDB is still usable. However, if the CDB is Database Vault enabled with the strict option set, then the PDB must be Database Vault enabled.</div>
                  <!-- class="section" -->
                  <div class="section">
                     <p>To enable a common user to manage the Database Vault configuration for this PDB:</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>Log into the PDB as the local primary Database Vault owner.</span><div>For example:<pre class="pre codeblock"><code>sqlplus dbv_owner@<span class="italic">pdb_name</span>
Enter password: <span class="italic">password</span>
</code></pre></div>
                        <div>
                           <p>For example:</p>
                           <p>To find the available PDBs, execute the <code class="codeph">show pdbs</code> command. To check the current PDB, run the <code class="codeph">show con_name</code> command.
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>Grant the common Database Vault <code class="codeph">DV_OWNER</code> users the <code class="codeph">CREATE SESSION</code> and <code class="codeph">SET CONTAINER</code> privileges, and the appropriate Database Vault roles.</span><div>The following accounts will be the primary and the backup accounts:<pre class="pre codeblock"><code>GRANT CREATE SESSION, SET CONTAINER, DV_OWNER TO c##dbv_owner_root WITH ADMIN OPTION;
GRANT CREATE SESSION, SET CONTAINER, DV_OWNER TO c##dbv_owner_root_backup WITH ADMIN OPTION;
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Connect as a user who has been granted the <code class="codeph">DV_ACCTMGR</code> role. </span></li>
                     <li class="stepexpand"><span>Create the <code class="codeph">DV_ACCTMGR</code> common accounts.</span><div><pre class="pre codeblock"><code>GRANT CREATE SESSION, SET CONTAINER, DV_ACCTMGR TO c##dbv_acctmgr_root WITH ADMIN OPTION;
GRANT CREATE SESSION, SET CONTAINER, DV_ACCTMGR TO c##dbv_acctmgr_root_backup WITH ADMIN OPTION;</code></pre></div>
                     </li>
                  </ol>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="using-oracle-database-vault-with-a-cdb.html#GUID-B5569AED-AC16-482C-BA6D-34E275F016D2" title="The DBA_DV_STATUS, CDB_DV_STATUS, DBA_OLS_STATUS, and CDB_OLS_STATUS data dictionary views verify if Oracle Database is configured and enabled.">Verifying That Database Vault Is Configured and Enabled</a></li>
                        <li><a href="../dvadm/oracle-database-vault-schemas-roles-and-accounts.html#DVADM-GUID-4E1707B4-F9BB-4131-9D3E-90BB273F2832" target="_blank"><span><cite>Oracle Database Vault Administrator’s Guide</cite></span></a></li>
                        <li><a href="../dvadm/getting-started-with-oracle-database-vault.html#DVADM-GUID-FD5C6859-EF01-49F7-B6D6-4E5ACB7FC0C6" target="_blank"><span><cite>Oracle Database Vault Administrator’s Guide</cite></span></a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="You can use Oracle Database Vault in a multitenant container database (CDB).">Using Oracle Database Vault with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-72403156-3E91-43FD-8D06-859DBBC10568" name="GUID-72403156-3E91-43FD-8D06-859DBBC10568"></a><h3 id="MULTI-GUID-72403156-3E91-43FD-8D06-859DBBC10568" class="sect3"><span class="enumeration_section">23.8 </span>Realms in a Multitenant Environment
               </h3>
               <div>
                  <p>In a multitenant environment, you can create a realm to protect common objects in the application root.</p>
                  <p>The advantage of creating a realm in the application root instead of creating a large number objects and realms around these objects within individual pluggable databases (PDBs) is that you can create them in one place, the application root. This way, you can manage them centrally.</p>
                  <p>You cannot create a common realm in the CDB root. </p>
                  <p>A Database Vault common realm can be either a regular realm or a mandatory realm. The realm protects only objects within the application root, not local objects in a PDB. The CDB root, application root, and any affected PDBs all must be Database Vault enabled. </p>
                  <p>To configure a common realm, you must be commonly granted the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> role. To grant common authorizations for a common realm, you must be in the application root. To propagate the realm to the PDBs that are associated with the application root, you must synchronize the application root. For example, to synchronize an application called <code class="codeph">saas_sales_app</code></p><pre class="pre codeblock"><code>ALTER PLUGGABLE DATABASE APPLICATION saas_sales_app SYNC;</code></pre></div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/multi&amp;id=DVADM-GUID-18D6FFCB-42C2-49D1-9F53-BADE7B0754AB" target="_blank"><span><cite>Oracle Database Vault Administrator’s Guide</cite></span></a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="You can use Oracle Database Vault in a multitenant container database (CDB).">Using Oracle Database Vault with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-DA60AF6B-D669-4E17-94B4-043BB41FC673" name="GUID-DA60AF6B-D669-4E17-94B4-043BB41FC673"></a><h3 id="MULTI-GUID-DA60AF6B-D669-4E17-94B4-043BB41FC673" class="sect3"><span class="enumeration_section">23.9 </span>Realm Authorizations in a Multitenant Environment
               </h3>
               <div>
                  <p>In a multitenant environment, the rules and behavior for common realm authorizations are similar to the authorizations for other common objects. </p>
                  <p><span class="bold">Local Authorization for a Common Realm</span></p>
                  <p>The local authorization for a common realm refers to the authorization a user has for the PDB that this user is accessing. </p>
                  <p>The rules for the local authorization for a common realm are as follows: </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>A user who has been commonly granted the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> role can grant local authorization to common users, common roles, local users, and local roles. The common <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> user can also remove local authorization from a common realm in a PDB.
                        </p>
                     </li>
                     <li>
                        <p>A local Database Vault administrator can authorize locally (that is, grant local authorizations to both local and common users) within the PDB. A common Database Vault administrator can also grant authorizations in each PDB. A common realm authorization can only be granted by a common Database Vault administrator in the application root. </p>
                     </li>
                     <li>
                        <p>The common Database Vault administrator can both add or remove local authorization to and from a common realm from within the PDB.</p>
                     </li>
                     <li>
                        <p> If a common user has only local authorization for a common realm, then this user cannot access the common realm in any other PDB than this local authorization. </p>
                     </li>
                     <li>
                        <p>A common user or a common role can have both the local authorization and the common authorization to a common realm at the same time. Removing a common user’s local authorization from a common realm does not affect the common user’s common authorization. Removing a common user’s common authorization from a common realm does not affect the common user’s local authorization. </p>
                     </li>
                  </ul>
                  <p><span class="bold">Common Authorization for a Common Realm</span></p>
                  <p>The common authorization for a common realm refers to the authorization a common user or a common role has in the application root while the authorization takes effect in every container that is Database Vault enabled.</p>
                  <p>The rules for the local authorization for a common realm are as follows: </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>A user who has been commonly granted the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> role can grant common realm authorization to common users or roles in the application root. This common Database Vault administrator can perform the removal of common authorizations while in the application root.
                        </p>
                     </li>
                     <li>
                        <p>This common authorization applies to the containers that have been Database Vault enabled in the CDB. </p>
                     </li>
                     <li>
                        <p>If a common user is authorized to a common realm in the application root, then this user has access to the objects protected by the common realm in the application root and any application PDBs.</p>
                     </li>
                     <li>
                        <p>Any rule sets that are associated with a common realm must be common rule sets. The rules that are added to a common rule set that is associated with common authorization cannot involve any local objects. </p>
                     </li>
                  </ul>
                  <p><span class="bold">How the Authorization of a Realm Works in Both the Application Root and in an Individual PDB</span></p>
                  <p>During the Database Vault enforcement in a container, a common realm performs the same enforcement behaviors as the same realm when it is used locally in a PDB. </p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="You can use Oracle Database Vault in a multitenant container database (CDB).">Using Oracle Database Vault with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-6308CB8B-6777-44AF-A523-F1A956591F6D" name="GUID-6308CB8B-6777-44AF-A523-F1A956591F6D"></a><h3 id="MULTI-GUID-6308CB8B-6777-44AF-A523-F1A956591F6D" class="sect3"><span class="enumeration_section">23.10 </span>Rule Sets and Rules in a Multitenant Environment
               </h3>
               <div>
                  <p>In a multitenant environment, you can create a rule set and its associated rules in the application root.</p>
                  <p>A common realm must use a common rule set when the associated realm or command rule is evaluated by Database Vault. The common rule set and its rules can only be created in the application root. After the common rule set is created, it exists in every container that is associated with the root where the common rule set is created. The common rule set can only include common rules.</p>
                  <p>To configure a common rule set and its rules, you must be commonly granted the <code class="codeph">DV_OWNER</code> or <code class="codeph">DV_ADMIN</code> role.
                  </p>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="using-oracle-database-vault-with-a-cdb.html#GUID-571C5AF1-909C-4A76-BE2B-9BAC5232FE84" title="In a multitenant environment, you can create common and local command rules in either the CDB root or the application root.">Command Rules in a Multitenant Environment</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="You can use Oracle Database Vault in a multitenant container database (CDB).">Using Oracle Database Vault with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-571C5AF1-909C-4A76-BE2B-9BAC5232FE84" name="GUID-571C5AF1-909C-4A76-BE2B-9BAC5232FE84"></a><h3 id="MULTI-GUID-571C5AF1-909C-4A76-BE2B-9BAC5232FE84" class="sect3"><span class="enumeration_section">23.11 </span>Command Rules in a Multitenant Environment
               </h3>
               <div>
                  <p>In a multitenant environment, you can create common and local command rules in either the CDB root or the application root.</p>
                  <p>Common command rules can be associated only with common realms, rule sets, and rules. Local command rules can be associated only with local realm, rule sets, and rules.</p>
                  <p>To apply these command rules to the entire multitenant environment, you must execute the command rule procedures from the CDB root or application root as a common user who has been granted the <code class="codeph">DVADM</code> or <code class="codeph">DVOWNER</code> role. A common command rule that is created in the CDB root will be applied to all PDBs in that CDB environment. A common command rule that is created in the application root will only be applied to the PDBs that are associated with this application root. To propagate the command rule to the PDBs that are associated with the CDB root or application root, you must synchronize the PDB. For example, to synchronize an application root called <code class="codeph">saas_sales_app</code> to its application PDBs:
                  </p><pre class="pre codeblock"><code>ALTER PLUGGABLE DATABASE APPLICATION saas_sales_app SYNC;</code></pre><p>To synchronize a common command rule in the CDB root to a PDB:</p><pre class="pre codeblock"><code>ALTER PLUGGABLE DATABASE APPLICATION APP$CDB$SYSTEM SYNC;</code></pre><p>You can check a user’s roles by querying the <code class="codeph">USER_ROLE_PRIVS</code> data dictionary view. To find information about command rules, query the <code class="codeph">DBA_DV_COMMAND_RULE</code> data dictionary view.
                  </p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="You can use Oracle Database Vault in a multitenant container database (CDB).">Using Oracle Database Vault with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-07513135-CB45-4788-A596-E5A71879BB81" name="GUID-07513135-CB45-4788-A596-E5A71879BB81"></a><h3 id="MULTI-GUID-07513135-CB45-4788-A596-E5A71879BB81" class="sect3"><span class="enumeration_section">23.12 </span>Oracle Database Vault Policies in a Multitenant Environment
               </h3>
               <div>
                  <p>Oracle Database Vault policies are only local to the pluggable database (PDB) in which they were created. </p>
                  <p>That is, if you created the policy in a PDB, then only local realms and command rules can be added to it. You cannot create Database Vault policies that can have common realms or common command rules. </p>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="You can use Oracle Database Vault in a multitenant container database (CDB).">Using Oracle Database Vault with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="props_rev_3"><a id="GUID-517E9611-546B-43D9-8C54-37037AF0B198" name="GUID-517E9611-546B-43D9-8C54-37037AF0B198"></a><h3 id="MULTI-GUID-517E9611-546B-43D9-8C54-37037AF0B198" class="sect3"><span class="enumeration_section">23.13 </span>Converting a Standalone Oracle Database to a PDB and Plugging It into a CDB
               </h3>
               <div>
                  <p>You can convert a standalone Oracle Database Release 12c or later database to a PDB, and then plug this PDB into a CDB.</p>
                  <ol>
                     <li class="stepexpand"><span>Connect to the root as a user who has been granted the <code class="codeph">DV_OWNER</code> role.</span><div>
                           <p>For example: </p><pre class="pre codeblock"><code>sqlplus c##sec_admin
Enter password: <span class="italic">password</span>
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Grant the <code class="codeph">DV_PATCH_ADMIN</code> role to user <code class="codeph">SYS</code> with <code class="codeph">CONTAINER = CURRENT</code>. </span><div><pre class="pre codeblock"><code>GRANT DV_PATCH_ADMIN TO SYS CONTAINER = CURRENT;
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>In the root, connect as user <code class="codeph">SYS</code> with the <code class="codeph">SYSOPER</code> system privilege. </span><div>
                           <p>For example:</p><pre class="pre codeblock"><code>CONNECT SYS AS SYSOPER <span class="italic">-- Or, CONNECT SYS@hrpdb AS SYSOPER</span>
Enter password: <span class="italic">password</span>
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Restart the database in read-only mode. </span><div>
                           <p>For example:</p><pre class="pre codeblock"><code>SHUTDOWN IMMEDIATE
STARTUP MOUNT
ALTER DATABASE OPEN READ ONLY
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Connect to the Database Vault-enabled database as a user who has the <code class="codeph">DV_OWNER</code> role. </span><div>
                           <p>For example:</p><pre class="pre codeblock"><code>CONNECT sec_admin@dv_db
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Grant the <code class="codeph">DV_PATCH_ADMIN</code> role to user <code class="codeph">SYS</code> on this database.</span><div><pre class="pre codeblock"><code>GRANT DV_PATCH_ADMIN TO SYS;
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Optionally, run the <code class="codeph">DBMS_PDB.CHECK_PLUG_COMPATIBILITY</code> function to determine whether the unplugged PDB is compatible with the CDB.</span><div>
                           <p>When you run the function, set the following parameters:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><code class="codeph">pdb_descr_file</code>: Set this parameter to the full path to the XML file that will contain a description of the PDB.
                                 </p>
                              </li>
                              <li>
                                 <p><code class="codeph">store_report</code>: Set this parameter to indicate whether you want to generate a report if the PDB is not compatible with the CDB. Set it to <code class="codeph">TRUE</code> to generate a report or <code class="codeph">FALSE</code> to not generate a report. A generated report is stored in the <code class="codeph">PDB_PLUG_IN_VIOLATIONS</code> temporary table and is generated only if the PDB is not compatible with the CDB.
                                 </p>
                              </li>
                           </ul>
                           <p>For example, to determine whether a PDB described by the <code class="codeph">/disk1/usr/dv_db_pdb.xml</code> file is compatible with the current CDB, run the following PL/SQL block:
                           </p><pre class="pre codeblock"><code>SET SERVEROUTPUT ON
DECLARE
  compatible CONSTANT VARCHAR2(3) := 
    CASE DBMS_PDB.CHECK_PLUG_COMPATIBILITY(
           pdb_descr_file =&gt; '/disk1/usr/dv_db_pdb.xml',
           store_report   =&gt; TRUE)
    WHEN TRUE THEN 'YES'
    ELSE 'NO'
END;
BEGIN
  DBMS_OUTPUT.PUT_LINE(compatible);
END;
/
</code></pre><p>If the output is <code class="codeph">YES</code>, then the PDB is compatible, and you can continue with the next step.
                           </p>
                           <p>If the output is <code class="codeph">NO</code>, then the PDB is not compatible. You can check the <code class="codeph">PDB_PLUG_IN_VIOLATIONS</code> temporary table to see why it is not compatible.
                           </p>
                        </div>
                     </li>
                     <li class="stepexpand"><span>Create an XML file that describes the PDB. </span><div>
                           <p>For example:</p><pre class="pre codeblock"><code>BEGIN
  DBMS_PDB.DESCRIBE(
    pdb_descr_file =&gt; '/disk1/oracle/dv_db.xml');
END;
/
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Run the <code class="codeph">CREATE PLUGGABLE DATABASE</code> statement, and specify the XML file in the <code class="codeph">USING</code> clause. Specify other clauses when they are required.</span><div>
                           <p>For example: </p><pre class="pre codeblock"><code>CREATE PLUGGABLE DATABASE dv_db_pdb AS CLONE USING 'dv_db.xml' NOCOPY;
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Connect to the PDB that you just created as user <code class="codeph">SYS</code> with the <code class="codeph">SYSDBA</code> administrative privilege. </span><div><pre class="pre codeblock"><code>CONNECT SYS@dv_db_pdb AS SYSDBA
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Execute the <code class="codeph">noncdb_to_pdb.sql</code> script.</span><div><pre class="pre codeblock"><code>@$ORACLE_HOME/rdbms/admin/noncdb_to_pdb.sql
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Open this PDB in a read/write restricted mode.</span><div><pre class="pre codeblock"><code>ALTER PLUGGABLE DATABASE dv_db_pdb OPEN READ WRITE RESTRICTED;
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Run the following procedure to synchronize the PDB:</span><div><pre class="pre codeblock"><code>EXECUTE DBMS_PDB.SYNC_PDB;
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Connect to the root as a user who has been granted the <code class="codeph">DV_OWNER</code> role. </span><div><pre class="pre codeblock"><code>sqlplus c##sec_admin
Enter password: <span class="italic">password</span>
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Revoke the <code class="codeph">DV_PATCH_ADMIN</code> role from user <code class="codeph">SYS</code> with <code class="codeph">CONTAINER = CURRENT</code>.</span><div><pre class="pre codeblock"><code>REVOKE DV_PATCH_ADMIN FROM SYS CONTAINER = CURRENT;
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Connect to the legacy Database Vault-enabled database as user <code class="codeph">SYS</code> with the <code class="codeph">SYSOPER</code> system privilege.</span><div><pre class="pre codeblock"><code>CONNECT SYS@dv_db_pdb AS SYSOPER
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Restart this database.</span><div>
                           <p>For example:</p><pre class="pre codeblock"><code>SHUTDOWN IMMMEDIATE
STARUP
</code></pre></div>
                     </li>
                     <li class="stepexpand"><span>Revoke the <code class="codeph">DV_PATCH_ADMIN</code> role from user <code class="codeph">SYS</code>.</span><div><pre class="pre codeblock"><code>REVOKE DV_PATCH_ADMIN FROM SYS;</code></pre></div>
                     </li>
                  </ol>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="creating-pdbs.html#GUID-9A250D93-5B3B-4643-BE85-F32CC7B0E413" title="You can create PDBs, application containers, and application seeds using a variety of techniques.">Creating and Removing PDBs and Application Containers</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="using-oracle-database-vault-with-a-cdb.html#GUID-5CD1D1E7-2435-4331-876F-34C5AE04BAD3" title="You can use Oracle Database Vault in a multitenant container database (CDB).">Using Oracle Database Vault with a CDB</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>