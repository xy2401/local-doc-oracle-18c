<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Installing Oracle Services for Microsoft Transaction Server</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Developer's Guide ">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Developer's Guide for Microsoft Windows">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="oracle-services-microsoft-transaction-server.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2018-08-05T10:28:43-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2018">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E90597-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/18">
      
      <link rel="prev" href="using-mts-with-oracledb.html" title="Previous" type="text/html">
      <link rel="next" href="managing-recovery-scenarios.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"18","element_name":"Release 18","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="OracleÂ® Services for Microsoft Transaction Server">
    <meta name="dcterms.isVersionOf" content="NTMTS">
    <meta name="dcterms.release" content="Release 18">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="using-mts-with-oracledb.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="managing-recovery-scenarios.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Developer's Guide </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem"> Installing Oracle Services for Microsoft Transaction Server </li>
            </ol>
            <a id="GUID-B7B69BBB-B909-418D-9AE8-F36412E8069A" name="GUID-B7B69BBB-B909-418D-9AE8-F36412E8069A"></a><a id="NTMTS002"></a>
            
            <h2 id="NTMTS-GUID-B7B69BBB-B909-418D-9AE8-F36412E8069A" class="sect2"><span class="enumeration_chapter">2 </span> Installing Oracle Services for Microsoft Transaction Server 
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>These topics describe installation requirements for the <a href="glossary.html#GUID-10C5A220-53B1-4AE6-AD1F-12B8C90EDB91"><span class="xrefglossterm">Microsoft Transaction Server</span></a> and Oracle Database environment.
               </p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="install.html#GUID-505CEE68-C968-4E01-A561-971CAB8C99B4">Installation Introduction</a></p>
                  </li>
                  <li>
                     <p><a href="install.html#GUID-379EFC27-862C-4672-B0EF-4278E1CA7C9D">Installation Requirements for Microsoft Transaction Server </a></p>
                  </li>
                  <li>
                     <p><a href="install.html#GUID-B5562752-1644-4B37-B1D3-597CDD3B9DE0">Using Oracle Services for MTS with Oracle Data Provider for .NET_ Managed Driver</a></p>
                  </li>
                  <li>
                     <p><a href="install.html#GUID-EA6A9689-7E78-4D49-9020-4E89A7C82C22">Manually Creating an Oracle MTS Recovery Service</a></p>
                  </li>
               </ul>
            </div><a id="NTMTS114"></a><div class="props_rev_3"><a id="GUID-505CEE68-C968-4E01-A561-971CAB8C99B4" name="GUID-505CEE68-C968-4E01-A561-971CAB8C99B4"></a><h3 id="NTMTS-GUID-505CEE68-C968-4E01-A561-971CAB8C99B4" class="sect3"><span class="enumeration_section">2.1 </span>Installation Introduction
               </h3>
               <div>
                  <p>You can install <a href="glossary.html#GUID-844EA270-9E41-4385-994B-82397C5C3789"><span class="xrefglossterm">OraMTS</span></a> as part of the Oracle Database Client. OraMTS service will be created for the Oracle Home you installed. Beginning in Oracle 12<span class="italic">c</span>, each Oracle Home has its own OraMTS recovery Windows service. Also, beginning in Oracle 12<span class="italic">c</span>, the OraMTS service runs as the Oracle Home user. 
                  </p>
                  <p>Oracle Home User is the owner of Oracle Services that run from Oracle Home and cannot be changed after installation. It can be a Windows built-in account or a Windows User Account. For enhanced security, Oracle recommends choosing the standard Windows User Account as Oracle Home User for Oracle Database installations rather than a Windows built-in account. The primary purpose of Oracle Home User is to run Windows services with Windows User Account. However, this user account (Oracle Home User) must be a low-privileged user account that should not be used for database administration. This ensures that Oracle Database services running under Oracle Home User have only the minimal privileges required to run Oracle products. The Windows User Account can be a Local User, a Domain User, or a Managed Services Account.</p>
                  <p>In some cases, such as a software-only install, clone cycles, or an <code class="codeph">AddNode</code> operation on the database, you may need to manually create the OraMTS service.
                  </p>
                  <p>This topic describes the Oracle and non-Oracle products you must install for OraMTS. Additional installation requirement is as follows. <a id="d2047e146" class="indexterm-anchor"></a>For <a href="glossary.html#GUID-A8C7E0DC-A5C7-4BD7-A4A8-0692119B6285"><span class="xrefglossterm">Oracle Data Provider for .NET (ODP.NET)</span></a> cluster configurations (or any failover configuration), install Microsoft Transaction Server on the node running the <a href="glossary.html#GUID-37C64380-2031-4103-8965-394C4A30A352"><span class="xrefglossterm">Microsoft Distributed Transaction Coordinator (MS DTC)</span></a> component. This ensures that the Oracle MTS Recovery Service migrates with the client application during failover. You can configure this when scheduling recovery transactions. 
                  </p>
                  <div class="infoboxnotealso" id="GUID-505CEE68-C968-4E01-A561-971CAB8C99B4__GUID-5C663BEB-6611-4709-9C58-9D8BF50F4E27">
                     <p class="notep1">See Also:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="install.html#GUID-EA6A9689-7E78-4D49-9020-4E89A7C82C22">Manually Creating an Oracle MTS Recovery Service</a></p>
                        </li>
                        <li>
                           <p><a href="../ntqrf/supporting-oracle-home-user-on-windows.html#NTQRF672" target="_blank"><span class="italic">Oracle Database Platform Guide for Microsoft Windows</span></a></p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="NTMTS115"></a><div class="props_rev_3"><a id="GUID-379EFC27-862C-4672-B0EF-4278E1CA7C9D" name="GUID-379EFC27-862C-4672-B0EF-4278E1CA7C9D"></a><h3 id="NTMTS-GUID-379EFC27-862C-4672-B0EF-4278E1CA7C9D" class="sect3"><span class="enumeration_section">2.2 </span>Installation Requirements for Microsoft Transaction Server 
               </h3>
               <div>
                  <p>The Windows computer where Microsoft Transaction Server is installed has the following product requirements:</p>
               </div><a id="NTMTS116"></a><div class="props_rev_3"><a id="GUID-AF37637E-07F3-4879-8D87-0D2A2D957C02" name="GUID-AF37637E-07F3-4879-8D87-0D2A2D957C02"></a><h4 id="NTMTS-GUID-AF37637E-07F3-4879-8D87-0D2A2D957C02" class="sect4"><span class="enumeration_section">2.2.1 </span>Oracle Products
                  </h4>
                  <div>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="glossary.html#GUID-844EA270-9E41-4385-994B-82397C5C3789"><span class="xrefglossterm">OraMTS</span></a> <a id="d2047e269" class="indexterm-anchor"></a><a id="d2047e273" class="indexterm-anchor"></a></p>
                        </li>
                        <li>
                           <p><a id="d2047e279" class="indexterm-anchor"></a><a id="d2047e283" class="indexterm-anchor"></a>Oracle Database Client, included automatically with the OraMTS installation.
                           </p>
                        </li>
                        <li>
                           <p>A data access driver that uses Oracle Services for MTS, such as:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="glossary.html#GUID-A8C7E0DC-A5C7-4BD7-A4A8-0692119B6285"><span class="xrefglossterm">Oracle Data Provider for .NET (ODP.NET)</span></a></p>
                              </li>
                              <li>
                                 <p><a id="d2047e299" class="indexterm-anchor"></a><a id="d2047e303" class="indexterm-anchor"></a><a href="glossary.html#GUID-DF699FFA-BE96-4E3B-83CD-07203F9EA102"><span class="xrefglossterm">Oracle Open Database Connectivity (ODBC) Driver</span></a></p>
                              </li>
                              <li>
                                 <p><a href="glossary.html#GUID-1D4CC36A-31D7-47CC-94BD-C1E9E69BDADF"><span class="xrefglossterm">Oracle Provider for OLE DB</span></a></p>
                              </li>
                              <li>
                                 <p><a href="glossary.html#GUID-5F4766B7-BFBF-44D2-901B-2BB62EDBB694"><span class="xrefglossterm">Oracle Call Interface (OCI)</span></a></p>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <p>Access to an Oracle Database 10<span class="italic">g</span> Release 2 or higher version
                           </p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-AF37637E-07F3-4879-8D87-0D2A2D957C02__GUID-90D09DC4-5780-4861-A621-A0D242B90520">
                        <p class="notep1">Note:</p>
                        <p></p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Oracle ODBC Driver, ODP.NET, Oracle Provider for OLE DB, and OCI are only required if you are building or using components with which they are required.</p>
                           </li>
                           <li>
                              <p>Depending on the installation, you are prompted to enter the port number on which the Oracle MTS Recovery Service will listen for requests to resolve in-doubt transactions</p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="NTMTS117"></a><div class="props_rev_3"><a id="GUID-19DB6E8F-9523-4A9A-9E29-EA9E35D74109" name="GUID-19DB6E8F-9523-4A9A-9E29-EA9E35D74109"></a><h4 id="NTMTS-GUID-19DB6E8F-9523-4A9A-9E29-EA9E35D74109" class="sect4"><span class="enumeration_section">2.2.2 </span>Non-Oracle Products
                  </h4>
                  <div>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Windows operating system <a id="d2047e378" class="indexterm-anchor"></a><a id="d2047e382" class="indexterm-anchor"></a></p>
                           <div class="infoboxnotealso" id="GUID-19DB6E8F-9523-4A9A-9E29-EA9E35D74109__GUID-4D3B3C27-90A5-484B-B6A7-C7117978702E">
                              <p class="notep1">See Also:</p>
                              <p><a href="../ntdbi/operating-system-checklist-for-oracle-database-installation-on-microsoft-windows.html#NTDBI-GUID-E3991846-D2D7-4D71-9F8F-F90996F046B5" target="_blank"><span><cite>Oracle Database Installation Guide for Microsoft Windows</cite></span></a></p>
                           </div>
                        </li>
                        <li>
                           <p>Microsoft Distributed Transaction Coordinator, which is part of the Windows operating system</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="NTMTS311"></a><div class="props_rev_3"><a id="GUID-B5562752-1644-4B37-B1D3-597CDD3B9DE0" name="GUID-B5562752-1644-4B37-B1D3-597CDD3B9DE0"></a><h3 id="NTMTS-GUID-B5562752-1644-4B37-B1D3-597CDD3B9DE0" class="sect3"><span class="enumeration_section">2.3 </span>Using Oracle Services for MTS with Oracle Data Provider for .NET
               </h3>
               <div>
                  <p>ODP.NET, Managed and Unmanaged Drivers provide its resource manager, which manage Oracle database transactions, and work in cooperation with Microsoft Distributed Transaction Coordinator (MSDTC) to guarantee atomicity and isolation to an application across networks. MSDTC coordinates with all the resource managers that are enlisted to the same <code class="codeph">System.Transactions</code>, to perform 2-phase commit or rollback atomically. With that, Oracle distributed transactions can then be committed or rolled back across networks properly.
                  </p>
                  <div class="section">
                     <p class="subhead2">Oracle Services for Microsoft Transaction Server</p>
                     <p>Oracle Services for Microsoft Transaction Server (OraMTS) allow client components to leverage Oracle database participation in MSDTC transactions. It acts as a proxy for the Oracle database to MSDTC to ensure that Oracle distributed database transactions commit or rollback together with the rest of the distributed transaction.</p>
                     <p>If a failure occurs, such as a network failure or server hardware failure, then it can leave an in-process distributed transaction in-doubt. OraMTS has a recovery service to resolve these transactions on the machine that began this transaction. This recovery service runs as a Windows service.</p>
                     <p>It is required to install the OraMTS Recovery Service on all the client machines where ODP.NET is running and participating in MSDTC. As a machine may have multiple IP addresses, administrators for managed ODP.NET applications can specify the host machine name or IP address that has the running recovery service in the application's .NET configuration file. ODP.NET, Unmanaged Driver automatically resolves the IP/machine name for the recovery service.</p>
                     <p>With .NET Framework 4.5.2, Microsoft introduced new API support that allows Oracle to use only managed calls to coordinate ODP.NET transactions with the MSDTC. ODP.NET utilizes this managed code with the managed driver (starting with ODAC 12c Release 3) and with the unmanaged driver (starting with ODAC 12c Release 4).</p>
                     <p>While ODP.NET, Unmanaged Driver developers can opt out of using OraMTS when using the latest .NET Framework and ODP.NET versions, they still need to install and configure the OraMTS Windows recovery service to manage recovery scenarios</p>
                     <div class="tblformal" id="GUID-B5562752-1644-4B37-B1D3-597CDD3B9DE0__GUID-B20466D4-1A97-48D6-8862-0998C952CF8F">
                        <table cellpadding="4" cellspacing="0" class="Formal" title="" summary="The table lists the version and Distributed Transaction Support for the ODP.NET Types" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" id="d2047e463">ODP.NET Type</th>
                                 <th align="left" valign="bottom" id="d2047e465">.NET Framework Version</th>
                                 <th align="left" valign="bottom" id="d2047e467">Distributed Transaction Support</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d2047e471" headers="d2047e463 ">Managed</td>
                                 <td align="left" valign="top" headers="d2047e471 d2047e465 ">4.5.2 and higher</td>
                                 <td align="left" valign="top" headers="d2047e471 d2047e467 ">Uses .NET Framework's native managed implementation (default) for distributed transactions. This is Oracle's recommended approach.</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d2047e478" headers="d2047e463 ">Managed</td>
                                 <td align="left" valign="top" headers="d2047e478 d2047e465 ">4.5.1 and lower</td>
                                 <td align="left" valign="top" headers="d2047e478 d2047e467 ">Uses the <code class="codeph">Oracle.ManagedDataAccessDTC.dll</code></td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d2047e487" headers="d2047e463 ">Unmanaged</td>
                                 <td align="left" valign="top" headers="d2047e487 d2047e465 ">4.5.2 and higher</td>
                                 <td align="left" valign="top" headers="d2047e487 d2047e467 ">Uses OraMTS (default) or managed OraMTS implementation. Oracle recommends using managed OraMTS for unmanaged ODP.NET applications requiring high availability from Oracle RAC or Data Guard.</td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" id="d2047e494" headers="d2047e463 ">Unmanaged</td>
                                 <td align="left" valign="top" headers="d2047e494 d2047e465 ">4.5.1 and lower</td>
                                 <td align="left" valign="top" headers="d2047e494 d2047e467 ">Uses OraMTS</td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <div class="infoboxnote" id="GUID-B5562752-1644-4B37-B1D3-597CDD3B9DE0__GUID-C77BC0C7-8680-452B-AA97-B8BC7CC4C0B5">
                        <p class="notep1">Note:</p>
                        <p>While .NET Framework 4.5.1 and lower within the .NET Framework 4 family are no longer supported, administrators can still use any of the distributed transaction configurations listed above in conjunction with .NET 4.5.2 and higher. For .NET 4.5.1 and lower, the table merely recommends specific setups based on user configuration. They are not requirements.</p>
                     </div>
                     <div class="infoboxnotealso" id="GUID-B5562752-1644-4B37-B1D3-597CDD3B9DE0__GUID-22BF3F83-98E1-4573-B504-69CDACE12F50">
                        <p class="notep1">See Also:</p>
                        <p><a href="install.html#GUID-EA6A9689-7E78-4D49-9020-4E89A7C82C22">Manually Creating an Oracle MTS Recovery Service</a> 
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2">ODP.NET, Managed Driver Setup</p>
                     <p>This section explains the setup and configuration steps required for using distributed transactions with ODP.NET, Managed Driver.</p>
                     <p>Oracle recommends that applications use .NET's native managed distributed transaction implementation (default), which is available in .NET Framework 4.5.2 or higher. Applications can set whether .NET's native managed distributed transaction or <code class="codeph">Oracle.ManagedDataAccessDTC.dll</code> is used by setting the <code class="codeph">UseManagedDTC</code> parameter in the .NET configuration file. Follow these steps to configure distributed transactions in these .NET Framework versions:
                     </p>
                     <ol>
                        <li>
                           <p>Create and setup the OraMTS recovery service or make sure an existing recovery service is running.</p>
                        </li>
                        <li>
                           <p>Set the value of <code class="codeph">OMTSRECO_PORT</code> in the .NET configuration to specify the port number that the OraMTS recovery service is running.
                           </p>
                        </li>
                     </ol>
                     <p>Alternatively, you can still use <code class="codeph">Oracle.ManagedDataAccessDTC.dll</code> with .NET Framework 4.5.2 and managed ODP.NET. To do so, set <code class="codeph">UseManagedDTC</code> to true and follow the instructions listed below for .NET Framework 4.5.1.
                     </p>
                     <p>For .NET Framework 4.5.1 and lower applications, follow these steps to setup and configure managed ODP.NET for distributed instructions:</p>
                     <ol>
                        <li>
                           <p>Create and setup the OraMTS recovery service or make sure an existing recovery service is running.</p>
                        </li>
                        <li>
                           <p>Deploy <code class="codeph">Oracle.ManagedDataAccessDTC.dll</code> along with the application.
                           </p>
                        </li>
                        <li>
                           <p>Set the value of <code class="codeph">OMTSRECO_PORT</code> in the .NET configuration to specify the port number that the OraMTS recovery service is running.
                           </p>
                        </li>
                     </ol>
                     <p><code class="codeph">Oracle.ManagedDataAccessDTC.dll</code> is included with ODP.NET, Managed Driver. This DLL makes unmanaged MSDTC COM calls to MSDTC, which means there is a 32-bit version and a 64-bit version of this DLL. These two DLLs share the same name. If you are using a 32-bit .NET Framework, then deploy the 32-bit <code class="codeph">Oracle.ManagedDataAccessDTC.dll</code>. If you are using a 64-bit .NET Framework, then deploy the 64-bit <code class="codeph">Oracle.ManagedDataAccessDTC.dll</code>. The DLLs are located in the following directories:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>For 32-bit .NET Framework: <code class="codeph"><span class="codeinlineitalic">ORACLE_HOME</span>\odp.net\managed\x86</code></p>
                        </li>
                        <li>
                           <p>For 64-bit .NET Framework: <code class="codeph"><span class="codeinlineitalic">ORACLE_HOME</span>\odp.net\managed\x64</code></p>
                        </li>
                     </ul>
                     <p>Upon ODP.NET installation, <code class="codeph">Oracle.ManagedDataAccessDTC.dll</code> is no longer placed into the Global Assembly Cache (GAC). For applications that use this DLL, <code class="codeph">Oracle.ManagedDataAccessDTC.dll</code> must either be placed in the application directory or in the GAC.
                     </p>
                     <p><code class="codeph">Oracle.ManagedDataAccessDTC.dll</code> should not be directly referenced by a .NET application. It will be implicitly loaded by ODP.NET, Managed Driver when using distributed transactions.
                     </p>
                     <p>For applications with platform target x64 or x86 specifically, <code class="codeph">Oracle.ManagedDataAccess.dll</code> will load <code class="codeph">Oracle.ManagedDataAccessDTC.dll</code> appropriately if it is placed into the GAC or if it resides in the application directory.
                     </p>
                     <p>For applications that target AnyCPU, the corresponding <code class="codeph">Oracle.ManagedDataAccessDTC.dll</code> needs to be placed into x64 and x86 subdirectories under wherever the <code class="codeph">Oracle.ManagedDataAccess.dll</code> is loaded from by the application. ODP.NET, Managed Driver will load the appropriate <code class="codeph">Oracle.ManagedDataAccessDTC.dll</code> assembly (32-bit or 64-bit), based on whether the application is 32-bit or 64-bit. If both 32-bit and 64-bit versions of <code class="codeph">Oracle.ManagedDataAccessDTC.dll</code> are in the GAC, then the appropriate assemblies will be loaded automatically.
                     </p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <p class="subhead2">ODP.NET, Unmanaged Driver Setup</p>
                     <p>This section explains the setup and configuration steps required for using distributed transactions with ODP.NET, Unmanaged Driver.</p>
                     <p>For .NET Framework 4.5.2 and higher, ODP.NET, Unmanaged Driver has embedded a managed OraMTS implementation into its assembly. OraMTS remains the default implementation for the ODP.NET, Unmanaged Driver, but the managed OraMTS implementation is recommended when using any high availability FAN operations (HA Events = true) with Oracle Real Application Clusters or Oracle Data Guard. The managed OraMTS implementation supports this high availability functionality, while the traditional OraMTS does not.</p>
                     <p>Applications can set whether OraMTS (default) or managed OraMTS is used by setting the <code class="codeph">UseOraMTSManaged</code> parameter in the .NET configuration file.
                     </p>
                     <p>Install and configure OraMTS, including its recovery service to use OraMTS implementation for ODP.NET, Unmanaged Driver.</p>
                     <p>For .NET Framework 4.5.2 and higher applications, you can use the managed OraMTS implementation instead of the traditional OraMTS. To set this up, perform the following steps:</p>
                     <ol>
                        <li>
                           <p>Set <code class="codeph">UseOraMTSManaged</code> to true in the .NET configuration file.
                           </p>
                        </li>
                        <li>
                           <p>Create and setup the OraMTS recovery service or make sure an existing recovery service is running.</p>
                        </li>
                     </ol>
                     <div class="infoboxnotealso" id="GUID-B5562752-1644-4B37-B1D3-597CDD3B9DE0__GUID-0A8D4A38-C36C-41DA-B5D6-A1F547807064">
                        <p class="notep1">See Also:</p>
                        <p><a href="../odpnt/InstallManagedConfig.html#ODPNT-GUID-A82B8720-BF62-48C4-8D48-E48114759EBE" target="_blank"><span><cite>Oracle Data Provider for .NET Developer's Guide for Microsoft Windows</cite></span></a> for more information
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="NTMTS303"></a><div class="props_rev_3"><a id="GUID-EA6A9689-7E78-4D49-9020-4E89A7C82C22" name="GUID-EA6A9689-7E78-4D49-9020-4E89A7C82C22"></a><h3 id="NTMTS-GUID-EA6A9689-7E78-4D49-9020-4E89A7C82C22" class="sect3"><span class="enumeration_section">2.4 </span>Manually Creating an Oracle MTS Recovery Service
               </h3>
               <div>
                  <div class="section">
                     <p>Starting with Oracle Database 12<span class="italic">c</span>, Oracle Database on Windows software includes the <code class="codeph">oramtsctl.exe</code> utility to enable manual creation of the OraMTS recovery service. ODP.NET, Managed and Unmanaged Drivers can both opt to use fully managed MS DTC solutions, which eliminates the need for OraMTS. However, in all cases, the OraMTS recovery service is still required to be setup. Every Oracle client machine that uses MS DTC must have one OraMTS recovery service configured. Multiple Oracle applications on the same machine can share using that one service. When run, the service will be created for the current Oracle home and runs as the Oracle Home User.
                     </p>
                     <p><span class="bold">To manually create an Oracle MTS Recovery Service:</span></p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>Install an Oracle Database.</span></li>
                     <li class="stepexpand"><span>Open the command prompt.</span></li>
                     <li class="stepexpand"><span>Run this command:</span><div><pre class="oac_no_warn" dir="ltr">oramtsctl -new
</pre></div>
                     </li>
                  </ol>
                  <div class="section">
                     <p><span class="bold">To delete an Oracle MTS Recovery Service run:</span></p><pre class="oac_no_warn" dir="ltr">oramtsctl -delete
</pre><p><span class="bold">Usage</span></p><pre class="oac_no_warn" dir="ltr">oramtsctl &lt;-new|-delete|-start|-stop|-status|-config|-passwd|-trace|-trcdir&gt;
          [-host    &lt;hostname|IP_address&gt; ...]
          [-port    &lt;number&gt;]
          [-ip      &lt;IP_address&gt;]
          [-dtchost &lt;DTC_hostname&gt;]
          [-cluster &lt;on|off&gt;]
          [-default]
 
 -new    </pre><p>         Create and start a new <code class="codeph">Oracler1MTSRecoveryService</code> service.
                     </p><pre class="oac_no_warn" dir="ltr"> 
 -delete [Oracle_home_directory]</pre><p>         Delete <code class="codeph">Oracler1MTSRecoveryService</code> of current home or specified home.
                     </p><pre class="oac_no_warn" dir="ltr"> 
 -start  </pre><p>         Start <code class="codeph">Oracler1MTSRecoveryService</code> service.
                     </p><pre class="oac_no_warn" dir="ltr"> 
 -stop   </pre><p>         Stop <code class="codeph">Oracler1MTSRecoveryService</code> service.
                     </p><pre class="oac_no_warn" dir="ltr"> 
 -status Query Oracler1MTSRecoveryService</pre><p>          service status.</p><pre class="oac_no_warn" dir="ltr"> 
 -config [-port &lt;number&gt;] [-ip &lt;IP_address&gt;] [-dtchost &lt;DTC_hostname&gt;]
         [-cluster &lt;on|off&gt;] [-default]
</pre><p>         Show or set <code class="codeph">Oracler1MTSRecoveryService</code> service configuration.
                     </p>
                     <p>         Use -default to reset <code class="codeph">Oracler1MTSRecoveryService</code> configuration.
                     </p><pre class="oac_no_warn" dir="ltr"> 
 -passwd</pre><p>          Update <code class="codeph">Oracler1MTSRecoveryService</code> service user password.
                     </p><pre class="oac_no_warn" dir="ltr"> 
 -trace  [0-5]</pre><p>         Show traces or set trace level. Set level 0 to turn off tracing.</p><pre class="oac_no_warn" dir="ltr"> 
 -trcdir [trace_directory]</pre><p>         Show or set trace directory.</p><pre class="oac_no_warn" dir="ltr"> 
 -host   &lt;hostname|IP_address&gt; ...</pre><p>         Execute operation on host(s) identified by name(s) or IP address(es).</p>
                     <p>         Local host is used if option not specified.</p><pre class="oac_no_warn" dir="ltr"> 
 -port   &lt;number&gt;</pre><p>         Execute <code class="codeph">-new</code> or <code class="codeph">-config</code> with this option to specify a service port.
                     </p>
                     <p>         Service port is configured automatically if option not specified.</p><pre class="oac_no_warn" dir="ltr"> 
 -ip     &lt;IP_address&gt;</pre><p>         Execute <code class="codeph">-new</code> or <code class="codeph">-config</code> with this option to specify an IP address.
                     </p><pre class="oac_no_warn" dir="ltr"> 
 -default</pre><p>         Execute <code class="codeph">-new</code> or <code class="codeph">-config</code> with this option to set default configuration.
                     </p><pre class="oac_no_warn" dir="ltr"> 
oramtsctl -new -host host1 host2.domain.com host3 -port 2033
</pre><p><span class="bold">Examples:</span></p>
                     <p>Install the service with automatic configuration:</p><pre class="oac_no_warn" dir="ltr">oramtsctl -new
 </pre><p>Install the service on port 2032:</p><pre class="oac_no_warn" dir="ltr">oramtsctl -new -port 2032
 </pre><p>Configure the service to use port 2033:</p><pre class="oac_no_warn" dir="ltr">oramtsctl -config -port 2033
 </pre><p>Update the service user password:</p><pre class="oac_no_warn" dir="ltr">oramtsctl -passwd
 </pre><p>Install the service on several hosts and use uniform port 2033:</p><pre class="oac_no_warn" dir="ltr">oramtsctl -new -host host1 host2.domain.com host3 -port 2033 </pre></div>
                  <!-- class="section" -->
               </div>
            </div>
         </div>
      </article>
   </body>
</html>