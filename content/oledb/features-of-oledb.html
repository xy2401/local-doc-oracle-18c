<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Features of OraOLEDB</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Developer's Guide ">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Developer's Guide for Microsoft Windows">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="oracle-provider-ole-db.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2018-08-05T11:14:26-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="1999, 2018">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E90595-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/18">
      
      <link rel="prev" href="introduction-to-oracle-provider-for-oledb.html" title="Previous" type="text/html">
      <link rel="next" href="provider-specific-info.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"18","element_name":"Release 18","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="OracleÂ® Provider for OLE DB">
    <meta name="dcterms.isVersionOf" content="OLEDB">
    <meta name="dcterms.release" content="Release 18">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="introduction-to-oracle-provider-for-oledb.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="provider-specific-info.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Developer's Guide </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem"> Features of OraOLEDB </li>
            </ol>
            <a id="GUID-B2F0FFA2-4DF7-4BDB-A33E-248439820028" name="GUID-B2F0FFA2-4DF7-4BDB-A33E-248439820028"></a><a id="OLEDB003"></a>
            
            <h2 id="OLEDB-GUID-B2F0FFA2-4DF7-4BDB-A33E-248439820028" class="sect2"><span class="enumeration_chapter">2 </span> Features of OraOLEDB 
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>These topics describe components of Oracle Provider for OLE DB (OraOLEDB) and how to use the components to develop OLE DB consumer applications. </p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="features-of-oledb.html#GUID-9648ED68-6DB1-4FBA-9531-467C137F56B1">OraOLEDB Provider Specific Features</a></p>
                  </li>
                  <li>
                     <p><a href="features-of-oledb.html#GUID-F143E2CD-CA25-4D52-BCFB-2A9D1C62BDE9">Using OraOLEDB with Visual Basic</a></p>
                  </li>
               </ul>
            </div><a id="OLEDB126"></a><div class="props_rev_3"><a id="GUID-9648ED68-6DB1-4FBA-9531-467C137F56B1" name="GUID-9648ED68-6DB1-4FBA-9531-467C137F56B1"></a><h3 id="OLEDB-GUID-9648ED68-6DB1-4FBA-9531-467C137F56B1" class="sect3"><span class="enumeration_section">2.1 </span>OraOLEDB Provider Specific Features
               </h3>
               <div>
                  <p>The following sections describe <a id="d3293e113" class="indexterm-anchor"></a><a id="d3293e117" class="indexterm-anchor"></a>provider-specific features of OraOLEDB:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="features-of-oledb.html#GUID-7C524D9D-173D-4C34-914A-9F4C2BFD2458">Data Source</a></p>
                     </li>
                     <li>
                        <p><a href="features-of-oledb.html#GUID-9EEB115E-50E2-4075-A986-1A3B246C60BB">OraOLEDB Sessions</a></p>
                     </li>
                     <li>
                        <p><a href="features-of-oledb.html#GUID-9B499CD6-C735-4C8B-A50B-DDE985F9AE0F">Commands</a></p>
                     </li>
                     <li>
                        <p><a href="features-of-oledb.html#GUID-D07A3F33-B9ED-4440-8DFD-534C49FF053F">Rowsets</a></p>
                     </li>
                     <li>
                        <p><a href="features-of-oledb.html#GUID-D78F518D-6DC3-4FAF-8320-571AEDC3B734">Data Types</a></p>
                     </li>
                     <li>
                        <p><a href="features-of-oledb.html#GUID-BF2FDAB4-BCC5-4BFE-9F80-C8B6303E7914">LOB Support</a></p>
                     </li>
                     <li>
                        <p><a href="features-of-oledb.html#GUID-E96E5C58-7004-4D76-9986-2DE9D4A17817">Unicode Support</a></p>
                     </li>
                     <li>
                        <p><a href="features-of-oledb.html#GUID-0E5603DB-BDB3-47F1-ABBB-E58CFD93C7D5">Errors</a></p>
                     </li>
                     <li>
                        <p><a href="features-of-oledb.html#GUID-946BB8F8-7BA1-486D-9205-90F05BC9896A">OLEDB.NET Data Provider Compatibility</a></p>
                     </li>
                  </ul>
                  <p>Additional provider-specific information is provided in <a href="provider-specific-info.html#GUID-FE1A4C21-5B11-4A97-8BCB-FCABBA5AFE3C">Provider-Specific Information</a>.
                  </p>
               </div><a id="OLEDB144"></a><div class="props_rev_3"><a id="GUID-7C524D9D-173D-4C34-914A-9F4C2BFD2458" name="GUID-7C524D9D-173D-4C34-914A-9F4C2BFD2458"></a><h4 id="OLEDB-GUID-7C524D9D-173D-4C34-914A-9F4C2BFD2458" class="sect4"><span class="enumeration_section">2.1.1 </span>Data Source
                  </h4>
                  <div>
                     <p>A data source object in OraOLEDB is responsible for establishing the first connection to the Oracle Database. To establish the initial connection, the consumer must use the <a id="d3293e223" class="indexterm-anchor"></a><a id="d3293e227" class="indexterm-anchor"></a><a id="d3293e231" class="indexterm-anchor"></a><code class="codeph">CoCreateInstance</code> function to create an instance of the data source object. This function requires important information about the provider: class ID of the provider and executable context. The <a id="d3293e238" class="indexterm-anchor"></a><a id="d3293e242" class="indexterm-anchor"></a>class ID of OraOLEDB is <code class="codeph">CLSID_OraOLEDB</code>. 
                     </p>
                     <p>OraOLEDB is an in-process server. When calling <code class="codeph">CoCreateInstance</code>, use the <a id="d3293e255" class="indexterm-anchor"></a><code class="codeph">CLSCTX_INPROC_SERVER</code> macro. For example:
                     </p><pre class="oac_no_warn" dir="ltr">// create an instance of OraOLEDB data source object and 
// obtain the IDBInitialize interface
hr = CoCreateInstance(CLSID_OraOLEDB, NULL, 
                      CLSCTX_INPROC_SERVER, IID_IDBInitialize, 
                     (void**)&amp;pIDBInitialize);
</pre><p>The code snippet above does not enable OLEDB Services when instantiating the Data Source object. To enable OLEDB services, see <span class="q">"<a href="features-of-oledb.html#GUID-BBC8F739-4258-4A56-BF19-5E2895C7D8D2">Compatibility with OLE DB Services</a>"</span> below. 
                     </p>
                     <div class="infoboxnote" id="GUID-7C524D9D-173D-4C34-914A-9F4C2BFD2458__GUID-FBC9DD99-4AEE-4253-B05D-34A6B574A0CA">
                        <p class="notep1">Note:</p>
                        <p>OraOLEDB does not support persistent data source objects.</p>
                     </div>
                     <p>After the successful creation of an instance of a data source object, the consumer application can initialize the data source and create sessions.</p>
                     <p><a id="d3293e274" class="indexterm-anchor"></a><a id="d3293e278" class="indexterm-anchor"></a>OraOLEDB supports connections to Oracle Databases releases. To connect to a specific database, the consumer is required to set the following properties of the <code class="codeph">DBPROPSET_DBINIT</code> property set:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><code class="codeph">DBPROP_AUTH_USERNAME</code> with the user ID, such as <code class="codeph">scott</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">DBPROP_AUTH_PASSWORD</code> with the password, such as <code class="codeph">tiger</code></p>
                        </li>
                        <li>
                           <p><code class="codeph">DBPROP_INIT_DATASOURCE</code> with the net service name, such as <code class="codeph">myOraDb</code></p>
                        </li>
                     </ul>
                     <p>The consumer could also populate <code class="codeph">DBPROP_INIT_PROMPT</code> with <code class="codeph">DBPROMPT_PROMPT</code> which causes the <span class="bold">provider</span> to display a logon box for the user to enter the connect information. 
                     </p>
                     <p>Using <code class="codeph">DBPROMPT_NOPROMPT</code> disables display of the logon box. In this case, incomplete logon information causes the provider to return a logon error. However, if this property is set to <code class="codeph">DBPROMPT_COMPLETE</code> or <code class="codeph">DBPROMPT_COMPLETEREQUIRED</code>, the logon box will be displayed only if the logon information is incomplete.
                     </p>
                  </div><a id="OLEDB145"></a><div class="props_rev_3"><a id="GUID-BBC8F739-4258-4A56-BF19-5E2895C7D8D2" name="GUID-BBC8F739-4258-4A56-BF19-5E2895C7D8D2"></a><h5 id="OLEDB-GUID-BBC8F739-4258-4A56-BF19-5E2895C7D8D2" class="sect5"><span class="enumeration_section">2.1.1.1 </span>Compatibility with OLE DB Services
                     </h5>
                     <div>
                        <p>OraOLEDB is compatible with OLE DB Services that are available in OLE DB version 2.0 and later. OLE DB Services contains useful services such as automatic transaction enlistment, Client Cursor Engine (CCE), connection and session pooling, which can enhance application performance, and others.</p>
                        <p>OLE DB Services can be used with OraOLEDB through C++/COM or ADO.</p>
                        <p>By default, the <code class="codeph">OLEDB_SERVICES</code> registry entry for OraOLEDB is set, under the <code class="codeph">CLSID</code> of OraOLEDB, to <code class="codeph">0xffffffff</code> (that is, <code class="codeph">-1</code>), which enables all services. Certain OLE DB Services can also be disabled or enabled programmatically through the <code class="codeph">DBPROP_INIT_OLEDBSERVICES</code> property setting.
                        </p>
                        <div class="infoboxnotealso" id="GUID-BBC8F739-4258-4A56-BF19-5E2895C7D8D2__GUID-FB909B48-6FE6-4F2E-A496-68F781F7084C">
                           <p class="notep1">See Also:</p>
                           <p><a href="http://msdn.microsoft.com/en-us/library/ms724518(VS.85).aspx" target="_blank"><code class="codeph">http://msdn.microsoft.com/en-us/library/ms724518(VS.85).aspx</code></a> for more information on OLE DB Services and how to enable or disable specific services
                           </p>
                        </div>
                     </div><a id="OLEDB146"></a><div class="props_rev_3"><a id="GUID-25014FA4-1821-4AB3-9C43-80809766055C" name="GUID-25014FA4-1821-4AB3-9C43-80809766055C"></a><h6 id="OLEDB-GUID-25014FA4-1821-4AB3-9C43-80809766055C" class="sect6"><span class="enumeration_section">2.1.1.1.1 </span>ADO Applications with OLE DB Services
                        </h6>
                        <div>
                           <p>ADO automatically enables OLE DB Services. Thus, ADO applications do not need any special code to use OLEDB Services.</p>
                        </div>
                     </div><a id="OLEDB147"></a><div class="props_rev_3"><a id="GUID-9AF3F978-7C91-4A47-BBBA-2010299571D0" name="GUID-9AF3F978-7C91-4A47-BBBA-2010299571D0"></a><h6 id="OLEDB-GUID-9AF3F978-7C91-4A47-BBBA-2010299571D0" class="sect6"><span class="enumeration_section">2.1.1.1.2 </span>C++/COM Applications with OLE DB Services
                        </h6>
                        <div>
                           <p> For C++/COM applications, some additional steps are needed to use OLE DB Services. </p>
                           <p>The following code snippet shows one way that C++/COM applications can enable OLE DB Services. The code shows the OLE DB consumer creating an instance of the <code class="codeph">CLSID_MSDAINITIALIZE</code> class through <code class="codeph">CoCreateInstance()</code>, obtaining the <code class="codeph">IDataInitialize</code> interface from that object, and then creating an OLE DB data source object through that interface.
                           </p><pre class="oac_no_warn" dir="ltr">// Instantiate the CLSID_MSDAINITIALIZE class and request for the
// IID_IDataInitialize interface from it
hr = <span class="bold">CoCreateInstance(CLSID_MSDAINITIALIZE</span>, NULL, CLSCTX_INPROC_SERVER, 
  IID_IDataInitialize, (void**)&amp;pIDataInitialize);

// Set properties, datasource name, userid, and password, etc.
...

// Create an OLEDB data source object using the interface obtained from the
// CLSID_MSDAINITIALIZE class.
hr = pIDataInitialize-&gt;CreateDBInstance(CLSID_OraOLEDB, NULL, 
    CLSCTX_INPROC_SERVER, NULL,IID_IDBInitialize,(IUnknown**)&amp;pIDBInitialize);
...

// If connection/session pooling was enabled, pIDBInitialize-&gt;Release()
// releases the connection/session back to the pool.
// pIDataInitialize-&gt;Release() should not be called until the application no
// longer need to use connection/session pooling and the rest of
// the OLE DB Services that were enabled for the application.
//  
pIDBInitialize-&gt;Release();</pre></div>
                     </div>
                  </div><a id="OLEDB148"></a><div class="props_rev_3"><a id="GUID-F3E1BA58-6A52-4AB3-9BFE-E5B09E7A979A" name="GUID-F3E1BA58-6A52-4AB3-9BFE-E5B09E7A979A"></a><h5 id="OLEDB-GUID-F3E1BA58-6A52-4AB3-9BFE-E5B09E7A979A" class="sect5"><span class="enumeration_section">2.1.1.2 </span>Connecting to an Oracle Database
                     </h5>
                     <div>
                        <div class="section">
                           <p>To connect to an Oracle Database using OraOLEDB, the OLE DB connection string must be as follows:</p><pre class="oac_no_warn" dir="ltr">"Provider=OraOLEDB.Oracle;User ID=user;Password=<span class="italic">pwd</span>;Data Source=constr;"
</pre><p>When connecting to a remote database, <code class="codeph">Data</code> <code class="codeph">Source</code> must be set to the correct net service name which is the alias in the <code class="codeph">tnsnames.ora</code> file.
                           </p>
                           <div class="infoboxnotealso" id="GUID-F3E1BA58-6A52-4AB3-9BFE-E5B09E7A979A__GUID-8C8A9F76-4E2A-4741-AE98-25735EA47C4A">
                              <p class="notep1">See Also:</p>
                              <p><a href="../netag/quick-start-oracle-net-services.html#NETAG006" target="_blank"><span><cite>Oracle Database Net Services Administrator's Guide</cite></span></a></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="OLEDB149"></a><div class="props_rev_3"><a id="GUID-551FB32E-FA0A-489C-8E6F-C528CBAA9D82" name="GUID-551FB32E-FA0A-489C-8E6F-C528CBAA9D82"></a><h5 id="OLEDB-GUID-551FB32E-FA0A-489C-8E6F-C528CBAA9D82" class="sect5"><span class="enumeration_section">2.1.1.3 </span>OraOLEDB-Specific Connection String Attributes
                     </h5>
                     <div>
                        <p>OraOLEDB offers provider-specific connection string attributes, which are set in the same way as the Provider and User ID are set. The provider-specific connection string attributes are:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">CacheType</code> - specifies the type of cache used to store the rowset data on the client. See <span class="q">"<a href="features-of-oledb.html#GUID-678B22C8-BE4A-4B50-997B-F916C6FA0F51">OraOLEDB-Specific Connection String Attributes for Rowsets</a>"</span>.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">ChunkSize</code> - specifies the size of <code class="codeph">LONG</code> or <code class="codeph">LONG RAW</code> column data stored in the provider's cache. See <span class="q">"<a href="features-of-oledb.html#GUID-678B22C8-BE4A-4B50-997B-F916C6FA0F51">OraOLEDB-Specific Connection String Attributes for Rowsets</a>"</span>.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">DistribTX</code> - enables or disables distributed transaction enlistment capability. See <span class="q">"<a href="features-of-oledb.html#GUID-3EC3DE20-7B35-4C9B-89A7-E7FF76A76DF8">Distributed Transactions</a>"</span>.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">FetchSize</code> - specifies the size of the fetch array in rows. See <span class="q">"<a href="features-of-oledb.html#GUID-678B22C8-BE4A-4B50-997B-F916C6FA0F51">OraOLEDB-Specific Connection String Attributes for Rowsets</a>"</span>.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">OLEDB.NET</code> <a id="d3293e756" class="indexterm-anchor"></a> - enables or disables compatibility with <a id="d3293e759" class="indexterm-anchor"></a>OLEDB.NET Data Provider. See <span class="q">"<a href="features-of-oledb.html#GUID-946BB8F8-7BA1-486D-9205-90F05BC9896A">OLEDB.NET Data Provider Compatibility</a>"</span>.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">OSAuthent</code> - specifies whether operating system authentication will be used when connecting to an Oracle Database. See <span class="q">"<a href="features-of-oledb.html#GUID-D054A55D-77BA-4954-BA0A-33F265756568">Operating System Authentication</a>"</span>.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">PLSQLRSet</code> - enables or disables the return of a rowset from <a href="glossary.html#GUID-A52D3997-0C77-424A-BE10-C7F18DCB4B2C"><span class="xrefglossterm">PL/SQL</span></a> stored procedures. See <span class="q">"<a href="features-of-oledb.html#GUID-70778DCD-8ECA-4AC5-8D31-C9A8B9D54413">OraOLEDB Custom Properties for Commands</a>"</span>.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">PwdChgDlg</code> - enables or disables displaying the password change dialog box when the password expires. See <span class="q">"<a href="features-of-oledb.html#GUID-1D909472-6C16-4713-8BB9-860F74CEDFEF">Password Expiration</a>"</span>.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">UseSessionFormat</code> - specifies whether to use the default NLS session formats or let OraOLEDB override some of these formats for the duration of the session. Valid values are <code class="codeph">0</code> (<code class="codeph">FALSE</code>) and <code class="codeph">1</code> (<code class="codeph">TRUE</code>). The default is <code class="codeph">FALSE</code> which lets OraOLEDB override some of the default NLS session formats. If the value is <code class="codeph">TRUE</code>, OraOLEDB uses the default NLS session formats.
                              </p>
                              <p>Note that this connection attribute does not appear under the <code class="codeph">\\HKEY_LOCAL_ MACHINE\SOFTWARE\ORACLE\KEY_</code><span class="italic"><code class="codeph">HOMENAME</code></span><code class="codeph">\OLEDB</code> registry key.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">VCharNull</code> - enables or disables the NULL termination of <code class="codeph">VARCHAR2 OUT</code> parameters from stored procedures.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">SPPrmDefVal</code><a id="d3293e842" class="indexterm-anchor"></a> - specifies whether to use the default value or a NULL value if the application has not specified a stored procedure parameter value.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">NDataType</code> - specifies whether any of the parameters bound to the command are of N data types, which include <code class="codeph">NCHAR</code>, <code class="codeph">NVARCHAR2</code>, or <code class="codeph">NCLOB</code>.  See <span class="q">"<a href="features-of-oledb.html#GUID-70778DCD-8ECA-4AC5-8D31-C9A8B9D54413__BABBCDHJ">NDatatype</a>"</span>.
                              </p>
                              <p>Note that this connection attribute does not appear under the <code class="codeph">\\HKEY_LOCAL_ MACHINE\SOFTWARE\ORACLE\KEY_</code><span class="italic"><code class="codeph">HOMENAME</code></span><code class="codeph">\OLEDB</code> registry key.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">SPPrmsLOB</code> - specifies whether one or more parameters bound to the stored procedures are of LOB data type, which include <code class="codeph">CLOB</code>, <code class="codeph">BLOB</code>, or <code class="codeph">NCLOB</code>. See <span class="q">"<a href="features-of-oledb.html#GUID-70778DCD-8ECA-4AC5-8D31-C9A8B9D54413__BABCAAIG">SPPrmsLOB</a>"</span>.
                              </p>
                              <p>Note that this connection attribute does not appear under the <code class="codeph">\\HKEY_LOCAL_ MACHINE\SOFTWARE\ORACLE\KEY_</code><span class="italic"><code class="codeph">HOMENAME</code></span><code class="codeph">\OLEDB</code> registry key.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">StmtCacheSize</code> &#x2013; specifies the maximum number of statements that can be cached. See <span class="q">"<a href="features-of-oledb.html#GUID-8E814A7F-F3A6-4161-B0A6-B236E9E62B5F">Statement Caching</a>"</span>.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">MetaDataCacheSize</code><a id="d3293e915" class="indexterm-anchor"></a> - specifies the maximum number of <code class="codeph">SELECT</code> statements for which the metadata can be cached. See <span class="q">"<a href="features-of-oledb.html#GUID-E2D83FFC-5085-4540-BF78-26AFAF377722">Metadata Caching</a>"</span>.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">DeferUpdChk</code> - specifies whether or not to defer the updateability check to support updating read-only disconnected rowsets. See <code class="codeph">DeferUpdChk</code> under <span class="q">"<a href="features-of-oledb.html#GUID-678B22C8-BE4A-4B50-997B-F916C6FA0F51">OraOLEDB-Specific Connection String Attributes for Rowsets</a>"</span>.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">DBNotifications</code><a id="d3293e941" class="indexterm-anchor"></a> - specifies whether or not to subscribe to the high availability events. See <span class="q">"<a href="features-of-oledb.html#GUID-5BBB7661-A1D0-4720-959A-6F2D558AD8F1">Enhanced Failover Capability</a>"</span>.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">DBNotificationPort</code> - specifies the port number, which is opened to listen to the Database notifications. See <span class="q">"<a href="features-of-oledb.html#GUID-5BBB7661-A1D0-4720-959A-6F2D558AD8F1">Enhanced Failover Capability</a>"</span>.
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="OLEDB150"></a><div class="props_rev_3"><a id="GUID-57E98379-51C8-4039-8809-897531FA38C3" name="GUID-57E98379-51C8-4039-8809-897531FA38C3"></a><h5 id="OLEDB-GUID-57E98379-51C8-4039-8809-897531FA38C3" class="sect5"><span class="enumeration_section">2.1.1.4 </span>Default Attribute Values
                     </h5>
                     <div>
                        <p><span class="bold"></span>The default values for these attributes are located under the <code class="codeph">\\HKEY_LOCAL_ MACHINE\SOFTWARE\ORACLE\KEY_</code><span class="italic"><code class="codeph">HOMENAME</code></span><code class="codeph">\OLEDB</code> registry key, where <code class="codeph">KEY_</code><span class="italic"><code class="codeph">HOMENAME</code></span> is the Oracle home. 
                        </p>
                        <p>The registry default values are read by OraOLEDB from the registry when the provider is loaded into memory. If Oracle-specific connection string attributes are not provided at connection time, then the default registry values are used. However, if the attributes are provided, then these new values override the default registry values.</p>
                        <p>These attributes can be set by setting the <code class="codeph">DBPROP_INIT_PROVIDERSTRING</code> property, provided in the <code class="codeph">DBPROPSET_DBINIT</code> property set. For example: 
                        </p><pre class="oac_no_warn" dir="ltr">"FetchSize=100;CacheType=Memory;OSAuthent=0;PLSQLRSet=1;StmtCacheSize=10;"</pre></div>
                  </div><a id="OLEDB151"></a><div class="props_rev_3"><a id="GUID-3EC3DE20-7B35-4C9B-89A7-E7FF76A76DF8" name="GUID-3EC3DE20-7B35-4C9B-89A7-E7FF76A76DF8"></a><h5 id="OLEDB-GUID-3EC3DE20-7B35-4C9B-89A7-E7FF76A76DF8" class="sect5"><span class="enumeration_section">2.1.1.5 </span>Distributed Transactions
                     </h5>
                     <div>
                        <p>The <code class="codeph">DistribTX</code> attribute specifies whether sessions are enabled to enlist in distributed transactions. Valid values are <code class="codeph">0</code> (disabled) and <code class="codeph">1</code> (enabled). The default is <code class="codeph">1</code> which indicates that sessions are enabled for distributed transaction enlistments. 
                        </p>
                        <p>Applications using Microsoft Distributed Transaction Coordinator must have <code class="codeph">DistribTX</code> set to <code class="codeph">1</code>, the default.
                        </p>
                        <p>Sessions <a id="d3293e1140" class="indexterm-anchor"></a>enabled for distributed transaction enlistments cannot run statements that use the direct path load and parallel DML capabilities of the Oracle database. Such statements are executed as conventional path serial statements.
                        </p>
                     </div>
                  </div><a id="OLEDB153"></a><a id="OLEDB152"></a><div class="props_rev_3"><a id="GUID-5BBB7661-A1D0-4720-959A-6F2D558AD8F1" name="GUID-5BBB7661-A1D0-4720-959A-6F2D558AD8F1"></a><h5 id="OLEDB-GUID-5BBB7661-A1D0-4720-959A-6F2D558AD8F1" class="sect5"><span class="enumeration_section">2.1.1.6 </span>Enhanced Failover Capability
                     </h5>
                     <div>
                        <p>This feature enhances failover capability.</p>
                        <p>These connection string attributes support enhanced failover capability.</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">DBNotifications</code></p>
                              <p>The <code class="codeph">DBNotifications</code> attribute specifies whether or not to subscribe to high availability events. Valid values are <code class="codeph">0</code> (<code class="codeph">FALSE</code>) and <code class="codeph">1</code> (<code class="codeph">TRUE</code>). The default is <code class="codeph">FALSE</code>, which indicates that OraOLEDB does not subscribe to high availability events. If this attribute is not provided at the connection time, then the default registry value is used.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">DBNotificationPort</code></p>
                              <p>The <code class="codeph">DBNotificationPort</code> attribute specifies the port number, which is used to listen to the database notifications. The valid value is an unsigned integer.
                              </p>
                              <p><code class="codeph">DBNotificationPort</code> is effective only if the <code class="codeph">DBNotifications</code> attribute is set to <code class="codeph">TRUE</code>, either through the connection string attribute or by registry entry. The default for the <code class="codeph">DBNotificationPort</code> attribute is <code class="codeph">0</code>, which implies that OraOLEDB opens a valid port randomly. OraOLEDB does not validate the port number, so it is the responsibility of the application to specify a valid port number.
                              </p>
                           </li>
                        </ul>
                        <div class="section">
                           <p class="subhead3">Enabling Failover Capability Through Registry Entry</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><code class="codeph">DBNotifications</code></p>
                                 <p>The <code class="codeph">DBNotifications</code> registry entry specifies whether or not to subscribe to high availability events. Valid values are <code class="codeph">0</code> (<code class="codeph">FALSE</code>) and <code class="codeph">1</code> (<code class="codeph">TRUE</code>). The default value is <code class="codeph">FALSE</code>, OraOLEDB does not subscribe. This registry entry value is used when the <code class="codeph">DBNotifications</code> connection string attribute is not set. It is located under the <code class="codeph">\\HKEY_LOCAL_MACHINE\SOFTWARE\ORACLE\</code><code class="codeph">KEY_</code><span class="italic"><code class="codeph">HOMENAME</code></span><code class="codeph">\OLEDB</code> registry key. 
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="OLEDB154"></a><div class="props_rev_3"><a id="GUID-D054A55D-77BA-4954-BA0A-33F265756568" name="GUID-D054A55D-77BA-4954-BA0A-33F265756568"></a><h5 id="OLEDB-GUID-D054A55D-77BA-4954-BA0A-33F265756568" class="sect5"><span class="enumeration_section">2.1.1.7 </span>Operating System Authentication
                     </h5>
                     <div>
                        <p>The <code class="codeph">OSAuthent</code> attribute specifies whether operating system authentication will be used when connecting to an Oracle Database. Valid values are <code class="codeph">0</code> (disabled) and <code class="codeph">1</code>(enabled). The default is <code class="codeph">0</code>, which indicates that operating system authentication is not used.
                        </p>
                        <p>Operating system authentication is the feature by which Oracle uses the security mechanisms of the operating system to authorize users.</p>
                        <p>After the Windows client has been set up properly for operating system authentication, this feature may be enabled by OraOLEDB clients by setting any of the following:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">DBPROP_AUTH_USERNAME</code> to <code class="codeph">/</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">DBPROP_INIT_PROVIDERSTRING</code> to <code class="codeph">OSAuthent=1</code>;
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">OSAuthent</code> in the registry to <code class="codeph">1</code></p>
                           </li>
                        </ul>
                        <div class="infoboxnotealso" id="GUID-D054A55D-77BA-4954-BA0A-33F265756568__GUID-24416959-870A-4631-959E-55B62901A5A4">
                           <p class="notep1">See Also:</p>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/oledb&amp;id=NTQRF327" target="_blank"><span class="italic">Oracle Database Platform Guide for Microsoft Windows</span></a> for more information on this subject and how to set it up on Windows clients.
                           </p>
                        </div>
                     </div>
                  </div><a id="OLEDB156"></a><a id="OLEDB157"></a><a id="OLEDB158"></a><a id="OLEDB159"></a><a id="OLEDB160"></a><a id="OLEDB161"></a><a id="OLEDB155"></a><div class="props_rev_3"><a id="GUID-1D909472-6C16-4713-8BB9-860F74CEDFEF" name="GUID-1D909472-6C16-4713-8BB9-860F74CEDFEF"></a><h5 id="OLEDB-GUID-1D909472-6C16-4713-8BB9-860F74CEDFEF" class="sect5"><span class="enumeration_section">2.1.1.8 </span>Password Expiration
                     </h5>
                     <div>
                        <p>Oracle provides a Password Expiration feature which allows database administrators to force users to change their passwords regularly. The <code class="codeph">PwdChgDlg</code> attribute enables or disables the displaying of the password change dialog box, whenever a logon fails due to an expired password. When enabled, the provider displays the dialog box to change the password. When disabled, the logon fails with an error message. The valid values are <code class="codeph">0</code> (disabled) and <code class="codeph">1</code> (enabled). The default is <code class="codeph">1</code> (enabled). 
                        </p>
                        <div class="infoboxnotealso" id="GUID-1D909472-6C16-4713-8BB9-860F74CEDFEF__GUID-E2C2897D-F5D4-4AC0-940A-10DF3299DDED">
                           <p class="notep1">See Also:</p>
                           <p><a href="../dbseg/configuring-authentication.html#DBSEG33236" target="_blank"><span class="italic">Oracle Database Security Guide</span></a> for more information on the Password Expiration feature.
                           </p>
                        </div>
                        <div class="section">
                           <p class="subhead3">Example: Connecting to an Oracle Database Using ADO</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>The following examples illustrate how to connect to an Oracle Database using OraOLEDB and ADO.</p>
                           <div class="infoboxnote" id="GUID-1D909472-6C16-4713-8BB9-860F74CEDFEF__GUID-E6A44B94-1CB1-41BB-AD0E-C96673C41606">
                              <p class="notep1">Note:</p>
                              <p>If <code class="codeph">Data Source</code>, <code class="codeph">User ID</code>, and <code class="codeph">Password</code> are provided with the <code class="codeph">Open</code> method, then ADO ignores those <code class="codeph">ConnectionString</code> attributes.
                              </p>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3">Connect Using ConnectionString</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section"><pre class="oac_no_warn" dir="ltr">Dim con As New ADODB.Connection
con.ConnectionString = "Provider=OraOLEDB.Oracle;Data Source=MyOraDb;" &amp; _
                     "User ID=scott;Password=tiger;"
con.Open</pre></div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3">Connect Without Using ConnectionString</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section"><pre class="oac_no_warn" dir="ltr">Dim con As New ADODB.Connection
con.Provider = "OraOLEDB.Oracle"
con.Open "MyOraDb", "scott", "tiger"
</pre></div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3">Connect and Set Provider-specific Attributes</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section"><pre class="oac_no_warn" dir="ltr">Dim con As New ADODB.Connection
con.Provider = "OraOLEDB.Oracle"
con.ConnectionString = "FetchSize=200;CacheType=Memory;" &amp; _
                       "OSAuthent=0;PLSQLRSet=1;Data Source=MyOraDb;" &amp; _
                       "User ID=scott;Password=tiger;"
con.Open
</pre></div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3">Operating System-Authenticated Connect Setting User ID to /</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section"><pre class="oac_no_warn" dir="ltr">Dim con As New ADODB.Connection
con.Provider = "OraOLEDB.Oracle"
con.Open "MyOraDb", "/", ""</pre></div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3">Operating System-Authenticated Connect Using OSAuthent</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section"><pre class="oac_no_warn" dir="ltr">Dim con As New ADODB.Connection
con.Provider = "OraOLEDB.Oracle"
con.ConnectionString = "Data Source=MyOraDb;OSAuthent=1;"
con.Open</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="OLEDB162"></a><div class="props_rev_3"><a id="GUID-F728CD4E-9E04-42A8-9FE2-D070DD748DA6" name="GUID-F728CD4E-9E04-42A8-9FE2-D070DD748DA6"></a><h5 id="OLEDB-GUID-F728CD4E-9E04-42A8-9FE2-D070DD748DA6" class="sect5"><span class="enumeration_section">2.1.1.9 </span>VCharNull
                     </h5>
                     <div>
                        <p>The <code class="codeph">VCharNull</code> attribute enables or disables the NULL termination of <code class="codeph">VARCHAR2 OUT</code> parameters from stored procedures. Valid values are <code class="codeph">0</code> (disabled) and <code class="codeph">1</code> (enabled). The default is <code class="codeph">1</code>, which indicates that <code class="codeph">VARCHAR2 OUT</code> parameters are NULL terminated. A value of <code class="codeph">0</code> indicates that <code class="codeph">VARCHAR2 OUT</code> parameters are padded with spaces.
                        </p>
                        <p>The default value for this attribute is located under the <code class="codeph">\\HKEY_LOCAL_ MACHINE\SOFTWARE\ORACLE\KEY_</code><span class="italic"><code class="codeph">HOMENAME</code></span><code class="codeph">\OLEDB</code> registry key, where <span class="italic"><code class="codeph">HOMENAME</code></span> is the Oracle home. If this attribute is not provided at the connection time, then the default registry value is used.
                        </p>
                        <p>Note that with this connection attribute enabled, applications need to pad the stored procedure <code class="codeph">IN</code> and <code class="codeph">IN OUT CHAR</code> parameters with spaces explicitly, if the parameter is to be used in a <code class="codeph">WHERE</code> clause.
                        </p>
                     </div>
                  </div><a id="OLEDB163"></a><div class="props_rev_3"><a id="GUID-5DD673A3-9AAD-4011-96CF-76F0BCF484CB" name="GUID-5DD673A3-9AAD-4011-96CF-76F0BCF484CB"></a><h5 id="OLEDB-GUID-5DD673A3-9AAD-4011-96CF-76F0BCF484CB" class="sect5"><span class="enumeration_section">2.1.1.10 </span>SPPrmDefVal
                     </h5>
                     <div>
                        <p>The <code class="codeph">SPPrmDefVal</code> attribute specifies whether to use the default value or a NULL value if the application has not specified a stored procedure parameter value. Valid values are <code class="codeph">0</code> (FALSE) and <code class="codeph">1</code> (TRUE). The default is FALSE, which enables OraOLEDB to pass a NULL value. If the value is TRUE, then OraOLEDB uses the default value.
                        </p>
                        <p>The default value for this attribute is located under the <code class="codeph">\\HKEY_LOCAL_ MACHINE\SOFTWARE\ORACLE\KEY_</code><span class="italic"><code class="codeph">HOMENAME</code></span><code class="codeph">\OLEDB</code> registry key. If this attribute is not provided at connection time, then the default registry value is used.
                        </p>
                     </div>
                  </div>
               </div><a id="OLEDB164"></a><div class="props_rev_3"><a id="GUID-9EEB115E-50E2-4075-A986-1A3B246C60BB" name="GUID-9EEB115E-50E2-4075-A986-1A3B246C60BB"></a><h4 id="OLEDB-GUID-9EEB115E-50E2-4075-A986-1A3B246C60BB" class="sect4"><span class="enumeration_section">2.1.2 </span>OraOLEDB Sessions
                  </h4>
                  <div>
                     <p>An OraOLEDB session object represents a single connection to an Oracle Database. The session object exposes the interfaces that allow data access and manipulation.</p>
                     <p>The first session created on the initialized data source inherits the initial connection established by <code class="codeph">IDBInitialize::Initialize()</code>. Subsequent sessions that are created establish their own independent connections to the particular Oracle Database specified by the data source properties.
                     </p>
                     <p>Each session object also defines a transaction space for a data source. All command and rowset objects created from a particular session object are part of the transaction of that session.</p>
                     <p>After all references to the session object are released, the session object is removed from memory and the connection is dropped.</p>
                  </div><a id="OLEDB165"></a><div class="props_rev_3"><a id="GUID-C8E2CEBA-2E46-4934-92CE-C199B61E09FB" name="GUID-C8E2CEBA-2E46-4934-92CE-C199B61E09FB"></a><h5 id="OLEDB-GUID-C8E2CEBA-2E46-4934-92CE-C199B61E09FB" class="sect5"><span class="enumeration_section">2.1.2.1 </span>Transactions
                     </h5>
                     <div>
                        <p>OraOLEDB supports local and distributed transactions, which provide explicit commit and abort transactional operations.</p>
                        <p>OraOLEDB does not support nested transactions. In addition, a local transaction cannot be started if the session is currently enlisted in a distributed transaction. This also applies to distributed transactions if the session is currently enlisted in a local transaction.</p>
                     </div><a id="OLEDB166"></a><div class="props_rev_3"><a id="GUID-C47822E8-1AC7-437D-9216-D78A587413AE" name="GUID-C47822E8-1AC7-437D-9216-D78A587413AE"></a><h6 id="OLEDB-GUID-C47822E8-1AC7-437D-9216-D78A587413AE" class="sect6"><span class="enumeration_section">2.1.2.1.1 </span>Local Transactions
                        </h6>
                        <div>
                           <p>OraOLEDB supports the <code class="codeph">ITransactionLocal</code> interface for explicit transactions. By default, OraOLEDB is in an autocommit mode, meaning that each unit of work done on the database is automatically or implicitly committed. With the use of the <code class="codeph">ITransactionLocal</code> interface, consumers may explicitly start a transaction for a particular session, allowing a unit of work to be explicitly committed or aborted by the consumer.
                           </p>
                           <p><a id="d3293e1944" class="indexterm-anchor"></a>OraOLEDB supports the Read Committed (<a id="d3293e1949" class="indexterm-anchor"></a>Cursor Stability) isolation level. In this level, the changes made by other transactions are not visible until those transactions are committed.
                           </p>
                        </div>
                     </div><a id="OLEDB167"></a><div class="props_rev_3"><a id="GUID-C7391359-3A81-401C-9493-DBB61EDA269F" name="GUID-C7391359-3A81-401C-9493-DBB61EDA269F"></a><h6 id="OLEDB-GUID-C7391359-3A81-401C-9493-DBB61EDA269F" class="sect6"><span class="enumeration_section">2.1.2.1.2 </span>Distributed Transactions
                        </h6>
                        <div>
                           <p>OraOLEDB consumers must install <a id="d3293e2023" class="indexterm-anchor"></a>Oracle Services for Microsoft Transaction Server (MTS) release 10.2 or higher to be able to participate in Microsoft Transaction Server (or COM+) transactions or to enlist in a distributed transaction coordinated by <a id="d3293e2026" class="indexterm-anchor"></a>Microsoft Distributed Transaction Coordinator (MS DTC). 
                           </p>
                           <p>OraOLEDB ignores <code class="codeph">IsoLevel</code>, <code class="codeph">IsoFlags</code>, and <code class="codeph">pOtherOptions</code> parameters when <code class="codeph">ITransactionJoin::JoinTransaction()</code> is called. These options must be provided when the consumer acquires a transaction object from MS DTC with the <code class="codeph">ITransactionDispenser::BeginTransaction()</code> method call.
                           </p>
                           <p>However, if <code class="codeph">IsoFlags</code> is nonzero, then <code class="codeph">XACT_E_NOISORETAIN</code> is returned.
                           </p>
                           <div class="infoboxnotealso" id="GUID-C7391359-3A81-401C-9493-DBB61EDA269F__GUID-EE909F9B-94E9-402B-A7D1-E52F2EA8CA42">
                              <p class="notep1">See Also:</p>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/oledb&amp;id=NTMTS003" target="_blank"><span class="italic">Oracle Services for Microsoft Transaction Server Developer's Guide for Microsoft Windows</span></a> for setup and configuration information on Oracle Services for MTS.
                              </p>
                           </div>
                        </div>
                     </div>
                  </div>
               </div><a id="OLEDB168"></a><div class="props_rev_3"><a id="GUID-9B499CD6-C735-4C8B-A50B-DDE985F9AE0F" name="GUID-9B499CD6-C735-4C8B-A50B-DDE985F9AE0F"></a><h4 id="OLEDB-GUID-9B499CD6-C735-4C8B-A50B-DDE985F9AE0F" class="sect4"><span class="enumeration_section">2.1.3 </span>Commands
                  </h4>
                  <div>
                     <p>OraOLEDB supports ANSI SQL as supported by Oracle Database and the ODBC SQL syntax.</p>
                  </div><a id="OLEDB169"></a><div class="props_rev_3"><a id="GUID-8A791326-7205-4CD7-9B65-66202F39B658" name="GUID-8A791326-7205-4CD7-9B65-66202F39B658"></a><h5 id="OLEDB-GUID-8A791326-7205-4CD7-9B65-66202F39B658" class="sect5"><span class="enumeration_section">2.1.3.1 </span>Stored Procedures
                     </h5>
                     <div>
                        <p>When executing an Oracle <span class="bold">PL/SQL</span> <a href="glossary.html#GUID-758B5AC7-B6B3-4ADC-BE11-F8091219E380"><span class="xrefglossterm">stored procedure</span></a> using a command, use Oracle native syntax or the ODBC procedure call escape sequence in the command text:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p> Oracle native syntax: <code class="codeph">BEGIN credit_account(123, 40); END;</code></p>
                           </li>
                           <li>
                              <p> ODBC syntax: {<code class="codeph">CALL credit_account(123, 40)}</code></p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="OLEDB170"></a><div class="props_rev_3"><a id="GUID-0DF5CEA6-0970-43EF-8E91-1AA0CB945A80" name="GUID-0DF5CEA6-0970-43EF-8E91-1AA0CB945A80"></a><h5 id="OLEDB-GUID-0DF5CEA6-0970-43EF-8E91-1AA0CB945A80" class="sect5"><span class="enumeration_section">2.1.3.2 </span>Preparing Commands
                     </h5>
                     <div>
                        <p>OraOLEDB validates and fetches the metadata only for SELECT SQL statements.</p>
                     </div>
                  </div><a id="OLEDB171"></a><div class="props_rev_3"><a id="GUID-10512555-791C-476C-AF2B-A950EBECBC97" name="GUID-10512555-791C-476C-AF2B-A950EBECBC97"></a><h5 id="OLEDB-GUID-10512555-791C-476C-AF2B-A950EBECBC97" class="sect5"><span class="enumeration_section">2.1.3.3 </span>Command Parameters
                     </h5>
                     <div>
                        <p>When using Oracle ANSI SQL, parameters in the command text are preceded by a colon. In ODBC SQL, parameters are indicated by a question mark (<code class="codeph">?</code>).
                        </p>
                        <p>OraOLEDB supports input, output, and input and output parameters for PL/SQL stored procedures and stored functions. OraOLEDB supports input parameters for SQL statements. </p>
                        <div class="infoboxnote" id="GUID-10512555-791C-476C-AF2B-A950EBECBC97__GUID-FDFE5AD8-AAA2-47C8-90B0-E2D02D30B6A4">
                           <p class="notep1">Note:</p>
                           <p>OraOLEDB supports only positional binding.</p>
                        </div>
                     </div>
                  </div><a id="OLEDB173"></a><a id="OLEDB174"></a><a id="OLEDB175"></a><a id="OLEDB176"></a><a id="OLEDB177"></a><a id="OLEDB178"></a><a id="OLEDB179"></a><a id="OLEDB180"></a><a id="OLEDB181"></a><a id="OLEDB172"></a><div class="props_rev_3"><a id="GUID-70778DCD-8ECA-4AC5-8D31-C9A8B9D54413" name="GUID-70778DCD-8ECA-4AC5-8D31-C9A8B9D54413"></a><h5 id="OLEDB-GUID-70778DCD-8ECA-4AC5-8D31-C9A8B9D54413" class="sect5"><span class="enumeration_section">2.1.3.4 </span>OraOLEDB Custom Properties for Commands
                     </h5>
                     <div>
                        <p>OraOLEDB custom properties for commands are grouped under the custom property set <code class="codeph">ORAPROPSET_COMMANDS</code>. It provides these properties:
                        </p>
                        <div class="tblformal" id="GUID-70778DCD-8ECA-4AC5-8D31-C9A8B9D54413__GUID-49A136CE-14DA-4253-9420-5FE1D553E789">
                           <p class="titleintable">Table 2-1 Custom Properties for Commands</p>
                           <table cellpadding="4" cellspacing="0" class="Formal" title="Custom Properties for Commands" summary="The rows are commands. The first column is the Visual Basic command. The second column is the C++ command." width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="31%" id="d3293e2406">For Visual Basic Users</th>
                                    <th align="left" valign="bottom" width="69%" id="d3293e2409">For C++ Users</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d3293e2414" headers="d3293e2406 ">
                                       <p><code class="codeph">PLSQLRSet</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d3293e2414 d3293e2409 ">
                                       <p><code class="codeph">ORAPROP_PLSQLRSet</code></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d3293e2423" headers="d3293e2406 ">
                                       <p><code class="codeph">NDatatype</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d3293e2423 d3293e2409 ">
                                       <p><code class="codeph">ORAPROP_NDatatype</code></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d3293e2432" headers="d3293e2406 ">
                                       <p><code class="codeph">SPPrmsLOB</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d3293e2432 d3293e2409 ">
                                       <p><code class="codeph">ORAPROP_SPPrmsLOB</code></p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="31%" id="d3293e2441" headers="d3293e2406 ">
                                       <p><code class="codeph">AddToStmtCache</code></p>
                                    </td>
                                    <td align="left" valign="top" width="69%" headers="d3293e2441 d3293e2409 ">
                                       <p><code class="codeph">ORAPROP_AddToStmtCache</code></p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <div class="section">
                           <p class="subhead3">PLSQLRSet</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>This property is similar to the <code class="codeph">PLSQLRSet</code> connection string attribute.
                           </p>
                           <p>The property specifies whether OraOLEDB must return a rowset from the PL/SQL stored procedure. If the stored procedure, provided by the consumer, returns a rowset, <code class="codeph">PLSQLRSet</code> must be set to <code class="codeph">TRUE</code> (enabled). This property should be set to <code class="codeph">FALSE</code> after the command has been run. By default, the property is set to <code class="codeph">FALSE</code> (disabled).
                           </p>
                           <p>Consumers should use the property over the attribute, as the property can be set at the command object rather than at the session. By setting it at the command object, the consumer is able to set the property only for the command object executing stored procedures which are returning rowsets. With the attribute, the consumer needed to set it even if only one of many stored procedures being executed by the ADO application returned a rowset. The use of this property should provide a performance boost to applications making use of the attribute previously.</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3">Example: Setting the Custom Property PLSQLRSet </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section"><pre class="oac_no_warn" dir="ltr">Dim objRes As NEW ADODB.Recordset
Dim objCon As NEW ADODB.Connection
Dim objCmd As NEW ADODB.Command
....
objCmd.ActiveConnection = objCon
objCmd.CommandType = adCmdText

' Enabling the PLSQLRSet property indicates to the provider
' that the command returns one or more rowsets
objCmd.Properties("PLSQLRSet") = TRUE

' Assume Employees.GetEmpRecords() has a REF CURSOR as
' one of the arguments
objCmd.CommandText = "{ CALL Employees.GetEmpRecords(?,?) }"

' Execute the SQL
set objRes = objCmd.Execute

' It is a good idea to disable the property after execute as the
' same command object may be used for a different SQL statement
objCmd.Properties("PLSQLRSet") = FALSE</pre></div>
                        <!-- class="section" -->
                        <div class="section" id="GUID-70778DCD-8ECA-4AC5-8D31-C9A8B9D54413__BABBCDHJ">
                           <p class="subhead3">NDatatype</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>This property allows the consumers to specify whether any of the parameters bound to the command are of Oracle's N data types (<code class="codeph">NCHAR</code>, <code class="codeph">NVARCHAR2,</code> or <code class="codeph">NCLOB</code>). This information is required by OraOLEDB to detect and bind the parameters. This property should not be set for commands executing <code class="codeph">SELECT</code> statements. However, this property must be set for all other SQL statements, such as <code class="codeph">INSERT</code>, <code class="codeph">UPDATE</code>, and <code class="codeph">DELETE</code>. 
                           </p>
                           <p>The use of this property should be limited to SQL statements containing parameters of N data type as setting it incurs a processing overhead of at least one round-trip to the database. By default, this property is set to <code class="codeph">FALSE</code>.
                           </p>
                           <div class="infoboxnote" id="GUID-70778DCD-8ECA-4AC5-8D31-C9A8B9D54413__GUID-7A6740C2-B73D-4424-9543-BA467D4C409F">
                              <p class="notep1">Note:</p>
                              <p>OraOLEDB does not support parameters of N data types in the <code class="codeph">WHERE</code> clause of SQL statements.
                              </p>
                           </div>
                           <div class="infoboxnote" id="GUID-70778DCD-8ECA-4AC5-8D31-C9A8B9D54413__GUID-2B0CA9AB-BB76-4A3F-A957-BCC51E9EADEA">
                              <p class="notep1">Note:</p>
                              <p>Consumers are required to use the ODBC procedure call escape sequence to call <span class="bold">stored procedure</span>s or functions having N data type parameters. 
                              </p>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3">Example: Setting the Custom Property NDatatype </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section"><pre class="oac_no_warn" dir="ltr">Dim objCon As NEW ADODB.Connection
Dim objCmd As NEW ADODB.Command
Dim prEmpno As NEW ADODB.Parameter
Dim prEname As NEW ADODB.Parameter
...
objCmd.ActiveConnection = objCon
objCmd.CommandType = adCmdText

' Create and append the parameters to the command object
Set prEmpno = objCmd.CreateParameter("prEmpno", adSmallInt, adParamInput, ,8521)
' prEname is bound to a NVARCHAR2 column in the EMP table
Set prEname = objCmd.CreateParameter("prEname", adBSTR, adParamInput, , "Joe")
objCmd.Parameters.Append prEmpno
objCmd.Parameters.Append prEname

' Enabling the NDatatype property indicates to the provider
' that one or more of the bound parameters is of N datatype
objCmd.Properties("NDatatype") = TRUE

' Assume column ENAME in table EMP is of NVARCHAR2 type
objCmd.CommandText = "INSERT INTO EMP (EMPNO, ENAME) VALUES (?, ?)"

' Execute the SQL
objCmd.Execute

' It is a good idea to disable the property after execute as the same command
' object may be used for a different SQL statement 
objCmd.Properties("NDatatype") = FALSE</pre></div>
                        <!-- class="section" -->
                        <div class="section" id="GUID-70778DCD-8ECA-4AC5-8D31-C9A8B9D54413__BABCAAIG">
                           <p class="subhead3">SPPrmsLOB</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>This property allows the consumer to specify whether one or more of the parameters bound to the stored procedures are of Oracle's LOB data type (<code class="codeph">CLOB</code>, <code class="codeph">BLOB</code>, or <code class="codeph">NCLOB</code>). OraOLEDB requires this property to be set to <code class="codeph">TRUE</code>, to fetch the parameter list of the stored procedure prior to execution. The use of this property limits the processing overhead to stored procedures having one or more LOB data type parameters. This property should be set to <code class="codeph">FALSE</code> after the command has been executed. By default, the property is set to <code class="codeph">FALSE</code>.
                           </p>
                           <div class="infoboxnote" id="GUID-70778DCD-8ECA-4AC5-8D31-C9A8B9D54413__GUID-8D387A38-D332-4A0E-8AE2-FFC870889C23">
                              <p class="notep1">Note:</p>
                              <p>Consumers are required to use the ODBC procedure call escape sequence to call stored procedures or functions having LOB data type parameters.</p>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3">Example: Setting the Custom Property SPPrmsLOB</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section"><pre class="oac_no_warn" dir="ltr">Dim objCon As NEW ADODB.Connection
Dim objCmd As NEW ADODB.Command
Dim prCLOB As NEW ADODB.Parameter
...
objCmd.ActiveConnection = objCon
objCmd.CommandType = adCmdText

' Create and append the parameters to the command object
Set prCLOB = objCmd.CreateParameter("prCLOB", adLongVarchar, adParamOutput, _
                                                10000)
objCmd.Parameters.Append prCLOB

' Enabling the SPPrmsLOB property indicates to the provider
' that one or more of the bound parameters is of LOB data type
objCmd.Properties("SPPrmsLOB") = TRUE

' Assume the Stored Procedure requires a CLOB parameter
objCmd.CommandText = "{ call storedproc(?) }"

'Execute the SQL
objCmd.Execute

' It is a good idea to disable the property after execute as the
' same command object may be used for a different SQL statement 
objCmd.Properties("SPPrmsLOB") = FALSE</pre></div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3">AddToStmtCache</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>This property allows the consumer to cache the executed statements when the property is set to <code class="codeph">TRUE</code> and statement caching is enabled. If the statement caching is disabled or if this property is set to <code class="codeph">FALSE</code>, then the executed statement is not cached.
                           </p>
                           <p>This property is ignored if statement caching is disabled. Statement caching can be enabled by setting the <code class="codeph">StmtCacheSize</code> connection string attribute to a value greater than zero. This property provides a way to selectively add statements to the cache when statement caching is enabled. By default, the property is set to <code class="codeph">TRUE</code>.
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3">Example: Setting the Custom Property AddToStmtCache</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section"><pre class="oac_no_warn" dir="ltr">Dim objCon As NEW ADODB.Connection
Dim objCmd As NEW ADODB.Command
... 

' Statement caching is enabled by setting the 'StmtCacheSize'
' connection string attribute to a value greater than zero
objCon.ConnectionString = "StmtCacheSize=10;Data Source=MyOraDb;" &amp; _                        "User ID=scott;Password=tiger;"
objCon.Open
objCmd.ActiveConnection = objCon
objCmd.CommandType = adCmdText
objCmd.CommandText = "SELECT * FROM EMP"

' "SELECT * FROM EMP" statement would be added to the statement cache because
' StmtCacheSize connection string attribute value is greater than 0 and 
' AddToStmtCache property value is TRUE by default.
objCmd.Execute

' Do not add "SELECT * FROM DEPT" to the statement cache
objCmd.CommandText = "SELECT * FROM DEPT"
objCmd.Properties("AddToStmtCache") = FALSE

' "SELECT * FROM DEPT" statement would not be added to the statement cache
objCmd.Execute
</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="OLEDB182"></a><div class="props_rev_3"><a id="GUID-76F6BCAA-DC93-4DAA-8EC2-C3AF8B3ED222" name="GUID-76F6BCAA-DC93-4DAA-8EC2-C3AF8B3ED222"></a><h5 id="OLEDB-GUID-76F6BCAA-DC93-4DAA-8EC2-C3AF8B3ED222" class="sect5"><span class="enumeration_section">2.1.3.5 </span>Stored Procedures and Functions Returning Rowsets
                     </h5>
                     <div>
                        <p>Oracle Provider for OLE DB allows consumers to execute a <span class="bold">PL/SQL</span> stored procedure with an argument of <code class="codeph">REF</code> <code class="codeph">CURSOR</code> type or a stored function returning a <code class="codeph">REF</code> <code class="codeph">CURSOR</code> value.
                        </p>
                        <p>OraOLEDB returns a rowset for the <code class="codeph">REF</code> <code class="codeph">CURSOR</code> bind variable. Because there is no predefined data type for <code class="codeph">REF</code> <code class="codeph">CURSOR</code> in the OLE DB specification, the consumer must not bind this parameter.
                        </p>
                        <p>If the PL/SQL stored procedure has one or more arguments of <code class="codeph">REF</code> <code class="codeph">CURSOR</code> type, OraOLEDB binds these arguments and returns a rowset for each argument of <code class="codeph">REF</code> <code class="codeph">CURSOR</code> type. 
                        </p>
                        <p>If the PL/SQL stored function returns a <code class="codeph">REF</code> <code class="codeph">CURSOR</code> or has an argument of <code class="codeph">REF</code> <code class="codeph">CURSOR</code> type, OraOLEDB binds these and returns a rowset for each <code class="codeph">REF</code> <code class="codeph">CURSOR</code> type. 
                        </p>
                        <p>To use this feature, stored procedures or functions must be called in the ODBC procedure call escape sequence. </p>
                        <p>The stored procedure or function being called could be either standalone or packaged. However, the <code class="codeph">REF</code> <code class="codeph">CURSOR</code> being returned must be explicitly defined in a package in the database.
                        </p>
                     </div>
                  </div><a id="OLEDB184"></a><a id="OLEDB185"></a><a id="OLEDB186"></a><a id="OLEDB183"></a><div class="props_rev_3"><a id="GUID-9912A91D-813C-41A3-A1A5-FAF3EF4EECC6" name="GUID-9912A91D-813C-41A3-A1A5-FAF3EF4EECC6"></a><h5 id="OLEDB-GUID-9912A91D-813C-41A3-A1A5-FAF3EF4EECC6" class="sect5"><span class="enumeration_section">2.1.3.6 </span>Multiple Rowsets
                     </h5>
                     <div>
                        <p>OraOLEDB supports returning more than one rowset from a stored procedure. Consumers can use this feature to access all the <code class="codeph">REF</code> <code class="codeph">CURSOR</code>s being returned by a stored procedure.
                        </p>
                        <div class="section">
                           <p class="subhead3">Example: Stored Procedure Returning Multiple Rowsets</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section" id="GUID-9912A91D-813C-41A3-A1A5-FAF3EF4EECC6__I1016901">
                           <p class="subhead3">PL/SQL Package</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section"><pre class="oac_no_warn" dir="ltr">CREATE OR REPLACE PACKAGE Employees AS  
  TYPE empcur IS REF CURSOR; 
 
  PROCEDURE GetEmpRecords(p_cursor OUT empcur,
                          q_cursor OUT empcur,
                          indeptno IN NUMBER,
                          p_errorcode OUT NUMBER);
 
  FUNCTION GetDept(inempno IN NUMBER,  
                   p_errorcode OUT NUMBER)  
    RETURN empcur; 
END Employees; 

CREATE OR REPLACE PACKAGE BODY Employees AS 
 
  PROCEDURE GetEmpRecords(p_cursor OUT empcur, 
                          q_cursor OUT empcur, 
                          indeptno IN NUMBER,  
                          p_errorcode OUT NUMBER) IS  
  BEGIN   
    p_errorcode := 0;  
    OPEN p_cursor FOR  
      SELECT *  
      FROM emp  
      WHERE deptno = indeptno  
      ORDER BY empno;  

OPEN q_cursor FOR  
      SELECT empno 
      FROM emp  
      WHERE deptno = indeptno  
      ORDER BY empno; 
 
  EXCEPTION  
    WHEN OTHERS THEN  
      p_errorcode:= SQLCODE;  
 
  END GetEmpRecords;  
 
  FUNCTION GetDept(inempno IN NUMBER,  
                   p_errorcode OUT NUMBER)  
    RETURN empcur IS  
      p_cursor empcur;  
  BEGIN   
    p_errorcode := 0;  
    OPEN p_cursor FOR  
      SELECT deptno  
      FROM emp  
      WHERE empno = inempno;  
    RETURN (p_cursor);  
 
  EXCEPTION  
    WHEN OTHERS THEN  
      p_errorcode:= SQLCODE; 
 
  END GetDept;   
 
END Employees; </pre></div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3">ADO Program</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section"><pre class="oac_no_warn" dir="ltr">Dim Con   As New ADODB.Connection
Dim Rst1  As New ADODB.Recordset 
Dim Rst2  As New ADODB.Recordset 
Dim Rst3  As New ADODB.Recordset 
Dim Cmd   As New ADODB.Command 
Dim Prm1  As New ADODB.Parameter 
Dim Prm2  As New ADODB.Parameter 

Con.Provider = "OraOLEDB.Oracle"
Con.ConnectionString = "Data Source=MyOraDb;" &amp; _
                       "User ID=scott;Password=tiger;"
Con.Open
Cmd.ActiveConnection = Con

' Although Employees.GetEmpRecords() takes four parameters, only 
' two need to be bound because Ref cursor parameters are automatically 
' bound by the provider. 

Set Prm1 = Cmd.CreateParameter("Prm1", adSmallInt, adParamInput, , 30)
Cmd.Parameters.Append Prm1 
Set Prm2 = Cmd.CreateParameter("Prm2", adSmallInt, adParamOutput) 
Cmd.Parameters.Append Prm2 

' Enable PLSQLRSet property
Cmd.Properties ("PLSQLRSet") = TRUE  

' Stored Procedures returning resultsets must be called using the 
' ODBC escape sequence for calling stored procedures. 
Cmd.CommandText = "{CALL Employees.GetEmpRecords(?, ?)}" 

' Get the first recordset
Set Rst1 = Cmd.Execute 

' Disable PLSQLRSet property
Cmd.Properties("PLSQLRSet") = FALSE 

' Get the second recordset
Set Rst2 = Rst1.NextRecordset

' Just as in a stored procedure, the REF CURSOR return value must  
' not be bound in a stored function. 
Prm1.Value = 7839
Prm2.Value = 0

' Enable PLSQLRSet property
Cmd.Properties("PLSQLRSet") = TRUE 

' Stored Functions returning resultsets must be called using the 
' ODBC escape sequence for calling stored functions. 
Cmd.CommandText = "{CALL Employees.GetDept(?, ?)}" 

' Get the rowset
Set Rst3 = Cmd.Execute   

' Disable PLSQLRSet
Cmd.Properties ("PLSQLRSet") = FALSE

' Clean up
Rst1.Close
Rst2.Close
Rst3.Close</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="OLEDB188"></a><a id="OLEDB189"></a><a id="OLEDB190"></a><a id="OLEDB191"></a><a id="OLEDB187"></a><div class="props_rev_3"><a id="GUID-8E814A7F-F3A6-4161-B0A6-B236E9E62B5F" name="GUID-8E814A7F-F3A6-4161-B0A6-B236E9E62B5F"></a><h5 id="OLEDB-GUID-8E814A7F-F3A6-4161-B0A6-B236E9E62B5F" class="sect5"><span class="enumeration_section">2.1.3.7 </span>Statement Caching
                     </h5>
                     <div>
                        <p>Statement caching eliminates the need to parse each SQL or PL/SQL statement before execution, by caching server cursors created during the initial statement execution. Subsequent executions of the same statement can reuse the parsed information from the cursor, and then execute the statement without reparsing, for better performance.</p>
                        <p>To see performance gains from statement caching, Oracle recommends caching only those statements that will be repeatedly executed. Furthermore, SQL or PL/SQL statements should use parameters rather than literal values. This will enable you to take full advantage of statement caching. This is because parsed information from parameterized statements can be reused, even if the parameter values change in subsequent executions. However, if the literal values in the statements are different, the parsed information cannot be reused unless the subsequent statements also have the same literal values.</p>
                        <div class="section">
                           <p class="subhead3">StmtCacheSize Connection String Attribute</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>This attribute enables or disables OraOLEDB statement caching. By default, this attribute is set to <code class="codeph">0</code> (disbled). If it is set to a value greater than <code class="codeph">0</code>, OraOLEDB statement caching is enabled and the value specifies the maximum number of statements that can be cached for a connection. 
                           </p>
                           <p>After a connection has been cached to the specified maximum cache size, the cursor least recently used is freed to make room to cache the newly-created cursor. This value should not be greater than the value of the <code class="codeph">OPEN_CURSORS</code> parameter set in the <code class="codeph">init.ora</code> database configuration file.
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3">AddToStmtCache Command Property</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>This property is relevant only when statement caching is enabled. If statement caching is enabled and this property is set to <code class="codeph">true</code> (default), then statements are added to the cache when they are executed. If statement caching is disabled or if this property is set to <code class="codeph">false</code>, then the executed statement is not cached.
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3">Enabling Statement Caching Through the Registry</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>To enable statement caching by default for all OraOLEDB applications running in a system without changing the application, set the registry key of <code class="codeph">\\HKEY_LOCAL_ MACHINE\SOFTWARE\ORACLE\</code><code class="codeph">KEY_</code><span class="italic"><code class="codeph">HOMENAME</code></span><code class="codeph">\OLEDB\StmtCacheSize</code> to a value greater than <code class="codeph">0</code>. Here, <span class="italic"><code class="codeph">HOMENAME</code></span> refers to the appropriate Oracle home. This value specifies the number of cursors that are to be cached on the server. By default, it is set to <code class="codeph">10</code>.
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3">Connections and Statement Caching</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>Statement caching is managed separately for each connection. Therefore, for running the same statement on different connections, you need to parse once for each connection and cache a separate cursor for each connection.</p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="OLEDB192"></a><div class="props_rev_3"><a id="GUID-E2D83FFC-5085-4540-BF78-26AFAF377722" name="GUID-E2D83FFC-5085-4540-BF78-26AFAF377722"></a><h5 id="OLEDB-GUID-E2D83FFC-5085-4540-BF78-26AFAF377722" class="sect5"><span class="enumeration_section">2.1.3.8 </span>Metadata Caching
                     </h5>
                     <div>
                        <p>This feature minimizes the retrieval of metadata for <code class="codeph">SELECT</code> statements by caching the metadata during the initial statement execution. Subsequent executions of the same statement can reuse the cached metadata information for better performance. To see performance gains from metadata caching, Oracle recommends caching only those statements that are executed repeatedly.
                        </p>
                        <div class="infoboxnote" id="GUID-E2D83FFC-5085-4540-BF78-26AFAF377722__GUID-7A0C037A-CE53-4BBC-BA82-A1591AA63450">
                           <p class="notep1">Note:</p>
                           <p>Metadata caching is managed separately for each connection. Therefore, to run the same statement on different connections, the metadata must be cached once for each connection. </p>
                        </div>
                     </div><a id="OLEDB193"></a><div class="props_rev_2"><a id="GUID-1621B58C-ABA1-49C0-BC7B-4C91DDAFFCC1" name="GUID-1621B58C-ABA1-49C0-BC7B-4C91DDAFFCC1"></a><h6 id="OLEDB-GUID-1621B58C-ABA1-49C0-BC7B-4C91DDAFFCC1" class="sect6"><span class="enumeration_section">2.1.3.8.1 </span>Enabling Metadata Caching Through the Connection String Attribute
                        </h6>
                        <div>
                           <p>The <code class="codeph">MetaDataCacheSize</code> attribute enables or disables OraOLEDB metadata caching. If it is set to a value greater than <code class="codeph">0</code>, OraOLEDB metadata caching is enabled and the value specifies the maximum number of statements for which the metadata can be cached for a connection. By default, this attribute is set to <code class="codeph">10</code>.
                           </p>
                        </div>
                     </div><a id="OLEDB194"></a><div class="props_rev_3"><a id="GUID-F4588CEB-E346-4031-821F-108CE9EBBADE" name="GUID-F4588CEB-E346-4031-821F-108CE9EBBADE"></a><h6 id="OLEDB-GUID-F4588CEB-E346-4031-821F-108CE9EBBADE" class="sect6"><span class="enumeration_section">2.1.3.8.2 </span>Enabling Metadata Caching Through the Registry
                        </h6>
                        <div>
                           <div class="section">
                              <p>To enable metadata caching by default for all OraOLEDB applications running in a system, without changing the application, set the following registry key to a value greater than <code class="codeph">0</code>. By default, it is set to <code class="codeph">10</code>. 
                              </p>
                              <p><code class="codeph">\\HKEY_LOCAL_MACHINE\SOFTWARE\ORACLE\</code><code class="codeph">KEY_</code><span class="italic"><code class="codeph">HOMENAME</code></span><code class="codeph">\ OLEDB\MetaDataCacheSize</code></p>
                           </div>
                           <!-- class="section" -->
                        </div>
                     </div>
                  </div><a id="OLEDB255"></a><div class="props_rev_3"><a id="GUID-57E27564-BB4C-4101-97B4-48868D54E877" name="GUID-57E27564-BB4C-4101-97B4-48868D54E877"></a><h5 id="OLEDB-GUID-57E27564-BB4C-4101-97B4-48868D54E877" class="sect5"><span class="enumeration_section">2.1.3.9 </span>Command Timeout and Cancel Method
                     </h5>
                     <div>
                        <p>The <code class="codeph">Cancel</code> method cancels the OraOLEDB command currently being executed. This method can be useful when the application needs to cancel a long running command during times of heavy network traffic or heavy server use. 
                        </p>
                        <p>Alternatively, by using the <code class="codeph">CommandTimeout</code> property, developers can set a limit to the time that a command executes before OraOLEDB attempts to cancel it. OraOLEDB requires setting the <code class="codeph">EnableCmdTimeout</code> registry value to <code class="codeph">1</code> to enable <code class="codeph">CommandTimeout</code>. 
                        </p>
                        <p>When using OLE DB, the default <code class="codeph">DPBROP_COMMANDTIMEOUT</code> is <code class="codeph">0</code> seconds. When using ADO, the default <code class="codeph">CommandTimeout</code> property is <code class="codeph">30</code> seconds.
                        </p>
                     </div><a id="OLEDB195"></a><div class="props_rev_3"><a id="GUID-9351C41E-88D2-40A8-A73A-9D1307A79EE0" name="GUID-9351C41E-88D2-40A8-A73A-9D1307A79EE0"></a><h6 id="OLEDB-GUID-9351C41E-88D2-40A8-A73A-9D1307A79EE0" class="sect6"><span class="enumeration_section">2.1.3.9.1 </span>Enabling CommandTimeout Through the Registry 
                        </h6>
                        <div>
                           <div class="section">
                              <p>The installation adds a registry value called <code class="codeph">EnableCmdTimeout</code> with the default value set to <code class="codeph">0</code>. Setting it to <code class="codeph">0</code> disables command timeout and setting it to <code class="codeph">1</code> enables it. The <code class="codeph">CommandTimeout</code> property value setting takes effect only when <code class="codeph">EnableCmdTimeout</code> is set to <code class="codeph">1</code>.
                              </p>
                              <p>The registry value is:</p>
                              <p><code class="codeph">\\HKEY_LOCAL_MACHINE\SOFTWARE\ORACLE\KEY_</code><span class="italic"><code class="codeph">HOMENAME</code></span><code class="codeph">\OLEDB\EnableCmdTimeout</code></p>
                           </div>
                           <!-- class="section" -->
                        </div>
                     </div>
                  </div>
               </div><a id="OLEDB196"></a><div class="props_rev_3"><a id="GUID-D07A3F33-B9ED-4440-8DFD-534C49FF053F" name="GUID-D07A3F33-B9ED-4440-8DFD-534C49FF053F"></a><h4 id="OLEDB-GUID-D07A3F33-B9ED-4440-8DFD-534C49FF053F" class="sect4"><span class="enumeration_section">2.1.4 </span>Rowsets
                  </h4>
                  <div>
                     <p>This section discusses using Rowsets with OraOLEDB.</p>
                  </div><a id="OLEDB198"></a><a id="OLEDB199"></a><a id="OLEDB200"></a><a id="OLEDB197"></a><div class="props_rev_3"><a id="GUID-9213A79D-D032-41F8-BEEE-871D786F1FAD" name="GUID-9213A79D-D032-41F8-BEEE-871D786F1FAD"></a><h5 id="OLEDB-GUID-9213A79D-D032-41F8-BEEE-871D786F1FAD" class="sect5"><span class="enumeration_section">2.1.4.1 </span>To Create Rowsets
                     </h5>
                     <div>
                        <div class="section">
                           <p>OraOLEDB supports <code class="codeph">IOpenRowset::OpenRowset</code> and <code class="codeph">ICommand::Execute</code> for creating rowsets.
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3">To Create Rowsets with IOpenRowset::OpenRowset</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>When using <code class="codeph">IOpenRowset::OpenRowset</code>, note the following guidelines:
                           </p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>The <code class="codeph">pTableID</code> parameter must contain a <code class="codeph">DBID</code> structure that specifies a base table or a view.
                                 </p>
                              </li>
                              <li>
                                 <p>The <code class="codeph">DBID</code> structure's <code class="codeph">eKind</code> member must be set to <code class="codeph">DBKIND_GUID_NAME</code>, <code class="codeph">DBKIND_NAME</code>, or <code class="codeph">DBKIND_PGUID_NAME</code>.
                                 </p>
                              </li>
                              <li>
                                 <p>The <code class="codeph">DBID</code> structure's <code class="codeph">uName</code> member must specify the base table or view name as a Unicode character string. It cannot be <code class="codeph">NULL</code>.
                                 </p>
                              </li>
                              <li>
                                 <p>The <code class="codeph">pIndexID</code> parameter of <code class="codeph">OpenRowset</code> must be <code class="codeph">NULL</code>.
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3">To Create Rowsets with ICommand::Execute</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>OraOLEDB supports SQL <code class="codeph">SELECT</code> statements that return rowsets. OraOLEDB also supports returning rowsets from PL/SQL stored procedures and functions.
                           </p>
                           <p>By default, ADO creates a nonupdatable rowset from a command object. An updatable rowset can be created by setting the <code class="codeph">Updatability</code> and <code class="codeph">IRowsetChange</code> properties on the command object. The <code class="codeph">Updatability</code> property can be set to the following values:
                           </p>
                           <div class="tblformal" id="GUID-9213A79D-D032-41F8-BEEE-871D786F1FAD__GUID-72077F8C-7537-4CD3-88D3-302F542CC373">
                              <p class="titleintable">Table 2-2 Possible Values for Updatability Property</p>
                              <table cellpadding="4" cellspacing="0" class="Formal" title="Possible Values for Updatability Property" summary="The rows are values that the Updatability property can be set to. The first column is the value. The second column is a description." width="100%" frame="hsides" border="1" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" width="31%" id="d3293e3560">Value</th>
                                       <th align="left" valign="bottom" width="69%" id="d3293e3563">Description</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d3293e3568" headers="d3293e3560 ">
                                          <p><code class="codeph">1</code></p>
                                       </td>
                                       <td align="left" valign="top" width="69%" headers="d3293e3568 d3293e3563 ">
                                          <p>update</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d3293e3576" headers="d3293e3560 ">
                                          <p><code class="codeph">2</code></p>
                                       </td>
                                       <td align="left" valign="top" width="69%" headers="d3293e3576 d3293e3563 ">
                                          <p>delete</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d3293e3584" headers="d3293e3560 ">
                                          <p><code class="codeph">3</code></p>
                                       </td>
                                       <td align="left" valign="top" width="69%" headers="d3293e3584 d3293e3563 ">
                                          <p>update and delete</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d3293e3592" headers="d3293e3560 ">
                                          <p><code class="codeph">4</code></p>
                                       </td>
                                       <td align="left" valign="top" width="69%" headers="d3293e3592 d3293e3563 ">
                                          <p>insert</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d3293e3600" headers="d3293e3560 ">
                                          <p><code class="codeph">5</code></p>
                                       </td>
                                       <td align="left" valign="top" width="69%" headers="d3293e3600 d3293e3563 ">
                                          <p>insert and update</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d3293e3608" headers="d3293e3560 ">
                                          <p><code class="codeph">6</code></p>
                                       </td>
                                       <td align="left" valign="top" width="69%" headers="d3293e3608 d3293e3563 ">
                                          <p>insert and delete</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="31%" id="d3293e3616" headers="d3293e3560 ">
                                          <p><code class="codeph">7</code></p>
                                       </td>
                                       <td align="left" valign="top" width="69%" headers="d3293e3616 d3293e3563 ">
                                          <p>insert, delete, and update</p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                           <p>The following ADO code sample sets the <code class="codeph">Updatability</code> property on a command object to allow insert, delete, and update operations on the rowset object.
                           </p><pre class="oac_no_warn" dir="ltr">Dim Cmd As New ADODB.Command
Dim Rst As New ADODB.Recordset
Dim Con As New ADODB.Connection
...
Cmd.ActiveConnection = Con
Cmd.CommandText = "SELECT * FROM emp"
Cmd.CommandType = adCmdText
cmd.Properties("IRowsetChange") = TRUE
Cmd.Properties("Updatability") = 7
' creates an updatable rowset
Set Rst = cmd.Execute</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="OLEDB201"></a><div class="props_rev_3"><a id="GUID-C5F87C59-906C-4C1D-BB0E-D243CFB52F7D" name="GUID-C5F87C59-906C-4C1D-BB0E-D243CFB52F7D"></a><h5 id="OLEDB-GUID-C5F87C59-906C-4C1D-BB0E-D243CFB52F7D" class="sect5"><span class="enumeration_section">2.1.4.2 </span>Updatability
                     </h5>
                     <div>
                        <p>OraOLEDB supports both immediate and deferred update mode. However, insert and update operations cannot be deferred when the operation changes a nonscalar column, such as <code class="codeph">LONG</code>, <code class="codeph">BLOB</code>, or <code class="codeph">CLOB</code>. When nonscalar column values are changed in a deferred update mode, the entire row is transmitted to the database as though the operation was in an immediate update mode. In addition, these operations cannot be undone with the <code class="codeph">Undo</code> method (ADO) or <code class="codeph">IRowsetUpdate::Undo()</code>. However, if they are in a transaction, they can be rolled back with <code class="codeph">RollbackTrans</code> method (ADO) or <code class="codeph">ITransactionLocal::Abort()</code>.
                        </p>
                        <p>Rowsets created using queries with joins are updatable by OraOLEDB only with the Client Cursor Engine enabled. C/C++ OLE DB consumers must enable this service to make these rowsets updatable. ADO consumers must specify the <code class="codeph">CursorLocation</code> as <code class="codeph">adUseClient</code> to make these rowsets updatable.
                        </p>
                        <p>For example:</p><pre class="oac_no_warn" dir="ltr">Dim objCon As New ADODB.Connection
Dim objRst As New ADODB.Recordset

objCon.Provider = "OraOLEDB.Oracle"
objCon.Open "MyOraDb", "scott", "tiger"
objRst.CursorLocation = adUseClient       'ADO Client Cursor
objRst.Open "select ename, dname " &amp; _
       "from emp, dept " &amp; _
       "where emp.deptno = dept.deptno", _
       objCon, adOpenStatic, adLockOptimistic, adCmdText


'Recordset created is updatable. Please note that CursorLocation 
'needs to be explicitly set to adUseClient for this join recordset
'to be updatable.</pre></div>
                  </div><a id="OLEDB202"></a><div class="props_rev_3"><a id="GUID-D678ACF6-D0E3-4F10-8194-57430658621E" name="GUID-D678ACF6-D0E3-4F10-8194-57430658621E"></a><h5 id="OLEDB-GUID-D678ACF6-D0E3-4F10-8194-57430658621E" class="sect5"><span class="enumeration_section">2.1.4.3 </span>Server Data on Insert Property
                     </h5>
                     <div>
                        <p>If <code class="codeph">DBPROP_SERVERDATAONINSERT</code> (Server Data on Insert) is set to <code class="codeph">TRUE</code> using OraOLEDB, the consumer can obtain defaults, sequences, and triggered column values from newly inserted and updated rows, if the insert and update operations are made through the rowset.
                        </p>
                        <p>Having <code class="codeph">DBPROP_SERVERDATAONINSERT</code> set to <code class="codeph">TRUE</code> may degrade performance for both insert and update executions using a rowset because OraOLEDB fetches row data from the database for the newly inserted and updated row. However, if <code class="codeph">DBPROP_SERVERDATAONINSERT</code> is set to its default value of <code class="codeph">FALSE</code>, only the explicitly provided values for insert and update operations are returned when column values are requested for those rows.
                        </p>
                        <p>If the base table from which the rowset was created does not contain any defaults, sequences, or triggers, then it is highly recommended that <code class="codeph">DBPROP_SERVERDATAONINSERT</code> retain its default value of <code class="codeph">FALSE</code>.
                        </p>
                        <p>The <code class="codeph">DBPROP_SERVERDATAONINSERT</code> property does not affect the performance of insert and update operations using the command object.
                        </p>
                     </div>
                  </div><a id="OLEDB203"></a><div class="props_rev_3"><a id="GUID-DA1B6D2A-AD57-4E9A-B655-12ABBF179BDF" name="GUID-DA1B6D2A-AD57-4E9A-B655-12ABBF179BDF"></a><h5 id="OLEDB-GUID-DA1B6D2A-AD57-4E9A-B655-12ABBF179BDF" class="sect5"><span class="enumeration_section">2.1.4.4 </span>To Search for Rows with IRowsetFind::FindNext
                     </h5>
                     <div>
                        <p>OraOLEDB only supports searches performed on <code class="codeph">CHAR</code>, <code class="codeph">DATE</code>, <code class="codeph">FLOAT</code>, <code class="codeph">NUMBER</code>, <code class="codeph">RAW</code>, and <code class="codeph">VARCHAR2</code> columns. Otherwise, <code class="codeph">DB_E_NOTSUPPORTED</code> is returned.
                        </p>
                        <p>When a search is done with a <code class="codeph">NULL</code> value, only the <code class="codeph">DBCOMPAREOPS_EQ</code> and <code class="codeph">DBCOMPAREOPS_NE</code> compare operations are supported. Otherwise, <code class="codeph">DB_E_NOTSUPPORTED</code> is returned.
                        </p>
                     </div>
                  </div><a id="OLEDB204"></a><div class="props_rev_3"><a id="GUID-678B22C8-BE4A-4B50-997B-F916C6FA0F51" name="GUID-678B22C8-BE4A-4B50-997B-F916C6FA0F51"></a><h5 id="OLEDB-GUID-678B22C8-BE4A-4B50-997B-F916C6FA0F51" class="sect5"><span class="enumeration_section">2.1.4.5 </span>OraOLEDB-Specific Connection String Attributes for Rowsets
                     </h5>
                     <div>
                        <p>OraOLEDB-specific connection string attributes which affect the performance of the rowset are:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">CacheType</code> - specifies the type of caching used by the provider to store rowset data. OraOLEDB provides two caching mechanisms:
                              </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>Memory - The provider stores all the rowset data in-memory. This caching mechanism provides better performance at the expense of higher memory utilization. The default is Memory.</p>
                                 </li>
                                 <li>
                                    <p>File - The provider stores all the rowset data on disk. This caching mechanism limits memory consumption at the expense of performance.</p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p><code class="codeph">ChunkSize</code> - This attribute specifies the size, in bytes, of the data in <code class="codeph">LONG</code> and <code class="codeph">LONG RAW</code> columns fetched and stored in the provider cache. Providing a high value for this attribute improves performance, but requires more memory to store the data in the rowset. Valid values are <code class="codeph">1</code> to <code class="codeph">65535</code>. The default is <code class="codeph">100</code>.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">FetchSize</code> - specifies the number of rows the provider will fetch at a time (fetch array). It must be set on the basis of data size and the response time of the network. If the value is set too high, then this could result in more wait time during the execution of the query. If the value is set too low, then this could result in many more round trips to the database. Valid values are <code class="codeph">1</code> to <code class="codeph">429</code>,<code class="codeph">496</code><code class="codeph">,</code> and <code class="codeph">296</code><code class="codeph">.</code> The default is <code class="codeph">100</code>. 
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">DeferUpdChk</code><a id="d3293e4032" class="indexterm-anchor"></a> - The <code class="codeph">DeferUpdChk</code> attribute specifies whether or not to defer the updateability check. This supports updating ADO read-only disconnected rowsets. Valid values are <code class="codeph">0</code> (<code class="codeph">FALSE</code>) and <code class="codeph">1</code> (<code class="codeph">TRUE</code>). The default is <code class="codeph">FALSE</code>, which implies that OraOLEDB does not defer the check. If this attribute is not provided at the connection time, then the default registry value is used.
                              </p>
                           </li>
                        </ul>
                        <p>The default attribute values are set in the registry. The following ADO code example overrides the default attribute values:</p><pre class="oac_no_warn" dir="ltr">Dim con As ADODB.Connection
Set con = NEW ADODB.Connection
con.ConnectionString = "Provider=OraOLEDB.Oracle;User ID=scott;" &amp; _
                          "Password=tiger;Data Source=MyOraDB;" &amp; _
                          "FetchSize=200;CacheType=File;"
con.Open</pre><div class="infoboxnotealso" id="GUID-678B22C8-BE4A-4B50-997B-F916C6FA0F51__GUID-9A04E6BA-7313-45F6-967B-5D2DB15C9748">
                           <p class="notep1">See Also:</p>
                           <p><a href="features-of-oledb.html#GUID-57E98379-51C8-4039-8809-897531FA38C3">Default Attribute Values</a> for more information about default attribute values.
                           </p>
                        </div>
                     </div>
                  </div><a id="OLEDB205"></a><div class="props_rev_3"><a id="GUID-B06907A0-3B1F-47DF-9C54-F5EB35EAB329" name="GUID-B06907A0-3B1F-47DF-9C54-F5EB35EAB329"></a><h5 id="OLEDB-GUID-B06907A0-3B1F-47DF-9C54-F5EB35EAB329" class="sect5"><span class="enumeration_section">2.1.4.6 </span>Tips for ADO Programmers
                     </h5>
                     <div>
                        <p>Setting the ADO Rowset property <code class="codeph">LockType</code> to <code class="codeph">adLockPessimistic</code> is not supported by Oracle Provider for OLE DB. If <code class="codeph">LockType</code> is set to <code class="codeph">adLockPessimistic</code>, then OraOLEDB behaves similar to when set as <code class="codeph">adLockOptimistic</code>. This behavior occurs because OraOLEDB does not perform explicit locks on the rows being modified. However, when new data is submitted to the database, the database only performs the update if the rowset data was not already updated by another user, which means that dirty writes are not allowed. <code class="codeph">LockType</code> values <code class="codeph">adLockReadOnly</code>, <code class="codeph">adLockBatchOptimistic</code>, and <code class="codeph">adLockOptimistic</code> are supported by OraOLEDB. 
                        </p>
                        <p>Setting ADO Rowset property <code class="codeph">CursorType</code> to <code class="codeph">adOpenKeyset</code> or <code class="codeph">adOpenDynamic</code> is not supported by Oracle Provider for OLE DB. OraOLEDB does not support either of the two as Oracle supports <span class="italic">Statement Level Read Consistency</span>, which ensures that the data returned by a query contains only committed data as of the time the query was executed. <code class="codeph">CursorType</code> values <code class="codeph">adOpenStatic</code> and <code class="codeph">adOpenForwardOnly</code> are supported by OraOLEDB. 
                        </p>
                     </div>
                  </div><a id="OLEDB206"></a><div class="props_rev_3"><a id="GUID-8D0204A6-9A20-4CA3-AB6D-A39EBB05F71D" name="GUID-8D0204A6-9A20-4CA3-AB6D-A39EBB05F71D"></a><h5 id="OLEDB-GUID-8D0204A6-9A20-4CA3-AB6D-A39EBB05F71D" class="sect5"><span class="enumeration_section">2.1.4.7 </span>Schema Rowsets
                     </h5>
                     <div>
                        <p>The schema rowsets available through Oracle Provider for OLE DB are: </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">DBSCHEMA_COLUMNS</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">DBSCHEMA_INDEXES</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">DBSCHEMA_SCHEMATA</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">DBSCHEMA_VIEWS</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">DBSCHEMA_TABLES</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">DBSCHEMA_PROVIDER_TYPES</code> (forward scroll only)
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">DBSCHEMA_FOREIGN_KEYS</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">DBSCHEMA_PRIMARY_KEYS</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">DBSCHEMA_PROCEDURES</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">DBSCHEMA_PROCEDURE_PARAMETERS</code></p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="OLEDB207"></a><div class="props_rev_3"><a id="GUID-85181459-F6FD-427C-AFBF-CBAD4E89DDE6" name="GUID-85181459-F6FD-427C-AFBF-CBAD4E89DDE6"></a><h5 id="OLEDB-GUID-85181459-F6FD-427C-AFBF-CBAD4E89DDE6" class="sect5"><span class="enumeration_section">2.1.4.8 </span>Date Formats
                     </h5>
                     <div>
                        <p>The date format for the Oracle session cannot be set using the <code class="codeph">ALTER SESSION SET NLS_DATE_FORMAT</code> command. In Visual Basic, date formats are controlled by the Regional Settings properties in Windows Control Panel. For more information on Visual Basic date formats, refer to your Visual Basic documentation.
                        </p>
                        <p>For Oracle Provider for OLE DB, if the <code class="codeph">Connection</code> property <code class="codeph">UseSessionFormat</code> is <code class="codeph">FALSE</code>, which is a default value, then <code class="codeph">NLS_DATE_FORMAT</code> is fixed for the session to <code class="codeph">'YYYY-MM-DD HH24:MI:SS'</code> by the provider. If you pass the date to Oracle Database as a string, the date must be in the <code class="codeph">'YYYY-MM-DD HH24:MI:SS'</code> format. If <code class="codeph">UseSessionFormat</code> is <code class="codeph">TRUE</code>, then <code class="codeph">NLS_DATE_FORMAT</code> is not fixed by Oracle Provider for OLE DB and the default session <code class="codeph">NLS_DATE_FORMAT</code> is used. For example:
                        </p><pre class="oac_no_warn" dir="ltr">SELECT * FROM EMP WHERE HIREDATE &gt; '1981-06-15 17:32:12'
</pre><p>To use a different format, you need to use the SQL function, <code class="codeph">TO_DATE()</code>, to specify the format for dates passed as strings. For example:
                        </p><pre class="oac_no_warn" dir="ltr">SELECT * FROM EMP WHERE HIREDATE &gt; TO_DATE('15-JUN-81', 'DD-MON-YY')
</pre><p>However, for dates passed as parameters, the date format is controlled by ADO, which is controlled by the Regional Settings in Windows Control Panel. In this case, <code class="codeph">TO_DATE()</code> should not be used. For example:
                        </p><pre class="oac_no_warn" dir="ltr">Private Sub Command1_Click()
  Dim objCon As New ADODB.Connection
  Dim objCmd As New ADODB.Command
  Dim objRst  As New ADODB.Recordset
  Dim pDate As New ADODB.Parameter

  objCon.Provider = "OraOLEDB.Oracle"
  objCon.Open "MyOraDb", "scott", "tiger"
  Set pDate = objCmd.CreateParameter("pDate", adDate, adParamInput)
  objCmd.Parameters.Append pDate
  objCmd.CommandText = _
         "SELECT * FROM EMP WHERE HIREDATE &gt; ?"
  objCmd.ActiveConnection = objCon
  objCmd.CommandType = adCmdText
  pDate.Value = "06/15/1981"
  Set objRst = objCmd.Execute

    ...
End Sub</pre></div>
                  </div><a id="OLEDB208"></a><div class="props_rev_3"><a id="GUID-18465EB9-934F-4ECC-9457-A6590146626F" name="GUID-18465EB9-934F-4ECC-9457-A6590146626F"></a><h5 id="OLEDB-GUID-18465EB9-934F-4ECC-9457-A6590146626F" class="sect5"><span class="enumeration_section">2.1.4.9 </span>Case of Object Names
                     </h5>
                     <div>
                        <p>The names of all objects (tables, columns, views, and so forth) in Oracle Database are case-sensitive. This allows the two objects <code class="codeph">EMP</code> and <code class="codeph">emp</code> to exist in the same namespace in the database.
                        </p>
                        <p>The query, <code class="codeph">SELECT ename FROM emp</code>, executes correctly even though the table name is <code class="codeph">EMP</code> (all uppercase) in the database. However, if you want to specify object names in mixed case, you can do so by enclosing the name in double quotes. For example:
                        </p><pre class="oac_no_warn" dir="ltr">SELECT ename FROM "Emp"
</pre><p>will execute successfully if the table name in the database is <code class="codeph">Emp</code>. Double quotes preserve the case of the object names in Oracle Database.
                        </p>
                     </div>
                  </div><a id="OLEDB266"></a><div class="props_rev_3"><a id="GUID-3570448B-12CF-470C-8E97-890244F251A0" name="GUID-3570448B-12CF-470C-8E97-890244F251A0"></a><h5 id="OLEDB-GUID-3570448B-12CF-470C-8E97-890244F251A0" class="sect5"><span class="enumeration_section">2.1.4.10 </span>Performing a Fast Load with SQL Server Integration Services
                     </h5>
                     <div>
                        <div class="section">
                           <p>OraOLEDB implements the <code class="codeph">IRowsetFastLoad</code> interface when opening a rowset. When used with SQL Server Integration Services (SSIS), this allows an application to perform a fast-load to an OLE DB Destination using Oracle Provider for OLE DB. This can dramatically speed up load times versus using a conventional load. In order to perform a fast-load, set the <code class="codeph">AccessMode</code> property on the OLE DB Destination to <code class="codeph">"</code><code class="codeph">OpenRowset</code> <code class="codeph">Using</code> <code class="codeph">FastLoad</code><code class="codeph">"</code>.
                           </p>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="OLEDB127"></a><div class="props_rev_3"><a id="GUID-D78F518D-6DC3-4FAF-8320-571AEDC3B734" name="GUID-D78F518D-6DC3-4FAF-8320-571AEDC3B734"></a><h4 id="OLEDB-GUID-D78F518D-6DC3-4FAF-8320-571AEDC3B734" class="sect4"><span class="enumeration_section">2.1.5 </span>Data Types
                  </h4>
                  <div>
                     <p>The data types that OraOLEDB supports are listed in <a href="provider-specific-info.html#GUID-3860A62F-B4C5-45FB-A4CB-F70FCFDCCE80__BABFJAAH" title="The rows are Oracle data types. The first column is he Oracle data type name. The second column lists OLE DB data types in regular non-unicode mode. The third column lists OLE DB data types in Unicode mode.">Table A-1</a> with Unicode and NonUnicode mappings.
                     </p>
                     <div class="infoboxnotealso" id="GUID-D78F518D-6DC3-4FAF-8320-571AEDC3B734__GUID-0D194EFF-DC2B-46B5-B298-39F3291530DF">
                        <p class="notep1">See Also:</p>
                        <p>For details about these and other data types, and time zones, see <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/oledb&amp;id=SQLRF002" target="_blank"><span class="italic">Oracle Database SQL Language Reference</span></a></p>
                     </div>
                  </div><a id="OLEDB128"></a><div class="props_rev_3"><a id="GUID-368BB4B6-1971-48A6-8728-D29617A32470" name="GUID-368BB4B6-1971-48A6-8728-D29617A32470"></a><h5 id="OLEDB-GUID-368BB4B6-1971-48A6-8728-D29617A32470" class="sect5"><span class="enumeration_section">2.1.5.1 </span>Binary Data Types
                     </h5>
                     <div>
                        <p><code class="codeph">BINARY_FLOAT</code> is a single-precision floating point data type (4 bytes), which is mapped to OLE DB <code class="codeph">DBTYPE_R4</code>.
                        </p>
                        <p><code class="codeph">BINARY_DOUBLE</code> is a double-precision floating point data type (8 bytes), which is mapped to OLE DB <code class="codeph">DBTYPE_R8</code>.
                        </p>
                     </div>
                  </div><a id="OLEDB130"></a><a id="OLEDB131"></a><a id="OLEDB132"></a><a id="OLEDB133"></a><a id="OLEDB134"></a><a id="OLEDB135"></a><a id="OLEDB136"></a><a id="OLEDB137"></a><a id="OLEDB262"></a><a id="OLEDB129"></a><div class="props_rev_3"><a id="GUID-919CE94B-D272-43E5-8C78-82409D2B0D04" name="GUID-919CE94B-D272-43E5-8C78-82409D2B0D04"></a><h5 id="OLEDB-GUID-919CE94B-D272-43E5-8C78-82409D2B0D04" class="sect5"><span class="enumeration_section">2.1.5.2 </span>TIMESTAMP Data Types
                     </h5>
                     <div>
                        <p>This section discusses the Timestamp data types and then provides the following:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Sample data illustrating insertion and retrieval operations using each of the <code class="codeph">Timestamp</code> data types.
                              </p>
                           </li>
                           <li>
                              <p>A Visual Basic code example using the <code class="codeph">Timestamp</code> data types.
                              </p>
                           </li>
                        </ul>
                        <p>Timestamp data types are mapped to the OLE DB <code class="codeph">DBTYPE_DBTIMESTAMP</code>. The OLE DB <code class="codeph">DBTYPE_DBTIMESTAMP</code> data type does not have <code class="codeph">TIME</code> <code class="codeph">ZONE</code> information.
                        </p>
                        <p>The Timestamp data types include:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">TIMESTAMP</code> 
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">TIMESTAMP</code> <code class="codeph">WITH</code> <code class="codeph">TIME</code> <code class="codeph">ZONE</code> 
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">TIMESTAMP</code> <code class="codeph">WITH</code> <code class="codeph">LOCAL</code> <code class="codeph">TIME</code> <code class="codeph">ZONE</code> 
                              </p>
                           </li>
                        </ul>
                        <div class="section" id="GUID-919CE94B-D272-43E5-8C78-82409D2B0D04__CHDDDBHI">
                           <p class="subhead3">Data Insertion</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>For data insertion into a <code class="codeph">TIMESTAMP</code> <code class="codeph">WITH</code> <code class="codeph">TIME</code> <code class="codeph">ZONE</code> or <code class="codeph">TIMESTAMP</code> <code class="codeph">WITH</code> <code class="codeph">LOCAL</code> <code class="codeph">TIME</code> <code class="codeph">ZONE</code> column, the time zone setting of the client is used. 
                           </p>
                           <p>OLE DB Timestamp data type cannot provide the time zone information. For insert operations, the default time zone from the client session is added to the <code class="codeph">TIMESTAMP</code> <code class="codeph">WITH</code> <code class="codeph">TIME</code> <code class="codeph">ZONE</code> column data. 
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section" id="GUID-919CE94B-D272-43E5-8C78-82409D2B0D04__CHDICHCD">
                           <p class="subhead3">Data Retrieval</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>For data retrieval, <code class="codeph">TIME</code> <code class="codeph">ZONE</code> is dropped for <code class="codeph">TIMESTAMP</code> <code class="codeph">WITH</code> <code class="codeph">TIME</code> <code class="codeph">ZONE</code> columns, but <code class="codeph">TIME</code> <code class="codeph">ZONE</code> is used for <code class="codeph">TIMESTAMP</code> <code class="codeph">WITH</code> <code class="codeph">LOCAL</code> <code class="codeph">TIME</code> <code class="codeph">ZONE</code> columns.
                           </p>
                           <p>The OLE DB <code class="codeph">Timestamp</code> data type cannot store time zone information.
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3">Fractional Second</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>Fractional second is not supported for <code class="codeph">TIMESTAMP</code> data types binding with <code class="codeph">Command</code> objects.
                           </p>
                           <p>Note that using <code class="codeph">ALTER</code> <code class="codeph">SESSION</code> to change time zone information does not change the time zone information in the new and existing <code class="codeph">Recordset</code>s, which use the client time zone setting from the Regional options of the operating system. The maximum <code class="codeph">fractional_seconds_precision</code> of <code class="codeph">TIMESTAMP</code> is <code class="codeph">9</code> and the default precision is <code class="codeph">6</code>.
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3">ADO Consumers</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>For the Timestamp data types, ADO consumers must specify the value of <code class="codeph">CursorLocation</code> as <code class="codeph">adUseServer</code> and use <code class="codeph">Recordset</code> for DML operations.
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3">Examples of Timestamp Insert and Retrieval </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>The following scenarios assume that the default precision of <code class="codeph">6</code> is used.
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3">TIMESTAMP Column</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>Insert Data: 4/16/2003 11:19:19 AM             (No time zone) </p>
                           <p>Data in DB: 4/16/2003 11.19.19.000000 AM </p>
                           <p>Data Retrieval: 4/16/2003 11:19:19 AM </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3">TIMESTAMP WITH TIME ZONE Column</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>Insert Data: 4/16/2003 11:19:19 AM     (Time zone of the Client session is used)</p>
                           <p>Data in DB: 4/16/2003 11.19.19.000000 AM -07:00 </p>
                           <p>Data Retrieval: 4/16/2003 11:19:19 AM      (Time zone is dropped)</p>
                           <div class="infoboxnotealso" id="GUID-919CE94B-D272-43E5-8C78-82409D2B0D04__GUID-FC0956C7-596B-47BD-ADF7-4CB19358C189">
                              <p class="notep1">See Also:</p>
                              <p></p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><span class="q">"<a href="features-of-oledb.html#GUID-919CE94B-D272-43E5-8C78-82409D2B0D04__CHDDDBHI">Data Insertion</a>"</span> 
                                    </p>
                                 </li>
                                 <li>
                                    <p><span class="q">"<a href="features-of-oledb.html#GUID-919CE94B-D272-43E5-8C78-82409D2B0D04__CHDICHCD">Data Retrieval</a>"</span> 
                                    </p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3">TIMESTAMP WITH LOCAL TIME ZONE Column</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>The following scenario assumes that the time zone of the client session is <code class="codeph">-04:00</code>, currently on US EDT (Eastern daylight time). For an insert operation, the data in the <code class="codeph">TIMESTAMP</code> <code class="codeph">WITH</code> <code class="codeph">LOCAL</code> <code class="codeph">TIME</code> <code class="codeph">ZONE</code> column does not include time zone displacement, but its <code class="codeph">TIMESTAMP</code> data is <span class="italic">normalized</span> to the database time zone <code class="codeph">-07:00</code>, which is the same as US PDT (Pacific daylight time). 
                           </p>
                           <p>For a query, data is returned in the time zone of the client session. The time zone     displacement is the difference (in hours and minutes) between the local time and the Coordinated Universal Time (UTC). </p>
                           <p>Insert Data: 4/16/2003 4:30:23 PM                     (Client time zone is -04:00)</p>
                           <p>Data in DB: 4/16/2003 01.30.23.000000 PM      (Database time zone -07:00)</p>
                           <p>Data Retrieval: 4/16/2003 4:30:23 PM              (Client time zone is -04:00)</p>
                           <p>Data Retrieval: 4/16/2003 3:30:23 PM              (Client time zone is -05:00)</p>
                           <p>Data Retrieval: 4/16/2003 2:30:23 PM              (Client time zone is -06:00) </p>
                           <p>Data Retrieval: 4/16/2003 1:30:23 PM              (Client time zone is -07:00) </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3">Visual Basic Example</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section"><pre class="oac_no_warn" dir="ltr">...
Dim DT As Date 
 DT = Now() 
con.ConnectionString = "Provider=OraOLEDB.Oracle.1;User ID=user_name;" &amp; _
    "Password=pwd;Data Source=Oracle;" 
con.Open 
'Must use adUseServer 
rec.CursorLocation = adUseServer 
rec.ActiveConnection = con 
rec.Open "select timestamp_column from test_table", con, adOpenDynamic,_
    adLockOptimistic 
rec.AddNew Array("timestamp_column"), Array(DT) 
 
update data 
rec.Update Array("timestamp_column"), Array("07/07/07 07:17:17 AM") 
...</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="OLEDB141"></a><a id="OLEDB142"></a><a id="OLEDB143"></a><a id="OLEDB140"></a><div class="props_rev_3"><a id="GUID-B2CD7A8C-6C7F-4B04-A275-977A9235A9CE" name="GUID-B2CD7A8C-6C7F-4B04-A275-977A9235A9CE"></a><h5 id="OLEDB-GUID-B2CD7A8C-6C7F-4B04-A275-977A9235A9CE" class="sect5"><span class="enumeration_section">2.1.5.3 </span>INTERVAL Data Types
                     </h5>
                     <div>
                        <p>The INTERVAL data types are mapped to OLE DB <code class="codeph">DBTYPE_STR</code> data type. The INTERVAL data types include:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">INTERVAL</code> <code class="codeph">YEAR</code> <code class="codeph">TO</code> <code class="codeph">MONTH</code> 
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">INTERVAL</code> <code class="codeph">DAY</code> <code class="codeph">TO</code> <code class="codeph">SECOND</code> 
                              </p>
                           </li>
                        </ul>
                        <p>For the <code class="codeph">INTERVAL</code> <code class="codeph">YEAR</code> <code class="codeph">TO</code> <code class="codeph">MONTH</code> column, the maximum <code class="codeph">year_precision</code> is <code class="codeph">9</code> and the default is <code class="codeph">2</code>. For <code class="codeph">INTERVAL</code> <code class="codeph">DAY</code> <code class="codeph">TO</code> <code class="codeph">SECOND</code> column, the maximum <code class="codeph">day_precision</code> is <code class="codeph">9</code> and the default is <code class="codeph">2</code> and the maximum <code class="codeph">fractional_seconds_precision</code> is <code class="codeph">9</code>, the default is <code class="codeph">6</code>. 
                        </p>
                        <div class="infoboxnote" id="GUID-B2CD7A8C-6C7F-4B04-A275-977A9235A9CE__GUID-4B15CB28-F44F-49EE-81B7-6F3B6574E2BE">
                           <p class="notep1">Note:</p>
                           <p>If the sign is not specified, then the default is <span class="bold">+</span>.
                           </p>
                        </div>
                        <div class="section">
                           <p class="subhead3">INTERVAL YEAR TO MONTH </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>Usage: (sign) <code class="codeph">years-months</code></p>
                           <p>Examples: </p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><code class="codeph">2-3</code></p>
                                 <p>2 years and 3 months</p>
                              </li>
                              <li>
                                 <p><code class="codeph">+2-3</code></p>
                                 <p>2 years and 3 months</p>
                              </li>
                              <li>
                                 <p><code class="codeph">-2-3</code></p>
                                 <p>negative 2 years and 3 months </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3">INTERVAL DAY TO SECOND</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p>Usage: (sign) <code class="codeph">days hours:minutes:seconds.second_fraction</code></p>
                           <p>Examples:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><code class="codeph">7</code> <code class="codeph">10:20:30.123456</code></p>
                                 <p>7 days, 10 hours, 20 minutes, and 30.123456 seconds</p>
                              </li>
                              <li>
                                 <p><code class="codeph">+7</code> <code class="codeph">10:20:30.123456</code></p>
                                 <p>7 days, 10 hours, 20 minutes, and 30.123456 seconds</p>
                              </li>
                              <li>
                                 <p><code class="codeph">-7</code> <code class="codeph">10:20:30.123456</code></p>
                                 <p>negative 7 days, 10 hours, 20 minutes, and 30.123456 seconds</p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <p class="subhead3">Visual Basic Example</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section"><pre class="oac_no_warn" dir="ltr">...
con.ConnectionString = "Provider=OraOLEDB.Oracle.1;User ID=user_name;"&amp; _
     "Password=pwd;Data Source=Oracle;" 
con.Open 
'no restriction on using adUseServer or adUseClient 
rec.CursorLocation = adUseServer 
rec.ActiveConnection = con 
rec.Open "select * from test_table2", con, adOpenDynamic, adLockOptimistic 
rec.AddNew Array("year_to_month_column", "day_to_second_column"), _
    Array("8-1", "3 20:30:10.12")   
 
'update data 
rec.Update Array("year_to_month_column", "day_to_second_column"), _
     Array("2-3", "7 10:20:30.123456")
... </pre></div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="OLEDB209"></a><div class="props_rev_3"><a id="GUID-BF2FDAB4-BCC5-4BFE-9F80-C8B6303E7914" name="GUID-BF2FDAB4-BCC5-4BFE-9F80-C8B6303E7914"></a><h4 id="OLEDB-GUID-BF2FDAB4-BCC5-4BFE-9F80-C8B6303E7914" class="sect4"><span class="enumeration_section">2.1.6 </span>LOB Support
                  </h4>
                  <div>
                     <p>The <code class="codeph">ISequentialStream</code> interface is supported for all <code class="codeph">LONG</code>, <code class="codeph">LONG RAW</code>, and LOB (<code class="codeph">BLOB</code>, <code class="codeph">CLOB</code>, <code class="codeph">NCLOB</code>, and <code class="codeph">BFILE</code>) columns. The consumer can use this interface to read and write to all the LOB columns, except <code class="codeph">BFILE</code> which is read-only. To have read and write access to these columns, the <code class="codeph">SELECT</code> SQL statement used to create the rowset should not contain a join.
                     </p>
                     <div class="infoboxnote" id="GUID-BF2FDAB4-BCC5-4BFE-9F80-C8B6303E7914__GUID-FC352B6F-6F85-4BD7-BFFF-44FE48C76C61">
                        <p class="notep1">Note:</p>
                        <p>Although most of the LOB columns in an Oracle Database support LOBs over 2 GB of data storage, ADO limits the maximum column size to 2 GB.</p>
                     </div>
                     <p>Columns having the <code class="codeph">BFILE</code> data type are not updatable in the <code class="codeph">Rowset</code> interface. However, these columns can be updated using the command interface, if the update is limited to modifying the directory and name of the external file pointed to by the <code class="codeph">BFILE</code> column. For example:
                     </p><pre class="oac_no_warn" dir="ltr">INSERT INTO topomaps (areanum, topomap) 
VALUES (158, BFILENAME('mapdir', 'topo158.tps'))
</pre><p>For more information on LOBs, see <a href="../adlob/introduction-to-large-objects.html#ADLOB001" target="_blank"><span><cite>Oracle Database SecureFiles and Large Objects Developer's Guide</cite></span></a>.
                     </p>
                  </div>
               </div><a id="OLEDB210"></a><div class="props_rev_3"><a id="GUID-E96E5C58-7004-4D76-9986-2DE9D4A17817" name="GUID-E96E5C58-7004-4D76-9986-2DE9D4A17817"></a><h4 id="OLEDB-GUID-E96E5C58-7004-4D76-9986-2DE9D4A17817" class="sect4"><span class="enumeration_section">2.1.7 </span>Unicode Support
                  </h4>
                  <div>
                     <p>OraOLEDB supports the Unicode character set. Using this feature, consumers can use OraOLEDB to access data in multiple languages on the same client computer. It can be especially useful in creating global Internet applications supporting as many languages as the Unicode standard entails. For example, you can write a single Active Server Page (ASP) application that accesses an Oracle Database to dynamically generate contents in Japanese, Arabic, English, Thai, and so on.</p>
                  </div><a id="OLEDB211"></a><div class="props_rev_3"><a id="GUID-BC0C7D1E-DD54-485E-A2E5-29A67B5E1246" name="GUID-BC0C7D1E-DD54-485E-A2E5-29A67B5E1246"></a><h5 id="OLEDB-GUID-BC0C7D1E-DD54-485E-A2E5-29A67B5E1246" class="sect5"><span class="enumeration_section">2.1.7.1 </span>Types of Unicode Encoding
                     </h5>
                     <div>
                        <p>The Oracle Databases store the Unicode data in the UTF-8 encoding scheme, which is an ASCII compatible multibyte encoding of Unicode. Microsoft Windows uses the UTF-16 encoding, which is a 2-byte fixed-width encoding scheme. OraOLEDB transparently converts the data between the two encoding schemes allowing the consumers to deal with only UTF-16.</p>
                        <div class="infoboxnote" id="GUID-BC0C7D1E-DD54-485E-A2E5-29A67B5E1246__GUID-19C38782-061E-4274-8656-1ED15A678664">
                           <p class="notep1">Note:</p>
                           <p>The Unicode support is transparent to ADO consumers. OLE DB consumers using C or C++ need to explicitly specify <code class="codeph">DBTYPE_WSTR</code> in their data type bindings when Unicode data in involved.
                           </p>
                        </div>
                     </div>
                  </div><a id="OLEDB212"></a><div class="props_rev_3"><a id="GUID-25BEECB1-8B12-4F1E-8DC4-A2DE3203CF9D" name="GUID-25BEECB1-8B12-4F1E-8DC4-A2DE3203CF9D"></a><h5 id="OLEDB-GUID-25BEECB1-8B12-4F1E-8DC4-A2DE3203CF9D" class="sect5"><span class="enumeration_section">2.1.7.2 </span>How Oracle Unicode Support Works
                     </h5>
                     <div>
                        <p>OraOLEDB works in two modes, Unicode mode and nonUnicode mode. When the client character set is not a superset of the server character set or the database character set is a multibyte character set, OraOLEDB automatically enables the Unicode mode. In this mode, OraOLEDB stores the data in its cache in the UTF-16 encoding scheme. The user should ensure that the database's character set is AL32UTF8 to prevent any data loss.</p>
                        <p>If the client character set is a superset of the server's, then the provider operates in the nonUnicode mode. This mode provides slightly better performance as it does not have to deal with larger character buffers required by the UTF-16 encoding.</p>
                        <p>The detection of the client's and the server's character set is performed during logon.</p>
                        <div class="infoboxnote" id="GUID-25BEECB1-8B12-4F1E-8DC4-A2DE3203CF9D__GUID-ED65B65E-2EB7-40D1-975E-5E9D97E87C4D">
                           <p class="notep1">Note:</p>
                           <p>OraOLEDB no longer requires the client character set to be set to UTF8 to enable the Unicode mode. The provider still supports such setups but no longer requires it.</p>
                        </div>
                        <p>See <span class="q">"<a href="provider-specific-info.html#GUID-3860A62F-B4C5-45FB-A4CB-F70FCFDCCE80">Data Type Mappings in Rowsets and Parameters</a>"</span> for further information.
                        </p>
                     </div>
                  </div><a id="OLEDB213"></a><div class="props_rev_3"><a id="GUID-D9D484C9-9607-466F-8C1E-6B48FDFA4A70" name="GUID-D9D484C9-9607-466F-8C1E-6B48FDFA4A70"></a><h5 id="OLEDB-GUID-D9D484C9-9607-466F-8C1E-6B48FDFA4A70" class="sect5"><span class="enumeration_section">2.1.7.3 </span>Unicode Support Setup
                     </h5>
                     <div>
                        <p>To prevent any data loss, the database character set should be AL32UTF8. Other than this, there is no other setup required for Unicode support.</p>
                     </div><a id="OLEDB214"></a><div class="props_rev_3"><a id="GUID-19281EC6-5266-4CF8-B287-FADA83B03439" name="GUID-19281EC6-5266-4CF8-B287-FADA83B03439"></a><h6 id="OLEDB-GUID-19281EC6-5266-4CF8-B287-FADA83B03439" class="sect6"><span class="enumeration_section">2.1.7.3.1 </span>Database Setup
                        </h6>
                        <div>
                           <div class="section">
                              <p>You must ensure that the Oracle Database is configured to store the data in the AL32UTF8 character set. The character set configuration is typically specified during database creation. To check the character set setting of your database, execute the following query in SQL*Plus:</p><pre class="oac_no_warn" dir="ltr">SQL&gt; SELECT parameter, value FROM nls_database_parameters
     WHERE parameter = 'NLS_CHARACTERSET';
</pre><p>If the character set of your database is not AL32UTF8, you need to create a new database with the AL32UTF8 character set and import your data into it. </p>
                              <div class="infoboxnotealso" id="GUID-19281EC6-5266-4CF8-B287-FADA83B03439__GUID-DEC00D17-815C-4258-82B8-863778136D74">
                                 <p class="notep1">See Also:</p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p><a href="../admin/creating-and-configuring-an-oracle-database.html#ADMIN13343" target="_blank"><span><cite>Oracle Database Administratorâs Guide</cite></span></a></p>
                                    </li>
                                    <li>
                                       <p><a href="../nlspg/supporting-multilingual-databases-with-unicode.html#NLSPG317" target="_blank"><span><cite>Oracle Database Globalization Support Guide</cite></span></a></p>
                                    </li>
                                 </ul>
                              </div>
                           </div>
                           <!-- class="section" -->
                        </div>
                     </div>
                  </div>
               </div><a id="OLEDB215"></a><div class="props_rev_3"><a id="GUID-0E5603DB-BDB3-47F1-ABBB-E58CFD93C7D5" name="GUID-0E5603DB-BDB3-47F1-ABBB-E58CFD93C7D5"></a><h4 id="OLEDB-GUID-0E5603DB-BDB3-47F1-ABBB-E58CFD93C7D5" class="sect4"><span class="enumeration_section">2.1.8 </span>Errors
                  </h4>
                  <div>
                     <p>OLE and COM objects report errors through the <code class="codeph">HRESULT</code> return code of the object member functions. An OLE/COM <code class="codeph">HRESULT</code> return code is a bit-packed structure. OLE provides macros that dereference structure members. OraOLEDB exposes <code class="codeph">IErrorLookup</code> to retrieve information about an error.
                     </p>
                     <p>All objects support extended error information. For this, the consumer must instantiate the OLE DB Extended Error object followed by calling the method <code class="codeph">GetErrorDescription()</code> to get the error text.
                     </p><pre class="oac_no_warn" dir="ltr">// Instantiate OraOLEDBErrorLookup and obtain a pointer to its
//   IErrorLookup interface
CoCreateInstance(CLSID_OraOLEDBErrorLookup, NULL, CLSCTX_INPROC_SERVER,
                 IID_IErrorLookup, (void **)&amp;pIErrorLookup)
//Call the method GetErrorDescription() to get the full error text
pIErrorLookup-&gt;GetErrorDescription()
</pre><p>The OraOLEDB provider returns the entire error stack in one text block.</p>
                     <p>For ADO users, the following example applies:</p><pre class="oac_no_warn" dir="ltr">Dim oerr As ADODB.Error
For Each oerr in con.Errors
    MsgBox "Error: " &amp; oerr.Description &amp; vbCrLf _
        &amp; "Source: " &amp; oerr.Source
Next</pre><p></p>
                  </div>
               </div><a id="OLEDB0002"></a><div class="props_rev_3"><a id="GUID-946BB8F8-7BA1-486D-9205-90F05BC9896A" name="GUID-946BB8F8-7BA1-486D-9205-90F05BC9896A"></a><h4 id="OLEDB-GUID-946BB8F8-7BA1-486D-9205-90F05BC9896A" class="sect4"><span class="enumeration_section">2.1.9 </span>OLEDB.NET Data Provider Compatibility
                  </h4>
                  <div>
                     <div class="section">
                        <p>The OLE DB .NET Data Provider can utilize OraOLEDB as the OLE DB Provider for accessing Oracle Database. </p>
                        <p>To make OraOLEDB compatible with OLE DB .NET Data Provider, set the connection string attribute <a id="d3293e5872" class="indexterm-anchor"></a><code class="codeph">OLEDB.NET</code> to <code class="codeph">True</code>.
                        </p>
                        <p>Setting the <code class="codeph">OLEDB.NET</code> attribute to <code class="codeph">False</code> disables .NET compatibility.
                        </p>
                        <div class="infoboxnote" id="GUID-946BB8F8-7BA1-486D-9205-90F05BC9896A__GUID-2C1D3B7D-51C7-4304-B767-5837DF5B19B4">
                           <p class="notep1">Note:</p>
                           <p>The <code class="codeph">OLEDB.NET</code> connection string attribute must not be used in ADO applications.
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div><a id="OLEDB216"></a><div class="props_rev_3"><a id="GUID-642EB89F-1F7F-44CA-8EB6-E51BF59DCAF7" name="GUID-642EB89F-1F7F-44CA-8EB6-E51BF59DCAF7"></a><h5 id="OLEDB-GUID-642EB89F-1F7F-44CA-8EB6-E51BF59DCAF7" class="sect5"><span class="enumeration_section">2.1.9.1 </span>Using the OLEDB.NET Attribute in a Connection String
                     </h5>
                     <div>
                        <div class="section">
                           <p>When using OraOLEDB with the OLE DB .NET Data Provider, the <code class="codeph">OLEDB.NET</code> connection attribute must be set to <code class="codeph">True</code> as shown in the following examples:
                           </p><pre class="oac_no_warn" dir="ltr">
// in <a id="d3293e5956" class="indexterm-anchor"></a><a id="d3293e5960" class="indexterm-anchor"></a><a id="d3293e5962" class="indexterm-anchor"></a>VB.NET
Dim con As New OleDbConnection()
con.ConnectionString = "Provider=OraOLEDB.Oracle;User Id=scott;" &amp; _
     "Password=tiger;Data Source=Oracle;OLEDB.NET=True;"
con.Open

// in <a id="d3293e5967" class="indexterm-anchor"></a>C#<a id="d3293e5970" class="indexterm-anchor"></a><a id="d3293e5974" class="indexterm-anchor"></a>
...
OleDbConnection con = new OleDbConnection();
con.ConnectionString = "Provider=OraOLEDB.Oracle;User Id=scott;" +
     "Password=tiger;Data Source=Oracle;OLEDB.NET=true;"
con.Open();
...
</pre></div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="OLEDB217"></a><div class="props_rev_3"><a id="GUID-46CC9C6C-AAFB-4D64-A7B7-0F386ABDEA0C" name="GUID-46CC9C6C-AAFB-4D64-A7B7-0F386ABDEA0C"></a><h5 id="OLEDB-GUID-46CC9C6C-AAFB-4D64-A7B7-0F386ABDEA0C" class="sect5"><span class="enumeration_section">2.1.9.2 </span>Using OraOLEDB Custom Properties
                     </h5>
                     <div>
                        <div class="section">
                           <p>ADO allows OraOLEDB provider-specific properties to be set at the object level. The OraOLEDB-specific properties <code class="codeph">SPPrmsLOB</code> and <code class="codeph">NDatatype</code> can be set as connection string attributes as well as at the command-object level. The <code class="codeph">StmtCacheSize</code> property can be set as a connection string attribute and the <code class="codeph">AddToStmtCache</code> property can be set at the command object level. The following example shows the setting of properties at the command level:
                           </p><pre class="oac_no_warn" dir="ltr">
// in VB
Dim cmd as new ADODB.Command
...
cmd.Properties("SPPrmsLOB") = True
cmd.Properties("NDatatype") = True
cmd.Properties("AddToStmtCache") = True
...</pre><p></p>
                           <p>However, the OLEDB.NET Data Provider cannot expose OLE DB provider-specific properties at the object level. Therefore, the <code class="codeph">SPPrmsLOB</code> and <code class="codeph">NDatatype</code> properties can only be set as connection string attributes and <code class="codeph">AddToStmtCache</code> property is not supported when OraOLEDB is used by OLE DB .NET Data Provider:
                           </p><pre class="oac_no_warn" dir="ltr">
// in VB.NET
Dim con As New OleDbConnection()
con.ConnectionString = "Provider=OraOLEDB.Oracle;User Id=scott;" &amp; _
     "Password=tiger;Data Source=Oracle;OLEDB.NET=True;" &amp; _
     "SPPrmsLOB=False;NDatatype=False;"
con.Open()</pre><p></p>
                           <p>Both <code class="codeph">SPPrmsLOB</code> and <code class="codeph">NDatatype</code> connection string attributes are set to <code class="codeph">False</code> by default if they are not specified. 
                           </p>
                           <p>Setting either of these connection string attributes to <code class="codeph">True</code> incurs additional processing overhead when executing commands with parameters.
                           </p>
                           <div class="infoboxnotealso" id="GUID-46CC9C6C-AAFB-4D64-A7B7-0F386ABDEA0C__GUID-B25DE846-8E01-4D5D-91E5-66799822C559">
                              <p class="notep1">See Also:</p>
                              <p><a href="features-of-oledb.html#GUID-70778DCD-8ECA-4AC5-8D31-C9A8B9D54413">OraOLEDB Custom Properties for Commands</a> before setting either attribute to <code class="codeph">True</code></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="OLEDB218"></a><div class="props_rev_3"><a id="GUID-EAC10C5E-3CFB-4A56-B432-DC67F2319FF2" name="GUID-EAC10C5E-3CFB-4A56-B432-DC67F2319FF2"></a><h5 id="OLEDB-GUID-EAC10C5E-3CFB-4A56-B432-DC67F2319FF2" class="sect5"><span class="enumeration_section">2.1.9.3 </span>Updating Oracle with DataTable Changes
                     </h5>
                     <div>
                        <div class="section">
                           <p>In order for the <code class="codeph">OleDbDataAdapter.Update()</code> method to properly update Oracle Database with changes made in <code class="codeph">DataTable</code>, which must contain a primary key of a database table. If the database table does not contain a primary key, the <code class="codeph">ROWID</code> must be selected explicitly when populating <code class="codeph">DataTable</code>, so that the <code class="codeph">ROWID</code> can be used to uniquely identify a row when updating a row in the database. 
                           </p>
                           <p>Do not select the <code class="codeph">ROWID</code> from database tables that contains a primary key. If <code class="codeph">ROWID</code> is selected along with a primary key, <code class="codeph">ROWID</code> will be the only column marked as the primary key. 
                           </p>
                           <div class="infoboxnotealso" id="GUID-EAC10C5E-3CFB-4A56-B432-DC67F2319FF2__GUID-27FE70A9-053B-43BF-AC29-1006D60614F1">
                              <p class="notep1">See Also:</p>
                              <p>For further information on using the OLE DB .NET Data Provider</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>Microsoft .NET Documentation</p>
                                 </li>
                                 <li>
                                    <p>Microsoft .NET Framework Class Library</p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div><a id="OLEDB219"></a><div class="props_rev_3"><a id="GUID-F143E2CD-CA25-4D52-BCFB-2A9D1C62BDE9" name="GUID-F143E2CD-CA25-4D52-BCFB-2A9D1C62BDE9"></a><h3 id="OLEDB-GUID-F143E2CD-CA25-4D52-BCFB-2A9D1C62BDE9" class="sect3"><span class="enumeration_section">2.2 </span>Using OraOLEDB with Visual Basic
               </h3>
               <div>
                  <div class="section">
                     <p>The following simple example illustrates how to use Oracle Provider for OLE DB with ADO in Visual Basic 6.0 to connect to an Oracle Database and execute PL/SQL stored procedures and functions.</p>
                  </div>
                  <!-- class="section" -->
               </div><a id="OLEDB220"></a><div class="props_rev_3"><a id="GUID-22CD680B-47C6-411E-B53E-557907423AA4" name="GUID-22CD680B-47C6-411E-B53E-557907423AA4"></a><h4 id="OLEDB-GUID-22CD680B-47C6-411E-B53E-557907423AA4" class="sect4"><span class="enumeration_section">2.2.1 </span>Setting Up the Oracle Database
                  </h4>
                  <div>
                     <div class="section">
                        <p>This example assumes that the Oracle Database has the demonstration table <code class="codeph">EMP</code> under the user account <code class="codeph">scott</code>. The <code class="codeph">scott</code> account is included in the Oracle starter database. If the account does not exist on your database, create the account before running the sample program. If your database does not contain the <code class="codeph">emp</code> table, then you can use the <code class="codeph">demobld.sql</code> script to create the demonstration tables.
                        </p>
                        <p>This example also uses <span class="italic"><code class="codeph">exampledb</code></span> as the database network alias when connecting to the Oracle Database. You must change this network alias to match your system.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3">Step 1: Build the Sample Tables:</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ol>
                           <li>
                              <p>Start SQL*Plus.</p>
                           </li>
                           <li>
                              <p>Connect as username <code class="codeph">scott</code> with the password <code class="codeph">tiger</code>.
                              </p>
                           </li>
                           <li>
                              <p>Run the <code class="codeph">demobld.sql</code> script:
                              </p><pre class="oac_no_warn" dir="ltr">SQL&gt; @<span class="italic">ORACLE_BASE\ORACLE_HOME</span>\sqlplus\demo\demobld.sql;
</pre></li>
                        </ol>
                        <p>After the <code class="codeph">emp</code> table has been created in the <code class="codeph">scott</code> account, you need to create the PL/SQL package that contains the stored procedure and function that are run in the Visual Basic example.
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3">Step 2: Create the PL/SQL package:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Connect as username <code class="codeph">scott</code> with the password <code class="codeph">tiger</code>.</span></li>
                        <li class="stepexpand"><span>Create the PL/SQL packages shown in <a href="features-of-oledb.html#GUID-9912A91D-813C-41A3-A1A5-FAF3EF4EECC6__I1016901">PL/SQL Package</a>. </span><div>
                              <div class="infoboxnote" id="GUID-22CD680B-47C6-411E-B53E-557907423AA4__GUID-9BFC4B42-BA18-4E11-8B4A-F58692926A19">
                                 <p class="notep1">Note:</p>
                                 <p>When creating PL/SQL packages the <code class="codeph">/</code> character is used as a terminator and must be added on a separate line following each <code class="codeph">CREATE</code> <code class="codeph">PACKAGE</code>...<code class="codeph">END</code> block.
                                 </p>
                              </div>
                           </div>
                        </li>
                     </ol>
                  </div>
               </div><a id="OLEDB221"></a><div class="props_rev_3"><a id="GUID-F8D12FE4-3D10-47AD-9FCA-1EEB5461ECD4" name="GUID-F8D12FE4-3D10-47AD-9FCA-1EEB5461ECD4"></a><h4 id="OLEDB-GUID-F8D12FE4-3D10-47AD-9FCA-1EEB5461ECD4" class="sect4"><span class="enumeration_section">2.2.2 </span>Setting Up the Visual Basic Project
                  </h4>
                  <div>
                     <div class="section">
                        <p>After the Oracle Database setup is completed, you can create the Visual Basic 6.0 project.</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>Start Visual Basic 6.0 and create a new project.</span></li>
                        <li class="stepexpand"><span>Make sure that the Microsoft ActiveX Data Objects 2.1 Library and Microsoft ActiveX Data Objects Recordset 2.1 Library are included as Project References.</span><div>
                              <div class="figure" id="GUID-F8D12FE4-3D10-47AD-9FCA-1EEB5461ECD4__GUID-EB09F5DB-76ED-4335-842A-BCF850796308"><img src="img/vbprjref.gif" alt="Description of vbprjref.gif follows" title="Description of vbprjref.gif follows" longdesc="img_text/vbprjref.html"><br><a href="img_text/vbprjref.html">Description of the illustration vbprjref.gif</a></div>
                              <!-- class="figure" -->
                           </div>
                        </li>
                        <li class="stepexpand"><span>Add two command buttons to the form. One of the buttons will run the code to execute the PL/SQL procedure <code class="codeph">GetEmpRecords</code>. The other will run the code to execute the PL/SQL function <code class="codeph">GetDept</code>.</span><div>
                              <div class="figure" id="GUID-F8D12FE4-3D10-47AD-9FCA-1EEB5461ECD4__GUID-259C1083-0895-4751-9743-8D9450E28F22"><img src="img/oledbvb1.gif" alt="Description of oledbvb1.gif follows" title="Description of oledbvb1.gif follows" longdesc="img_text/oledbvb1.html"><br><a href="img_text/oledbvb1.html">Description of the illustration oledbvb1.gif</a></div>
                              <!-- class="figure" -->
                           </div>
                        </li>
                        <li class="stepexpand"><span>Add the following code to the <code class="codeph">Click</code> subroutine of the button that will run the code to execute the PL/SQL procedure <code class="codeph">GetEmpRecords</code>.</span><div><pre class="oac_no_warn" dir="ltr">Dim Oracon As ADODB.Connection
Dim recset As New ADODB.Recordset
Dim cmd As New ADODB.Command
Dim param1 As New ADODB.Parameter
Dim param2 As New ADODB.Parameter
Dim objErr As ADODB.Error
Dim Message, Title, Default, EmpNoValue

Message = "Enter an employee number (5000 - 9000)"
Title = "Choose an Employee"
Default = "7654"

On Error GoTo err_test

EmpNoValue = InputBox(Message, Title, Default)
If EmpNoValue = "" Then Exit Sub
If EmpNoValue &lt; 5000 Or EmpNoValue &gt; 9000 Then EmpNoValue = 7654

Set Oracon = CreateObject("ADODB.Connection")
Oracon.ConnectionString = "Provider=OraOLEDB.Oracle;" &amp; _
                          "Data Source=exampledb;" &amp; _
                          "User ID=scott;" &amp; _
                          "Password=tiger;"

Oracon.Open
Set cmd.ActiveConnection = Oracon
Set param1 = cmd.CreateParameter("param1", adSmallInt, adParamInput, ,
                                 EmpNoValue)
cmd.Parameters.Append param1
Set param2 = cmd.CreateParameter("param2", adSmallInt, adParamOutput)
cmd.Parameters.Append param2

' Enable PLSQLRSet property
Cmd.Properties ("PLSQLRSet") = TRUE  

cmd.CommandText = "{CALL Employees.GetDept(?, ?)}"
Set recset = cmd.Execute

' Disable PLSQLRSet property
Cmd.Properties ("PLSQLRSet") = FALSE 

MsgBox "Number: " &amp; EmpNoValue &amp; "  Dept: " &amp; recset.Fields("deptno").Value

Exit Sub

err_test:
    MsgBox Error$
    For Each objErr In Oracon.Errors
        MsgBox objErr.Description
    Next
    Oracon.Errors.Clear
    Resume Next
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Add the following code to the <code class="codeph">Click</code> subroutine of the button that will run the code to execute the PL/SQL function <code class="codeph">GetDept</code>.</span><div><pre class="oac_no_warn" dir="ltr">Dim Oracon As ADODB.Connection
Dim recset As New ADODB.Recordset
Dim cmd As New ADODB.Command
Dim param1 As New ADODB.Parameter
Dim param2 As New ADODB.Parameter
Dim objErr As ADODB.Error
 
Dim Message, Title, Default, DeptValue
Message = "Enter a department number (10, 20, or 30)"
Title = "Choose a Department"
Default = "30"

On Error GoTo err_test
DeptValue = InputBox(Message, Title, Default)
If DeptValue = "" Then Exit Sub
If DeptValue &lt; 10 Or DeptValue &gt; 30 Then DeptValue = 30

Set Oracon = CreateObject("ADODB.Connection")
Oracon.ConnectionString = "Provider=OraOLEDB.Oracle;" &amp; _
                          "Data Source=exampledb;" &amp; _
                          "User ID=scott;" &amp; _
                          "Password=tiger;"  
Oracon.Open
Set cmd = New ADODB.Command
Set cmd.ActiveConnection = Oracon
Set param1 = cmd.CreateParameter("param1", adSmallInt, adParamInput, ,
                                DeptValue)
cmd.Parameters.Append param1
Set param2 = cmd.CreateParameter("param2", adSmallInt, adParamOutput)
cmd.Parameters.Append param2

' Enable PLSQLRSet property
Cmd.Properties ("PLSQLRSet") = TRUE  

cmd.CommandText = "{CALL Employees.GetEmpRecords(?, ?)}"
Set recset = cmd.Execute

' Disable PLSQLRSet property
Cmd.Properties ("PLSQLRSet") = FALSE 

Do While Not recset.EOF
   MsgBox "Number: " &amp; recset.Fields("empno").Value &amp; "  Name: " &amp;
   recset.Fields("ename").Value &amp; "  Dept: " &amp; recset.Fields("deptno").Value
   recset.MoveNext
Loop

Exit Sub

err_test:
    MsgBox Error$
    For Each objErr In Oracon.Errors
        MsgBox objErr.Description
    Next
    Oracon.Errors.Clear
    Resume Next
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Run the project and check the results. For example, if you choose the Get Employee Records by Dept button, then you would see a dialog box requesting that you enter a department number.</span><div>
                              <div class="figure" id="GUID-F8D12FE4-3D10-47AD-9FCA-1EEB5461ECD4__GUID-F626F7B7-EFF1-4EE1-9738-6F2E931978B5"><img src="img/oledbvb2.gif" alt="Description of oledbvb2.gif follows" title="Description of oledbvb2.gif follows" longdesc="img_text/oledbvb2.html"><br><a href="img_text/oledbvb2.html">Description of the illustration oledbvb2.gif</a></div>
                              <!-- class="figure" -->
                              <p>After you have entered a department number and clicked <span class="bold">OK</span>, another dialog box displays employee names and numbers from that department.
                              </p>
                              <div class="figure" id="GUID-F8D12FE4-3D10-47AD-9FCA-1EEB5461ECD4__GUID-A97A71A9-6385-4977-A534-5A444502378D"><img src="img/oledbvb3.gif" alt="Description of oledbvb3.gif follows" title="Description of oledbvb3.gif follows" longdesc="img_text/oledbvb3.html"><br><a href="img_text/oledbvb3.html">Description of the illustration oledbvb3.gif</a></div>
                              <!-- class="figure" -->
                           </div>
                        </li>
                     </ol>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>