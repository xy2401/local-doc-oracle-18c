<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="Describes how to create and use external procedures on Windows.">
      <meta name="description" content="Describes how to create and use external procedures on Windows.">
      <title>About Building External Procedures</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Administrator's Reference ">
      <meta property="og:description" content="Describes how to create and use external procedures on Windows.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Administrator's Reference for Microsoft Windows">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="administrators-reference-guide-microsoft-windows.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2018-08-02T05:05:35-07:00">
      
      <meta name="dcterms.dateCopyrighted" content="1996, 2018">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E83889-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/18">
      
      <link rel="prev" href="32-bit-to-64-bit-application-migration.html" title="Previous" type="text/html">
      <link rel="next" href="overview-of-multithreaded-agent-architecture.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"18","element_name":"Release 18","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Administrator's Reference Guide for Microsoft Windows">
    <meta name="dcterms.isVersionOf" content="NTQRF">
    <meta name="dcterms.release" content="Release 18">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="32-bit-to-64-bit-application-migration.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="overview-of-multithreaded-agent-architecture.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Administrator's Reference </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="developing-applications-for-windows.html" property="item" typeof="WebPage"><span property="name">Developing Applications for Windows</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">About Building External Procedures</li>
            </ol>
            <a id="GUID-DB15FD29-A121-4B3F-B422-1C8BF3FB696D" name="GUID-DB15FD29-A121-4B3F-B422-1C8BF3FB696D"></a><a id="NTQRF478"></a>
            
            <h2 id="NTQRF-GUID-DB15FD29-A121-4B3F-B422-1C8BF3FB696D" class="sect2">About Building External Procedures</h2>
         </header>
         <div class="ind">
            <div>
               <p>Describes how to create and use external procedures on Windows. </p>
               <p>The following files are located in <span class="italic"><code class="codeph">ORACLE_HOME</code></span><code class="codeph">\rdbms\extproc</code>:
               </p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><span class="bold"><code class="codeph">extern.c</code></span><code class="codeph"> </code>is the code example shown in <span class="q">"Writing an External Procedure"</span></p>
                     <p><span class="bold"><code class="codeph">make.bat</code></span> is the batch file that builds the dynamic link library
                     </p>
                  </li>
                  <li>
                     <p><span class="bold"><code class="codeph">extern.sql</code></span> automates the instructions described in <span class="q">"Registering an External Procedure"</span> and <span class="q">"Executing an External Procedure"</span></p>
                  </li>
               </ul>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="about-building-external-procedures.html#GUID-B0F2D810-DD0C-4198-90B6-0CA53A47F43B">External Procedures Overview</a><br>External procedures are functions written in a third-generation language (C, for example) and callable from within PL/SQL or SQL as if they were a PL/SQL routine or function.
                  </li>
                  <li class="ulchildlink"><a href="about-building-external-procedures.html#GUID-F58FA21E-229E-48C6-AC96-066E3CA8BED7">Installing and Configuring Oracle Database and Oracle Net Services</a><br>Describes about the installation and configuration of Oracle Database and Oracle Net.
                  </li>
                  <li class="ulchildlink"><a href="about-building-external-procedures.html#GUID-38DC5A2E-A76F-4DA4-9148-B6857F6E8C12">Writing an External Procedure</a><br>Using a third-generation programming language, you can write functions to be built into DLLs and started by <code class="codeph">EXTPROC</code>. 
                  </li>
                  <li class="ulchildlink"><a href="about-building-external-procedures.html#GUID-E859789A-E42E-4545-AFE7-946D808D53ED">Building a DLL</a><br>After writing your external procedures in a third-generation programming language, use the appropriate compiler and linker to build a DLL, making sure to export the external procedures as noted previously. 
                  </li>
                  <li class="ulchildlink"><a href="about-building-external-procedures.html#GUID-7BC71588-E0C0-46EC-8C1A-AFB16C61269C">Registering an External Procedure</a><br>Once you have built a DLL containing your external procedures, you must register your external procedures with Oracle Database. 
                  </li>
                  <li class="ulchildlink"><a href="about-building-external-procedures.html#GUID-51F6B56D-F53E-48AF-B7E4-913B8BD059E3">Restricting Library-Related Privileges to Trusted Users Only</a><br>The <code class="codeph">CREATE LIBRARY</code>, <code class="codeph">CREATE ANY LIBRARY</code>, <code class="codeph">ALTER ANY LIBRARY</code>, and <code class="codeph">EXECUTE ANY LIBRARY</code> privileges, and grants of <code class="codeph">EXECUTE ON</code> <span class="italic"><code class="codeph">library_name</code></span> convey a great deal of power to users. 
                  </li>
                  <li class="ulchildlink"><a href="about-building-external-procedures.html#GUID-65F40B02-BD9B-4F10-A869-47BA705D5A8D">Executing an External Procedure</a><br>To run an external procedure, you must call the PL/SQL program unit (that is, the alias for the external function) that registered the external procedure. 
                  </li>
               </ul>
               <div class="familylinks">
                  <div class="parentlink">
                     <p><strong>Parent topic:</strong> <a href="developing-applications-for-windows.html#GUID-87C43994-ECCF-4801-90BC-FFF1622B1621">Developing Applications for Windows</a></p>
                  </div>
               </div>
            </div>
            <a id="NTQRF479"></a><div class="props_rev_3"><a id="GUID-B0F2D810-DD0C-4198-90B6-0CA53A47F43B" name="GUID-B0F2D810-DD0C-4198-90B6-0CA53A47F43B"></a><h3 id="NTQRF-GUID-B0F2D810-DD0C-4198-90B6-0CA53A47F43B" class="sect3">External Procedures Overview</h3>
               <div>
                  <p>External procedures are functions written in a third-generation language (C, for example) and callable from within PL/SQL or SQL as if they were a PL/SQL routine or function.</p>
                  <p>External procedures let you take advantage of strengths and capabilities of a third-generation programming language in a PL/SQL environment.</p>
                  <div class="infoboxnote" id="GUID-B0F2D810-DD0C-4198-90B6-0CA53A47F43B__GUID-DC7176F9-EA42-42BD-9373-AD7A9FA94C91">
                     <p class="notep1">Note:</p>
                     <p>Oracle Database also provides a special purpose interface, the call specification, that lets you call external procedures from other languages, as long as they are callable by C.</p>
                  </div>
                  <p><a id="d45115e236" class="indexterm-anchor"></a>The main advantages of external procedures are: 
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Performance, because some tasks are performed more efficiently in a third-generation language than in PL/SQL, which is better suited for SQL transaction processing</p>
                     </li>
                     <li>
                        <p>Code re-usability, because dynamic link libraries (DLLs) can be called directly from PL/SQL programs on the server or in client tools</p>
                     </li>
                  </ul>
                  <p>You can use external procedures to perform specific processes:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Solving scientific and engineering problems</p>
                     </li>
                     <li>
                        <p>Analyzing data</p>
                     </li>
                     <li>
                        <p>Controlling real-time devices and processes</p>
                     </li>
                  </ul>
                  <div class="infoboxnote" id="GUID-B0F2D810-DD0C-4198-90B6-0CA53A47F43B__GUID-4F2C9F7A-B345-4179-82F9-CA0504977982">
                     <p class="notep1">Note:</p>
                     <p>Special security precautions are warranted when configuring a listener to handle external procedures. </p>
                  </div>
                  <p>To create and use an external procedure, perform the following steps:</p>
                  <ol>
                     <li>
                        <p><a href="about-building-external-procedures.html#GUID-F58FA21E-229E-48C6-AC96-066E3CA8BED7" title="Describes about the installation and configuration of Oracle Database and Oracle Net.">Installing and Configuring Oracle Database and Oracle Net Services </a></p>
                     </li>
                     <li>
                        <p><a href="about-building-external-procedures.html#GUID-38DC5A2E-A76F-4DA4-9148-B6857F6E8C12" title="Using a third-generation programming language, you can write functions to be built into DLLs and started by EXTPROC.">Writing an External Procedure</a></p>
                     </li>
                     <li>
                        <p><a href="about-building-external-procedures.html#GUID-E859789A-E42E-4545-AFE7-946D808D53ED" title="After writing your external procedures in a third-generation programming language, use the appropriate compiler and linker to build a DLL, making sure to export the external procedures as noted previously.">Building a DLL</a></p>
                     </li>
                     <li>
                        <p><a href="about-building-external-procedures.html#GUID-7BC71588-E0C0-46EC-8C1A-AFB16C61269C" title="Once you have built a DLL containing your external procedures, you must register your external procedures with Oracle Database.">Registering an External Procedure</a></p>
                     </li>
                     <li>
                        <p><a href="about-building-external-procedures.html#GUID-51F6B56D-F53E-48AF-B7E4-913B8BD059E3" title="The CREATE LIBRARY, CREATE ANY LIBRARY, ALTER ANY LIBRARY, and EXECUTE ANY LIBRARY privileges, and grants of EXECUTE ON library_name convey a great deal of power to users.">Restricting Library-Related Privileges to Trusted Users Only</a></p>
                     </li>
                     <li>
                        <p><a href="about-building-external-procedures.html#GUID-65F40B02-BD9B-4F10-A869-47BA705D5A8D" title="To run an external procedure, you must call the PL/SQL program unit (that is, the alias for the external function) that registered the external procedure.">Executing an External Procedure</a></p>
                     </li>
                  </ol>
                  <div class="infoboxnote" id="GUID-B0F2D810-DD0C-4198-90B6-0CA53A47F43B__GUID-277E0BC9-6803-46DE-9105-24C852E95405">
                     <p class="notep1">Note:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>You must have a C compiler and linker installed on your system to build DLLs.</p>
                        </li>
                        <li>
                           <p>You can combine the instructions described in the fourth and fifth tasks into one SQL script that automates the task of registering and executing your external procedure. See <span class="italic"><code class="codeph">ORACLE_HOME</code></span><code class="codeph">\rdbms\extproc\extern.sql</code> for an example of a SQL script that combines these steps.
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-B0F2D810-DD0C-4198-90B6-0CA53A47F43B__GUID-485C7FE6-ACED-4A64-A103-E59BC90E0C16">
                     <p class="notep1">See Also:</p><span class="q">"<a href="about-backing-up-a-database.html#GUID-865A998B-7CB3-4D5D-9D8E-8E43167588BA" title="For an Oracle database in NOARCHIVELOG mode, the only supported component-based VSS snapshot is of Oracle Database when the type is full, default, or copy.">Modifying Configuration of External Procedures for Higher Security</a>"</span> and <a href="../netag/enabling-advanced-features.html#NETAG0132" target="_blank"><span class="italic">Oracle Database Net Services Administrator's Guide</span></a></div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="about-building-external-procedures.html#GUID-DB15FD29-A121-4B3F-B422-1C8BF3FB696D" title="Describes how to create and use external procedures on Windows.">About Building External Procedures</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="NTQRF480"></a><div class="props_rev_3"><a id="GUID-F58FA21E-229E-48C6-AC96-066E3CA8BED7" name="GUID-F58FA21E-229E-48C6-AC96-066E3CA8BED7"></a><h3 id="NTQRF-GUID-F58FA21E-229E-48C6-AC96-066E3CA8BED7" class="sect3">Installing and Configuring Oracle Database and Oracle Net Services </h3>
               <p>Describes about the installation and configuration of Oracle Database and Oracle Net.</p>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="about-building-external-procedures.html#GUID-D8E15913-AC74-490B-8254-58805CA00797">Installing Oracle Database</a><br>Learn how to install Oracle Database on your Windows server.
                     </li>
                     <li class="ulchildlink"><a href="about-building-external-procedures.html#GUID-B936CD76-69F3-4BCA-B53B-E360F6AEED7F">Configuring Oracle Net Services</a><br>During database server installation, Oracle Net Configuration Assistant configures <code class="codeph">listener.ora</code> and <code class="codeph">tnsnames.ora</code> files for external procedure calls.
                     </li>
                  </ul>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="about-building-external-procedures.html#GUID-DB15FD29-A121-4B3F-B422-1C8BF3FB696D" title="Describes how to create and use external procedures on Windows.">About Building External Procedures</a></p>
                     </div>
                  </div>
               </div>
               <a id="NTQRF481"></a><div class="props_rev_3"><a id="GUID-D8E15913-AC74-490B-8254-58805CA00797" name="GUID-D8E15913-AC74-490B-8254-58805CA00797"></a><h4 id="NTQRF-GUID-D8E15913-AC74-490B-8254-58805CA00797" class="sect4">Installing Oracle Database</h4>
                  <div>
                     <p>Learn how to install Oracle Database on your Windows server.</p>
                     <div class="section">
                        <p>Follow the steps in to install these products on your Windows server:</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a id="d45115e520" class="indexterm-anchor"></a>Oracle Database Enterprise Edition, Oracle Database Standard Edition, or Oracle Database Personal Edition. Each type contains PL/SQL, from which external procedures are called, and the PL/SQL external procedure program (<code class="codeph">EXTPROC</code>), which runs external procedures.
                              </p>
                           </li>
                           <li>
                              <p>Oracle Net Services</p>
                           </li>
                           <li>
                              <p>Oracle Protocol Support</p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-D8E15913-AC74-490B-8254-58805CA00797__GUID-02B27E3E-AAC6-4EF9-BD6D-D4CE4A802124">
                        <p class="notep1">See Also:</p><a href="../ntdbi/installing-oracle-database.html#NTDBI2766" target="_blank"><span class="italic">Oracle Database Installation Guide for Microsoft Windows</span></a></div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="about-building-external-procedures.html#GUID-F58FA21E-229E-48C6-AC96-066E3CA8BED7" title="Describes about the installation and configuration of Oracle Database and Oracle Net.">Installing and Configuring Oracle Database and Oracle Net Services</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div><a id="NTQRF482"></a><div class="props_rev_3"><a id="GUID-B936CD76-69F3-4BCA-B53B-E360F6AEED7F" name="GUID-B936CD76-69F3-4BCA-B53B-E360F6AEED7F"></a><h4 id="NTQRF-GUID-B936CD76-69F3-4BCA-B53B-E360F6AEED7F" class="sect4">Configuring Oracle Net Services</h4>
                  <div>
                     <p>During database server installation, Oracle Net Configuration Assistant configures <code class="codeph">listener.ora</code> and <code class="codeph">tnsnames.ora</code> files for external procedure calls.
                     </p>
                     <div class="section">
                        <p><a id="d45115e612" class="indexterm-anchor"></a><a id="d45115e616" class="indexterm-anchor"></a>When an application calls an external procedure, Oracle Net Listener starts an external procedure agent called <code class="codeph">EXTPROC</code>. By default, the <code class="codeph">extproc</code> process communicates directly through the server process. Using a network connection established by the listener, the application passes the following information to <code class="codeph">EXTPROC</code>:
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>DLL name</p>
                           </li>
                           <li>
                              <p>External procedure name</p>
                           </li>
                           <li>
                              <p>Parameters (if necessary)</p>
                           </li>
                        </ul>
                        <p><code class="codeph">EXTPROC</code> then loads the DLL, runs the external procedure, and passes back any values returned by the external procedure.
                        </p>
                        <p>If you overwrite default <code class="codeph">listener.ora</code> and <code class="codeph">tnsnames.ora</code> files, then you must manually configure the following files for the external procedure behavior described previously to occur:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="italic"><code class="codeph">ORACLE_HOME</code></span><code class="codeph">\network\admin\listener.ora</code></p>
                           </li>
                           <li>
                              <p><span class="italic"><code class="codeph">ORACLE_HOME</code></span><code class="codeph">\network\admin\tnsnames.ora</code> 
                              </p>
                              <div class="infoboxnote" id="GUID-B936CD76-69F3-4BCA-B53B-E360F6AEED7F__GUID-725EF229-4613-44D7-BDAA-EDA887F203A8">
                                 <p class="notep1">Note:</p>
                                 <p>Additional security may be required for the listener in a production environment. </p>
                              </div>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section"></div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <div class="infoboxnotealso" id="GUID-B936CD76-69F3-4BCA-B53B-E360F6AEED7F__GUID-87429408-8F48-433B-AAFC-450DA4B903EE">
                        <p class="notep1">See Also:</p><a href="../netag/configuring-and-administering-oracle-net-listener.html#NETAG010" target="_blank"><span class="italic">Oracle Database Net Services Administrator's Guide</span></a></div>
                     <div class="familylinks">
                        <div class="parentlink">
                           <p><strong>Parent topic:</strong> <a href="about-building-external-procedures.html#GUID-F58FA21E-229E-48C6-AC96-066E3CA8BED7" title="Describes about the installation and configuration of Oracle Database and Oracle Net.">Installing and Configuring Oracle Database and Oracle Net Services</a></p>
                        </div>
                     </div>
                  </div>
                  
               </div>
            </div><a id="NTQRF483"></a><div class="props_rev_3"><a id="GUID-38DC5A2E-A76F-4DA4-9148-B6857F6E8C12" name="GUID-38DC5A2E-A76F-4DA4-9148-B6857F6E8C12"></a><h3 id="NTQRF-GUID-38DC5A2E-A76F-4DA4-9148-B6857F6E8C12" class="sect3">Writing an External Procedure</h3>
               <div>
                  <p>Using a third-generation programming language, you can write functions to be built into DLLs and started by <code class="codeph">EXTPROC</code>. 
                  </p>
                  <div class="section">
                     <p>The following is a simple Microsoft Visual C++ example of an external procedure called <code class="codeph">FIND_MAX</code>:
                     </p>
                     <div class="infoboxnote" id="GUID-38DC5A2E-A76F-4DA4-9148-B6857F6E8C12__GUID-8F3BB449-7729-4CE1-91F4-75FC6786F197">
                        <p class="notep1">Note:</p>
                        <p>Because external procedures are built into DLLs, they must be explicitly exported. In this example, the <code class="codeph">DLLEXPORT</code><span class="bold"> </span>storage class modifier exports the function <code class="codeph">FIND_MAX</code> from a dynamic link library.
                        </p>
                     </div><pre class="oac_no_warn" dir="ltr">#include &lt;windows.h&gt;
#define NullValue -1
/*
  This function tests if x is at least as big as y.
*/
long __declspec(dllexport) find_max(long 	x, 
 				short 	x_indicator, 
long 	y, 
short y_indicator, 
 				short *ret_indicator)
{
   /* It can be tricky to debug DLL's that are being called by a process
      that is spawned only when needed, as in this case.  
      Therefore try using the DebugBreak(); command.  
      This starts your debugger.  Uncomment the line with DebugBreak(); 
      in it and you can step right into your code.
   */
   /* DebugBreak();  */

   /* First check to see if you have any nulls. */
   /* Just return a null if either x or y is null. */

   if ( x_indicator==NullValue || y_indicator==NullValue) {
      *ret_indicator = NullValue;   
      return(0);
   } else { 
      *ret_indicator = 0;       /* Signify that return value is not null. */
      if (x &gt;= y) return x;
      else return y;
   }
}</pre></div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="about-building-external-procedures.html#GUID-DB15FD29-A121-4B3F-B422-1C8BF3FB696D" title="Describes how to create and use external procedures on Windows.">About Building External Procedures</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-E859789A-E42E-4545-AFE7-946D808D53ED" name="GUID-E859789A-E42E-4545-AFE7-946D808D53ED"></a><h3 id="NTQRF-GUID-E859789A-E42E-4545-AFE7-946D808D53ED" class="sect3">Building a DLL</h3>
               <div>
                  <p>After writing your external procedures in a third-generation programming language, use the appropriate compiler and linker to build a DLL, making sure to export the external procedures as noted previously. </p>
                  <div class="section">
                     <p>See your compiler and linker documentation for instructions on building a DLL and exporting its functions. </p>
                     <p>You can build the external procedure <code class="codeph">FIND_MAX</code>, created in <span class="q">"Writing an External Procedure"</span>, into a DLL called <code class="codeph">extern.dll</code> by going to <span class="italic"><code class="codeph">ORACLE_HOME</code></span><code class="codeph">\rdbms\extproc</code> and typing <code class="codeph">make</code>. After building the DLL, you can move it to any directory on your system.
                     </p>
                     <p>The default behavior of <code class="codeph">EXTPROC</code> is to load DLLs only from <span class="italic"><code class="codeph">ORACLE_HOME</code></span><code class="codeph">\bin</code> or <span class="italic"><code class="codeph">ORACLE_HOME</code></span><code class="codeph">\lib</code>. To load DLLs from other directories, you must set environment variable <code class="codeph">EXTPROC_DLLS</code> to a colon (:) separated list (semicolon-separated on Windows systems) of the DLL names qualified with their complete paths. The preferred way to set this environment variable is through the <code class="codeph">ENVS</code> parameter in <code class="codeph">listener.ora</code>.
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="infoboxnotealso" id="GUID-E859789A-E42E-4545-AFE7-946D808D53ED__GUID-9F805CFC-ADBB-403C-BC47-163007CC76D0">
                     <p class="notep1">See Also:</p>
                     <p><a href="../adfns/design_basics.html#ADFNS010" target="_blank"><span class="italic">Oracle Database Development Guide</span></a> for more information on <code class="codeph">EXTPROC</code></p>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="about-building-external-procedures.html#GUID-DB15FD29-A121-4B3F-B422-1C8BF3FB696D" title="Describes how to create and use external procedures on Windows.">About Building External Procedures</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="NTQRF485"></a><div class="props_rev_3"><a id="GUID-7BC71588-E0C0-46EC-8C1A-AFB16C61269C" name="GUID-7BC71588-E0C0-46EC-8C1A-AFB16C61269C"></a><h3 id="NTQRF-GUID-7BC71588-E0C0-46EC-8C1A-AFB16C61269C" class="sect3">Registering an External Procedure</h3>
               <div>
                  <p>Once you have built a DLL containing your external procedures, you must register your external procedures with Oracle Database. </p>
                  <div class="section">
                     <p>Now, you can configure the <a id="d45115e962" class="indexterm-anchor"></a><a id="d45115e968" class="indexterm-anchor"></a><code class="codeph">EXTPROC</code> process to be authenticated through a <code class="codeph">CREDENTIAL</code> for better security.
                     </p>
                     <p><a id="d45115e981" class="indexterm-anchor"></a>Oracle Database supports two new extensions to the <code class="codeph">CREATE LIBRARY</code> command. This includes a <code class="codeph">CREDENTIAL</code> clause and a <code class="codeph">DIRECTORY</code> object option. The <code class="codeph">CREDENTIAL</code> clause defines the user the <code class="codeph">EXTPROC</code> runs as while the <code class="codeph">DIRECTORY</code> object option specifies the directory where the DLL can be located.
                     </p>
                     <p><a id="d45115e1006" class="indexterm-anchor"></a><a id="d45115e1008" class="indexterm-anchor"></a>To create a PL/SQL library to map to the DLL:
                     </p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>Set environment variable <code class="codeph">EXTPROC_DLLS</code> in the <code class="codeph">ENVS</code> parameter in <code class="codeph">listener.ora</code>. For example:</span><div><pre class="oac_no_warn" dir="ltr">SID_LIST_LISTENER =
 (SID_LIST =
  (SID_DESC =
   (SID_NAME=PLSExtProc)
   (ENVS=EXTPROC_DLLS=C:\app\oracle\product\18.0.0\dbhome_1\rdbms\extproc\extern.dll)
   (ORACLE_HOME=C:\app\oracle\product\18.0.0\dbhome_1)
   (PROGRAM=extproc)
  )
 )
</pre></div>
                     </li>
                     <li class="stepexpand"><span>Start SQL*Plus:</span><div><pre class="oac_no_warn" dir="ltr">C:\&gt; sqlplus
</pre></div>
                     </li>
                     <li class="stepexpand"><span>Connect to the database with appropriate username and password.</span></li>
                     <li class="stepexpand"><span>Create the PL/SQL library using the <code class="codeph">CREATE LIBRARY</code> command:</span><div><pre class="oac_no_warn" dir="ltr">DBMS_CREDENTIAL.CREATE_CREDENTIAL(...);
CREATE DIRECTORY DLL_LOC as ...;
CREATE LIBRARY externProcedures as 'extern.dll' in DLL_LOC credential the_credential;
</pre><p>where <code class="codeph">the_credential</code> is the name chosen during the <code class="codeph">DBMS_CREDENTIAL.CREATE_CREDENTIAL</code> invocation
                           </p><pre class="oac_no_warn" dir="ltr">SQL&gt; CREATE LIBRARY externProcedures AS 'C:\app\oracle\product\18.0.0\dbhome_1\rdbms\ extproc\extern.dll';
</pre><p>where  <code class="codeph">externProcedures</code> is an alias library (essentially a schema object in the database), and 
                           </p><pre class="oac_no_warn" dir="ltr">C:\app\oracle\product\18.0.0\dbhome_1\rdbms\extproc\extern.dll
</pre><p>is the path to the Windows operating system <code class="codeph">dllextern.dll</code>. This example uses <code class="codeph">C:\app\oracle\product\18.0.0</code> as your Oracle base and <code class="codeph">dbhome_1</code> as your Oracle home.
                           </p>
                           <div class="infoboxnote" id="GUID-7BC71588-E0C0-46EC-8C1A-AFB16C61269C__GUID-9878126D-B441-461A-A23D-0BC1F8DB8A52">
                              <p class="notep1">Note:</p>
                              <p><a id="d45115e1077" class="indexterm-anchor"></a><a id="d45115e1081" class="indexterm-anchor"></a>The DBA must grant the <code class="codeph">EXECUTE</code> privilege on the PL/SQL library to users who want to call the library's external procedure from PL/SQL or SQL. Separate <code class="codeph">EXECUTE</code> privilege on credential and directory object extensions are required for them to function properly.
                              </p>
                           </div>
                        </div>
                     </li>
                     <li class="stepexpand"><span><a id="d45115e1092" class="indexterm-anchor"></a><a id="d45115e1096" class="indexterm-anchor"></a>Create a PL/SQL program unit specification.</span><div>
                           <p>Do this by writing a PL/SQL subprogram that uses the <code class="codeph">EXTERNAL</code> clause instead of declarations and a <code class="codeph">BEGIN...END</code> block. The <code class="codeph">EXTERNAL</code> clause is the interface between PL/SQL and the external procedure. The <code class="codeph">EXTERNAL</code> clause identifies the following information about the external procedure:
                           </p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Name</p>
                              </li>
                              <li>
                                 <p>DLL alias</p>
                              </li>
                              <li>
                                 <p>Programming language in which it was written</p>
                              </li>
                              <li>
                                 <p>Calling standard (defaults to C if omitted)</p>
                              </li>
                           </ul>
                           <p>In the following example, <code class="codeph">externProcedures</code> is a DLL alias. You need the <code class="codeph">EXECUTE</code> privilege for this library. The external procedure to call is <code class="codeph">find_max</code>. If enclosed in double quotation marks, it becomes case-sensitive. The <code class="codeph">LANGUAGE</code> term specifies the language in which the external procedure was written.
                           </p><pre class="oac_no_warn" dir="ltr">CREATE OR REPLACE FUNCTION PLS_MAX(
  x BINARY_INTEGER,
  y BINARY_INTEGER)
RETURN BINARY_INTEGER AS EXTERNAL
  LIBRARY externProcedures
  NAME "find_max"
  LANGUAGE C
  PARAMETERS (
    x long,                  -- stores value of x
    x_INDICATOR short,       -- used to determine if x is a NULL value
    y long,                  -- stores value of y
    y_INDICATOR short,        -- used to determine if y is a NULL value
  RETURN INDICATOR short );  -- need to pass pointer to return value's
                             -- indicator variable to determine if NULL
-- This means that my function is defined as:
    -- long max(long x, short x_indicator,
    -- long y, short y_indicator, short * ret_indicator)</pre></div>
                     </li>
                  </ol>
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="about-building-external-procedures.html#GUID-DB15FD29-A121-4B3F-B422-1C8BF3FB696D" title="Describes how to create and use external procedures on Windows.">About Building External Procedures</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="NTQRF666"></a><div class="props_rev_3"><a id="GUID-51F6B56D-F53E-48AF-B7E4-913B8BD059E3" name="GUID-51F6B56D-F53E-48AF-B7E4-913B8BD059E3"></a><h3 id="NTQRF-GUID-51F6B56D-F53E-48AF-B7E4-913B8BD059E3" class="sect3">Restricting Library-Related Privileges to Trusted Users Only</h3>
               <div>
                  <p>The <code class="codeph">CREATE LIBRARY</code>, <code class="codeph">CREATE ANY LIBRARY</code>, <code class="codeph">ALTER ANY LIBRARY</code>, and <code class="codeph">EXECUTE ANY LIBRARY</code> privileges, and grants of <code class="codeph">EXECUTE ON</code> <span class="italic"><code class="codeph">library_name</code></span> convey a great deal of power to users. 
                  </p>
                  <div class="section">
                     <p>If you plan to create PL/SQL interfaces to libraries, only grant the <code class="codeph">EXECUTE</code> privilege to the PL/SQL interface. Do not grant <code class="codeph">EXECUTE</code> on the underlying library. You must have the <code class="codeph">EXECUTE</code> privilege on a library to create the PL/SQL interface to it. However, users have this privilege implicitly on libraries that they create in their own schemas. Explicit grants of <code class="codeph">EXECUTE ON</code> <span class="italic"><code class="codeph">library_name</code></span> are rarely required. Only make an explicit grant of these privileges to trusted users, and never to the <code class="codeph">PUBLIC</code> role.
                     </p>
                  </div>
                  <!-- class="section" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="about-building-external-procedures.html#GUID-DB15FD29-A121-4B3F-B422-1C8BF3FB696D" title="Describes how to create and use external procedures on Windows.">About Building External Procedures</a></p>
                     </div>
                  </div>
               </div>
               
            </div><a id="NTQRF486"></a><div class="props_rev_3"><a id="GUID-65F40B02-BD9B-4F10-A869-47BA705D5A8D" name="GUID-65F40B02-BD9B-4F10-A869-47BA705D5A8D"></a><h3 id="NTQRF-GUID-65F40B02-BD9B-4F10-A869-47BA705D5A8D" class="sect3">Executing an External Procedure</h3>
               <div>
                  <p>To run an external procedure, you must call the PL/SQL program unit (that is, the alias for the external function) that registered the external procedure. </p>
                  <div class="section">
                     <p>These calls can appear in any of the following:</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Anonymous blocks</p>
                        </li>
                        <li>
                           <p>Standalone and packaged subprograms</p>
                        </li>
                        <li>
                           <p>Methods of an object type</p>
                        </li>
                        <li>
                           <p>Database triggers</p>
                        </li>
                        <li>
                           <p>SQL statements (calls to packaged functions only)</p>
                        </li>
                     </ul>
                     <p>In “Registering an External Procedure”, PL/SQL function <code class="codeph">PLS_MAX</code> registered external procedure <code class="codeph">find_max</code><span class="bold">.</span> Follow these steps to run <code class="codeph">find_max</code>:
                     </p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>Call PL/SQL function <code class="codeph">PLS_MAX</code> from a PL/SQL routine named <code class="codeph">UseIt</code>:</span><div><pre class="oac_no_warn" dir="ltr">SET SERVER OUTPUT ON
CREATE OR REPLACE PROCEDURE UseIt AS
         	a integer;
         	b integer;
         	c integer;
BEGIN
         	a := 1;
         	b := 2;
         	c := PLS_MAX(a,b);
         	dbms_output.put_line('The maximum of '||a||' and '||b||' is  '||c);
END;
</pre></div>
                     </li>
                     <li class="stepexpand"><span>Run the routine:</span><div><pre class="oac_no_warn" dir="ltr">SQL&gt; EXECUTE UseIt;</pre></div>
                     </li>
                  </ol>
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="about-building-external-procedures.html#GUID-7BC71588-E0C0-46EC-8C1A-AFB16C61269C" title="Once you have built a DLL containing your external procedures, you must register your external procedures with Oracle Database.">Registering an External Procedure</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="about-building-external-procedures.html#GUID-DB15FD29-A121-4B3F-B422-1C8BF3FB696D" title="Describes how to create and use external procedures on Windows.">About Building External Procedures</a></p>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>