<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="SODA collections are highly configurable. You can customize collection metadata, to obtain different behavior from that provided by default.">
      <meta name="description" content="SODA collections are highly configurable. You can customize collection metadata, to obtain different behavior from that provided by default.">
      <title>SODA Collection Configuration Using Custom Metadata</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="SODA for PL/SQL Developer's Guide">
      <meta property="og:description" content="SODA collections are highly configurable. You can customize collection metadata, to obtain different behavior from that provided by default.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="SODA for PL/SQL Developer's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.2.2">
      <link rel="alternate" href="oracle-database-soda-pl-sql-developers-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2019-02-25T09:39:58-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2018, 2019">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E84719-04">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/18">
      
      <link rel="prev" href="using-soda-pl-sql.html" title="Previous" type="text/html">
      <link rel="next" href="book-index.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"18","element_name":"Release 18","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="OracleÂ® Database SODA for PL/SQL Developer's Guide">
    <meta name="dcterms.isVersionOf" content="ADSDP">
    <meta name="dcterms.release" content="Release 18">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="using-soda-pl-sql.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="book-index.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">SODA for PL/SQL Developer's Guide</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">SODA Collection Configuration Using Custom Metadata</li>
            </ol>
            <a id="GUID-D17E8D3C-EE74-49CD-84AA-CE86B9664554" name="GUID-D17E8D3C-EE74-49CD-84AA-CE86B9664554"></a>
            
            <h2 id="ADSDP-GUID-D17E8D3C-EE74-49CD-84AA-CE86B9664554" class="sect2"><span class="enumeration_chapter">4 </span>SODA Collection Configuration Using Custom Metadata
            </h2>
         </header>
         <div class="ind">
            <div>
               <p>SODA collections are highly configurable. You can customize collection metadata, to obtain different behavior from that provided by default.</p>
               <div class="infoboxnote" id="GUID-D17E8D3C-EE74-49CD-84AA-CE86B9664554__GUID-CA214E29-8204-406D-883C-F2D875EDAC64">
                  <p class="notep1">Note:</p>
                  <p>You can customize collection metadata to obtain different behavior from that provided by default. However, changing some components requires familiarity with Oracle Database concepts, such as SQL data types. Oracle recommends that you do not change such components unless you have a compelling reason. Because SODA collections are implemented on top of Oracle Database tables (or views), many collection configuration components are related to the underlying table configuration.</p>
                  <p>For example, if you change the content column type from <code class="codeph">BLOB</code> (the default value) to <code class="codeph">VARCHAR2</code> then you must understand the implications (content size for <code class="codeph">VARCHAR2</code> is limited to 32K bytes, character-set conversion can take place, and so on).
                  </p>
               </div>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="soda-collection-configuration-using-custom-metadata.html#GUID-30D97FE4-21F7-4B72-B634-B941E7E0F635">Getting the Metadata of an Existing Collection</a><br>You use <code class="codeph">SODA_COLLECTION_T</code> method <code class="codeph">get_metadata()</code> to get all of the metadata for a collection, as a JSON document.
                  </li>
                  <li class="ulchildlink"><a href="soda-collection-configuration-using-custom-metadata.html#GUID-1973425A-F505-433F-9B2D-7003902A823E">Creating a Collection That Has Custom Metadata</a><br>To create a document collection that has custom metadata, you pass its metadata, as JSON data, to PL/SQL function <code class="codeph">DBMS_SODA.create_collection</code>.
                  </li>
               </ul>
               <div class="infoboxnotealso" id="GUID-D17E8D3C-EE74-49CD-84AA-CE86B9664554__GUID-6E00E4A1-DE5A-4EF0-86F7-5D8D5D878C49">
                  <p class="notep1">See Also:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="../adsdi/overview-soda.html#ADSDI-GUID-C107707F-E135-493F-9112-98691C80D3E9" target="_blank"><span><cite>Oracle Database Introduction to Simple Oracle Document Access (SODA)</cite></span></a> for general information about SODA document collections and their metadata
                        </p>
                     </li>
                     <li>
                        <p><a href="../adsdi/soda-collection-metadata-components-reference.html#ADSDI-GUID-49EFF3D3-9FAB-4DA6-BDE2-2650383566A3" target="_blank"><span><cite>Oracle Database Introduction to Simple Oracle Document Access (SODA)</cite></span></a> for reference information about collection metadata components
                        </p>
                     </li>
                  </ul>
               </div>
            </div>
            
            <div class="sect2"><a id="GUID-30D97FE4-21F7-4B72-B634-B941E7E0F635" name="GUID-30D97FE4-21F7-4B72-B634-B941E7E0F635"></a><h3 id="ADSDP-GUID-30D97FE4-21F7-4B72-B634-B941E7E0F635" class="sect3"><span class="enumeration_section">4.1 </span>Getting the Metadata of an Existing Collection
               </h3>
               <div>
                  <p>You use <code class="codeph">SODA_COLLECTION_T</code> method <code class="codeph">get_metadata()</code> to get all of the metadata for a collection, as a JSON document.
                  </p>
                  <div class="section">
                     <div class="infoboxnotealso" id="GUID-30D97FE4-21F7-4B72-B634-B941E7E0F635__ORACLEDATABASESQLLANGUAGEREFERENCEF-1833B117">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="../arpls/SODA_TYPES.html#ARPLS-GUID-C27EB17B-E716-43FC-9B13-1440687DCAC9" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for information about <code class="codeph">SODA_COLLECTION_T</code> method <code class="codeph">get_metadata()</code></p>
                           </li>
                           <li>
                              <p><a href="../sqlrf/JSON_QUERY.html#SQLRF-GUID-6D396EC4-D2AA-43D2-8F5D-08D646A4A2D9" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for information about SQL/JSON function <code class="codeph">json_query</code></p>
                              <p></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-30D97FE4-21F7-4B72-B634-B941E7E0F635__GETTINGTHEMETADATAOFACOLLECTION-0F850EEB">
                     <p class="titleinexample">Example 4-1 Getting the Metadata of a Collection</p>
                     <p>This example shows the result of invoking <code class="codeph">SODA_COLLECTION_T</code> method <code class="codeph">get_metadata()</code> on the collection with the default configuration that was created using <a href="using-soda-pl-sql.html#GUID-AC1A88D5-8C89-492D-AC57-E6F3694F6D96__CREATINGACOLLECTIONTHATHASTHEDEFAUL-0F85688A">Example 3-3</a>. (It also uses SQL/JSON function <code class="codeph">json_query</code>, with keyword <code class="codeph">PRETTY</code>, to pretty-print the JSON data obtained.)
                     </p><pre class="pre codeblock"><code>DECLARE
    collection  SODA_COLLECTION_T;
BEGIN
    collection := DBMS_SODA.open_collection('myCollectionName');
    IF collection IS NULL THEN
        DBMS_OUTPUT.put_line('Collection does not exist');
    ELSE
        DBMS_OUTPUT.put_line('Metadata: '
                             || json_query(collection.<span class="bold">get_metadata</span>, '$' <span class="bold">PRETTY</span>));
    END IF;
END;
/</code></pre></div>
                  <!-- class="example" -->
                  <div class="example" id="GUID-30D97FE4-21F7-4B72-B634-B941E7E0F635__EXAMPLE-143-0F85E47A">
                     <p class="titleinexample">Example 4-2 Default Collection Metadata</p><pre class="pre codeblock"><code>{
   "schemaName" : "mySchemaName",
   "tableName" : "myTableName",
   "keyColumn" :
   {
      "name" : "ID",
      "sqlType" : "VARCHAR2",
      "maxLength" : 255,
      "assignmentMethod" : "UUID"
   },
   "contentColumn" :
   {
      "name" : "JSON_DOCUMENT",
      "sqlType" : "BLOB",
      "compress" : "NONE",
      "cache" : true,
      "encrypt" : "NONE",
      "validation" : "STANDARD"
   },
   "versionColumn" :
   {
     "name" : "VERSION",
     "method" : "SHA256"
   },
   "lastModifiedColumn" :
   {
     "name" : "LAST_MODIFIED"
   },
   "creationTimeColumn" :
   {
      "name" : "CREATED_ON"
   },
   "readOnly" : false
}</code></pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="soda-collection-configuration-using-custom-metadata.html#GUID-D17E8D3C-EE74-49CD-84AA-CE86B9664554" title="SODA collections are highly configurable. You can customize collection metadata, to obtain different behavior from that provided by default.">SODA Collection Configuration Using Custom Metadata</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
            <div class="sect2"><a id="GUID-1973425A-F505-433F-9B2D-7003902A823E" name="GUID-1973425A-F505-433F-9B2D-7003902A823E"></a><h3 id="ADSDP-GUID-1973425A-F505-433F-9B2D-7003902A823E" class="sect3"><span class="enumeration_section">4.2 </span>Creating a Collection That Has Custom Metadata
               </h3>
               <div>
                  <p>To create a document collection that has custom metadata, you pass its metadata, as JSON data, to PL/SQL function <code class="codeph">DBMS_SODA.create_collection</code>.
                  </p>
                  <div class="section">
                     <p>The optional second argument to PL/SQL function <code class="codeph">DBMS_SODA.create_collection</code> is a SODA <strong class="term">collection specification</strong>. It is JSON data that specifies the metadata for the new collection.
                     </p>
                     <p>If a collection with the same name already exists then it is simply opened and its handle is returned. If the custom metadata provided does not match the metadata of the existing collection then the collection is not opened and an error is raised. (To match, all metadata fields must have the same values.)</p>
                     <div class="infoboxnotealso" id="GUID-1973425A-F505-433F-9B2D-7003902A823E__GUID-DA9BF410-4B12-4175-AAC6-CCB156AE4632">
                        <p class="notep1">See Also:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="../arpls/DBMS_SODA.html#ARPLS-GUID-ACD8298F-9EFC-4261-8639-4279FB8D63B3" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a> for information about PL/SQL function <code class="codeph">DBMS_SODA.create_collection</code></p>
                           </li>
                           <li>
                              <p><a href="../arpls/SODA_TYPES.html#ARPLS-GUID-C27EB17B-E716-43FC-9B13-1440687DCAC9" target="_blank"><span><cite>Oracle Database PL/SQL Packages and Types Reference</cite></span></a>  for information about <code class="codeph">SODA_COLLECTION_T</code> method <code class="codeph">get_metadata()</code></p>
                           </li>
                           <li>
                              <p><a href="../sqlrf/JSON_QUERY.html#SQLRF-GUID-6D396EC4-D2AA-43D2-8F5D-08D646A4A2D9" target="_blank"><span><cite>Oracle Database SQL Language Reference</cite></span></a> for information about SQL/JSON function <code class="codeph">json_query</code></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
                  <div class="example" id="GUID-1973425A-F505-433F-9B2D-7003902A823E__THISEXAMPLECREATESACOLLECTIONWITHCU-0F79AE8E">
                     <p class="titleinexample">Example 4-3 Creating a Collection That Has Custom Metadata</p>
                     <p>This example creates a collection with custom metadata that specifies two metadata columns, named <code class="codeph">KEY</code> (for document keys), and <code class="codeph">JSON</code> (for document content type JSON). The key assignment method is <code class="codeph">CLIENT</code>, and the content-column SQL data type is <code class="codeph">VARCHAR2</code>. The example uses <code class="codeph">SODA_COLLECTION_T</code> method <code class="codeph">get_metadata()</code> to get the complete metadata from the newly created collection, which it passes to SQL/JSON function <code class="codeph">json_query</code> to pretty-print (using keyword <code class="codeph">PRETTY</code>).
                     </p><pre class="pre codeblock"><code>DECLARE
    collection SODA_COLLECTION_T;
    <span class="bold">metadata</span> VARCHAR2(4000) :=
      '{"<span class="bold">keyColumn</span>" : {"<span class="bold">name</span>" : "KEY",  "<span class="bold">assignmentMethod</span>": "CLIENT" },
        "<span class="bold">contentColumn</span>" : { "<span class="bold">name</span>" : "JSON", "<span class="bold">sqlType</span>": "VARCHAR2" } }';
BEGIN
    collection := DBMS_SODA.<span class="bold">create_collection</span>('myCustomCollection', <span class="bold">metadata</span>);
    DBMS_OUTPUT.put_line('Collection specification: ' ||
                         json_query(collection.<span class="bold">get_metadata</span>, '$' <span class="bold">PRETTY</span>));
END;
/
</code></pre><p>This is the pretty-printed output. The values of fields for <code class="codeph">keyColumn</code> and <code class="codeph">contentColumn</code> that are not specified in the collection specification are defaulted. The values of fields other than those provided in the collection specification (<code class="codeph">keyColumn</code> and <code class="codeph">contentColumn</code>) are also defaulted. The value of field <code class="codeph">tableName</code> is defaulted from the collection name. The value of field <code class="codeph">schemaName</code> is the database schema (user) that is current when the collection is created.
                     </p><pre class="pre codeblock"><code>Collection specification: {
  "schemaName" : "mySchemaName",
  "tableName" : "myCustomCollection",
  "<span class="bold">keyColumn</span>" :
  {
    "<span class="bold">name</span>" : "KEY",
    "sqlType" : "VARCHAR2",
    "maxLength" : 255,
    "<span class="bold">assignmentMethod</span>" : "CLIENT"
  },

"<span class="bold">contentColumn</span>" :
  {
    "<span class="bold">name</span>" : "JSON",
    "<span class="bold">sqlType</span>" : "VARCHAR2",
    "maxLength" : 4000,
    "validation" : "STANDARD"
  },
  "readOnly" : false
}</code></pre></div>
                  <!-- class="example" -->
               </div>
               <div>
                  <div class="relinfo">
                     <p><strong>Related Topics</strong></p>
                     <ul>
                        <li><a href="using-soda-pl-sql.html#GUID-AC1A88D5-8C89-492D-AC57-E6F3694F6D96" title="You can use PL/SQL function DBMS_SODA.create_collection to create a document collection with the default metadata.">Creating a Document Collection with SODA for PL/SQL</a></li>
                     </ul>
                  </div>
                  <div class="familylinks">
                     <div class="parentlink">
                        <p><strong>Parent topic:</strong> <a href="soda-collection-configuration-using-custom-metadata.html#GUID-D17E8D3C-EE74-49CD-84AA-CE86B9664554" title="SODA collections are highly configurable. You can customize collection metadata, to obtain different behavior from that provided by default.">SODA Collection Configuration Using Custom Metadata</a></p>
                     </div>
                  </div>
               </div>
               
            </div>
         </div>
      </article>
   </body>
</html>