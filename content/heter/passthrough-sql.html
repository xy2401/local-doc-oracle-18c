<!DOCTYPE html
  SYSTEM "about:legacy-compat">

<!-- saved from url=(0023)https://docs.oracle.com -->

<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="abstract" content="The passthrough SQL feature enables you to send a statement directly to a non-Oracle system without first being interpreted by Oracle Database.">
      <meta name="description" content="The passthrough SQL feature enables you to send a statement directly to a non-Oracle system without first being interpreted by Oracle Database.">
      <title>Passthrough SQL</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Heterogeneous Connectivity User's Guide">
      <meta property="og:description" content="The passthrough SQL feature enables you to send a statement directly to a non-Oracle system without first being interpreted by Oracle Database.">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Heterogeneous Connectivity User's Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.1.1">
      <link rel="alternate" href="heterogeneous-connectivity-users-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2018-01-31T12:46:21-08:00">
      <meta name="dcterms.title" content="Heterogeneous Connectivity User's Guide">
      <meta name="dcterms.dateCopyrighted" content="2001, 2018">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E84323-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/18">
      <meta name="dcterms.release" content="Release 18">
      <link rel="prev" href="heterogeneous-replication.html" title="Previous" type="text/html">
      <link rel="next" href="result-set-support.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"18","element_name":"Release 18","display_in_url":true}}}</script>
      
    <meta name="dcterms.isVersionOf" content="HETER">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="heterogeneous-replication.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="result-set-support.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Heterogeneous Connectivity User's Guide</span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="oracle-database-gateways-features.html" property="item" typeof="WebPage"><span property="name"> Features of Oracle Database Gateways</span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem">Passthrough SQL</li>
            </ol>
            <a id="GUID-C03895FB-EE60-4F71-8943-994C185C2EB2" name="GUID-C03895FB-EE60-4F71-8943-994C185C2EB2"></a><a id="HETER4049"></a>
            
            <h2 id="HETER-GUID-C03895FB-EE60-4F71-8943-994C185C2EB2" class="sect2">Passthrough SQL</h2>
         </header>
         <div class="ind">
            <div>
               <p>The passthrough SQL feature enables you to send a statement directly to a non-Oracle system without first being interpreted by Oracle Database. </p>
               <p><a id="d3108e33" class="indexterm-anchor"></a><a id="d3108e39" class="indexterm-anchor"></a><a id="d3108e45" class="indexterm-anchor"></a> <a id="d3108e50" class="indexterm-anchor"></a>This feature can be useful if the non-Oracle system allows for operations in statements for which there is no equivalent in Oracle. 
               </p>
            </div>
            <div>
               <ul class="ullinks">
                  <li class="ulchildlink"><a href="passthrough-sql.html#GUID-C9A8CC1A-ABB1-46F0-81C2-11C6014FC5DB">DBMS_HS_PASSTHROUGH Package</a><br>You can execute passthrough SQL statements directly on the non-Oracle system using the PL/SQL package <code class="codeph">DBMS_HS_PASSTHROUGH</code>. 
                  </li>
                  <li class="ulchildlink"><a href="passthrough-sql.html#GUID-3D0E0A6A-D3DA-46BD-88FD-A7A63BD74A4C">Implications of Using Passthrough SQL</a><br>When you execute a passthrough SQL statement that implicitly commits or rolls back a transaction in a non-Oracle system, the transaction is affected.
                  </li>
                  <li class="ulchildlink"><a href="passthrough-sql.html#GUID-54AD0928-3148-43BA-8840-2661937F4C40">Executing Passthrough SQL Statements</a><br>This section describes the functions and procedures provided by the <code class="codeph">DBMS_HS_PASSTHROUGH</code> package that enable you to execute passthrough SQL statements.
                  </li>
               </ul>
            </div>
            <a id="HETER4050"></a><div class="props_rev_3"><a id="GUID-C9A8CC1A-ABB1-46F0-81C2-11C6014FC5DB" name="GUID-C9A8CC1A-ABB1-46F0-81C2-11C6014FC5DB"></a><h3 id="HETER-GUID-C9A8CC1A-ABB1-46F0-81C2-11C6014FC5DB" class="sect3">DBMS_HS_PASSTHROUGH Package</h3>
               <div>
                  <p>You can execute passthrough SQL statements directly on the non-Oracle system using the PL/SQL package <code class="codeph">DBMS_HS_PASSTHROUGH</code>. 
                  </p>
                  <div class="section">
                     <p><a id="d3108e114" class="indexterm-anchor"></a>Any statement executed with this package is executed in the same transaction as standard SQL statements.
                     </p>
                     <p>The <code class="codeph">DBMS_HS_PASSTHROUGH</code> package is a virtual package. It conceptually resides on the non-Oracle system. In reality, however, calls to this package are intercepted by Heterogeneous Services and are mapped to one or more Heterogeneous Services calls. The driver then maps these Heterogeneous Services calls to the API of the non-Oracle system. The client application invokes the procedures in the package through a database link in the same way as it would invoke a non-Oracle system stored procedure. The special processing done by Heterogeneous Services is transparent to the user.
                     </p>
                     <div class="infoboxnotealso" id="GUID-C9A8CC1A-ABB1-46F0-81C2-11C6014FC5DB__GUID-0175A0D7-6DB8-444A-90AD-20415B76B63B">
                        <p class="notep1">See Also:</p>
                        <p><a href="../arpls/DBMS_HS_PASSTHROUGH.html#ARPLS017"><span class="italic">Oracle Database PL/SQL Packages and Types Reference </span></a>for more information about this package
                        </p>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="HETER4051"></a><div class="props_rev_3"><a id="GUID-3D0E0A6A-D3DA-46BD-88FD-A7A63BD74A4C" name="GUID-3D0E0A6A-D3DA-46BD-88FD-A7A63BD74A4C"></a><h3 id="HETER-GUID-3D0E0A6A-D3DA-46BD-88FD-A7A63BD74A4C" class="sect3">Implications of Using Passthrough SQL</h3>
               <div>
                  <p>When you execute a passthrough SQL statement that implicitly commits or rolls back a transaction in a non-Oracle system, the transaction is affected.</p>
                  <p><a id="d3108e151" class="indexterm-anchor"></a><a id="d3108e155" class="indexterm-anchor"></a>For example, some systems implicitly commit the transaction containing a data definition language (DDL) statement. Because Oracle Database is bypassed, Oracle Database is unaware that a transaction was committed in the non-Oracle system. Consequently, the data at the non-Oracle system can be committed, while the transaction in Oracle Database is not. 
                  </p>
                  <p>If the transaction in Oracle Database is rolled back, data inconsistencies between Oracle Database and the non-Oracle system can occur. This situation results in <span class="bold">global data inconsistency.</span> 
                  </p>
                  <p>Note that if the application executes a typical <code class="codeph">COMMIT</code> statement, Oracle Database can coordinate the distributed transaction with the non-Oracle system. The statement executed with the passthrough facility is part of the distributed transaction.
                  </p>
               </div>
            </div><a id="HETER4052"></a><div class="props_rev_3"><a id="GUID-54AD0928-3148-43BA-8840-2661937F4C40" name="GUID-54AD0928-3148-43BA-8840-2661937F4C40"></a><h3 id="HETER-GUID-54AD0928-3148-43BA-8840-2661937F4C40" class="sect3">Executing Passthrough SQL Statements</h3>
               <div>
                  <p>This section describes the functions and procedures provided by the <code class="codeph">DBMS_HS_PASSTHROUGH</code> package that enable you to execute passthrough SQL statements.
                  </p>
                  <div class="section"></div>
                  <!-- class="section" -->
                  <div class="tblformalwide" id="GUID-54AD0928-3148-43BA-8840-2661937F4C40__GUID-E8B4438F-A73B-43AF-875F-4E1E842A0A71">
                     <p class="titleintable">Table 3-1 DBMS_HS_PASSTHROUGH Functions and Procedures</p>
                     <table cellpadding="4" cellspacing="0" class="FormalWide" title="DBMS_HS_PASSTHROUGH Functions and Procedures" summary="This is a 2 column table describing the functions and procedures provided by the DBMS_HS_PASSTHROUGH package. Column 1 is the name of the function or procedure. Column 2 is a description of the function or procedure." width="100%" frame="hsides" border="1" rules="rows">
                        <thead>
                           <tr align="left" valign="top">
                              <th align="left" valign="bottom" width="39%" id="d3108e210">Procedure/Function</th>
                              <th align="left" valign="bottom" width="61%" id="d3108e213">Description</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="39%" id="d3108e218" headers="d3108e210 ">
                                 <p><code class="codeph">OPEN_CURSOR</code></p>
                              </td>
                              <td align="left" valign="top" width="61%" headers="d3108e218 d3108e213 ">
                                 <p>Opens a cursor.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="39%" id="d3108e226" headers="d3108e210 ">
                                 <p><code class="codeph">CLOSE_CURSOR</code></p>
                              </td>
                              <td align="left" valign="top" width="61%" headers="d3108e226 d3108e213 ">
                                 <p>Closes a cursor.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="39%" id="d3108e234" headers="d3108e210 ">
                                 <p><code class="codeph">PARSE</code></p>
                              </td>
                              <td align="left" valign="top" width="61%" headers="d3108e234 d3108e213 ">
                                 <p>Parses the statement.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="39%" id="d3108e242" headers="d3108e210 ">
                                 <p><code class="codeph">BIND_VARIABLE</code></p>
                              </td>
                              <td align="left" valign="top" width="61%" headers="d3108e242 d3108e213 ">
                                 <p>Binds <code class="codeph">IN</code> variables.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="39%" id="d3108e253" headers="d3108e210 ">
                                 <p><code class="codeph">BIND_OUT_VARIABLE</code></p>
                              </td>
                              <td align="left" valign="top" width="61%" headers="d3108e253 d3108e213 ">
                                 <p>Binds <code class="codeph">OUT</code> variables.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="39%" id="d3108e264" headers="d3108e210 ">
                                 <p><code class="codeph">BIND_INOUT_VARIABLE</code></p>
                              </td>
                              <td align="left" valign="top" width="61%" headers="d3108e264 d3108e213 ">
                                 <p>Binds <code class="codeph">IN OUT</code> variables.
                                 </p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="39%" id="d3108e275" headers="d3108e210 ">
                                 <p><code class="codeph">EXECUTE_NON_QUERY</code></p>
                              </td>
                              <td align="left" valign="top" width="61%" headers="d3108e275 d3108e213 ">
                                 <p>Executes a nonquery statement.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="39%" id="d3108e283" headers="d3108e210 ">
                                 <p><code class="codeph">EXECUTE_IMMEDIATE</code></p>
                              </td>
                              <td align="left" valign="top" width="61%" headers="d3108e283 d3108e213 ">
                                 <p>Executes a nonquery statement without bind variables.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="39%" id="d3108e291" headers="d3108e210 ">
                                 <p><code class="codeph">FETCH_ROW</code></p>
                              </td>
                              <td align="left" valign="top" width="61%" headers="d3108e291 d3108e213 ">
                                 <p>Fetches rows from query.</p>
                              </td>
                           </tr>
                           <tr align="left" valign="top">
                              <td align="left" valign="top" width="39%" id="d3108e299" headers="d3108e210 ">
                                 <p><code class="codeph">GET_VALUE</code></p>
                              </td>
                              <td align="left" valign="top" width="61%" headers="d3108e299 d3108e213 ">
                                 <p>Retrieves column value from <code class="codeph">SELECT</code> statement or retrieves <code class="codeph">OUT</code> bind parameters.
                                 </p>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <!-- class="inftblhruleinformal" -->
               </div>
               <div>
                  <ul class="ullinks">
                     <li class="ulchildlink"><a href="passthrough-sql.html#GUID-576AA232-B946-4C77-9A6F-037593614CFC">Executing Nonqueries</a><br>Nonqueries include the statements <code class="codeph">INSERT</code>, <code class="codeph">UPDATE</code>, and <code class="codeph">DELETE</code> and other DDL types of statements.
                     </li>
                     <li class="ulchildlink"><a href="passthrough-sql.html#GUID-AADA1C44-98BF-4890-BA49-55CDD7144A59">Executing Queries</a><br>Use passthrough SQL to execute queries.
                     </li>
                  </ul>
               </div>
               <a id="HETER4053"></a><div class="props_rev_3"><a id="GUID-576AA232-B946-4C77-9A6F-037593614CFC" name="GUID-576AA232-B946-4C77-9A6F-037593614CFC"></a><h4 id="HETER-GUID-576AA232-B946-4C77-9A6F-037593614CFC" class="sect4">Executing Nonqueries</h4>
                  <div>
                     <p>Nonqueries include the statements <code class="codeph">INSERT</code>, <code class="codeph">UPDATE</code>, and <code class="codeph">DELETE</code> and other DDL types of statements.
                     </p>
                     <div class="section">
                        <p>To execute <a id="d3108e373" class="indexterm-anchor"></a>nonquery statements, use the <code class="codeph">EXECUTE_IMMEDIATE</code> function. For example, to execute a DDL statement on a non-Oracle system that you can access using the database link <code class="codeph">salesdb</code>, enter the following:
                        </p><pre class="oac_no_warn" dir="ltr">DECLARE
  num_rows INTEGER;

BEGIN
  num_rows := DBMS_HS_PASSTHROUGH.EXECUTE_IMMEDIATE@salesdb
            ('CREATE TABLE dept1 (n SMALLINT, loc CHARACTER(10))');
END;

</pre><p>The variable <span class="italic"><code class="codeph">num_rows</code></span> is assigned the number of rows affected by the statements that were executed. For DDL statements, zero is returned. Note that you cannot execute a query with <a id="d3108e394" class="indexterm-anchor"></a><code class="codeph">EXECUTE_IMMEDIATE</code> function and you cannot use bind variables.
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
                  <div>
                     <ul class="ullinks">
                        <li class="ulchildlink"><a href="passthrough-sql.html#GUID-02A630D5-3533-4819-A8F6-EC4FFB5899CC">Overview of Bind Variables</a><br>Bind variables let you use the same SQL statement multiple times with different values, reducing the number of times a SQL statement needs to be parsed.
                        </li>
                        <li class="ulchildlink"><a href="passthrough-sql.html#GUID-16743824-9784-437E-9DCA-411EEE3D81C9">IN Bind Variables</a><br>The syntax of the non-Oracle system determines how a statement specifies a <code class="codeph">IN</code> bind variable.
                        </li>
                        <li class="ulchildlink"><a href="passthrough-sql.html#GUID-D14E12B8-6433-434E-BF95-3E4F67FC0C07">OUT Bind Variables</a><br>The non-Oracle system can support <code class="codeph">OUT</code> bind variables.
                        </li>
                        <li class="ulchildlink"><a href="passthrough-sql.html#GUID-C77A1E92-2FAF-4987-A3F5-412EBB8D21C0">IN OUT Bind Variables</a><br>A bind variable can be both an <code class="codeph">IN</code> and an <code class="codeph">OUT</code> variable.
                        </li>
                     </ul>
                  </div>
                  <a id="HETER4055"></a><a id="HETER4054"></a><div class="props_rev_3"><a id="GUID-02A630D5-3533-4819-A8F6-EC4FFB5899CC" name="GUID-02A630D5-3533-4819-A8F6-EC4FFB5899CC"></a><h5 id="HETER-GUID-02A630D5-3533-4819-A8F6-EC4FFB5899CC" class="sect5">Overview of Bind Variables</h5>
                     <div>
                        <p>Bind variables let you use the same SQL statement multiple times with different values, reducing the number of times a SQL statement needs to be parsed.</p>
                        <p>For example, when you <a id="d3108e472" class="indexterm-anchor"></a>insert four rows in a table, you can parse the SQL statement once, and bind and execute the SQL statement for each row. One SQL statement can have zero or more bind variables. 
                        </p>
                        <p>To execute <a id="d3108e479" class="indexterm-anchor"></a>passthrough SQL statements with bind variables, you must:
                        </p>
                        <ol>
                           <li>
                              <p>Open a cursor.</p>
                           </li>
                           <li>
                              <p>Parse the SQL statement on the non-Oracle system.</p>
                           </li>
                           <li>
                              <p>Bind the variables.</p>
                           </li>
                           <li>
                              <p>Execute the SQL statement on the non-Oracle system.</p>
                           </li>
                           <li>
                              <p>Close the cursor.</p>
                           </li>
                        </ol>
                        <p><a href="passthrough-sql.html#GUID-02A630D5-3533-4819-A8F6-EC4FFB5899CC__I1006184">Figure 3-1</a> shows the flow diagram for executing nonqueries with bind variables.
                        </p>
                        <div class="figure" id="GUID-02A630D5-3533-4819-A8F6-EC4FFB5899CC__I1006184">
                           <p class="titleinfigure">Figure 3-1 Flow Diagram for Nonquery Passthrough SQL</p><br><div class="imagecenter"><img class="imagecenter" src="img/heter007.gif" alt="Description of Figure 3-1 follows" title="Description of Figure 3-1 follows" longdesc="img_text/heter007.html"><br><a href="img_text/heter007.html">Description of "Figure 3-1 Flow Diagram for Nonquery Passthrough SQL"</a></div><br></div>
                        <!-- class="figure" -->
                     </div>
                  </div><a id="HETER4056"></a><div class="props_rev_3"><a id="GUID-16743824-9784-437E-9DCA-411EEE3D81C9" name="GUID-16743824-9784-437E-9DCA-411EEE3D81C9"></a><h5 id="HETER-GUID-16743824-9784-437E-9DCA-411EEE3D81C9" class="sect5">IN Bind Variables</h5>
                     <div>
                        <p>The syntax of the non-Oracle system determines how a statement specifies a <code class="codeph">IN</code> bind variable.
                        </p>
                        <p>For example, <a id="d3108e536" class="indexterm-anchor"></a>on an Oracle system you define bind variables with a preceding colon. For example:
                        </p><pre class="oac_no_warn" dir="ltr">...
UPDATE emp
SET sal=sal*1.1
WHERE ename=:ename;
...
</pre><p>In this statement<code class="codeph">,</code> <code class="codeph">ename</code> is the bind variable. On non-Oracle systems, you may need to specify bind variables with a question mark. For example:
                        </p><pre class="oac_no_warn" dir="ltr">...
UPDATE emp
SET sal=sal*1.1
WHERE ename= ?;
...
</pre><p>In the bind variable step, you must positionally associate host program variables (in this case, PL/SQL) with each of these bind variables. For example, to execute the preceding statement, use the following PL/SQL program:</p><pre class="oac_no_warn" dir="ltr">DECLARE
  c INTEGER;
  nr INTEGER;
BEGIN
  c := DBMS_HS_PASSTHROUGH.OPEN_CURSOR@salesdb;
  DBMS_HS_PASSTHROUGH.PARSE@salesdb(c,
        'UPDATE emp SET SAL=SAL*1.1 WHERE ename=?');
  DBMS_HS_PASSTHROUGH.BIND_VARIABLE@salesdb(c,1,'JONES');
  nr:=DBMS_HS_PASSTHROUGH.EXECUTE_NON_QUERY@salesdb(c);
  DBMS_OUTPUT.PUT_LINE(nr||' rows updated');
  DBMS_HS_PASSTHROUGH.CLOSE_CURSOR@salesdb(c);
END;</pre></div>
                  </div><a id="HETER4057"></a><div class="props_rev_3"><a id="GUID-D14E12B8-6433-434E-BF95-3E4F67FC0C07" name="GUID-D14E12B8-6433-434E-BF95-3E4F67FC0C07"></a><h5 id="HETER-GUID-D14E12B8-6433-434E-BF95-3E4F67FC0C07" class="sect5">OUT Bind Variables</h5>
                     <div>
                        <p>The non-Oracle system can support <code class="codeph">OUT</code> bind variables.
                        </p>
                        <p><a id="d3108e583" class="indexterm-anchor"></a><a id="d3108e589" class="indexterm-anchor"></a>With <code class="codeph">OUT</code> bind variables, the value of the bind variable is not known until after the execution of the SQL statement. 
                        </p>
                        <p>Although <code class="codeph">OUT</code> bind variables are populated after executing the SQL statement, the non-Oracle system must know that the particular bind variable is an <code class="codeph">OUT</code> bind variable before the SQL statement is executed. You must use the <a id="d3108e603" class="indexterm-anchor"></a><code class="codeph">BIND_OUT_VARIABLE</code> procedure to specify that the bind variable is an <code class="codeph">OUT</code> bind variable.
                        </p>
                        <p>After executing the SQL statement, you can retrieve the value of the <code class="codeph">OUT</code> bind variable using the <a id="d3108e616" class="indexterm-anchor"></a><code class="codeph">GET_VALUE</code> procedure.
                        </p>
                     </div>
                  </div><a id="HETER4058"></a><div class="props_rev_3"><a id="GUID-C77A1E92-2FAF-4987-A3F5-412EBB8D21C0" name="GUID-C77A1E92-2FAF-4987-A3F5-412EBB8D21C0"></a><h5 id="HETER-GUID-C77A1E92-2FAF-4987-A3F5-412EBB8D21C0" class="sect5">IN OUT Bind Variables</h5>
                     <div>
                        <p>A bind variable can be both an <code class="codeph">IN</code> and an <code class="codeph">OUT</code> variable.
                        </p>
                        <p><a id="d3108e648" class="indexterm-anchor"></a>This means that the value of the bind variable must be known before executing the SQL statement, but you can change the value after the SQL statement is executed.
                        </p>
                        <p>For <code class="codeph">IN OUT</code> bind variables, you must use the<a id="d3108e660" class="indexterm-anchor"></a> <code class="codeph">BIND_INOUT_VARIABLE</code> procedure to provide a value before executing the SQL statement. <span>After</span> executing the SQL statement, you must use the <code class="codeph">GET_VALUE</code> procedure to retrieve the new value of the bind variable.
                        </p>
                     </div>
                  </div>
               </div><a id="HETER4060"></a><a id="HETER4059"></a><div class="props_rev_3"><a id="GUID-AADA1C44-98BF-4890-BA49-55CDD7144A59" name="GUID-AADA1C44-98BF-4890-BA49-55CDD7144A59"></a><h4 id="HETER-GUID-AADA1C44-98BF-4890-BA49-55CDD7144A59" class="sect4">Executing Queries</h4>
                  <div>
                     <p>Use passthrough SQL to execute queries.</p>
                     <div class="section">
                        <p><a id="d3108e702" class="indexterm-anchor"></a><a id="d3108e706" class="indexterm-anchor"></a>The difference between queries and nonqueries is that queries retrieve a result set from a <code class="codeph">SELECT</code> statement. The result set is retrieved by using a cursor. 
                        </p>
                        <p><a href="passthrough-sql.html#GUID-AADA1C44-98BF-4890-BA49-55CDD7144A59__I1006242">Figure 3-2</a> illustrates the steps in a passthrough SQL query. After the system parses the <code class="codeph">SELECT</code> statement, each row of the result set can be retrieved with the <code class="codeph">FETCH_ROW</code> procedure. After the row is retrieved, use the <code class="codeph">GET_VALUE</code> procedure to retrieve the selected list of items into program variables. After all rows are retrieved, you can close the cursor.
                        </p>
                        <div class="figure" id="GUID-AADA1C44-98BF-4890-BA49-55CDD7144A59__I1006242">
                           <p class="titleinfigure">Figure 3-2 Passthrough SQL for Queries</p><br><div class="imagecenter"><img class="imagecenter" src="img/heter008.gif" alt="Description of Figure 3-2 follows" title="Description of Figure 3-2 follows" longdesc="img_text/heter008.html"><br><a href="img_text/heter008.html">Description of "Figure 3-2 Passthrough SQL for Queries"</a></div><br></div>
                        <!-- class="figure" -->
                        <p>You do not have to retrieve all the rows. You can close the cursor at any time after opening the cursor.</p>
                        <div class="infoboxnote" id="GUID-AADA1C44-98BF-4890-BA49-55CDD7144A59__GUID-3596A8C9-7ED2-417B-89C8-BB594A7AFC00">
                           <p class="notep1">Note:</p>
                           <p>Although you are retrieving one row at a time, Heterogeneous Services <a id="d3108e738" class="indexterm-anchor"></a>optimizes the round-trips between Oracle Database and the non-Oracle system by <a id="d3108e743" class="indexterm-anchor"></a>buffering<a id="d3108e748" class="indexterm-anchor"></a> multipl<a id="d3108e753" class="indexterm-anchor"></a>e rows and fetching from the non-Oracle data system in one round-trip.
                           </p>
                        </div>
                        <p>The following example executes a query:</p><pre class="oac_no_warn" dir="ltr">DECLARE
   val  VARCHAR2(100);
   c    INTEGER;
   nr   INTEGER;
BEGIN
  c := DBMS_HS_PASSTHROUGH.OPEN_CURSOR@salesdb; 
  DBMS_HS_PASSTHROUGH.PARSE@salesdb(c, 
    'select ENAME
     from   EMP
     where  DEPTNO=10');
  LOOP
    nr := DBMS_HS_PASSTHROUGH.FETCH_ROW@salesdb(c);
    EXIT WHEN nr = 0;
    DBMS_HS_PASSTHROUGH.GET_VALUE@salesdb(c, 1, val);
    DBMS_OUTPUT.PUT_LINE(val);
  END LOOP;  
  DBMS_HS_PASSTHROUGH.CLOSE_CURSOR@salesdb(c); 
END;
</pre><p>After the <code class="codeph">SELECT</code> statement has been parsed, the rows are fetched and printed in a loop until the <code class="codeph">FETCH_ROW</code> function returns the value <code class="codeph">0</code>. 
                        </p>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>