<!DOCTYPE html
  SYSTEM "about:legacy-compat">

<!-- saved from url=(0023)https://docs.oracle.com -->

<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Best Practices for Apply</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Replication Administrator’s Guide ">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Replication Administrator’s Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.1.1">
      <link rel="alternate" href="streams-replication-administrators-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2018-01-24T23:25:23-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2003, 2018">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E83780-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/18">
      <meta name="dcterms.release" content="Release 18">
      <link rel="prev" href="best-practices-for-propagation.html" title="Previous" type="text/html">
      <link rel="next" href="book-index.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"18","element_name":"Release 18","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Streams Replication Administrator's Guide">
    <meta name="dcterms.isVersionOf" content="STREP">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="best-practices-for-propagation.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="book-index.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Replication Administrator’s Guide </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="oracle-streams-replication-best-practices.html" property="item" typeof="WebPage"><span property="name"> Oracle Streams Replication Best Practices </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem"> Best Practices for Apply</li>
            </ol>
            <a id="GUID-B83395F2-C932-49CC-97C4-16717313903C" name="GUID-B83395F2-C932-49CC-97C4-16717313903C"></a><a id="STREP534"></a>
            
            <h2 id="STREP-GUID-B83395F2-C932-49CC-97C4-16717313903C" class="sect2"><span class="enumeration_chapter">18 </span> Best Practices for Apply
            </h2>
         </header>
         <div class="ind">
            <div>
               <p><a id="d73475e100" class="indexterm-anchor"></a>This chapter describes the best practices for applying changes with an apply process in an Oracle Streams replication environment. This chapter includes these topics:
               </p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="best-practices-for-apply.html#GUID-0BEDF8CB-6850-467D-9ED2-02A969ACEDD6">Best Practices for Destination Database Configuration</a></p>
                  </li>
                  <li>
                     <p><a href="best-practices-for-apply.html#GUID-FD547117-953F-403F-A876-3FEE94ADAD52">Best Practices for Apply Process Configuration</a></p>
                  </li>
                  <li>
                     <p><a href="best-practices-for-apply.html#GUID-0B57C103-2CB1-4943-A132-7B3DB5A2528A">Best Practices for Apply Process Operation</a></p>
                  </li>
               </ul>
               <div class="infoboxnotealso" id="GUID-B83395F2-C932-49CC-97C4-16717313903C__GUID-7DF752FA-CFB3-4FD7-AFFE-587AAD058761">
                  <p class="notep1">See Also:</p>
                  <p><span class="q">"<a href="best-practices-for-oracle-streams-replication-databases.html#GUID-9E3CABFC-BE9C-49ED-BD21-0A1858868AAB">Best Practices for Oracle Real Application Clusters and Oracle Streams</a>"</span></p>
               </div>
            </div><a id="STREP535"></a><div class="props_rev_3"><a id="GUID-0BEDF8CB-6850-467D-9ED2-02A969ACEDD6" name="GUID-0BEDF8CB-6850-467D-9ED2-02A969ACEDD6"></a><h3 id="STREP-GUID-0BEDF8CB-6850-467D-9ED2-02A969ACEDD6" class="sect3"><span class="enumeration_section">18.1 </span>Best Practices for Destination Database Configuration
               </h3>
               <div>
                  <p>In an Oracle Streams replication environment, a destination database is a database where an apply process applies changes. This section contains these topics:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="best-practices-for-apply.html#GUID-9E5C73DF-C902-436A-BC9F-002799BF4862">Grant Required Privileges to the Apply User</a></p>
                     </li>
                     <li>
                        <p><a href="best-practices-for-apply.html#GUID-5D51C000-686F-4839-AA3B-55C8FDB576C6">Set Instantiation SCN Values</a></p>
                     </li>
                     <li>
                        <p><a href="best-practices-for-apply.html#GUID-FBFFE4F9-FFF9-4A9C-8424-0D79A0F1B6A9">Configure Conflict Resolution</a></p>
                     </li>
                  </ul>
               </div><a id="STREP536"></a><div class="props_rev_3"><a id="GUID-9E5C73DF-C902-436A-BC9F-002799BF4862" name="GUID-9E5C73DF-C902-436A-BC9F-002799BF4862"></a><h4 id="STREP-GUID-9E5C73DF-C902-436A-BC9F-002799BF4862" class="sect4"><span class="enumeration_section">18.1.1 </span>Grant Required Privileges to the Apply User
                  </h4>
                  <div>
                     <p>The apply user is the user in whose security domain an apply process performs the following actions:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Dequeues messages that satisfy its rule sets</p>
                        </li>
                        <li>
                           <p>Runs custom rule-based transformations configured for apply process rules</p>
                        </li>
                        <li>
                           <p>Applies messages directly to database objects</p>
                        </li>
                        <li>
                           <p>Runs apply handlers configured for the apply process</p>
                        </li>
                     </ul>
                     <p>The apply user for an apply process is configured when you create an apply process, and the apply user can be modified when you alter an apply process. Grant the following privileges to the apply user:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>If the apply process applies data manipulation language (DML) changes to a table, then grant <code class="codeph">INSERT</code>, <code class="codeph">UPDATE</code>, and <code class="codeph">DELETE</code> privileges on the table to the apply user.
                           </p>
                        </li>
                        <li>
                           <p>If the apply process applies data definition language (DDL) changes to a table, then grant <code class="codeph">CREATE</code> <code class="codeph">TABLE</code> or <code class="codeph">CREATE</code> <code class="codeph">ANY</code> <code class="codeph">TABLE</code>, <code class="codeph">CREAT</code> <code class="codeph">INDEX</code> or <code class="codeph">CREATE</code> <code class="codeph">ANY</code> <code class="codeph">INDEX</code>, and <code class="codeph">CREATE</code> <code class="codeph">PROCEDURE</code> or <code class="codeph">CREATE</code> <code class="codeph">ANY</code> <code class="codeph">PROCEDURE</code> to the apply user.
                           </p>
                        </li>
                        <li>
                           <p>Grant <code class="codeph">EXECUTE</code> privilege on the rule sets used by the apply process.
                           </p>
                        </li>
                        <li>
                           <p>Grant <code class="codeph">EXECUTE</code> privilege on all custom rule-based transformation functions specified for rules in the positive rule set of the apply process.
                           </p>
                        </li>
                        <li>
                           <p>Grant <code class="codeph">EXECUTE</code> privilege on any apply handlers used by the apply process.
                           </p>
                        </li>
                        <li>
                           <p>Grant privileges to dequeue messages from the apply process's queue.</p>
                        </li>
                     </ul>
                     <p>These privileges can be granted directly to the apply user, or they can be granted through roles.</p>
                     <p>In addition, the apply user must be granted <code class="codeph">EXECUTE</code> privilege on all packages, including Oracle-supplied packages, that are invoked in subprograms run by the apply process. These privileges must be granted directly to the apply user. They cannot be granted through roles.
                     </p>
                     <div class="infoboxnotealso" id="GUID-9E5C73DF-C902-436A-BC9F-002799BF4862__GUID-B29EB9DF-028E-4B9B-92C3-B90251AEC9DD">
                        <p class="notep1">See Also:</p>
                        <p></p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=DBSEG004"><span class="italic">Oracle Database Security Guide</span></a> for general information about granting privileges
                              </p>
                           </li>
                           <li>
                              <p><a href="../strms/managing-rules.html#STRMS012"><span class="italic">Oracle Streams Concepts and Administration</span></a> for information about granting privileges on rule sets
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="STREP537"></a><div class="props_rev_3"><a id="GUID-5D51C000-686F-4839-AA3B-55C8FDB576C6" name="GUID-5D51C000-686F-4839-AA3B-55C8FDB576C6"></a><h4 id="STREP-GUID-5D51C000-686F-4839-AA3B-55C8FDB576C6" class="sect4"><span class="enumeration_section">18.1.2 </span>Set Instantiation SCN Values
                  </h4>
                  <div>
                     <p>An instantiation SCN value must be set for each database object to which an apply process applies changes. Confirm that an instantiation SCN is set for all such objects, and set any required instantiation SCN values that are not set.</p>
                     <p>Instantiation SCN values can be set in various ways, including during export/import, by Recovery Manager (RMAN), or manually. To set instantiation SCN values manually, use one of the following procedures in the <code class="codeph">DBMS_APPLY_ADM</code> package:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS325"><code class="codeph">SET_TABLE_INSTANTIATION_SCN</code></a></p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS589"><code class="codeph">SET_SCHEMA_INSTANTIATION_SCN</code></a></p>
                        </li>
                        <li>
                           <p><a href="../arpls/DBMS_APPLY_ADM.html#ARPLS538"><code class="codeph">SET_GLOBAL_INSTANTIATION_SCN</code></a></p>
                        </li>
                     </ul>
                     <p>For example, to set the instantiation SCN manually for each table in the a schema, run the <code class="codeph">SET_SCHEMA_INSTANTIATION_SCN</code> procedure with the <code class="codeph">recursive</code> parameter set to <code class="codeph">TRUE</code>. If an apply process applies data definition language (DDL) changes, then set the instantiation SCN values at a level higher than table level using either the <code class="codeph">SET_SCHEMA_INSTANTIATION_SCN</code> or <code class="codeph">SET_GLOBAL_INSTANTIATION_SCN</code> procedure.
                     </p>
                     <div class="infoboxnotealso" id="GUID-5D51C000-686F-4839-AA3B-55C8FDB576C6__GUID-32BED910-AED3-45D1-B535-6A091663781F">
                        <p class="notep1">See Also:</p>
                        <p><a href="instantiation-and-oracle-streams-replication.html#GUID-003967CE-08B9-439C-902F-45E7B7C37371"> Instantiation and Oracle Streams Replication</a> for more information about instantiation and setting instantiation SCN values
                        </p>
                     </div>
                  </div>
               </div><a id="STREP538"></a><div class="props_rev_3"><a id="GUID-FBFFE4F9-FFF9-4A9C-8424-0D79A0F1B6A9" name="GUID-FBFFE4F9-FFF9-4A9C-8424-0D79A0F1B6A9"></a><h4 id="STREP-GUID-FBFFE4F9-FFF9-4A9C-8424-0D79A0F1B6A9" class="sect4"><span class="enumeration_section">18.1.3 </span>Configure Conflict Resolution
                  </h4>
                  <div>
                     <p>If updates will be performed at multiple databases for the same shared database object, then ensure that you configure conflict resolution for that object. To simplify conflict resolution for tables with LOB columns, create an error handler to handle errors for the table. When registering the error handler using the <code class="codeph">DBMS_APPLY_ADM.SET_DML_HANDLER</code> procedure, ensure that you set the <code class="codeph">assemble_lobs</code> parameter to <code class="codeph">TRUE</code>.
                     </p>
                     <p>If you configure conflict resolution at a destination database, then additional supplemental logging is required at the source database. Specifically, the columns specified in a column list for conflict resolution during apply must be conditionally logged if more than one column at the source database is used in the column list at the destination database.</p>
                     <div class="infoboxnotealso" id="GUID-FBFFE4F9-FFF9-4A9C-8424-0D79A0F1B6A9__GUID-83717C60-47D1-4394-AB87-FA7DED7688B4">
                        <p class="notep1">See Also:</p>
                        <p></p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="oracle-streams-conflict-resolution.html#GUID-5D79AA72-A682-4623-8A0B-4CF84D1FFC86"> Oracle Streams Conflict Resolution</a></p>
                           </li>
                           <li>
                              <p><span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-12A4DC82-EEC7-4ACC-BF8F-8D82AA1D19DE">Specifying Supplemental Logging</a>"</span></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div><a id="STREP539"></a><div class="props_rev_3"><a id="GUID-FD547117-953F-403F-A876-3FEE94ADAD52" name="GUID-FD547117-953F-403F-A876-3FEE94ADAD52"></a><h3 id="STREP-GUID-FD547117-953F-403F-A876-3FEE94ADAD52" class="sect3"><span class="enumeration_section">18.2 </span>Best Practices for Apply Process Configuration
               </h3>
               <div>
                  <p>The following sections describe best practices for configuring apply processes:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="best-practices-for-apply.html#GUID-A0B03AA6-3782-490B-B2C4-FF5E4CA9E637">Set Apply Process Parallelism</a></p>
                     </li>
                     <li>
                        <p><a href="best-practices-for-apply.html#GUID-C219947C-79A7-4249-AB5C-A0F72E893730">Consider Allowing Apply Processes to Continue When They Encounter Errors</a></p>
                     </li>
                  </ul>
               </div><a id="STREP540"></a><div class="props_rev_3"><a id="GUID-A0B03AA6-3782-490B-B2C4-FF5E4CA9E637" name="GUID-A0B03AA6-3782-490B-B2C4-FF5E4CA9E637"></a><h4 id="STREP-GUID-A0B03AA6-3782-490B-B2C4-FF5E4CA9E637" class="sect4"><span class="enumeration_section">18.2.1 </span>Set Apply Process Parallelism
                  </h4>
                  <div>
                     <p>Set the parallelism of an apply process by specifying the <code class="codeph">parallelism</code> parameter in the <code class="codeph">DBMS_APPLY_ADM.SET_PARAMETER</code> procedure. The <code class="codeph">parallelism</code> parameter controls the number of processes that concurrently apply changes. The default setting for the <code class="codeph">parallelism</code> apply process parameter is <code class="codeph">4</code>.
                     </p>
                     <p>Typically, apply process parallelism is set to either <code class="codeph">1</code>, <code class="codeph">4</code>, <code class="codeph">8</code>, or <code class="codeph">16</code>. The setting that is best for a particular apply process depends on the load applied and the processing power of the computer system running the database. Follow these guidelines when setting apply process parallelism:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>If the load is heavy for the apply process and the computer system running the database has excellent processing power, then set apply process parallelism to <code class="codeph">8</code> or&nbsp;<code class="codeph">16</code>. Multiple high-speed CPUs provide excellent processing power.
                           </p>
                        </li>
                        <li>
                           <p>If the is light for the apply process, then set apply process parallelism to <code class="codeph">1</code> or&nbsp;<code class="codeph">4</code>.
                           </p>
                        </li>
                        <li>
                           <p>If the computer system running the database has less than optimal processing power, then set apply process parallelism to <code class="codeph">1</code> or&nbsp;<code class="codeph">4</code>.
                           </p>
                        </li>
                     </ul>
                     <p>Ensure that the <code class="codeph">PROCESSES</code> initialization parameter is set appropriately when you set the <code class="codeph">parallelism</code> apply process parameter.
                     </p>
                     <p>In addition, if parallelism is greater than 1 for an apply process, then ensure that any database objects whose changes are applied by the apply process have the appropriate settings for the <code class="codeph">INITRANS</code> and <code class="codeph">PCTFREE</code> parameters. The <code class="codeph">INITRANS</code> parameter specifies the initial number of concurrent transaction entries allocated within each data block allocated to the database object. Set the <code class="codeph">INITRANS</code> parameter to the parallelism of the apply process or higher. The <code class="codeph">PCTFREE</code> parameter specifies the percentage of space in each data block of the database object reserved for future updates to rows of the object. The <code class="codeph">PCTFREE</code> parameter should be set to 10 or higher. You can modify these parameters for a table using the <code class="codeph">ALTER</code> <code class="codeph">TABLE</code> statement
                     </p>
                     <div class="infoboxnotealso" id="GUID-A0B03AA6-3782-490B-B2C4-FF5E4CA9E637__GUID-51F2E775-B22D-435F-8DAC-852164B06828">
                        <p class="notep1">See Also:</p>
                        <p></p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="../strms/oracle-streams-information-consumption.html#STRMS004"><span class="italic">Oracle Streams Concepts and Administration</span></a></p>
                           </li>
                           <li>
                              <p><a href="../arpls/DBMS_APPLY_ADM.html#ARPLS314"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a></p>
                           </li>
                           <li>
                              <p><a href="../sqlrf/ALTER-TABLE.html#SQLRF01001"><span class="italic">Oracle Database SQL Language Reference</span></a> for more information about the <code class="codeph">ALTER</code> <code class="codeph">TABLE</code> statement
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="STREP541"></a><div class="props_rev_3"><a id="GUID-C219947C-79A7-4249-AB5C-A0F72E893730" name="GUID-C219947C-79A7-4249-AB5C-A0F72E893730"></a><h4 id="STREP-GUID-C219947C-79A7-4249-AB5C-A0F72E893730" class="sect4"><span class="enumeration_section">18.2.2 </span>Consider Allowing Apply Processes to Continue When They Encounter Errors
                  </h4>
                  <div>
                     <p>When the <code class="codeph">disable_on_error</code> apply process parameter is set to <code class="codeph">Y</code>, the apply process is disabled on the first unresolved error, even if the error is not irrecoverable. When the <code class="codeph">disable_on_error</code> apply process parameter is set to <code class="codeph">N</code>, the apply process continues regardless of unresolved errors. The default setting for this parameter is <code class="codeph">Y</code>. If you do not want an apply process to become disabled when it encounters errors, then set the <code class="codeph">disable_on_error</code> parameter to <code class="codeph">N</code>.
                     </p>
                  </div>
               </div>
            </div><a id="STREP542"></a><div class="props_rev_3"><a id="GUID-0B57C103-2CB1-4943-A132-7B3DB5A2528A" name="GUID-0B57C103-2CB1-4943-A132-7B3DB5A2528A"></a><h3 id="STREP-GUID-0B57C103-2CB1-4943-A132-7B3DB5A2528A" class="sect3"><span class="enumeration_section">18.3 </span>Best Practices for Apply Process Operation
               </h3>
               <div>
                  <p>The following section describes best practices for operating existing apply processes.</p>
               </div><a id="STREP543"></a><div class="props_rev_3"><a id="GUID-07B9ECBF-0FAA-4DF7-AC85-E73C52253F61" name="GUID-07B9ECBF-0FAA-4DF7-AC85-E73C52253F61"></a><h4 id="STREP-GUID-07B9ECBF-0FAA-4DF7-AC85-E73C52253F61" class="sect4"><span class="enumeration_section">18.3.1 </span>Manage Apply Errors
                  </h4>
                  <div>
                     <p>The error queue contains all of the current apply errors for a database. If there are multiple apply processes in a database, then the error queue contains the apply errors for each apply process. If an apply process encounters an error when it tries to apply a logical change record (LCR) in a transaction, then all of the LCRs in the transaction are moved to the error queue. To view information about apply errors, query the <code class="codeph">DBA_APPLY_ERROR</code> data dictionary view or use Oracle Enterprise Manager Cloud Control.
                     </p>
                     <p>The <code class="codeph">MESSAGE_NUMBER</code> column in the <code class="codeph">DBA_APPLY_ERROR</code> view indicates the LCR within the transaction that resulted in the error. When apply errors are encountered, correct the problem(s) that caused the error(s), and either retry or delete the error transaction in the error queue.
                     </p>
                     <div class="infoboxnotealso" id="GUID-07B9ECBF-0FAA-4DF7-AC85-E73C52253F61__GUID-8BADC661-C3E1-40AA-AA90-9FDF29031D05">
                        <p class="notep1">See Also:</p>
                        <p><a href="../strms/toc.htm"><span class="italic">Oracle Streams Concepts and Administration</span></a> for information about <a href="../strms/managing-oracle-streams-information-consumption.html#STRMS112">managing apply errors</a> and for information about <a href="../strms/monitoring-oracle-streams-apply-processes.html#STRMS143">displaying detailed information for the column values of each LCR in an error transaction</a></p>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>