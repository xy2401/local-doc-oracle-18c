<!DOCTYPE html
  SYSTEM "about:legacy-compat">

<!-- saved from url=(0023)https://docs.oracle.com -->

<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Instantiation and Oracle Streams Replication</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Replication Administrator’s Guide ">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Replication Administrator’s Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.1.1">
      <link rel="alternate" href="streams-replication-administrators-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2018-01-24T23:25:23-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2003, 2018">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E83780-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/18">
      <meta name="dcterms.release" content="Release 18">
      <link rel="prev" href="configuring-implicit-apply.html" title="Previous" type="text/html">
      <link rel="next" href="oracle-streams-conflict-resolution.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"18","element_name":"Release 18","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Streams Replication Administrator's Guide">
    <meta name="dcterms.isVersionOf" content="STREP">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="configuring-implicit-apply.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="oracle-streams-conflict-resolution.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Replication Administrator’s Guide </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="configuring-oracle-streams-replication.html" property="item" typeof="WebPage"><span property="name">    Configuring Oracle Streams Replication </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem"> Instantiation and Oracle Streams Replication</li>
            </ol>
            <a id="GUID-003967CE-08B9-439C-902F-45E7B7C37371" name="GUID-003967CE-08B9-439C-902F-45E7B7C37371"></a><a id="STREP012"></a>
            
            <h2 id="STREP-GUID-003967CE-08B9-439C-902F-45E7B7C37371" class="sect2"><span class="enumeration_chapter">8 </span> Instantiation and Oracle Streams Replication
            </h2>
         </header>
         <div class="ind">
            <div>
               <p><a id="d37209e100" class="indexterm-anchor"></a>This chapter contains conceptual information about instantiation and Oracle Streams replication. It also contains instructions for preparing database objects for instantiation, performing instantiations, setting instantiation system change numbers (SCNs), and monitoring instantiations.
               </p>
               <p>This chapter contains these topics:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="instantiation-and-oracle-streams-replication.html#GUID-5152A86B-0B25-44B7-A857-DBE83CAA509A">Overview of Instantiation and Oracle Streams Replication</a></p>
                  </li>
                  <li>
                     <p><a href="instantiation-and-oracle-streams-replication.html#GUID-49D5B599-16A8-40EB-8A2A-D4425F13682A">Capture Rules and Preparation for Instantiation</a></p>
                  </li>
                  <li>
                     <p><a href="instantiation-and-oracle-streams-replication.html#GUID-AAB63D95-9728-4142-BB75-83356AE7C899">Oracle Data Pump and Oracle Streams Instantiation</a></p>
                  </li>
                  <li>
                     <p><a href="instantiation-and-oracle-streams-replication.html#GUID-34BBF85F-E48A-497E-94F4-54911224CDEC">Recovery Manager (RMAN) and Oracle Streams Instantiation</a></p>
                  </li>
                  <li>
                     <p><a href="instantiation-and-oracle-streams-replication.html#GUID-35E458F3-6293-47A8-AB12-FA7720E99AC0">Setting Instantiation SCNs at a Destination Database</a></p>
                  </li>
                  <li>
                     <p><a href="instantiation-and-oracle-streams-replication.html#GUID-D03E9B4C-F2CD-4C20-B0A4-19ED3CA5AA61">Monitoring Instantiation</a></p>
                  </li>
               </ul>
            </div><a id="STREP113"></a><div class="props_rev_3"><a id="GUID-5152A86B-0B25-44B7-A857-DBE83CAA509A" name="GUID-5152A86B-0B25-44B7-A857-DBE83CAA509A"></a><h3 id="STREP-GUID-5152A86B-0B25-44B7-A857-DBE83CAA509A" class="sect3"><span class="enumeration_section">8.1 </span>Overview of Instantiation and Oracle Streams Replication
               </h3>
               <div>
                  <p>In an Oracle Streams environment that replicates a database object within a single database or between multiple databases, a source database is the database where changes to the object are generated, and a destination database is the database where these changes are dequeued by an apply process. If a capture process or synchronous capture captures, or will capture, such changes, and the changes will be applied locally or propagated to other databases and applied at destination databases, then you must <span class="bold">instantiate</span> these source database objects before you can replicate changes to the objects. If a database where changes to the source database objects will be applied is a different database than the source database, then the destination database must have a copy of these database objects. 
                  </p>
                  <p>In Oracle Streams, the following general steps instantiate a database object:</p>
                  <ol>
                     <li id="GUID-5152A86B-0B25-44B7-A857-DBE83CAA509A__BABEBICJ">
                        <p>Prepare the database object for instantiation at the source database.</p>
                     </li>
                     <li>
                        <p>If a copy of the database object does not exist at the destination database, then create a database object physically at the destination database based on a database object at the source database. You can use export/import, transportable tablespaces, or RMAN to copy database objects for instantiation. If the database object already exists at the destination database, then this step is not necessary.</p>
                     </li>
                     <li id="GUID-5152A86B-0B25-44B7-A857-DBE83CAA509A__i1007983">
                        <p>Set the instantiation system change number (SCN) for the database object at the destination database. An instantiation SCN instructs an apply process at the destination database to apply only changes that committed at the source database after the specified&nbsp;SCN.</p>
                     </li>
                  </ol>
                  <p>All of these instantiation steps can be performed automatically when you use one of the following Oracle-supplied procedures in the <code class="codeph">DBMS_STREAMS_ADM</code> package that configure replication environments:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="../arpls/DBMS_STREAMS_ADM.html#ARPLS825"><code class="codeph">MAINTAIN_GLOBAL</code></a></p>
                     </li>
                     <li>
                        <p><a href="../arpls/DBMS_STREAMS_ADM.html#ARPLS826"><code class="codeph">MAINTAIN_SCHEMAS</code></a></p>
                     </li>
                     <li>
                        <p><a href="../arpls/DBMS_STREAMS_ADM.html#ARPLS863"><code class="codeph">MAINTAIN_SIMPLE_TTS</code></a></p>
                     </li>
                     <li>
                        <p><a href="../arpls/DBMS_STREAMS_ADM.html#ARPLS827"><code class="codeph">MAINTAIN_TABLES</code></a></p>
                     </li>
                     <li>
                        <p><a href="../arpls/DBMS_STREAMS_ADM.html#ARPLS864"><code class="codeph">MAINTAIN_TTS</code></a></p>
                     </li>
                  </ul>
                  <p>In some cases, Step <a href="instantiation-and-oracle-streams-replication.html#GUID-5152A86B-0B25-44B7-A857-DBE83CAA509A__BABEBICJ">1</a> and Step <a href="instantiation-and-oracle-streams-replication.html#GUID-5152A86B-0B25-44B7-A857-DBE83CAA509A__i1007983">3</a> are completed automatically. For example, when you add rules for a database object to the positive rule set of a capture process by running a procedure in the <code class="codeph">DBMS_STREAMS_ADM</code> package, the database object is prepared for instantiation automatically.
                  </p>
                  <p>Also, when you use export/import, transportable tablespaces, or the RMAN <code class="codeph">TRANSPORT</code> <code class="codeph">TABLESPACE</code> command to copy database objects from a source database to a destination database, instantiation SCNs can be set for these database objects automatically.
                  </p>
                  <div class="infoboxnote" id="GUID-5152A86B-0B25-44B7-A857-DBE83CAA509A__GUID-F15A5470-E926-465A-8A10-9BFF2DE9401E">
                     <p class="notep1">Note:</p>
                     <p>The RMAN <code class="codeph">DUPLICATE</code> command can instantiate an entire database, but this command does not set instantiation SCNs for database objects.
                     </p>
                  </div>
                  <p>If the database object being instantiated is a table, then the tables at the source and destination database do not need to be an exact match. However, if some or all of the table data is replicated between the two databases, then the data that is replicated should be consistent when the table is instantiated. Whenever you plan to replicate changes to a database object, you must always prepare the database object for instantiation at the source database and set the instantiation SCN for the database object at the destination database. By preparing an object for instantiation, you are setting the lowest SCN for which changes to the object can be applied at destination databases. This SCN is called the ignore SCN. You should prepare a database object for instantiation after a capture process or synchronous capture has been configured to capture changes to the database object.</p>
                  <p><a id="d37209e328" class="indexterm-anchor"></a><a id="d37209e332" class="indexterm-anchor"></a>When you instantiate tables using export/import, transportable tablespaces, or RMAN, any supplemental log group specifications are retained for the instantiated tables. That is, after instantiation, log group specifications for imported tables at the import database are the same as the log group specifications for these tables at the export database. If you do not want to retain supplemental log group specifications for tables at the import database, then you can drop specific supplemental log groups after import.
                  </p>
                  <p>Database supplemental logging specifications are not retained during export/import, even if you perform a full database export/import. However, the RMAN <code class="codeph">DUPLICATE</code> command retains database supplemental logging specifications at the instantiated database.
                  </p>
                  <div class="infoboxnote" id="GUID-5152A86B-0B25-44B7-A857-DBE83CAA509A__GUID-AFC3B9AE-F2EA-4D2B-8EB8-838BC59423FF">
                     <p class="notep1">Note:</p>
                     <p></p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>During an export for an Oracle Streams instantiation, ensure that no data definition language (DDL) changes are made to objects being exported.</p>
                        </li>
                        <li>
                           <p>When you export a database or schema that contains rules with non-<code class="codeph">NULL</code> action contexts, the database or the default tablespace of the schema that owns the rules must be writeable. If the database or tablespace is read-only, then export errors result.
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div class="infoboxnotealso" id="GUID-5152A86B-0B25-44B7-A857-DBE83CAA509A__GUID-F2F1C53B-A1FE-4FEF-AF18-C17D261DC46C">
                     <p class="notep1">See Also:</p>
                     <p></p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="../strms/advanced-apply-process-concepts.html#STRMS213"><span class="italic">Oracle Streams Concepts and Administration</span></a> for more information about the oldest SCN for an apply process
                           </p>
                        </li>
                        <li>
                           <p><span class="q">"<a href="simple-oracle-streams-replication-configuration.html#GUID-8FAAAEF7-0689-4A95-8BD4-D8630CE45FD5">Configuring Replication Using the DBMS_STREAMS_ADM Package</a>"</span></p>
                        </li>
                        <li>
                           <p><span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-12A4DC82-EEC7-4ACC-BF8F-8D82AA1D19DE">Specifying Supplemental Logging</a>"</span> for information about adding and dropping supplemental log groups
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div><a id="STREP115"></a><div class="props_rev_3"><a id="GUID-49D5B599-16A8-40EB-8A2A-D4425F13682A" name="GUID-49D5B599-16A8-40EB-8A2A-D4425F13682A"></a><h3 id="STREP-GUID-49D5B599-16A8-40EB-8A2A-D4425F13682A" class="sect3"><span class="enumeration_section">8.2 </span>Capture Rules and Preparation for Instantiation
               </h3>
               <div>
                  <p>The following subprograms in the <code class="codeph">DBMS_CAPTURE_ADM</code> package prepare database objects for instantiation:
                  </p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>The <code class="codeph">PREPARE_TABLE_INSTANTIATION</code> procedure prepares a single table for instantiation when changes to the table will be captured by a capture process.
                        </p>
                     </li>
                     <li>
                        <p>The <code class="codeph">PREPARE_SYNC_INSTANTIATION</code> function prepares a single table or multiple tables for instantiation when changes to the table or tables will be captured by a synchronous capture.
                        </p>
                     </li>
                     <li>
                        <p>The <code class="codeph">PREPARE_SCHEMA_INSTANTIATION</code> procedure prepares for instantiation all of the database objects in a schema and all database objects added to the schema in the future. This procedure should only be used when changes will be captured by a capture process.
                        </p>
                     </li>
                     <li>
                        <p>The <code class="codeph">PREPARE_GLOBAL_INSTANTIATION</code> procedure prepares for instantiation all of the database objects in a database and all database objects added to the database in the future. This procedure should only be used when changes will be captured by a capture process.
                        </p>
                     </li>
                  </ul>
                  <p>These procedures record the lowest system change number (SCN) of each object for instantiation. SCNs after the lowest SCN for an object can be used for instantiating the object.</p>
                  <p>If you use a capture process to capture changes, then these procedures also populate the Oracle Streams data dictionary for the relevant capture processes, propagations, and apply processes that capture, propagate, or apply changes made to the table, schema, or database being prepared for instantiation. In addition, if you use a capture process to capture changes, then these procedures optionally can enable supplemental logging for key columns or all columns in the tables that are being prepared for instantiation.</p>
                  <div class="infoboxnote" id="GUID-49D5B599-16A8-40EB-8A2A-D4425F13682A__GUID-33F8403E-A23D-42F7-A5D1-9279B14223C7">
                     <p class="notep1">Note:</p>
                     <p>Replication with synchronous capture does not use the Oracle Streams data dictionary and does not require supplemental logging.</p>
                  </div>
                  <div class="infoboxnotealso" id="GUID-49D5B599-16A8-40EB-8A2A-D4425F13682A__GUID-2C34AECB-3812-4B9B-96D9-E35D5AD22DBD">
                     <p class="notep1">See Also:</p>
                     <p></p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><span class="q">"<a href="instantiation-and-oracle-streams-replication.html#GUID-CBDA09E8-D2E0-4E56-B7A7-E87BDC26FC5A">Preparing Database Objects for Instantiation at a Source Database</a>"</span></p>
                        </li>
                        <li>
                           <p><span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-C448DF14-14D0-45FE-9D29-ECBFFF4FB255">Procedures That Automatically Specify Supplemental Logging</a>"</span></p>
                        </li>
                        <li>
                           <p><a href="../strms/advanced-capture-process-concepts.html#STRMS138"><span class="italic">Oracle Streams Concepts and Administration</span></a> for more information about the Oracle Streams data dictionary
                           </p>
                        </li>
                     </ul>
                  </div>
               </div><a id="STREP320"></a><a id="STREP319"></a><div class="props_rev_3"><a id="GUID-A067A70F-CAAD-4942-80A6-BDD6C66BD2EB" name="GUID-A067A70F-CAAD-4942-80A6-BDD6C66BD2EB"></a><h4 id="STREP-GUID-A067A70F-CAAD-4942-80A6-BDD6C66BD2EB" class="sect4"><span class="enumeration_section">8.2.1 </span>DBMS_STREAMS_ADM Package Procedures Automatically Prepare Objects
                  </h4>
                  <div>
                     <p>When you add rules to the positive rule set for a capture process or synchronous capture by running a procedure in the <code class="codeph">DBMS_STREAMS_ADM</code> package, a procedure or function in the <code class="codeph">DBMS_CAPTURE_ADM</code> package is run automatically on the database objects where changes will be captured. <a href="instantiation-and-oracle-streams-replication.html#GUID-A067A70F-CAAD-4942-80A6-BDD6C66BD2EB__BABBJHGD" title="This table lists procedures that run automatically in DBMS_CAPTURE_ADM package when you run a procedure in the DBMS_STREAMS_ADM package.">Table 8-1</a> lists which procedure or function is run in the <code class="codeph">DBMS_CAPTURE_ADM</code> package when you run a procedure in the <code class="codeph">DBMS_STREAMS_ADM</code> package.
                     </p>
                     <div class="tblformal" id="GUID-A067A70F-CAAD-4942-80A6-BDD6C66BD2EB__BABBJHGD">
                        <p class="titleintable">Table 8-1 DBMS_CAPTURE_ADM Package Procedures That Are Run Automatically</p>
                        <table cellpadding="4" cellspacing="0" class="Formal" title="DBMS_CAPTURE_ADM Package Procedures That Are Run Automatically" summary="This table lists procedures that run automatically in DBMS_CAPTURE_ADM package when you run a procedure in the DBMS_STREAMS_ADM package." width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="45%" id="d37209e690">When you run this procedure in the DBMS_STREAMS_ADM package</th>
                                 <th align="left" valign="bottom" width="55%" id="d37209e693">This procedure or function in the DBMS_CAPTURE_ADM package is run automatically</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="45%" id="d37209e698" headers="d37209e690 ">
                                    <p><code class="codeph">ADD_TABLE_RULES</code></p>
                                    <p><code class="codeph">ADD_SUBSET_RULES</code></p>
                                 </td>
                                 <td align="left" valign="top" width="55%" headers="d37209e698 d37209e693 ">
                                    <p><code class="codeph">PREPARE_TABLE_INSTANTIATION</code> when rules are added to a capture process rule set
                                    </p>
                                    <p><code class="codeph">PREPARE_SYNC_INSTANTIATION</code> when rules are added to a synchronous capture rule set
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="45%" id="d37209e715" headers="d37209e690 ">
                                    <p><code class="codeph">ADD_SCHEMA_RULES</code></p>
                                 </td>
                                 <td align="left" valign="top" width="55%" headers="d37209e715 d37209e693 ">
                                    <p><code class="codeph">PREPARE_SCHEMA_INSTANTIATION</code></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="45%" id="d37209e724" headers="d37209e690 ">
                                    <p><code class="codeph">ADD_GLOBAL_RULES</code></p>
                                 </td>
                                 <td align="left" valign="top" width="55%" headers="d37209e724 d37209e693 ">
                                    <p><code class="codeph">PREPARE_GLOBAL_INSTANTIATION</code></p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>Multiple calls to prepare for instantiation are allowed. If you are using downstream capture, and the downstream capture process uses a database link from the downstream database to the source database, then the database objects are prepared for instantiation automatically when you run one of these procedures in the <code class="codeph">DBMS_STREAMS_ADM</code> package. However, if the downstream capture process does not use a database link from the downstream database to the source database, then you must prepare the database objects for instantiation manually.
                     </p>
                     <p>When capture process rules are created by the <code class="codeph">DBMS_RULE_ADM</code> package instead of the <code class="codeph">DBMS_STREAMS_ADM</code> package, you must run the appropriate procedure manually to prepare each table, schema, or database whose changes will be captured for instantiation, if you plan to apply changes that result from the capture process rules with an apply process.
                     </p>
                     <p>In addition, some procedures automatically run these procedures. For example, the <a href="../arpls/DBMS_STREAMS_ADM.html#ARPLS827"><code class="codeph">DBMS_STREAMS_ADM.MAINTAIN_TABLES</code></a> procedure automatically runs the<a href="../arpls/DBMS_STREAMS_ADM.html#ARPLS308"> <code class="codeph">ADD_TABLE_RULES</code></a> procedure.
                     </p>
                     <div class="infoboxnote" id="GUID-A067A70F-CAAD-4942-80A6-BDD6C66BD2EB__GUID-0919B636-C42F-4A23-BED3-05B41CB4EBF6">
                        <p class="notep1">Note:</p>
                        <p>A synchronous capture only captures changes based on rules created by the <code class="codeph">ADD_TABLE_RULES</code> or <code class="codeph">ADD_SUBSET_RULES</code> procedures.
                        </p>
                     </div>
                     <div class="infoboxnotealso" id="GUID-A067A70F-CAAD-4942-80A6-BDD6C66BD2EB__GUID-AE7BA8ED-8A77-4D6D-B681-7E51E8D9A5E9">
                        <p class="notep1">See Also:</p>
                        <p><span class="q">"<a href="simple-oracle-streams-replication-configuration.html#GUID-8FAAAEF7-0689-4A95-8BD4-D8630CE45FD5">Configuring Replication Using the DBMS_STREAMS_ADM Package</a>"</span></p>
                     </div>
                  </div>
               </div><a id="STREP321"></a><div class="props_rev_3"><a id="GUID-8ABC5383-D6BC-4977-A20A-F2B4C4B88EC5" name="GUID-8ABC5383-D6BC-4977-A20A-F2B4C4B88EC5"></a><h4 id="STREP-GUID-8ABC5383-D6BC-4977-A20A-F2B4C4B88EC5" class="sect4"><span class="enumeration_section">8.2.2 </span>When Preparing for Instantiation Is Required
                  </h4>
                  <div>
                     <p>Whenever you add, or modify the condition of, a capture process, propagation, or apply process rule for a database object that is in a positive rule set, you must run the appropriate procedure to prepare the database object for instantiation at the source database if any of the following conditions are met:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>One or more rules are added to the positive rule set for a capture process that instruct the capture process to capture changes made to the object.</p>
                        </li>
                        <li>
                           <p>One or more conditions of rules in the positive rule set for a capture process are modified to instruct the capture process to capture changes made to the object.</p>
                        </li>
                        <li>
                           <p>One or more rules are added to the positive rule set for a propagation that instruct the propagation to propagate changes made to the object.</p>
                        </li>
                        <li>
                           <p>One or more conditions of rules in the positive rule set for a propagation are modified to instruct the propagation to propagate changes made to the object.</p>
                        </li>
                        <li>
                           <p>One or more rules are added to the positive rule set for an apply process that instruct the apply process to apply changes that were made to the object at the source database.</p>
                        </li>
                        <li>
                           <p>One or more conditions of rules in the positive rule set for an apply process are modified to instruct the apply process to apply changes that were made to the object at the source database.</p>
                        </li>
                     </ul>
                     <p>Whenever you remove, or modify the condition of, a capture process, propagation, or apply process rule for a database object that is in a negative rule set, you must run the appropriate procedure to prepare the database object for instantiation at the source database if any of the following conditions are met:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>One or more rules are removed from the negative rule set for a capture process to instruct the capture process to capture changes made to the object.</p>
                        </li>
                        <li>
                           <p>One or more conditions of rules in the negative rule set for a capture process are modified to instruct the capture process to capture changes made to the object.</p>
                        </li>
                        <li>
                           <p>One or more rules are removed from the negative rule set for a propagation to instruct the propagation to propagate changes made to the object.</p>
                        </li>
                        <li>
                           <p>One or more conditions of rules in the negative rule set for a propagation are modified to instruct the propagation to propagate changes made to the object.</p>
                        </li>
                        <li>
                           <p>One or more rules are removed from the negative rule set for an apply process to instruct the apply process to apply changes that were made to the object at the source database.</p>
                        </li>
                        <li>
                           <p>One or more conditions of rules in the negative rule set for an apply process are modified to instruct the apply process to apply changes that were made to the object at the source database.</p>
                        </li>
                     </ul>
                     <p>When any of these conditions are met for changes to a positive or negative rule set, you must prepare the relevant database objects for instantiation at the source database to populate any relevant Oracle Streams data dictionary that requires information about the source object, even if the object already exists at a remote database where the rules were added or changed.</p>
                     <p>The relevant Oracle Streams data dictionaries are populated asynchronously for both the local dictionary and all remote dictionaries. The procedure that prepares for instantiation adds information to the redo log at the source database. The local Oracle Streams data dictionary is populated with the information about the object when a capture process captures these redo entries, and any remote Oracle Streams data dictionaries are populated when the information is propagated to them.</p>
                     <p>Synchronous captures do not use Oracle Streams data dictionaries. However, when you are capturing changes to a database object with synchronous capture, you must prepare the database object for instantiation when you add rules for the database object to the synchronous capture rule set. Preparing the database object for instantiation is required when rules are added because it records the lowest SCN for instantiation for the database object. Preparing the database object for instantiation is not required when synchronous capture rules are modified, but modifications cannot change the database object name or schema in the rule condition.</p>
                     <div class="infoboxnotealso" id="GUID-8ABC5383-D6BC-4977-A20A-F2B4C4B88EC5__GUID-4F19FCDE-2763-4508-964A-6366FB55924A">
                        <p class="notep1">See Also:</p>
                        <p></p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="q">"<a href="instantiation-and-oracle-streams-replication.html#GUID-CBDA09E8-D2E0-4E56-B7A7-E87BDC26FC5A">Preparing Database Objects for Instantiation at a Source Database</a>"</span></p>
                           </li>
                           <li>
                              <p><a href="../strms/advanced-capture-process-concepts.html#STRMS138"><span class="italic">Oracle Streams Concepts and Administration</span></a> for more information about the Oracle Streams data dictionary
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="STREP323"></a><a id="STREP322"></a><div class="props_rev_3"><a id="GUID-44EF379E-1332-48B7-9223-02F07D168EDB" name="GUID-44EF379E-1332-48B7-9223-02F07D168EDB"></a><h4 id="STREP-GUID-44EF379E-1332-48B7-9223-02F07D168EDB" class="sect4"><span class="enumeration_section">8.2.3 </span>Supplemental Logging Options During Preparation for Instantiation
                  </h4>
                  <div>
                     <p>If a replication environment uses a capture process to capture changes, then supplemental logging is required. Supplemental logging places additional column data into a redo log whenever an operation is performed. The procedures in the <code class="codeph">DBMS_CAPTURE_ADM</code> package that prepare database objects for instantiation include <code class="codeph">PREPARE_TABLE_INSTANTIATION</code>, <code class="codeph">PREPARE_SCHEMA_INSTANTIATION</code>, and <code class="codeph">PREPARE_GLOBAL_INSTANTIATION</code>. These procedures have a <code class="codeph">supplemental_logging</code> parameter which controls the supplemental logging specifications for the database objects being prepared for instantiation.
                     </p>
                     <p><a href="instantiation-and-oracle-streams-replication.html#GUID-44EF379E-1332-48B7-9223-02F07D168EDB__BABGIDGH" title="This table describes the results of each setting of the supplemental_logging parameter in the procedures that prepare database objects for instantiation.">Table 8-2</a> describes the values for the <code class="codeph">supplemental_logging</code> parameter for each procedure.
                     </p>
                     <div class="tblformalwide" id="GUID-44EF379E-1332-48B7-9223-02F07D168EDB__BABGIDGH">
                        <p class="titleintable">Table 8-2 Supplemental Logging Options During Preparation for Instantiation</p>
                        <table cellpadding="4" cellspacing="0" class="FormalWide" title="Supplemental Logging Options During Preparation for Instantiation" summary="This table describes the results of each setting of the supplemental_logging parameter in the procedures that prepare database objects for instantiation." width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="36%" id="d37209e1089">Procedure</th>
                                 <th align="left" valign="bottom" width="23%" id="d37209e1092">supplemental_logging Parameter Setting</th>
                                 <th align="left" valign="bottom" width="40%" id="d37209e1095">Description</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="36%" id="d37209e1100" headers="d37209e1089 ">
                                    <p><code class="codeph">PREPARE_TABLE_INSTANTIATION</code></p>
                                 </td>
                                 <td align="left" valign="top" width="23%" headers="d37209e1100 d37209e1092 ">
                                    <p><code class="codeph">keys</code></p>
                                 </td>
                                 <td align="left" valign="top" width="40%" headers="d37209e1100 d37209e1095 ">
                                    <p>The procedure enables supplemental logging for primary key, unique key, bitmap index, and foreign key columns in the table being prepared for instantiation. The procedure places the logged columns for the table in three separate log groups: the primary key columns in an unconditional log group, the unique key columns and bitmap index columns in a conditional log group, and the foreign key columns in a conditional log group.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="36%" id="d37209e1112" headers="d37209e1089 ">
                                    <p><code class="codeph">PREPARE_TABLE_INSTANTIATION</code></p>
                                 </td>
                                 <td align="left" valign="top" width="23%" headers="d37209e1112 d37209e1092 ">
                                    <p><code class="codeph">all</code></p>
                                 </td>
                                 <td align="left" valign="top" width="40%" headers="d37209e1112 d37209e1095 ">
                                    <p>The procedure enables supplemental logging for all columns in the table being prepared for instantiation. The procedure places all of the columns for the table in an unconditional log group.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="36%" id="d37209e1124" headers="d37209e1089 ">
                                    <p><code class="codeph">PREPARE_SCHEMA_INSTANTIATION</code></p>
                                 </td>
                                 <td align="left" valign="top" width="23%" headers="d37209e1124 d37209e1092 ">
                                    <p><code class="codeph">keys</code></p>
                                 </td>
                                 <td align="left" valign="top" width="40%" headers="d37209e1124 d37209e1095 ">
                                    <p>The procedure enables supplemental logging for primary key, unique key, bitmap index, and foreign key columns in the tables in the schema being prepared for instantiation and for any table added to this schema in the future. Primary key columns are logged unconditionally. Unique key, bitmap index, and foreign key columns are logged conditionally.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="36%" id="d37209e1136" headers="d37209e1089 ">
                                    <p><code class="codeph">PREPARE_SCHEMA_INSTANTIATION</code></p>
                                 </td>
                                 <td align="left" valign="top" width="23%" headers="d37209e1136 d37209e1092 ">
                                    <p><code class="codeph">all</code></p>
                                 </td>
                                 <td align="left" valign="top" width="40%" headers="d37209e1136 d37209e1095 ">
                                    <p>The procedure enables supplemental logging for all columns in the tables in the schema being prepared for instantiation and for any table added to this schema in the future. The columns are logged unconditionally.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="36%" id="d37209e1148" headers="d37209e1089 ">
                                    <p><code class="codeph">PREPARE_GLOBAL_INSTANTIATION</code></p>
                                 </td>
                                 <td align="left" valign="top" width="23%" headers="d37209e1148 d37209e1092 ">
                                    <p><code class="codeph">keys</code></p>
                                 </td>
                                 <td align="left" valign="top" width="40%" headers="d37209e1148 d37209e1095 ">
                                    <p>The procedure enables database supplemental logging for primary key, unique key, bitmap index, and foreign key columns in the tables in the database being prepared for instantiation and for any table added to the database in the future. Primary key columns are logged unconditionally. Unique key, bitmap index, and foreign key columns are logged conditionally.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="36%" id="d37209e1160" headers="d37209e1089 ">
                                    <p><code class="codeph">PREPARE_GLOBAL_INSTANTIATION</code></p>
                                 </td>
                                 <td align="left" valign="top" width="23%" headers="d37209e1160 d37209e1092 ">
                                    <p><code class="codeph">all</code></p>
                                 </td>
                                 <td align="left" valign="top" width="40%" headers="d37209e1160 d37209e1095 ">
                                    <p>The procedure enables supplemental logging for all columns in all of the tables in the database being prepared for instantiation and for any table added to the database in the future. The columns are logged unconditionally.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="36%" id="d37209e1172" headers="d37209e1089 ">
                                    <p>Any Prepare Procedure</p>
                                 </td>
                                 <td align="left" valign="top" width="23%" headers="d37209e1172 d37209e1092 ">
                                    <p><code class="codeph">none</code></p>
                                 </td>
                                 <td align="left" valign="top" width="40%" headers="d37209e1172 d37209e1095 ">
                                    <p>The procedure does not enable supplemental logging for any columns in the tables being prepared for instantiation.</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>If the <code class="codeph">supplemental_logging</code> parameter is not specified when one of prepare procedures is run, then <code class="codeph">keys</code> is the default. Some procedures in the <code class="codeph">DBMS_STREAMS_ADM</code> package prepare tables for instantiation when they add rules to a positive capture process rule set. In this case, the default supplemental logging option, <code class="codeph">keys</code>, is specified for the tables being prepared for instantiation.
                     </p>
                     <div class="infoboxnote" id="GUID-44EF379E-1332-48B7-9223-02F07D168EDB__GUID-220E2B7D-9529-40C1-ADF4-CB965F2B63C7">
                        <p class="notep1">Note:</p>
                        <p></p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>When <code class="codeph">all</code> is specified for the <code class="codeph">supplemental_logging</code> parameter, supplemental logging is not enabled for columns of the following types: LOB, <code class="codeph">LONG</code>, <code class="codeph">LONG</code> <code class="codeph">RAW</code>, user-defined type, and Oracle-supplied type.
                              </p>
                           </li>
                           <li>
                              <p>Specifying <code class="codeph">keys</code> for the <code class="codeph">supplemental_logging</code> parameter does not enable supplemental logging of bitmap join index columns.
                              </p>
                           </li>
                           <li>
                              <p>Oracle Database 10<span class="italic">g</span> Release 2 introduced the <code class="codeph">supplemental_logging</code> parameter for the prepare procedures. By default, running these procedures enables supplemental logging. Before this release, these procedures did not enable supplemental logging. If you remove an Oracle Streams environment, or if you remove certain database objects from an Oracle Streams environment, then you can also remove the supplemental logging enabled by these procedures to avoid unnecessary logging.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="infoboxnotealso" id="GUID-44EF379E-1332-48B7-9223-02F07D168EDB__GUID-EF129A6A-C59E-4ABB-8EE3-315F1DECFC6F">
                        <p class="notep1">See Also:</p>
                        <p></p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="q">"<a href="instantiation-and-oracle-streams-replication.html#GUID-CBDA09E8-D2E0-4E56-B7A7-E87BDC26FC5A">Preparing Database Objects for Instantiation at a Source Database</a>"</span></p>
                           </li>
                           <li>
                              <p><span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-12A4DC82-EEC7-4ACC-BF8F-8D82AA1D19DE">Specifying Supplemental Logging</a>"</span></p>
                           </li>
                           <li>
                              <p><span class="q">"<a href="instantiation-and-oracle-streams-replication.html#GUID-A067A70F-CAAD-4942-80A6-BDD6C66BD2EB">DBMS_STREAMS_ADM Package Procedures Automatically Prepare Objects</a>"</span></p>
                           </li>
                           <li>
                              <p><span class="q">"<a href="instantiation-and-oracle-streams-replication.html#GUID-207E8687-3B93-4782-80A3-92CD9B36947B">Aborting Preparation for Instantiation at a Source Database</a>"</span> for information about removing supplemental logging enabled by the prepare procedures
                              </p>
                           </li>
                           <li>
                              <p><a href="../sqlrf/Data-Types.html#SQLRF0021"><span class="italic">Oracle Database SQL Language Reference</span></a> for information about data types
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="STREP114"></a><div class="props_rev_3"><a id="GUID-CBDA09E8-D2E0-4E56-B7A7-E87BDC26FC5A" name="GUID-CBDA09E8-D2E0-4E56-B7A7-E87BDC26FC5A"></a><h4 id="STREP-GUID-CBDA09E8-D2E0-4E56-B7A7-E87BDC26FC5A" class="sect4"><span class="enumeration_section">8.2.4 </span>Preparing Database Objects for Instantiation at a Source Database
                  </h4>
                  <div>
                     <p>If you use the <code class="codeph">DBMS_STREAMS_ADM</code> package to create rules for a capture process or a synchronous capture, then any objects referenced in the system-created rules are prepared for instantiation automatically. If you use the <code class="codeph">DBMS_RULE_ADM</code> package to create rules for a capture process, then you must prepare the database objects referenced in these rules for instantiation manually. In this case, you should prepare a database object for instantiation after a capture process has been configured to capture changes to the database object. Synchronous captures ignore rules created by the <code class="codeph">DBMS_RULE_ADM</code> package.
                     </p>
                     <p>See <span class="q">"<a href="instantiation-and-oracle-streams-replication.html#GUID-49D5B599-16A8-40EB-8A2A-D4425F13682A">Capture Rules and Preparation for Instantiation</a>"</span> for information about the PL/SQL subprograms that prepare database objects for instantiation. If you run one of these procedures while a long running transaction is modifying one or more database objects being prepared for instantiation, then the procedure waits until the long running transaction is complete before it records the ignore&nbsp;SCN for the objects. The ignore SCN is the SCN below which changes to an object cannot be applied at destination databases. Query the <a href="../refrn/V-STREAMS_TRANSACTION.html#REFRN30415"><code class="codeph">V$STREAMS_TRANSACTION</code></a> dynamic performance view to monitor long running transactions being processed by a capture process or apply process.
                     </p>
                     <p>The following sections contain examples that prepare database objects for instantiation:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="instantiation-and-oracle-streams-replication.html#GUID-19FC31D5-2654-45E6-9EC5-B5828BF47526">Preparing Tables for Instantiation</a></p>
                        </li>
                        <li>
                           <p><a href="instantiation-and-oracle-streams-replication.html#GUID-6225F720-A593-432E-90B1-020AA2094FA7">Preparing the Database Objects in a Schema for Instantiation</a></p>
                        </li>
                        <li>
                           <p><a href="instantiation-and-oracle-streams-replication.html#GUID-6832412C-9F6C-4345-A32B-424B9E38C284">Preparing All of the Database Objects in a Database for Instantiation</a></p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-CBDA09E8-D2E0-4E56-B7A7-E87BDC26FC5A__GUID-59379C01-77BA-4795-9742-1C5BF79BC431">
                        <p class="notep1">See Also:</p>
                        <p><a href="../strms/advanced-apply-process-concepts.html#STRMS212"><span class="italic">Oracle Streams Concepts and Administration</span></a> for more information about the instantiation SCN and ignore SCN for an apply process
                        </p>
                     </div>
                  </div><a id="STREP324"></a><div class="props_rev_3"><a id="GUID-19FC31D5-2654-45E6-9EC5-B5828BF47526" name="GUID-19FC31D5-2654-45E6-9EC5-B5828BF47526"></a><h5 id="STREP-GUID-19FC31D5-2654-45E6-9EC5-B5828BF47526" class="sect5"><span class="enumeration_section">8.2.4.1 </span>Preparing Tables for Instantiation
                     </h5>
                     <div>
                        <p>This section contains these topics:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="instantiation-and-oracle-streams-replication.html#GUID-1920512C-89D4-405C-8839-AC939E83BEFA">Preparing a Table for Instantiation Using DBMS_STREAMS_ADM When a Capture Process Is Used</a></p>
                           </li>
                           <li>
                              <p><a href="instantiation-and-oracle-streams-replication.html#GUID-7E208F15-0248-4BCB-8BD9-31C27AC06D3B">Preparing a Table for Instantiation Using DBMS_CAPTURE_ADM When a Capture Process Is Used</a></p>
                           </li>
                           <li>
                              <p><a href="instantiation-and-oracle-streams-replication.html#GUID-916388AC-A793-4860-8202-E81094727288">Preparing Tables for Instantiation Using DBMS_STREAMS_ADM When a Synchronous Capture Is Used</a></p>
                           </li>
                           <li>
                              <p><a href="instantiation-and-oracle-streams-replication.html#GUID-80584FAA-B0F3-4CD7-ABD8-6EF1C12CEFE1">Preparing Tables for Instantiation Using DBMS_CAPTURE_ADM When a Synchronous Capture Is Used</a></p>
                           </li>
                        </ul>
                     </div><a id="STREP325"></a><div class="props_rev_3"><a id="GUID-1920512C-89D4-405C-8839-AC939E83BEFA" name="GUID-1920512C-89D4-405C-8839-AC939E83BEFA"></a><h6 id="STREP-GUID-1920512C-89D4-405C-8839-AC939E83BEFA" class="sect6"><span class="enumeration_section">8.2.4.1.1 </span>Preparing a Table for Instantiation Using DBMS_STREAMS_ADM When a Capture Process Is Used
                        </h6>
                        <div>
                           <div class="section">
                              <p>The example in this section prepares a table for instantiation using the <code class="codeph">DBMS_STREAMS_ADM</code> package when a capture process captures changes to the table. To prepare the <code class="codeph">hr.regions</code> table for instantiation and enable supplemental logging for any primary key, unique key, bitmap index, and foreign key columns in the table, add rules for the <code class="codeph">hr.regions</code> table to the positive rule set for a capture process using a procedure in the <code class="codeph">DBMS_STREAMS_ADM</code> package. If the capture process is a local capture process or a downstream capture process with a database link to the source database, then the procedure that you run prepares this table for instantiation automatically. 
                              </p>
                              <p>The following procedure adds rules to the positive rule set of a capture process named <code class="codeph">strm01_capture</code> and prepares the <code class="codeph">hr.regions</code> table for instantiation:
                              </p><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_STREAMS_ADM.ADD_TABLE_RULES(
    table_name     =&gt; 'hr.regions',   
    streams_type   =&gt; 'capture',
    streams_name   =&gt; 'strm01_capture',
    queue_name     =&gt; 'strmadmin.strm01_queue',
&nbsp;&nbsp;&nbsp; include_dml &nbsp;&nbsp;&nbsp;=&gt; TRUE,
    include_ddl &nbsp;&nbsp; =&gt; TRUE,
    inclusion_rule =&gt; TRUE);
END;
/
</pre><div class="infoboxnotealso" id="GUID-1920512C-89D4-405C-8839-AC939E83BEFA__GUID-DE6C9F19-02A9-4D61-8F40-33EC86392DF8">
                                 <p class="notep1">See Also:</p>
                                 <p><span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-12A4DC82-EEC7-4ACC-BF8F-8D82AA1D19DE">Specifying Supplemental Logging</a>"</span></p>
                              </div>
                           </div>
                           <!-- class="section" -->
                        </div>
                     </div><a id="STREP326"></a><div class="props_rev_3"><a id="GUID-7E208F15-0248-4BCB-8BD9-31C27AC06D3B" name="GUID-7E208F15-0248-4BCB-8BD9-31C27AC06D3B"></a><h6 id="STREP-GUID-7E208F15-0248-4BCB-8BD9-31C27AC06D3B" class="sect6"><span class="enumeration_section">8.2.4.1.2 </span>Preparing a Table for Instantiation Using DBMS_CAPTURE_ADM When a Capture Process Is Used
                        </h6>
                        <div>
                           <div class="section">
                              <p>The example in this section prepares a table for instantiation using the <code class="codeph">DBMS_CAPTURE_ADM</code> package when a capture process captures changes to the table. To prepare the <code class="codeph">hr.regions</code> table for instantiation and enable supplemental logging for any primary key, unique key, bitmap index, and foreign key columns in the table, run the following procedure:
                              </p><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_CAPTURE_ADM.PREPARE_TABLE_INSTANTIATION(
    table_name           =&gt; 'hr.regions',
    supplemental_logging =&gt; 'keys');
END;
/
</pre><p>The default value for the <code class="codeph">supplemental_logging</code> parameter is <code class="codeph">keys</code>. Therefore, if this parameter is not specified, then supplemental logging is enabled for any primary key, unique key, bitmap index, and foreign key columns in the table that is being prepared for instantiation.
                              </p>
                              <div class="infoboxnotealso" id="GUID-7E208F15-0248-4BCB-8BD9-31C27AC06D3B__GUID-9A077ACA-25CE-4916-9A11-DB4CBD8284AC">
                                 <p class="notep1">See Also:</p>
                                 <p><span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-12A4DC82-EEC7-4ACC-BF8F-8D82AA1D19DE">Specifying Supplemental Logging</a>"</span></p>
                              </div>
                           </div>
                           <!-- class="section" -->
                        </div>
                     </div><a id="STREP327"></a><div class="props_rev_3"><a id="GUID-916388AC-A793-4860-8202-E81094727288" name="GUID-916388AC-A793-4860-8202-E81094727288"></a><h6 id="STREP-GUID-916388AC-A793-4860-8202-E81094727288" class="sect6"><span class="enumeration_section">8.2.4.1.3 </span>Preparing Tables for Instantiation Using DBMS_STREAMS_ADM When a Synchronous Capture Is Used
                        </h6>
                        <div>
                           <div class="section">
                              <p>The example in this section prepares all of the tables in the <code class="codeph">hr</code> schema for instantiation using the <code class="codeph">DBMS_STREAMS_ADM</code> package when a synchronous capture captures changes to the tables.Add rules for the <code class="codeph">hr.jobs_transport</code> and <code class="codeph">hr.regions_transport</code> tables to the positive rule set for a synchronous capture using a procedure in the <code class="codeph">DBMS_STREAMS_ADM</code> package. The procedure that you run prepares the tables for instantiation automatically.
                              </p>
                              <p>The following procedure adds a rule to the positive rule set of a synchronous capture named <code class="codeph">sync_capture</code> and prepares the <code class="codeph">hr.regions</code> table for instantiation:
                              </p><pre class="oac_no_warn" dir="ltr">BEGIN 
  DBMS_STREAMS_ADM.ADD_TABLE_RULES(
    table_name   =&gt; 'hr.regions',
    streams_type =&gt; 'sync_capture',
    streams_name =&gt; 'sync_capture',
    queue_name   =&gt; 'strmadmin.streams_queue');
END;
/
</pre></div>
                           <!-- class="section" -->
                        </div>
                     </div><a id="STREP328"></a><div class="props_rev_3"><a id="GUID-80584FAA-B0F3-4CD7-ABD8-6EF1C12CEFE1" name="GUID-80584FAA-B0F3-4CD7-ABD8-6EF1C12CEFE1"></a><h6 id="STREP-GUID-80584FAA-B0F3-4CD7-ABD8-6EF1C12CEFE1" class="sect6"><span class="enumeration_section">8.2.4.1.4 </span>Preparing Tables for Instantiation Using DBMS_CAPTURE_ADM When a Synchronous Capture Is Used
                        </h6>
                        <div>
                           <div class="section">
                              <p>The example in this section prepares all of the tables in the <code class="codeph">hr</code> schema for instantiation using the <code class="codeph">DBMS_CAPTURE_ADM</code> package when a synchronous capture captures changes to the tables. To prepare the tables in the <code class="codeph">hr</code> schema for instantiation, run the following function:
                              </p><pre class="oac_no_warn" dir="ltr">SET SERVEROUTPUT ON
DECLARE
  tables       DBMS_UTILITY.UNCL_ARRAY;
  prepare_scn  NUMBER;
  BEGIN
    tables(1) := 'hr.departments';
    tables(2) := 'hr.employees';
    tables(3) := 'hr.countries';
    tables(4) := 'hr.regions';
    tables(5) := 'hr.locations';
    tables(6) := 'hr.jobs';
    tables(7) := 'hr.job_history';
    prepare_scn := DBMS_CAPTURE_ADM.PREPARE_SYNC_INSTANTIATION(
                      table_names =&gt; tables);
  DBMS_OUTPUT.PUT_LINE('Prepare SCN = ' || prepare_scn);
END;
/</pre></div>
                           <!-- class="section" -->
                        </div>
                     </div>
                  </div><a id="STREP329"></a><div class="props_rev_3"><a id="GUID-6225F720-A593-432E-90B1-020AA2094FA7" name="GUID-6225F720-A593-432E-90B1-020AA2094FA7"></a><h5 id="STREP-GUID-6225F720-A593-432E-90B1-020AA2094FA7" class="sect5"><span class="enumeration_section">8.2.4.2 </span>Preparing the Database Objects in a Schema for Instantiation
                     </h5>
                     <div>
                        <p>This section contains these topics:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="instantiation-and-oracle-streams-replication.html#GUID-D40F624E-24C6-4D6A-82F0-1B90507C5875">Preparing the Database Objects in a Schema for Instantiation Using DBMS_STREAMS_ADM</a></p>
                           </li>
                           <li>
                              <p><a href="instantiation-and-oracle-streams-replication.html#GUID-EE0A6C2A-2D6F-405B-9A9D-B5F72E123610">Preparing the Database Objects in a Schema for Instantiation Using DBMS_CAPTURE_ADM</a></p>
                           </li>
                        </ul>
                     </div><a id="STREP330"></a><div class="props_rev_3"><a id="GUID-D40F624E-24C6-4D6A-82F0-1B90507C5875" name="GUID-D40F624E-24C6-4D6A-82F0-1B90507C5875"></a><h6 id="STREP-GUID-D40F624E-24C6-4D6A-82F0-1B90507C5875" class="sect6"><span class="enumeration_section">8.2.4.2.1 </span>Preparing the Database Objects in a Schema for Instantiation Using DBMS_STREAMS_ADM
                        </h6>
                        <div>
                           <div class="section">
                              <p>The example in this section prepares the database objects in a schema for instantiation using the <code class="codeph">DBMS_STREAMS_ADM</code> package when a capture process captures changes to these objects. 
                              </p>
                              <p>To prepare the database objects in the <code class="codeph">hr</code> schema for instantiation and enable supplemental logging for the all columns in the tables in the <code class="codeph">hr</code> schema, run the following procedure, add rules for the <code class="codeph">hr</code> schema to the positive rule set for a capture process using a procedure in the <code class="codeph">DBMS_STREAMS_ADM</code> package. If the capture process is a local capture process or a downstream capture process with a database link to the source database, then the procedure that you run prepares the objects in the <code class="codeph">hr</code> schema for instantiation automatically. 
                              </p>
                              <p>The following procedure adds rules to the positive rule set of a capture process named <code class="codeph">strm01_capture</code> and prepares the <code class="codeph">hr</code> schema, and all of its database objects, for instantiation:
                              </p><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_STREAMS_ADM.ADD_SCHEMA_RULES(
 &nbsp;&nbsp;&nbsp;schema_name     =&gt;  'hr',
 &nbsp;&nbsp;&nbsp;streams_type    =&gt;  'capture',
 &nbsp;&nbsp;&nbsp;streams_name    =&gt;  'strm01_capture',
    queue_name      =&gt;  'strm01_queue',
 &nbsp;&nbsp;&nbsp;include_dml &nbsp;   =&gt;  TRUE,
&nbsp; &nbsp;&nbsp;include_ddl     =&gt;  TRUE,
    inclusion_rule  =&gt;  TRUE);
END;
/
</pre><p>If the specified capture process does not exist, then this procedure creates it.</p>
                              <p>In addition, supplemental logging is enabled for any primary key, unique key, bitmap index, and foreign key columns in the tables that are being prepared for instantiation.</p>
                              <div class="infoboxnotealso" id="GUID-D40F624E-24C6-4D6A-82F0-1B90507C5875__GUID-D2F991E4-3ED4-4E82-BC41-08802AA28A56">
                                 <p class="notep1">See Also:</p>
                                 <p><span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-12A4DC82-EEC7-4ACC-BF8F-8D82AA1D19DE">Specifying Supplemental Logging</a>"</span></p>
                              </div>
                           </div>
                           <!-- class="section" -->
                        </div><a id="STREP331"></a><div class="props_rev_3"><a id="GUID-EE0A6C2A-2D6F-405B-9A9D-B5F72E123610" name="GUID-EE0A6C2A-2D6F-405B-9A9D-B5F72E123610"></a><h6 id="STREP-GUID-EE0A6C2A-2D6F-405B-9A9D-B5F72E123610" class="sect6"><span class="enumeration_section">8.2.4.2.1.1 </span>Preparing the Database Objects in a Schema for Instantiation Using DBMS_CAPTURE_ADM
                           </h6>
                           <div>
                              <div class="section">
                                 <p>The example in this section prepares the database objects in a schema for instantiation using the <code class="codeph">DBMS_CAPTURE_ADM</code> package when a capture process captures changes to these objects. To prepare the database objects in the <code class="codeph">hr</code> schema for instantiation and enable supplemental logging for the all columns in the tables in the <code class="codeph">hr</code> schema, run the following procedure:
                                 </p><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_CAPTURE_ADM.PREPARE_SCHEMA_INSTANTIATION(
    schema_name          =&gt; 'hr',
    supplemental_logging =&gt; 'all');
END;
/
</pre><p>After running this procedure, supplemental logging is enabled for all of the columns in the tables in the <code class="codeph">hr</code> schema and for all of the columns in the tables added to the <code class="codeph">hr</code> schema in the future.
                                 </p>
                                 <div class="infoboxnotealso" id="GUID-EE0A6C2A-2D6F-405B-9A9D-B5F72E123610__GUID-DA5CA941-B589-4AA7-BB56-8C4A6EA7387D">
                                    <p class="notep1">See Also:</p>
                                    <p><span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-12A4DC82-EEC7-4ACC-BF8F-8D82AA1D19DE">Specifying Supplemental Logging</a>"</span></p>
                                 </div>
                              </div>
                              <!-- class="section" -->
                           </div>
                        </div>
                     </div>
                  </div><a id="STREP332"></a><div class="props_rev_3"><a id="GUID-6832412C-9F6C-4345-A32B-424B9E38C284" name="GUID-6832412C-9F6C-4345-A32B-424B9E38C284"></a><h5 id="STREP-GUID-6832412C-9F6C-4345-A32B-424B9E38C284" class="sect5"><span class="enumeration_section">8.2.4.3 </span>Preparing All of the Database Objects in a Database for Instantiation
                     </h5>
                     <div>
                        <p>This section contains these topics:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="instantiation-and-oracle-streams-replication.html#GUID-FBBC31BD-BC63-47E6-AA0E-D174EEAB667D">Preparing All of the Database Objects in a Database for Instantiation Using DBMS_STREAMS_ADM</a></p>
                           </li>
                           <li>
                              <p><a href="instantiation-and-oracle-streams-replication.html#GUID-CCCC5CA8-D050-4ED1-AC17-49F96A869B19">Preparing All of the Database Objects in a Database for Instantiation Using DBMS_CAPTURE_ADM</a></p>
                           </li>
                        </ul>
                     </div><a id="STREP333"></a><div class="props_rev_3"><a id="GUID-FBBC31BD-BC63-47E6-AA0E-D174EEAB667D" name="GUID-FBBC31BD-BC63-47E6-AA0E-D174EEAB667D"></a><h6 id="STREP-GUID-FBBC31BD-BC63-47E6-AA0E-D174EEAB667D" class="sect6"><span class="enumeration_section">8.2.4.3.1 </span>Preparing All of the Database Objects in a Database for Instantiation Using DBMS_STREAMS_ADM
                        </h6>
                        <div>
                           <div class="section">
                              <p>The example in this section prepares the database objects in a database for instantiation using the <code class="codeph">DBMS_STREAMS_ADM</code> package when a capture process captures changes to these objects. To prepare all of the database objects in a database for instantiation, run the <code class="codeph">ADD_GLOBAL_RULES</code> procedure in the <code class="codeph">DBMS_STREAMS_ADM</code> package:
                              </p><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_STREAMS_ADM.ADD_GLOBAL_RULES(
    streams_type   =&gt; 'capture',
    streams_name   =&gt; 'capture_db',
    queue_name     =&gt; 'strmadmin.streams_queue',
    include_dml    =&gt; TRUE,
    include_ddl    =&gt; TRUE,
    inclusion_rule =&gt; TRUE);
END;
/
</pre><p>If the specified capture process does not exist, then this procedure creates it.</p>
                              <p>In addition, supplemental logging is enabled for any primary key, unique key, bitmap index, and foreign key columns in the tables that are being prepared for instantiation.</p>
                              <div class="infoboxnotealso" id="GUID-FBBC31BD-BC63-47E6-AA0E-D174EEAB667D__GUID-95CD0E81-E0B8-4446-854F-2386A350C281">
                                 <p class="notep1">See Also:</p>
                                 <p><span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-12A4DC82-EEC7-4ACC-BF8F-8D82AA1D19DE">Specifying Supplemental Logging</a>"</span></p>
                              </div>
                           </div>
                           <!-- class="section" -->
                        </div><a id="STREP334"></a><div class="props_rev_3"><a id="GUID-CCCC5CA8-D050-4ED1-AC17-49F96A869B19" name="GUID-CCCC5CA8-D050-4ED1-AC17-49F96A869B19"></a><h6 id="STREP-GUID-CCCC5CA8-D050-4ED1-AC17-49F96A869B19" class="sect6"><span class="enumeration_section">8.2.4.3.1.1 </span>Preparing All of the Database Objects in a Database for Instantiation Using DBMS_CAPTURE_ADM
                           </h6>
                           <div>
                              <div class="section">
                                 <p>The example in this section prepares the database objects in a database for instantiation using the <code class="codeph">DBMS_CAPTURE_ADM</code> package when a capture process captures changes to these objects. To prepare all of the database objects in a database for instantiation, run the following procedure:
                                 </p><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_CAPTURE_ADM.PREPARE_GLOBAL_INSTANTIATION(
    supplemental_logging =&gt; 'none');
END;
/
</pre><p>Because <code class="codeph">none</code> is specified for the <code class="codeph">supplemental_logging</code> parameter, this procedure does not enable supplemental logging for any columns. However, you can specify supplemental logging manually using an <code class="codeph">ALTER</code> <code class="codeph">TABLE</code> or <code class="codeph">ALTER</code> <code class="codeph">DATABASE</code> statement.
                                 </p>
                                 <div class="infoboxnotealso" id="GUID-CCCC5CA8-D050-4ED1-AC17-49F96A869B19__GUID-4F0430BB-FA29-4CE2-BECE-D06CE21AA045">
                                    <p class="notep1">See Also:</p>
                                    <p><span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-12A4DC82-EEC7-4ACC-BF8F-8D82AA1D19DE">Specifying Supplemental Logging</a>"</span></p>
                                 </div>
                              </div>
                              <!-- class="section" -->
                           </div>
                        </div>
                     </div>
                  </div>
               </div><a id="STREP335"></a><div class="props_rev_3"><a id="GUID-207E8687-3B93-4782-80A3-92CD9B36947B" name="GUID-207E8687-3B93-4782-80A3-92CD9B36947B"></a><h4 id="STREP-GUID-207E8687-3B93-4782-80A3-92CD9B36947B" class="sect4"><span class="enumeration_section">8.2.5 </span>Aborting Preparation for Instantiation at a Source Database
                  </h4>
                  <div>
                     <div class="section">
                        <p>The following procedures in the <code class="codeph">DBMS_CAPTURE_ADM</code> package abort preparation for instantiation:
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">ABORT_TABLE_INSTANTIATION</code> reverses the effects of <code class="codeph">PREPARE_TABLE_INSTANTIATION</code> and removes any supplemental logging enabled by the <code class="codeph">PREPARE_TABLE_INSTANTIATION</code> procedure.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">ABORT_SYNC_INSTANTIATION</code> reverses the effects of <code class="codeph">PREPARE_SYNC_INSTANTIATION</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">ABORT_SCHEMA_INSTANTIATION</code> reverses the effects of <code class="codeph">PREPARE_SCHEMA_INSTANTIATION</code> and removes any supplemental logging enabled by the <code class="codeph">PREPARE_SCHEMA_INSTANTIATION</code> and <code class="codeph">PREPARE_TABLE_INSTANTIATION</code> procedures.
                              </p>
                           </li>
                           <li>
                              <p><code class="codeph">ABORT_GLOBAL_INSTANTIATION</code> reverses the effects of <code class="codeph">PREPARE_GLOBAL_INSTANTIATION</code> and removes any supplemental logging enabled by the <code class="codeph">PREPARE_GLOBAL_INSTANTIATION</code>, <code class="codeph">PREPARE_SCHEMA_INSTANTIATION</code>, and <code class="codeph">PREPARE_TABLE_INSTANTIATION</code> procedures.
                              </p>
                           </li>
                        </ul>
                        <p>These procedures remove data dictionary information related to the potential instantiation of the relevant database objects.</p>
                        <p>For example, to abort the preparation for instantiation of the <code class="codeph">hr.regions</code> table, run the following procedure:
                        </p><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_CAPTURE_ADM.ABORT_TABLE_INSTANTIATION(
    table_name  =&gt; 'hr.regions');
END;
/</pre></div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="STREP336"></a><div class="props_rev_3"><a id="GUID-AAB63D95-9728-4142-BB75-83356AE7C899" name="GUID-AAB63D95-9728-4142-BB75-83356AE7C899"></a><h3 id="STREP-GUID-AAB63D95-9728-4142-BB75-83356AE7C899" class="sect3"><span class="enumeration_section">8.3 </span>Oracle Data Pump and Oracle Streams Instantiation
               </h3>
               <div>
                  <p>The following sections contain information about performing Oracle Streams instantiations using Oracle Data Pump:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="instantiation-and-oracle-streams-replication.html#GUID-99C34F9A-E584-495C-9CC2-05905C9BCDBE">Data Pump Export and Object Consistency</a></p>
                     </li>
                     <li>
                        <p><a href="instantiation-and-oracle-streams-replication.html#GUID-EA661384-A2B7-4A21-A98D-400DFC020F9C">Oracle Data Pump Import and Oracle Streams Instantiation</a></p>
                     </li>
                     <li>
                        <p><a href="instantiation-and-oracle-streams-replication.html#GUID-E00E89D3-2ACB-4259-BC8B-3787DF576875">Instantiating Objects Using Data Pump Export/Import</a></p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-AAB63D95-9728-4142-BB75-83356AE7C899__GUID-43216A47-8644-4725-9B84-1AC2106322FF">
                     <p class="notep1">See Also:</p>
                     <p></p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=STRMS125"><span class="italic">Oracle Streams Concepts and Administration </span></a>for information about performing a full database export/import on a database using Oracle Streams
                           </p>
                        </li>
                        <li>
                           <p><a href="../sutil/oracle-data-pump-overview.html#SUTIL100"><span class="italic">Oracle Database Utilities </span></a>for more information about Data Pump
                           </p>
                        </li>
                     </ul>
                  </div>
               </div><a id="STREP337"></a><div class="props_rev_3"><a id="GUID-99C34F9A-E584-495C-9CC2-05905C9BCDBE" name="GUID-99C34F9A-E584-495C-9CC2-05905C9BCDBE"></a><h4 id="STREP-GUID-99C34F9A-E584-495C-9CC2-05905C9BCDBE" class="sect4"><span class="enumeration_section">8.3.1 </span>Data Pump Export and Object Consistency
                  </h4>
                  <div>
                     <p>During export, Oracle Data Pump automatically uses Oracle Flashback to ensure that the exported data and the exported procedural actions for each database object are consistent to a single point in time. When you perform an instantiation in an Oracle Streams environment, some degree of consistency is required. Using the Data Pump Export utility is sufficient to ensure this consistency for Oracle Streams instantiations.</p>
                     <p>If you are using an export dump file for other purposes in addition to an Oracle Streams instantiation, and these other purposes have more stringent consistency requirements than those provided by Data Pump's default export, then you can use the Data Pump Export utility parameters <code class="codeph">FLASHBACK_SCN</code> or <code class="codeph">FLASHBACK_TIME</code> for Oracle Streams instantiations. For example, if an export includes objects with foreign key constraints, then more stringent consistency might be required.
                     </p>
                  </div>
               </div><a id="STREP338"></a><div class="props_rev_3"><a id="GUID-EA661384-A2B7-4A21-A98D-400DFC020F9C" name="GUID-EA661384-A2B7-4A21-A98D-400DFC020F9C"></a><h4 id="STREP-GUID-EA661384-A2B7-4A21-A98D-400DFC020F9C" class="sect4"><span class="enumeration_section">8.3.2 </span>Oracle Data Pump Import and Oracle Streams Instantiation
                  </h4>
                  <div>
                     <p>The following sections provide information about Oracle Data Pump import and Oracle Streams instantiation:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="instantiation-and-oracle-streams-replication.html#GUID-C7163320-AD7E-4957-8162-C6653A74EB5A">Instantiation SCNs and Data Pump Imports</a></p>
                        </li>
                        <li>
                           <p><a href="instantiation-and-oracle-streams-replication.html#GUID-DC727837-86F3-4786-98DF-0071B8F3EDB9">Instantiation SCNs and Oracle Streams Tags Resulting from Data Pump Imports</a></p>
                        </li>
                        <li>
                           <p><a href="instantiation-and-oracle-streams-replication.html#GUID-3D8F02FD-80E9-41F0-A39B-56770AFAB937">The STREAMS_CONFIGURATION Data Pump Import Utility Parameter</a></p>
                        </li>
                     </ul>
                  </div><a id="STREP339"></a><div class="props_rev_3"><a id="GUID-C7163320-AD7E-4957-8162-C6653A74EB5A" name="GUID-C7163320-AD7E-4957-8162-C6653A74EB5A"></a><h5 id="STREP-GUID-C7163320-AD7E-4957-8162-C6653A74EB5A" class="sect5"><span class="enumeration_section">8.3.2.1 </span>Instantiation SCNs and Data Pump Imports
                     </h5>
                     <div>
                        <p>During a Data Pump import, an instantiation SCN is set at the import database for each database object that was prepared for instantiation at the export database before the Data Pump export was performed. The instantiation SCN settings are based on metadata obtained during Data Pump export.</p>
                        <div class="infoboxnotealso" id="GUID-C7163320-AD7E-4957-8162-C6653A74EB5A__GUID-C8FCEAE7-48B2-476F-8AA0-92494BDA578A">
                           <p class="notep1">See Also:</p>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=STRMS212"><span class="italic">Oracle Streams Concepts and Administration</span></a></p>
                        </div>
                     </div>
                  </div><a id="STREP340"></a><div class="props_rev_3"><a id="GUID-DC727837-86F3-4786-98DF-0071B8F3EDB9" name="GUID-DC727837-86F3-4786-98DF-0071B8F3EDB9"></a><h5 id="STREP-GUID-DC727837-86F3-4786-98DF-0071B8F3EDB9" class="sect5"><span class="enumeration_section">8.3.2.2 </span>Instantiation SCNs and Oracle Streams Tags Resulting from Data Pump Imports
                     </h5>
                     <div>
                        <p>A Data Pump import session can set its Oracle Streams tag to the hexadecimal equivalent of <code class="codeph">'00'</code> to avoid cycling the changes made by the import. Redo entries resulting from such an import have this tag value.
                        </p>
                        <p>Whether the import session tag is set to the hexadecimal equivalent of <code class="codeph">'00'</code> depends on the export that is being imported. Specifically, the import session tag is set to the hexadecimal equivalent of <code class="codeph">'00'</code> in either of the following cases:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The Data Pump export was in <code class="codeph">FULL</code> or <code class="codeph">SCHEMA</code> mode.
                              </p>
                           </li>
                           <li>
                              <p>The Data Pump export was in <code class="codeph">TABLE</code> or <code class="codeph">TABLESPACE</code> mode and at least one table included in the export was prepared for instantiation at the export database before the export was performed.
                              </p>
                           </li>
                        </ul>
                        <p>If neither one of these conditions is true for a Data Pump export that is being imported, then the import session tag is <code class="codeph">NULL</code>.
                        </p>
                        <div class="infoboxnote" id="GUID-DC727837-86F3-4786-98DF-0071B8F3EDB9__GUID-0B1306A3-7EAF-4B70-ACBE-2CD54B3BD54D">
                           <p class="notep1">Note:</p>
                           <p></p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>If you perform a network import using Data Pump, then an implicit export is performed in the same mode as the import. For example, if the network import is in schema mode, then the implicit export is in schema mode also.</p>
                              </li>
                              <li>
                                 <p>The import session tag is not set if the Data Pump import is performed in <code class="codeph">TRANSPORTABLE</code> <code class="codeph">TABLESPACE</code> mode. An import performed in this mode does not generate any redo data for the imported data. Therefore, setting the session tag is not required.
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <div class="infoboxnotealso" id="GUID-DC727837-86F3-4786-98DF-0071B8F3EDB9__GUID-1EA44827-1E2E-4540-ACCC-61B614B7D076">
                           <p class="notep1">See Also:</p>
                           <p><a href="oracle-streams-tags.html#GUID-9339D29B-65F3-450B-B3CD-A7B4ADCA4AAF"> Oracle Streams Tags</a></p>
                        </div>
                     </div>
                  </div><a id="STREP341"></a><div class="props_rev_3"><a id="GUID-3D8F02FD-80E9-41F0-A39B-56770AFAB937" name="GUID-3D8F02FD-80E9-41F0-A39B-56770AFAB937"></a><h5 id="STREP-GUID-3D8F02FD-80E9-41F0-A39B-56770AFAB937" class="sect5"><span class="enumeration_section">8.3.2.3 </span>The STREAMS_CONFIGURATION Data Pump Import Utility Parameter
                     </h5>
                     <div>
                        <p>The <code class="codeph">STREAMS_CONFIGURATION</code> Data Pump Import utility parameter specifies whether to import any general Oracle Streams metadata that is present in the export dump file. This import parameter is relevant only if you are performing a full database import. By default, the <code class="codeph">STREAMS_CONFIGURATION</code> Import utility parameter is set to <code class="codeph">y</code>. Typically, specify <code class="codeph">y</code> if an import is part of a backup or restore operation.
                        </p>
                        <p>The following objects are imported regardless of the <code class="codeph">STREAMS_CONFIGURATION</code> setting if the information is present in the export dump file:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">ANYDATA</code> queues and their queue tables
                              </p>
                           </li>
                           <li>
                              <p>Queue subscribers</p>
                           </li>
                           <li>
                              <p>Advanced Queuing agents</p>
                           </li>
                           <li>
                              <p>Rules, including their positive and negative rule sets and evaluation contexts. All rules are imported, including Oracle Streams rules and non-Oracle Streams rules. Oracle Streams rules are rules generated by the system when certain procedures in the <code class="codeph">DBMS_STREAMS_ADM</code> package are run, while non-Oracle Streams rules are rules created using the <code class="codeph">DBMS_RULE_ADM</code> package.
                              </p>
                              <p>If the <code class="codeph">STREAMS_CONFIGURATION</code> parameter is set to <code class="codeph">n</code>, then information about Oracle Streams rules is not imported into the following data dictionary views: <code class="codeph">ALL_STREAMS_RULES</code>, <code class="codeph">ALL_STREAMS_GLOBAL_RULES</code>, <code class="codeph">ALL_STREAMS_SCHEMA_RULES</code>, <code class="codeph">ALL_STREAMS_TABLE_RULES</code>, <code class="codeph">DBA_STREAMS_RULES</code>, <code class="codeph">DBA_STREAMS_GLOBAL_RULES</code>, <code class="codeph">DBA_STREAMS_SCHEMA_RULES</code>, and <code class="codeph">DBA_STREAMS_TABLE_RULES</code>. However, regardless of the <code class="codeph">STREAMS_CONFIGURATION</code> parameter setting, information about these rules is imported into the <code class="codeph">ALL_RULES</code>, <code class="codeph">ALL_RULE_SETS</code>, <code class="codeph">ALL_RULE_SET_RULES</code>, <code class="codeph">DBA_RULES</code>, <code class="codeph">DBA_RULE_SETS</code>, <code class="codeph">DBA_RULE_SET_RULES</code>, <code class="codeph">USER_RULES</code>, <code class="codeph">USER_RULE_SETS</code>, and <code class="codeph">USER_RULE_SET_RULES</code> data dictionary views.
                              </p>
                           </li>
                        </ul>
                        <p>When the <code class="codeph">STREAMS_CONFIGURATION</code> Import utility parameter is set to <code class="codeph">y</code>, the import includes the following information, if the information is present in the export dump file;&nbsp;when the <code class="codeph">STREAMS_CONFIGURATION</code> Import utility parameter is set to <code class="codeph">n</code>, the import does not include the following information:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Capture processes that capture local changes, including the following information for each capture process:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>Name of the capture process</p>
                                 </li>
                                 <li>
                                    <p>State of the capture process</p>
                                 </li>
                                 <li>
                                    <p>Capture process parameter settings</p>
                                 </li>
                                 <li>
                                    <p>Queue owner and queue name of the queue used by the capture process</p>
                                 </li>
                                 <li>
                                    <p>Rule set owner and rule set name of each positive and negative rule set used by the capture process</p>
                                 </li>
                                 <li>
                                    <p>Capture user for the capture process</p>
                                 </li>
                                 <li>
                                    <p>The time that the status of the capture process last changed. This information is recorded in the <code class="codeph">DBA_CAPTURE</code> data dictionary view.
                                    </p>
                                 </li>
                                 <li>
                                    <p>If the capture process disabled or aborted, then the error number and message of the error that was the cause. This information is recorded in the <code class="codeph">DBA_CAPTURE</code> data dictionary view.
                                    </p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>Synchronous captures, including the following information for each synchronous capture:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>Name of the synchronous capture</p>
                                 </li>
                                 <li>
                                    <p>Queue owner and queue name of the queue used by the synchronous capture</p>
                                 </li>
                                 <li>
                                    <p>Rule set owner and rule set name of each rule set used by the synchronous capture</p>
                                 </li>
                                 <li>
                                    <p>Capture user for the synchronous capture</p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>If any tables have been prepared for instantiation at the export database, then these tables are prepared for instantiation at the import database.</p>
                           </li>
                           <li>
                              <p>If any schemas have been prepared for instantiation at the export database, then these schemas are prepared for instantiation at the import database.</p>
                           </li>
                           <li>
                              <p>If the export database has been prepared for instantiation, then the import database is prepared for instantiation.</p>
                           </li>
                           <li>
                              <p>The state of each <code class="codeph">ANYDATA</code> queue that is used by an Oracle Streams client, either started or stopped. Oracle Streams clients include capture processes, synchronous captures, propagations, apply process, and messaging clients. <code class="codeph">ANYDATA</code> queues themselves are imported regardless of the <code class="codeph">STREAMS_CONFIGURATION</code> Import utility parameter setting.
                              </p>
                           </li>
                           <li>
                              <p>Propagations, including the following information for each propagation:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>Name of the propagation</p>
                                 </li>
                                 <li>
                                    <p>Queue owner and queue name of the source queue</p>
                                 </li>
                                 <li>
                                    <p>Queue owner and queue name of the destination queue</p>
                                 </li>
                                 <li>
                                    <p>Destination database link</p>
                                 </li>
                                 <li>
                                    <p>Rule set owner and rule set name of each positive and negative rule set used by the propagation</p>
                                 </li>
                                 <li>
                                    <p>Oracle Scheduler jobs related to Oracle Streams propagations</p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>Apply processes, including the following information for each apply process:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>Name of the apply process</p>
                                 </li>
                                 <li>
                                    <p>State of the apply process</p>
                                 </li>
                                 <li>
                                    <p>Apply process parameter settings</p>
                                 </li>
                                 <li>
                                    <p>Queue owner and queue name of the queue used by the apply process</p>
                                 </li>
                                 <li>
                                    <p>Rule set owner and rule set name of each positive and negative rule set used by the apply process</p>
                                 </li>
                                 <li>
                                    <p>Whether the apply process applies captured LCRs in a buffered queue or messages in a persistent queue</p>
                                 </li>
                                 <li>
                                    <p>Apply user for the apply process</p>
                                 </li>
                                 <li>
                                    <p>Message handler used by the apply process, if one exists</p>
                                 </li>
                                 <li>
                                    <p>DDL handler used by the apply process, if one exists.</p>
                                 </li>
                                 <li>
                                    <p>Precommit handler used by the apply process, if one exists</p>
                                 </li>
                                 <li>
                                    <p>Tag value generated in the redo log for changes made by the apply process</p>
                                 </li>
                                 <li>
                                    <p>Apply database link, if one exists</p>
                                 </li>
                                 <li>
                                    <p>Source database for the apply process</p>
                                 </li>
                                 <li>
                                    <p>The information about apply progress in the <code class="codeph">DBA_APPLY_PROGRESS</code> data dictionary view, including applied message number, oldest message number (oldest SCN), apply time, and applied message create time
                                    </p>
                                 </li>
                                 <li>
                                    <p>Apply errors</p>
                                 </li>
                                 <li>
                                    <p>The time that the status of the apply process last changed. This information is recorded in the <code class="codeph">DBA_APPLY</code> data dictionary view
                                    </p>
                                 </li>
                                 <li>
                                    <p>If the apply process disabled or aborted, then the error number and message of the error that was the cause. This information is recorded in the <code class="codeph">DBA_APPLY</code> data dictionary view.
                                    </p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>DML handlers (including both statement DML handlers and procedure DML handlers)</p>
                           </li>
                           <li>
                              <p>Error handlers</p>
                           </li>
                           <li>
                              <p>Update conflict handlers</p>
                           </li>
                           <li>
                              <p>Substitute key columns for apply tables</p>
                           </li>
                           <li>
                              <p>Instantiation SCN for each apply object</p>
                           </li>
                           <li>
                              <p>Ignore SCN for each apply object</p>
                           </li>
                           <li>
                              <p>Messaging clients, including the following information for each messaging client:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>Name of the messaging client</p>
                                 </li>
                                 <li>
                                    <p>Queue owner and queue name of the queue used by the messaging client</p>
                                 </li>
                                 <li>
                                    <p>Rule set owner and rule set name of each positive and negative rule set used by the messaging client</p>
                                 </li>
                                 <li>
                                    <p>Message notification settings</p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>Some data dictionary information about Oracle Streams rules. The rules themselves are imported regardless of the setting for the <code class="codeph">STREAMS_CONFIGURATION</code> parameter.
                              </p>
                           </li>
                           <li>
                              <p>Data dictionary information about Oracle Streams administrators, messaging clients, message rules, extra attributes included in logical change records (LCRs) captured by a capture process or synchronous capture, and extra attributes used in message rules</p>
                           </li>
                        </ul>
                        <div class="infoboxnote" id="GUID-3D8F02FD-80E9-41F0-A39B-56770AFAB937__GUID-53B0525D-3229-4FB6-B6A3-EA3F842A648F">
                           <p class="notep1">Note:</p>
                           <p>Downstream capture processes are not included in an import regardless of the <code class="codeph">STREAMS_CONFIGURATION</code> setting.
                           </p>
                        </div>
                     </div>
                  </div>
               </div><a id="STREP342"></a><div class="props_rev_3"><a id="GUID-E00E89D3-2ACB-4259-BC8B-3787DF576875" name="GUID-E00E89D3-2ACB-4259-BC8B-3787DF576875"></a><h4 id="STREP-GUID-E00E89D3-2ACB-4259-BC8B-3787DF576875" class="sect4"><span class="enumeration_section">8.3.3 </span>Instantiating Objects Using Data Pump Export/Import
                  </h4>
                  <div>
                     <div class="section">
                        <p>The example in this section describes the steps required to instantiate objects in an Oracle Streams environment using Oracle Data Pump export/import. This example makes the following assumptions:</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>You want to capture changes to all of the database objects in the <code class="codeph">hr</code> schema at a source database and apply these changes at a separate destination database. 
                              </p>
                           </li>
                           <li>
                              <p>The <code class="codeph">hr</code> schema exists at the source database but does not exist at the destination database. For the purposes of this example, you can drop the <code class="codeph">hr</code> user at the destination database using the following SQL statement:
                              </p><pre class="oac_no_warn" dir="ltr">DROP USER hr CASCADE;
</pre><p>The Data Pump import re-creates the user and the user's database objects at the destination database.</p>
                           </li>
                           <li>
                              <p>You have configured an Oracle Streams administrator at the source database and the destination database named <code class="codeph">strmadmin</code>. At each database, the Oracle Streams administrator is granted <code class="codeph">DBA</code> role.
                              </p>
                           </li>
                        </ul>
                        <div class="infoboxnote" id="GUID-E00E89D3-2ACB-4259-BC8B-3787DF576875__GUID-5FB27D5A-53DC-444B-975A-C66A7162F7F2">
                           <p class="notep1">Note:</p>
                           <p>The example in this section uses the command line Data Pump utility. You can also use the <code class="codeph">DBMS_DATAPUMP</code> package for Oracle Streams instantiations.
                           </p>
                        </div>
                        <div class="infoboxnotealso" id="GUID-E00E89D3-2ACB-4259-BC8B-3787DF576875__GUID-C5FA8786-6F0B-4A04-ADED-49759D87C54C">
                           <p class="notep1">See Also:</p>
                           <p></p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-EF5A403D-42E5-426D-B654-456E634F53B0">Configuring an Oracle Streams Administrator on All Databases</a>"</span></p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=SUTIL100"><span class="italic">Oracle Database Utilities </span></a>for more information about Data Pump
                                 </p>
                              </li>
                              <li>
                                 <p><a href="../strex/toc.htm"><span class="italic">Oracle Streams Extended Examples</span></a> for examples that use the <code class="codeph">DBMS_DATAPUMP</code> package for Oracle Streams instantiations
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <p>Given these assumptions, complete the following steps to instantiate the <code class="codeph">hr</code> schema using Data Pump export/import:
                        </p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>In SQL*Plus, connect to the source database as the Oracle Streams administrator.</span><div>
                              <p>See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ADMIN00102"><span class="italic">Oracle Database Administrator's Guide</span></a> for instructions about connecting to a database in SQL*Plus.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand" id="GUID-E00E89D3-2ACB-4259-BC8B-3787DF576875__BABEHFJC"><span>Create a directory object to hold the export dump file and export log file:</span><div><pre class="oac_no_warn" dir="ltr">CREATE DIRECTORY DPUMP_DIR AS '/usr/dpump_dir';
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Prepare the database objects in the <code class="codeph">hr</code> schema for instantiation. See <span class="q">"<a href="instantiation-and-oracle-streams-replication.html#GUID-6225F720-A593-432E-90B1-020AA2094FA7">Preparing the Database Objects in a Schema for Instantiation</a>"</span> for instructions.</span></li>
                        <li class="stepexpand"><span>While still connected to the source database as the Oracle Streams administrator, determine the current system change number (SCN) of the source database:</span><div><pre class="oac_no_warn" dir="ltr">SELECT DBMS_FLASHBACK.GET_SYSTEM_CHANGE_NUMBER FROM DUAL;
</pre><p>The SCN value returned by this query is specified for the <code class="codeph">FLASHBACK_SCN</code> Data Pump export parameter in Step <a href="instantiation-and-oracle-streams-replication.html#GUID-E00E89D3-2ACB-4259-BC8B-3787DF576875__i1014585">5</a>. Because the <code class="codeph">hr</code> schema includes foreign key constraints between tables, the <code class="codeph">FLASHBACK_SCN</code> export parameter, or a similar export parameter, must be specified during export. In this example, assume that the query returned <code class="codeph">876606</code>.
                              </p>
                              <p>After you perform this query, ensure that no DDL changes are made to the objects being exported until after the export is complete.</p>
                           </div>
                        </li>
                        <li class="stepexpand" id="GUID-E00E89D3-2ACB-4259-BC8B-3787DF576875__i1014585"><span>On a command line, use Data Pump to export the <code class="codeph">hr</code> schema at the source database. </span><div>
                              <p>Perform the export by connecting as an administrative user who is granted <code class="codeph">EXP_FULL_DATABASE</code> role. This user also must have <code class="codeph">READ</code> and <code class="codeph">WRITE</code> privilege on the directory object created in Step <a href="instantiation-and-oracle-streams-replication.html#GUID-E00E89D3-2ACB-4259-BC8B-3787DF576875__BABEHFJC">2</a>. This example connects as the Oracle Streams administrator <code class="codeph">strmadmin</code>.
                              </p>
                              <p>The following is a sample Data Pump export command:</p><pre class="oac_no_warn" dir="ltr">expdp strmadmin SCHEMAS=hr DIRECTORY=DPUMP_DIR DUMPFILE=hr_schema_dp.dmp 
FLASHBACK_SCN=876606
</pre><div class="infoboxnotealso" id="GUID-E00E89D3-2ACB-4259-BC8B-3787DF576875__GUID-F951511E-C23C-4FDC-8F85-07E7633BC31A">
                                 <p class="notep1">See Also:</p>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=SUTIL200"><span class="italic">Oracle Database Utilities </span></a>for information about performing a Data Pump export
                                 </p>
                              </div>
                           </div>
                        </li>
                        <li class="stepexpand"><span>In SQL*Plus, connect to the destination database as the Oracle Streams administrator.</span></li>
                        <li class="stepexpand" id="GUID-E00E89D3-2ACB-4259-BC8B-3787DF576875__i1013790"><span>Create a directory object to hold the import dump file and import log file:</span><div><pre class="oac_no_warn" dir="ltr">CREATE DIRECTORY DPUMP_DIR AS '/usr/dpump_dir';
</pre></div>
                        </li>
                        <li class="stepexpand"><span>Transfer the Data Pump export dump file <code class="codeph">hr_schema_dp.dmp</code> to the destination database. You can use the <code class="codeph">DBMS_FILE_TRANSFER</code> package, binary FTP, or some other method to transfer the file to the destination database. After the file transfer, the export dump file should reside in the directory that corresponds to the directory object created in Step <a href="instantiation-and-oracle-streams-replication.html#GUID-E00E89D3-2ACB-4259-BC8B-3787DF576875__i1013790">7</a>.</span></li>
                        <li class="stepexpand"><span>On a command line at the destination database, use Data Pump to import the export dump file <code class="codeph">hr_schema_dp.dmp</code>. Ensure that no changes are made to the tables in the schema being imported at the destination database until the import is complete. Performing the import automatically sets the instantiation SCN for the <code class="codeph">hr</code> schema and all of its database objects at the destination database.</span><div>
                              <p>Perform the import by connecting as an administrative user who is granted <code class="codeph">IMP_FULL_DATABASE</code> role. This user also must have <code class="codeph">READ</code> and <code class="codeph">WRITE</code> privilege on the directory object created in Step <a href="instantiation-and-oracle-streams-replication.html#GUID-E00E89D3-2ACB-4259-BC8B-3787DF576875__i1013790">7</a>. This example connects as the Oracle Streams administrator <code class="codeph">strmadmin</code>.
                              </p>
                              <p>The following is a sample import command:</p><pre class="oac_no_warn" dir="ltr">impdp strmadmin SCHEMAS=hr DIRECTORY=DPUMP_DIR DUMPFILE=hr_schema_dp.dmp
</pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <div class="infoboxnote" id="GUID-E00E89D3-2ACB-4259-BC8B-3787DF576875__GUID-F8CCF891-610B-4AE4-9341-6727523A3A99">
                           <p class="notep1">Note:</p>
                           <p>Any table supplemental log groups for the tables exported from the export database are retained when the tables are imported at the import database. You can drop these supplemental log groups if necessary.</p>
                        </div>
                        <div class="infoboxnotealso" id="GUID-E00E89D3-2ACB-4259-BC8B-3787DF576875__GUID-8CD31FE4-DA6D-4255-BB11-03045D5CE4DC">
                           <p class="notep1">See Also:</p>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=SUTIL300"><span class="italic">Oracle Database Utilities </span></a>for information about performing a Data Pump import
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div><a id="STREP139"></a><div class="props_rev_3"><a id="GUID-34BBF85F-E48A-497E-94F4-54911224CDEC" name="GUID-34BBF85F-E48A-497E-94F4-54911224CDEC"></a><h3 id="STREP-GUID-34BBF85F-E48A-497E-94F4-54911224CDEC" class="sect3"><span class="enumeration_section">8.4 </span>Recovery Manager (RMAN) and Oracle Streams Instantiation
               </h3>
               <div>
                  <p>The RMAN <code class="codeph">TRANSPORT</code> <code class="codeph">TABLESPACE</code> command can instantiate a tablespace or set of tablespaces, and the RMAN <code class="codeph">DUPLICATE</code> and <code class="codeph">CONVERT</code> <code class="codeph">DATABASE</code> commands can instantiate an entire database. Using RMAN for instantiation usually is faster than other instantiation methods.
                  </p>
                  <p>The following sections contain information about using these RMAN commands for instantiation:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="instantiation-and-oracle-streams-replication.html#GUID-E74B9C41-8F19-423F-9CC0-9CF8B34569FD">Instantiating Objects in a Tablespace Using Transportable Tablespace or RMAN</a></p>
                     </li>
                     <li>
                        <p><a href="instantiation-and-oracle-streams-replication.html#GUID-65A7F70C-C849-40FB-8351-CFF3114C9271">Instantiating an Entire Database Using RMAN</a></p>
                     </li>
                  </ul>
               </div><a id="STREP343"></a><div class="props_rev_3"><a id="GUID-E74B9C41-8F19-423F-9CC0-9CF8B34569FD" name="GUID-E74B9C41-8F19-423F-9CC0-9CF8B34569FD"></a><h4 id="STREP-GUID-E74B9C41-8F19-423F-9CC0-9CF8B34569FD" class="sect4"><span class="enumeration_section">8.4.1 </span>Instantiating Objects in a Tablespace Using Transportable Tablespace or RMAN
                  </h4>
                  <div>
                     <p>The RMAN <code class="codeph">TRANSPORT</code> <code class="codeph">TABLESPACE</code> command uses Data Pump and an RMAN-managed auxiliary instance to export the database objects in a tablespace or tablespace set while the tablespace or tablespace set remains online in the source database. RMAN automatically starts an auxiliary instance with a system-generated name. The RMAN <code class="codeph">TRANSPORT</code> <code class="codeph">TABLESPACE</code> command produces a Data Pump export dump file and data files for the tablespace or tablespaces.
                     </p>
                     <p>You can use Data Pump to import the dump file at the destination database, or you can use the <code class="codeph">ATTACH_TABLESPACES</code> procedure in the <code class="codeph">DBMS_STREAMS_TABLESPACE_ADM</code> package to attach the tablespace or tablespaces to the destination database. Also, instantiation SCN values for the database objects in the tablespace or tablespaces are set automatically at the destination database when the tablespaces are imported or attached.
                     </p>
                     <div class="infoboxnote" id="GUID-E74B9C41-8F19-423F-9CC0-9CF8B34569FD__GUID-F40E1839-9563-4EEF-9197-01A7E19AEC60">
                        <p class="notep1">Note:</p>
                        <p>The RMAN <code class="codeph">TRANSPORT</code> <code class="codeph">TABLESPACE</code> command does not support user-managed auxiliary instances.
                        </p>
                     </div>
                     <p>The examples in this section describe the steps required to instantiate the database objects in a tablespace using transportable tablespace or RMAN. These instantiation options usually are faster than export/import. The following examples instantiate the database objects in a tablespace:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><span class="q">"<a href="instantiation-and-oracle-streams-replication.html#GUID-697E750C-6920-4D44-909D-AB9CA2A75951">Instantiating Objects Using Transportable Tablespace</a>"</span> uses the transportable tablespace feature to complete the instantiation. Data Pump exports the tablespace at the source database and imports the tablespace at the destination database. The tablespace is read-only during the export.
                           </p>
                        </li>
                        <li>
                           <p><span class="q">"<a href="instantiation-and-oracle-streams-replication.html#GUID-89AEE784-C5CF-4D57-94BC-D636A123E9D5">Instantiating Objects Using Transportable Tablespace From Backup With RMAN</a>"</span> uses the RMAN <code class="codeph">TRANSPORT</code> <code class="codeph">TABLESPACE</code> command to generate a Data Pump export dump file and data files for a tablespace or set of tablespaces at the source database while the tablespace or tablespaces remain online. Either Data Pump import or the <code class="codeph">ATTACH_TABLESPACES</code> procedure in the <code class="codeph">DBMS_STREAMS_TABLESPACE_ADM</code> package can add the tablespace or tablespaces to the destination database.
                           </p>
                        </li>
                     </ul>
                     <p>These examples instantiate a tablespace set that includes a tablespace called <code class="codeph">jobs_tbs</code>, and a tablespace called <code class="codeph">regions_tbs</code>. To run the examples, connect to the source database in SQL*Plus as an administrative user and create the new tablespaces:
                     </p><pre class="oac_no_warn" dir="ltr">CREATE TABLESPACE jobs_tbs DATAFILE '/usr/oracle/dbs/jobs_tbs.dbf' SIZE 5 M;

CREATE TABLESPACE regions_tbs DATAFILE '/usr/oracle/dbs/regions_tbs.dbf' SIZE 5 M;
</pre><p>Place the new table <code class="codeph">hr.jobs_transport</code> in the <code class="codeph">jobs_tbs</code> tablespace:
                     </p><pre class="oac_no_warn" dir="ltr">CREATE TABLE hr.jobs_transport TABLESPACE jobs_tbs AS 
  SELECT * FROM hr.jobs;
</pre><p>Place the new table <code class="codeph">hr.regions_transport</code> in the <code class="codeph">regions_tbs</code> tablespace:
                     </p><pre class="oac_no_warn" dir="ltr">CREATE TABLE hr.regions_transport TABLESPACE regions_tbs AS 
  SELECT * FROM hr.regions;
</pre><p>Both of the examples make the following assumptions:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>You want to capture all of the changes to the <code class="codeph">hr.jobs_transport</code> and <code class="codeph">hr.regions_transport</code> tables at a source database and apply these changes at a separate destination database. 
                           </p>
                        </li>
                        <li>
                           <p>The <code class="codeph">hr.jobs_transport</code> table exists at a source database, and a single self-contained tablespace named <code class="codeph">jobs_tbs</code> contains the table. The <code class="codeph">jobs_tbs</code> tablespace is stored in a single data file named <code class="codeph">jobs_tbs.dbf</code>.
                           </p>
                        </li>
                        <li>
                           <p>The <code class="codeph">hr.regions_transport</code> table exists at a source database, and a single self-contained tablespace named <code class="codeph">regions_tbs</code> contains the table. The <code class="codeph">regions_tbs</code> tablespace is stored in a single data file named <code class="codeph">regions_tbs.dbf</code>.
                           </p>
                        </li>
                        <li>
                           <p>The <code class="codeph">jobs_tbs</code> and <code class="codeph">regions_tbs</code> tablespaces do not contain data from any other schemas.
                           </p>
                        </li>
                        <li>
                           <p>The <code class="codeph">hr.jobs_transport</code> table, the <code class="codeph">hr.regions_transport</code> table, the <code class="codeph">jobs_tbs</code> tablespace, and the <code class="codeph">regions_tbs</code> tablespace do not exist at the destination database.
                           </p>
                        </li>
                        <li>
                           <p>You have configured an Oracle Streams administrator at both the source database and the destination database named <code class="codeph">strmadmin</code>, and you have granted this Oracle Streams administrator <code class="codeph">DBA</code> role at both databases.
                           </p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-E74B9C41-8F19-423F-9CC0-9CF8B34569FD__GUID-51DC6C9A-CC9F-458C-AEAD-A99B7925081A">
                        <p class="notep1">See Also:</p>
                        <p></p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="q">"<a href="comparing-and-converging-data.html#GUID-BE4621F5-4EEC-491C-9141-ABDCCA282D9E">Checking for Consistency After Instantiation</a>"</span></p>
                           </li>
                           <li>
                              <p><span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-EF5A403D-42E5-426D-B654-456E634F53B0">Configuring an Oracle Streams Administrator on All Databases</a>"</span></p>
                           </li>
                           <li>
                              <p><a href="../admin/index.html"><span class="italic">Oracle Database Administrator's Guide</span></a> for instructions about connecting to a database in SQL*Plus
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="STREP344"></a><div class="props_rev_3"><a id="GUID-697E750C-6920-4D44-909D-AB9CA2A75951" name="GUID-697E750C-6920-4D44-909D-AB9CA2A75951"></a><h5 id="STREP-GUID-697E750C-6920-4D44-909D-AB9CA2A75951" class="sect5"><span class="enumeration_section">8.4.1.1 </span>Instantiating Objects Using Transportable Tablespace
                     </h5>
                     <div>
                        <div class="section">
                           <p>This example uses transportable tablespace to instantiate the database objects in a tablespace set. In addition to the assumptions listed in <span class="q">"<a href="instantiation-and-oracle-streams-replication.html#GUID-E74B9C41-8F19-423F-9CC0-9CF8B34569FD">Instantiating Objects in a Tablespace Using Transportable Tablespace or RMAN</a>"</span>, this example makes the following assumptions:
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>The Oracle Streams administrator at the source database is granted the <code class="codeph">EXP_FULL_DATABASE</code> role to perform the transportable tablespaces export. The <code class="codeph">DBA</code> role is sufficient because it includes the <code class="codeph">EXP_FULL_DATABASE</code> role. In this example, the Oracle Streams administrator performs the transportable tablespaces export.
                                 </p>
                              </li>
                              <li>
                                 <p>The Oracle Streams administrator at the destination database is granted the <code class="codeph">IMP_FULL_DATABASE</code> role to perform the transportable tablespaces import. The <code class="codeph">DBA</code> role is sufficient because it includes the <code class="codeph">IMP_FULL_DATABASE</code> role. In this example, the Oracle Streams administrator performs the transportable tablespaces export.
                                 </p>
                              </li>
                           </ul>
                           <div class="infoboxnotealso" id="GUID-697E750C-6920-4D44-909D-AB9CA2A75951__GUID-297BD1BC-9C72-491D-8FAB-2912B084555F">
                              <p class="notep1">See Also:</p>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ADMIN01101"><span class="italic">Oracle Database Administrator's Guide </span></a>for more information about using transportable tablespaces and for information about limitations that might apply
                              </p>
                           </div>
                           <p>Complete the following steps to instantiate the database objects in the <code class="codeph">jobs_tbs</code> and <code class="codeph">regions_tbs</code> tablespaces using transportable tablespace:
                           </p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>In SQL*Plus, connect to the source database as the Oracle Streams administrator.</span><div>
                                 <p>See <a href="../admin/index.html"><span class="italic">Oracle Database Administrator's Guide</span></a> for instructions about connecting to a database in SQL*Plus.
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Create a directory object to hold the export dump file and export log file:</span><div><pre class="oac_no_warn" dir="ltr">CREATE DIRECTORY TRANS_DIR AS '/usr/trans_dir';
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Prepare the <code class="codeph">hr.jobs_transport</code> and <code class="codeph">hr.regions_transport</code> tables for instantiation. See <span class="q">"<a href="instantiation-and-oracle-streams-replication.html#GUID-19FC31D5-2654-45E6-9EC5-B5828BF47526">Preparing Tables for Instantiation</a>"</span> for instructions.</span></li>
                           <li class="stepexpand"><span>Make the tablespaces that contain the objects you are instantiating read-only. In this example, the <code class="codeph">jobs_tbs</code> and <code class="codeph">regions_tbs</code> tablespaces contain the database objects.</span><div><pre class="oac_no_warn" dir="ltr">ALTER TABLESPACE jobs_tbs READ ONLY;

ALTER TABLESPACE regions_tbs READ ONLY;
</pre></div>
                           </li>
                           <li class="stepexpand"><span>On a command line, use the Data Pump Export utility to export the <code class="codeph">jobs_tbs</code> and <code class="codeph">regions_tbs</code> tablespaces at the source database using transportable tablespaces export parameters. The following is a sample export command that uses transportable tablespaces export parameters:</span><div><pre class="oac_no_warn" dir="ltr">expdp strmadmin TRANSPORT_TABLESPACES=jobs_tbs, regions_tbs 
DIRECTORY=TRANS_DIR DUMPFILE=tbs_ts.dmp
</pre><p>When you run the export command, ensure that you connect as an administrative user who was granted <code class="codeph">EXP_FULL_DATABASE</code> role and has <code class="codeph">READ</code> and <code class="codeph">WRITE</code> privileges on the directory object.
                                 </p>
                                 <div class="infoboxnotealso" id="GUID-697E750C-6920-4D44-909D-AB9CA2A75951__GUID-025C8324-045C-4CA0-8A60-38F65967F2D6">
                                    <p class="notep1">See Also:</p>
                                    <p><a href="../sutil/index.html"><span class="italic">Oracle Database Utilities </span></a>for information about performing an export
                                    </p>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand"><span>In SQL*Plus, connect to the destination database as the Oracle Streams administrator.</span></li>
                           <li class="stepexpand" id="GUID-697E750C-6920-4D44-909D-AB9CA2A75951__i1014027"><span>Create a directory object to hold the import dump file and import log file:</span><div><pre class="oac_no_warn" dir="ltr">CREATE DIRECTORY TRANS_DIR AS '/usr/trans_dir';
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Transfer the data files for the tablespaces and the export dump file <code class="codeph">tbs_ts.dmp</code> to the destination database. You can use the <code class="codeph">DBMS_FILE_TRANSFER</code> package, binary FTP, or some other method to transfer these files to the destination database. After the file transfer, the export dump file should reside in the directory that corresponds to the directory object created in Step <a href="instantiation-and-oracle-streams-replication.html#GUID-697E750C-6920-4D44-909D-AB9CA2A75951__i1014027">7</a>.</span></li>
                           <li class="stepexpand"><span>On a command line at the destination database, use the Data Pump Import utility to import the export dump file <code class="codeph">tbs_ts.dmp</code> using transportable tablespaces import parameters. Performing the import automatically sets the instantiation SCN for the <code class="codeph">hr.jobs_transport</code> and <code class="codeph">hr.regions_transport</code> tables at the destination database.</span><div>
                                 <p>The following is an example import command:</p><pre class="oac_no_warn" dir="ltr">impdp strmadmin DIRECTORY=TRANS_DIR DUMPFILE=tbs_ts.dmp 
TRANSPORT_DATAFILES=/usr/orc/dbs/jobs_tbs.dbf,/usr/orc/dbs/regions_tbs.dbf
</pre><p>When you run the import command, ensure that you connect as an administrative user who was granted <code class="codeph">IMP_FULL_DATABASE</code> role and has <code class="codeph">READ</code> and <code class="codeph">WRITE</code> privileges on the directory object.
                                 </p>
                                 <div class="infoboxnotealso" id="GUID-697E750C-6920-4D44-909D-AB9CA2A75951__GUID-1DE2392E-3BE5-482E-BC16-027DD069FF42">
                                    <p class="notep1">See Also:</p>
                                    <p><a href="../sutil/index.html"><span class="italic">Oracle Database Utilities </span></a>for information about performing an import
                                    </p>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand"><span>If necessary, at both the source database and the destination database, connect as the Oracle Streams administrator and put the tablespaces into read/write mode:</span><div><pre class="oac_no_warn" dir="ltr">ALTER TABLESPACE jobs_tbs READ WRITE;

ALTER TABLESPACE regions_tbs READ WRITE;
</pre></div>
                           </li>
                        </ol>
                        <div class="section">
                           <div class="infoboxnote" id="GUID-697E750C-6920-4D44-909D-AB9CA2A75951__GUID-50D774EB-F27E-42E8-95B8-EDE308960E0A">
                              <p class="notep1">Note:</p>
                              <p>Any table supplemental log groups for the tables exported from the export database are retained when tables are imported at the import database. You can drop these supplemental log groups if necessary.</p>
                           </div>
                           <div class="infoboxnotealso" id="GUID-697E750C-6920-4D44-909D-AB9CA2A75951__GUID-64B0D712-F715-434E-A66E-ED5B3A108D42">
                              <p class="notep1">See Also:</p>
                              <p><span class="q">"<a href="comparing-and-converging-data.html#GUID-BE4621F5-4EEC-491C-9141-ABDCCA282D9E">Checking for Consistency After Instantiation</a>"</span></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="STREP143"></a><div class="props_rev_3"><a id="GUID-89AEE784-C5CF-4D57-94BC-D636A123E9D5" name="GUID-89AEE784-C5CF-4D57-94BC-D636A123E9D5"></a><h5 id="STREP-GUID-89AEE784-C5CF-4D57-94BC-D636A123E9D5" class="sect5"><span class="enumeration_section">8.4.1.2 </span>Instantiating Objects Using Transportable Tablespace From Backup With RMAN
                     </h5>
                     <div>
                        <div class="section">
                           <p>The RMAN <code class="codeph">TRANSPORT</code> <code class="codeph">TABLESPACE</code> command uses Data Pump and an RMAN-managed auxiliary instance to export the database objects in a tablespace or tablespace set while the tablespace or tablespace set remains online in the source database. The RMAN <code class="codeph">TRANSPORT</code> <code class="codeph">TABLESPACE</code> command produces a Data Pump export dump file and data files, and you can use these files to perform a Data Pump import of the tablespace or tablespaces at the destination database. You can also use the <code class="codeph">ATTACH_TABLESPACES</code> procedure in the <code class="codeph">DBMS_STREAMS_TABLESPACE_ADM</code> package to attach the tablespace or tablespaces at the destination database.
                           </p>
                           <p>In addition to the assumptions listed in <span class="q">"<a href="instantiation-and-oracle-streams-replication.html#GUID-E74B9C41-8F19-423F-9CC0-9CF8B34569FD">Instantiating Objects in a Tablespace Using Transportable Tablespace or RMAN</a>"</span>, this example makes the following assumptions:
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>The source database is <code class="codeph">tts1.example.com</code>.
                                 </p>
                              </li>
                              <li>
                                 <p>The destination database is <code class="codeph">tts2.example.com</code>.
                                 </p>
                              </li>
                           </ul>
                           <div class="infoboxnotealso" id="GUID-89AEE784-C5CF-4D57-94BC-D636A123E9D5__GUID-88AA0DFB-2989-4E08-8B97-52EF38D74114">
                              <p class="notep1">See Also:</p>
                              <p><a href="../bradv/creating-transportable-tablespace-sets.html#BRADV05141"><span class="italic">Oracle Database Backup and Recovery User's Guide </span></a>for instructions on using the RMAN <code class="codeph">TRANSPORT</code> <code class="codeph">TABLESPACE</code> command
                              </p>
                           </div>
                           <p>Complete the following steps to instantiate the database objects in the <code class="codeph">jobs_tbs</code> and <code class="codeph">regions_tbs</code> tablespaces using transportable tablespaces and RMAN:
                           </p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Create a backup of the source database that includes the tablespaces being instantiated, if a backup does not exist. RMAN requires a valid backup for tablespace cloning. In this example, create a backup of the source database that includes the <code class="codeph">jobs_tbs</code> and <code class="codeph">regions_tbs</code> tablespaces if one does not exist.</span></li>
                           <li class="stepexpand"><span>In SQL*Plus, connect to the source database <code class="codeph">tts1.example.com</code> as the Oracle Streams administrator.</span><div>
                                 <p>See <a href="../admin/index.html"><span class="italic">Oracle Database Administrator's Guide</span></a> for instructions about connecting to a database in SQL*Plus.
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Optionally, create a directory object to hold the export dump file and export log file:</span><div><pre class="oac_no_warn" dir="ltr">CREATE DIRECTORY SOURCE_DIR AS '/usr/db_files';
</pre><p>This step is optional because the RMAN <code class="codeph">TRANSPORT</code> <code class="codeph">TABLESPACE</code> command creates a directory object named <code class="codeph">STREAMS_DIROBJ_DPDIR</code> on the auxiliary instance if the <code class="codeph">DATAPUMP</code> <code class="codeph">DIRECTORY</code> parameter is omitted when you run this command in Step <a href="instantiation-and-oracle-streams-replication.html#GUID-89AEE784-C5CF-4D57-94BC-D636A123E9D5__BABIIBDE">9</a>.
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Prepare the <code class="codeph">hr.jobs_transport</code> and <code class="codeph">hr.regions_transport</code> tables for instantiation. See <span class="q">"<a href="instantiation-and-oracle-streams-replication.html#GUID-19FC31D5-2654-45E6-9EC5-B5828BF47526">Preparing Tables for Instantiation</a>"</span> for instructions.</span></li>
                           <li class="stepexpand"><span>Determine the until SCN for the RMAN <code class="codeph">TRANSPORT</code> <code class="codeph">TABLESPACE</code> command:</span><div><pre class="oac_no_warn" dir="ltr">SET SERVEROUTPUT ON SIZE 1000000
DECLARE
  until_scn NUMBER;
BEGIN
  until_scn:= DBMS_FLASHBACK.GET_SYSTEM_CHANGE_NUMBER;
      DBMS_OUTPUT.PUT_LINE('Until SCN: ' || until_scn);
END;
/
</pre><p>Make a note of the until SCN returned. You will use this number in Step <a href="instantiation-and-oracle-streams-replication.html#GUID-89AEE784-C5CF-4D57-94BC-D636A123E9D5__BABIIBDE">9</a>. For this example, assume that the returned until SCN is&nbsp;<code class="codeph">7661956</code>.
                                 </p>
                                 <p>Optionally, you can skip this step. In this case, do not specify the until clause in the RMAN <code class="codeph">TRANSPORT</code> <code class="codeph">TABLESPACE</code> command in Step <a href="instantiation-and-oracle-streams-replication.html#GUID-89AEE784-C5CF-4D57-94BC-D636A123E9D5__BABIIBDE">9</a>. When no until clause is specified, RMAN uses the last archived redo log file to determine the until SCN automatically.
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>In SQL*Plus, connect to the source database tts1.net as an administrative user.</span></li>
                           <li class="stepexpand"><span>Archive the current online redo log:</span><div><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM ARCHIVE LOG CURRENT;
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Start the RMAN client, and connect to the source database <code class="codeph">tts1.example.com</code> as <code class="codeph">TARGET</code>.</span><div>
                                 <p>See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=RCMRF114"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for more information about the RMAN <code class="codeph">CONNECT</code> command
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand" id="GUID-89AEE784-C5CF-4D57-94BC-D636A123E9D5__BABIIBDE"><span>At the source database <code class="codeph">tts1.example.com</code>, use the RMAN <code class="codeph">TRANSPORT</code> <code class="codeph">TABLESPACE</code> command to generate the dump file for the tablespace set:</span><div><pre class="oac_no_warn" dir="ltr">RMAN&gt; RUN
      { 
        TRANSPORT TABLESPACE 'jobs_tbs', 'regions_tbs'
        UNTIL SCN 7661956
        AUXILIARY DESTINATION '/usr/aux_files'
        DATAPUMP DIRECTORY SOURCE_DIR 
        DUMP FILE 'jobs_regions_tbs.dmp' 
        EXPORT LOG 'jobs_regions_tbs.log'
        IMPORT SCRIPT 'jobs_regions_tbs_imp.sql'
        TABLESPACE DESTINATION '/orc/dbs';
      }
</pre><p>The <code class="codeph">TRANSPORT</code> <code class="codeph">TABLESPACE</code> command places the files in the following directories on the computer system that runs the source database:
                                 </p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>The directory that corresponds to the <code class="codeph">SOURCE_DIR</code> directory object (<code class="codeph">/usr/db_files</code>) contains the export dump file and export log file.
                                       </p>
                                    </li>
                                    <li>
                                       <p>The <code class="codeph">/orc/dbs</code> directory contains the generated data files for the tablespaces and the import script. You use this script to complete the instantiation by attaching the tablespace at the destination database.
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Modify the import script, if necessary. You might need to modify one or both of the following items in the script:</span><div>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>You might want to change the method used to make the exported tablespaces part of the destination database. The import script includes two ways to make the exported tablespaces part of the destination database: a Data Pump import command (<code class="codeph">impdp</code>), and a script for attaching the tablespaces using the <code class="codeph">ATTACH_TABLESPACES</code> procedure in the <code class="codeph">DBMS_STREAMS_TABLESPACE_ADM</code> package.
                                       </p>
                                       <p>The default script uses the attach tablespaces method. The Data Pump import command is commented out. To use Data Pump import, remove the comment symbols (<code class="codeph">/*</code> and <code class="codeph">*/</code>) surrounding the impdp command, and either surround the attach tablespaces script with comments or remove the attach tablespaces script. The attach tablespaces script starts with <code class="codeph">SET</code> <code class="codeph">SERVEROUTPUT</code> <code class="codeph">ON</code> and continues to the end of the file.
                                       </p>
                                    </li>
                                    <li>
                                       <p>You might need to change the directory paths specified in the script. In Step <a href="instantiation-and-oracle-streams-replication.html#GUID-89AEE784-C5CF-4D57-94BC-D636A123E9D5__BABJGHAC">11</a>, you will transfer the import script (<code class="codeph">jobs_regions_tbs_imp.sql</code>), the Data Pump export dump file (<code class="codeph">jobs_regions_tbs.dmp</code>), and the generated data file for each tablespace (<code class="codeph">jobs_tbs.dbf</code> and <code class="codeph">regions_tbs.dbf</code>) to one or more directories on the computer system running the destination database. Ensure that the directory paths specified in the script are the correct directory paths.
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li class="stepexpand" id="GUID-89AEE784-C5CF-4D57-94BC-D636A123E9D5__BABJGHAC"><span>Transfer the import script (<code class="codeph">jobs_regions_tbs_imp.sql</code>), the Data Pump export dump file (<code class="codeph">jobs_regions_tbs.dmp</code>), and the generated data file for each tablespace (<code class="codeph">jobs_tbs.dbf</code> and <code class="codeph">regions_tbs.dbf</code>) to the destination database. You can use the <code class="codeph">DBMS_FILE_TRANSFER</code> package, binary FTP, or some other method to transfer the file to the destination database. After the file transfer, these files should reside in the directories specified in the import script.</span></li>
                           <li class="stepexpand"><span>In SQL*Plus, connect to the destination database <code class="codeph">tts2.example.com</code> as the Oracle Streams administrator.</span></li>
                           <li class="stepexpand"><span>Run the import script:</span><div><pre class="oac_no_warn" dir="ltr">SET ECHO ON
SPOOL jobs_tbs_imp.out
@jobs_tbs_imp.sql
</pre><p>When the script completes, check the <code class="codeph">jobs_tbs_imp.out</code> spool file to ensure that all actions finished successfully.
                                 </p>
                              </div>
                           </li>
                        </ol>
                        <div class="section">
                           <div class="infoboxnotealso" id="GUID-89AEE784-C5CF-4D57-94BC-D636A123E9D5__GUID-88BA4241-F033-4F6A-AC45-2DB34800BEC9">
                              <p class="notep1">See Also:</p>
                              <p><span class="q">"<a href="comparing-and-converging-data.html#GUID-BE4621F5-4EEC-491C-9141-ABDCCA282D9E">Checking for Consistency After Instantiation</a>"</span></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="STREP345"></a><div class="props_rev_3"><a id="GUID-65A7F70C-C849-40FB-8351-CFF3114C9271" name="GUID-65A7F70C-C849-40FB-8351-CFF3114C9271"></a><h4 id="STREP-GUID-65A7F70C-C849-40FB-8351-CFF3114C9271" class="sect4"><span class="enumeration_section">8.4.2 </span>Instantiating an Entire Database Using RMAN
                  </h4>
                  <div>
                     <div class="section">
                        <p>The Recovery Manager (RMAN) <code class="codeph">DUPLICATE</code> command creates a copy of the target database in another location. The command uses an RMAN auxiliary instance to restore backups of the target database files and create a new database. In an Oracle Streams instantiation, the target database is the source database and the new database that is created is the destination database. The RMAN <code class="codeph">DUPLICATE</code> command requires that the source and destination database run on the same platform.
                        </p>
                        <p>The RMAN <code class="codeph">CONVERT</code> <code class="codeph">DATABASE</code> command generates the data files and an initialization parameter file for a new destination database on a different platform. It also generates a script that creates the new destination database. These files can instantiate an entire destination database that runs on a different platform than the source database but has the same endian format as the source database.
                        </p>
                        <p>The RMAN <code class="codeph">DUPLICATE</code> and <code class="codeph">CONVERT</code> <code class="codeph">DATABASE</code> commands do not set the instantiation SCN values for the database objects. The instantiation SCN values must be set manually during instantiation.
                        </p>
                        <p>The examples in this section describe the steps required to instantiate an entire database using the RMAN <code class="codeph">DUPLICATE</code> command or <code class="codeph">CONVERT</code> <code class="codeph">DATABASE</code> command. To use one of these RMAN commands for full database instantiation, complete the following general steps:
                        </p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li><span>Copy the entire source database to the destination site using the RMAN command.</span></li>
                        <li><span>Remove the Oracle Streams configuration at the destination site using the <code class="codeph">REMOVE_STREAMS_CONFIGURATION</code> procedure in the <code class="codeph">DBMS_STREAMS_ADM</code> package.</span></li>
                        <li><span>Configure Oracle Streams destination site, including configuration of one or more apply processes to apply changes from the source database.</span></li>
                     </ol>
                     <div class="section">
                        <p>You can complete this process without stopping any running capture processes or propagations at the source database.</p>
                        <p>Follow the instructions in one of these sections:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="instantiation-and-oracle-streams-replication.html#GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B">Instantiating an Entire Database on the Same Platform Using RMAN</a></p>
                           </li>
                           <li>
                              <p><a href="instantiation-and-oracle-streams-replication.html#GUID-2E02C473-967C-4FF2-ADCE-6EE0D308F30D">Instantiating an Entire Database on Different Platforms Using RMAN</a></p>
                           </li>
                        </ul>
                        <div class="infoboxnote" id="GUID-65A7F70C-C849-40FB-8351-CFF3114C9271__GUID-62B5CFAD-5294-44C9-ACA7-DE292FC8BCA9">
                           <p class="notep1">Note:</p>
                           <p></p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>To configure an Oracle Streams replication environment that replicates all of the supported changes for an entire database, you can use the <code class="codeph">PRE_INSTANTIATION_SETUP</code> and <code class="codeph">POST_INSTANTIATION_SETUP</code> procedures in the <code class="codeph">DBMS_STREAMS_ADM</code> package. See <span class="q">"<a href="simple-oracle-streams-replication-configuration.html#GUID-55241DE7-C460-4069-A75A-4B898543E3DC">Configuring Two-Database Global Replication with Local Capture</a>"</span> for instructions.
                                 </p>
                              </li>
                              <li>
                                 <p>Oracle recommends that you do not use RMAN for instantiation in an environment where distributed transactions are possible. Doing so can cause in-doubt transactions that must be corrected manually. Use export/import or transportable tablespaces for instantiation instead.</p>
                              </li>
                           </ul>
                        </div>
                        <div class="infoboxnotealso" id="GUID-65A7F70C-C849-40FB-8351-CFF3114C9271__GUID-78A93513-2B59-4CCE-BD68-31E78D4AD188">
                           <p class="notep1">See Also:</p>
                           <p><span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-EF5A403D-42E5-426D-B654-456E634F53B0">Configuring an Oracle Streams Administrator on All Databases</a>"</span> for information about configuring an Oracle Streams administrator
                           </p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div><a id="STREP346"></a><div class="props_rev_3"><a id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B" name="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B"></a><h5 id="STREP-GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B" class="sect5"><span class="enumeration_section">8.4.2.1 </span>Instantiating an Entire Database on the Same Platform Using RMAN
                     </h5>
                     <div>
                        <div class="section">
                           <p>The example in this section instantiates an entire database using the RMAN <code class="codeph">DUPLICATE</code> command. The example makes the following assumptions:
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>You want to capture all of the changes made to a source database named <code class="codeph">dpx1.example.com</code>, propagate these changes to a separate destination database named <code class="codeph">dpx2.example.com</code>, and apply these changes at the destination database.
                                 </p>
                              </li>
                              <li>
                                 <p>You have configured an Oracle Streams administrator at the source database named <code class="codeph">strmadmin</code>. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-EF5A403D-42E5-426D-B654-456E634F53B0">Configuring an Oracle Streams Administrator on All Databases</a>"</span>.
                                 </p>
                              </li>
                              <li>
                                 <p>The <code class="codeph">dpx1.example.com</code> and <code class="codeph">dpx2.example.com</code> databases run on the same platform.
                                 </p>
                              </li>
                           </ul>
                           <div class="infoboxnotealso" id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__GUID-C7E907CE-34BA-416F-9E12-28C7FFA017A7">
                              <p class="notep1">See Also:</p>
                              <p><a href="../bradv/rman-duplicating-databases.html#BRADV010"><span class="italic">Oracle Database Backup and Recovery User's Guide</span></a> for instructions about using the RMAN <code class="codeph">DUPLICATE</code> command
                              </p>
                           </div>
                           <p>Complete the following steps to instantiate an entire database using RMAN when the source and destination databases run on the same platform:</p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand" id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__CREATEABACKUPOFTHESOURCEDATABASEIFO-2C65A10B"><span>Create a backup of the source database if one does not exist. RMAN requires a valid backup for duplication. In this example, create a backup of <code class="codeph">dpx1.example.com</code> if one does not exist.</span><div>
                                 <div class="infoboxnote" id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__GUID-0C79FA18-7A50-475E-A65B-7CC4920372A7">
                                    <p class="notep1">Note:</p>
                                    <p>A backup of the source database is not necessary if you use the <code class="codeph">FROM</code> <code class="codeph">ACTIVE</code> <code class="codeph">DATABASE</code> option when you run the RMAN <code class="codeph">DUPLICATE</code> command. For large databases, the <code class="codeph">FROM</code> <code class="codeph">ACTIVE</code> <code class="codeph">DATABASE</code> option requires significant network resources. This example does not use this option.
                                    </p>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand" id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__INSQLPLUSCONNECTTOTHESOURCEDATABASE-2C65A409"><span>In SQL*Plus, connect to the source database <code class="codeph">dpx1.example.com</code> as the Oracle Streams administrator.</span><div>
                                 <p>See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ADMIN00102"><span class="italic">Oracle Database Administrator's Guide</span></a> for instructions about connecting to a database in SQL*Plus.
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand" id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__CREATEANANYDATAQUEUETOSTAGETHECHANG-2C65A5B6"><span>Create an <code class="codeph">ANYDATA</code> queue to stage the changes from the source database if such a queue does not already exist. This queue will stage changes that will be propagated to the destination database after it has been configured. </span><div>
                                 <p>For example, the following procedure creates a queue named <code class="codeph">streams_queue</code>:
                                 </p><pre class="oac_no_warn" dir="ltr">EXEC DBMS_STREAMS_ADM.SET_UP_QUEUE();
</pre><p>Remain connected as the Oracle Streams administrator in SQL*Plus at the source database through Step <a href="instantiation-and-oracle-streams-replication.html#GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__DETERMINETHEUNTILSCNFORTHERMANDUPLI-2C65C2CC">9</a>.
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand" id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__CREATEADATABASELINKFROMDPX1.EXAMPLE-2C65A7E0"><span>Create a database link from <code class="codeph">dpx1.example.com</code> to <code class="codeph">dpx2.example.com</code>:</span><div><pre class="oac_no_warn" dir="ltr">CREATE DATABASE LINK dpx2.example.com CONNECT TO strmadmin 
   IDENTIFIED BY <span class="italic">password</span> USING 'dpx2.example.com';
</pre></div>
                           </li>
                           <li class="stepexpand" id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__CREATEAPROPAGATIONFROMTHESOURCEQUEU-2C65B19D"><span>Create a propagation from the source queue at the source database to the destination queue at the destination database. The destination queue at the destination database does not exist yet, but creating this propagation ensures that logical change records (LCRs) enqueued into the source queue will remain staged there until propagation is possible. In addition to captured LCRs, the source queue will stage internal messages that will populate the Oracle Streams data dictionary at the destination database.</span><div>
                                 <p>The following procedure creates the <code class="codeph">dpx1_to_dpx2</code> propagation:
                                 </p><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_STREAMS_ADM.ADD_GLOBAL_PROPAGATION_RULES(
    streams_name            =&gt; 'dpx1_to_dpx2', 
    source_queue_name       =&gt; 'strmadmin.streams_queue',
    destination_queue_name  =&gt; 'strmadmin.streams_queue@dpx2.example.com',
    include_dml             =&gt; TRUE,
    include_ddl             =&gt; TRUE,
    source_database         =&gt; 'dpx1.example.com',
    inclusion_rule          =&gt; TRUE,
    queue_to_queue          =&gt; TRUE);
END;
/
</pre></div>
                           </li>
                           <li class="stepexpand" id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__STOPTHEPROPAGATIONYOUCREATEDINSTEP.-2C65B82D"><span>Stop the propagation you created in Step <a href="instantiation-and-oracle-streams-replication.html#GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__CREATEAPROPAGATIONFROMTHESOURCEQUEU-2C65B19D">5</a>.</span><div><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_PROPAGATION_ADM.STOP_PROPAGATION(
    propagation_name  =&gt; 'dpx1_to_dpx2');
END;
/
</pre></div>
                           </li>
                           <li class="stepexpand" id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__PREPARETHEENTIRESOURCEDATABASEFORIN-2C65BB7B"><span>Prepare the entire source database for instantiation, if it has not been prepared for instantiation previously. See <span class="q">"<a href="instantiation-and-oracle-streams-replication.html#GUID-6832412C-9F6C-4345-A32B-424B9E38C284">Preparing All of the Database Objects in a Database for Instantiation</a>"</span> for instructions.</span><div>
                                 <p>If there is no capture process that captures all of the changes to the source database, then create this capture process using the <code class="codeph">ADD_GLOBAL_RULES</code> procedure in the <code class="codeph">DBMS_STREAMS_ADM</code> package. If the capture process is a local capture process or a downstream capture process with a database link to the source database, then running this procedure automatically prepares the entire source database for instantiation. If such a capture process already exists, then ensure that the source database has been prepared for instantiation by querying the <code class="codeph">DBA_CAPTURE_PREPARED_DATABASE</code> data dictionary view.
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand" id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__IFYOUCREATEDACAPTUREPROCESSINSTEPTH-2C65BF11"><span>If you created a capture process in Step <a href="instantiation-and-oracle-streams-replication.html#GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__PREPARETHEENTIRESOURCEDATABASEFORIN-2C65BB7B">7</a>, then start the capture process:</span><div><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_CAPTURE_ADM.START_CAPTURE(
    capture_name  =&gt; 'capture_db');
END;
/
</pre></div>
                           </li>
                           <li class="stepexpand" id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__DETERMINETHEUNTILSCNFORTHERMANDUPLI-2C65C2CC"><span>Determine the until SCN for the RMAN <code class="codeph">DUPLICATE</code> command:</span><div><pre class="oac_no_warn" dir="ltr">SET SERVEROUTPUT ON SIZE 1000000
DECLARE
  until_scn NUMBER;
BEGIN
  until_scn:= DBMS_FLASHBACK.GET_SYSTEM_CHANGE_NUMBER;
      DBMS_OUTPUT.PUT_LINE('Until SCN: ' || until_scn);
END;
/
</pre><p>Make a note of the until SCN returned. You will use this number in a later step. For this example, assume that the returned until SCN is&nbsp;<code class="codeph">3050191</code>.
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand" id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__INSQLPLUSCONNECTTOTHESOURCEDATABASE-2C65C641"><span>In SQL*Plus, connect to the source database <code class="codeph">dpx1.example.com</code> as an administrative user.</span><div>
                                 <p>See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ADMIN00102"><span class="italic">Oracle Database Administrator's Guide</span></a> for instructions about connecting to a database in SQL*Plus.
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand" id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__ARCHIVETHECURRENTONLINEREDOLOGALTER-2C65C903"><span>Archive the current online redo log:</span><div><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM ARCHIVE LOG CURRENT;
</pre></div>
                           </li>
                           <li class="stepexpand" id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__PREPAREYOURENVIRONMENTFORDATABASEDU-2C65CB28"><span>Prepare your environment for database duplication, which includes preparing the destination database as an auxiliary instance for duplication. See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=BRADV010"><span class="italic">Oracle Database Backup and Recovery User's Guide </span></a>for instructions. </span></li>
                           <li class="stepexpand" id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__STARTTHERMANCLIENTANDCONNECTTOTHESO-2C65CDB8"><span>Start the RMAN client, and connect to the source database <code class="codeph">dpx1.example.com</code> as <code class="codeph">TARGET</code> and to the destination database <code class="codeph">dpx2.example.com</code> as <code class="codeph">AUXILIARY</code>.</span><div>
                                 <p>See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=RCMRF114"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for more information about the RMAN <code class="codeph">CONNECT</code> command.
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand" id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__USETHERMANDUPLICATECOMMANDWITHTHEOP-2C65CFEB"><span>Use the RMAN <code class="codeph">DUPLICATE</code> command with the <code class="codeph">OPEN</code> <code class="codeph">RESTRICTED</code> option to instantiate the source database at the destination database. The <code class="codeph">OPEN</code> <code class="codeph">RESTRICTED</code> option is required. This option enables a restricted session in the duplicate database by issuing the following SQL statement: <code class="codeph">ALTER</code> <code class="codeph">SYSTEM</code> <code class="codeph">ENABLE</code> <code class="codeph">RESTRICTED</code> <code class="codeph">SESSION</code>. RMAN issues this statement immediately before the duplicate database is opened.</span><div>
                                 <p>You can use the <code class="codeph">UNTIL</code> <code class="codeph">SCN</code> clause to specify an SCN for the duplication. Use the until SCN determined in Step <a href="instantiation-and-oracle-streams-replication.html#GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__DETERMINETHEUNTILSCNFORTHERMANDUPLI-2C65C2CC">9</a> for this clause. The until SCN specified for the RMAN <code class="codeph">DUPLICATE</code> command must be higher than the SCN when the database was prepared for instantiation in Step&nbsp;<a href="instantiation-and-oracle-streams-replication.html#GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__PREPARETHEENTIRESOURCEDATABASEFORIN-2C65BB7B">7</a>. Also, archived redo logs must be available for the until SCN specified and for higher SCN values. Therefore, Step&nbsp;<a href="instantiation-and-oracle-streams-replication.html#GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__ARCHIVETHECURRENTONLINEREDOLOGALTER-2C65C903">11</a> archived the redo log containing the until SCN.
                                 </p>
                                 <p>Ensure that you use <code class="codeph">TO</code> <span class="italic"><code class="codeph">database_name</code></span> in the <code class="codeph">DUPLICATE</code> command to specify the name of the duplicate database. In this example, the duplicate database name is <code class="codeph">dpx2</code>. Therefore, the <code class="codeph">DUPLICATE</code> command for this example includes <code class="codeph">TO</code> <code class="codeph">dpx2</code>.
                                 </p>
                                 <p>The following is an example of an RMAN <code class="codeph">DUPLICATE</code> command:
                                 </p><pre class="oac_no_warn" dir="ltr">RMAN&gt; RUN
      { 
        SET UNTIL SCN 3050191;
        ALLOCATE AUXILIARY CHANNEL dpx2 DEVICE TYPE sbt; 
        DUPLICATE TARGET DATABASE TO dpx2 
        NOFILENAMECHECK
        OPEN RESTRICTED;
      }
</pre><div class="infoboxnotealso" id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__GUID-7074CF76-1BDF-4262-8811-9B43B73A21EF">
                                    <p class="notep1">See Also:</p>
                                    <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=RCMRF126"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for more information about the RMAN <code class="codeph">DUPLICATE</code> command
                                    </p>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand" id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__ATTHEDESTINATIONDATABASECONNECTASAN-2C65D2E3"><span>At the destination database, connect as an administrative user in SQL*Plus and rename the database global name. After the RMAN <code class="codeph">DUPLICATE</code> command, the destination database has the same global name as the source database.</span><div><pre class="oac_no_warn" dir="ltr">ALTER DATABASE RENAME GLOBAL_NAME TO DPX2.EXAMPLE.COM;
</pre></div>
                           </li>
                           <li class="stepexpand" id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__ATTHEDESTINATIONDATABASECONNECTASAN-2C65D510"><span>At the destination database, connect as an administrative user in SQL*Plus and run the following procedure:</span><div>
                                 <div class="infoboxnote" id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__GUID-A734B872-C8C0-4A0C-93F0-C9D974145A63">
                                    <p class="notep1">Note:</p>
                                    <p>Ensure that you are connected to the destination database, not the source database, when you run this procedure because it removes the local Oracle Streams configuration.</p>
                                 </div><pre class="oac_no_warn" dir="ltr">EXEC DBMS_STREAMS_ADM.REMOVE_STREAMS_CONFIGURATION();
</pre><div class="infoboxnote" id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__GUID-D959165A-1A4F-42BA-84C9-85D31063CED1">
                                    <p class="notep1">Note:</p>
                                    <p>Any supplemental log groups for the tables at the source database are retained at the destination database, and the <code class="codeph">REMOVE_STREAMS_CONFIGURATION</code> procedure does not drop them. You can drop these supplemental log groups if necessary.
                                    </p>
                                 </div>
                                 <div class="infoboxnotealso" id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__GUID-2911EBC9-C401-4D97-9A03-E9210F19D780">
                                    <p class="notep1">See Also:</p>
                                    <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS508"><span class="italic">Oracle Database PL/SQL Packages and Types Reference </span></a>for more information about the <code class="codeph">REMOVE_STREAMS_CONFIGURATION</code> procedure
                                    </p>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand" id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__ATTHEDESTINATIONDATABASEUSETHEALTER-2C65D692"><span>At the destination database, use the <code class="codeph">ALTER</code> <code class="codeph">SYSTEM</code> statement to disable the <code class="codeph">RESTRICTED</code> <code class="codeph">SESSION</code>:</span><div><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM DISABLE RESTRICTED SESSION;
</pre></div>
                           </li>
                           <li class="stepexpand" id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__ATTHEDESTINATIONDATABASECONNECTASTH-2C65D8E5"><span>At the destination database, connect as the Oracle Streams administrator. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-EF5A403D-42E5-426D-B654-456E634F53B0">Configuring an Oracle Streams Administrator on All Databases</a>"</span>.</span></li>
                           <li class="stepexpand" id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__ATTHEDESTINATIONDATABASECREATETHEQU-2C65DC47"><span>At the destination database, create the queue specified in Step <a href="instantiation-and-oracle-streams-replication.html#GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__CREATEAPROPAGATIONFROMTHESOURCEQUEU-2C65B19D">5</a>.</span><div>
                                 <p>For example, the following procedure creates a queue named <code class="codeph">streams_queue</code>:
                                 </p><pre class="oac_no_warn" dir="ltr">EXEC DBMS_STREAMS_ADM.SET_UP_QUEUE();
</pre></div>
                           </li>
                           <li class="stepexpand" id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__ATTHEDESTINATIONDATABASECONFIGURETH-2C65DED7"><span>At the destination database, configure the Oracle Streams environment.</span><div>
                                 <div class="infoboxnote" id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__GUID-17AF10EA-0AA3-4420-82EE-6E401974E46B">
                                    <p class="notep1">Note:</p>
                                    <p>Do not start any apply processes at the destination database until after you set the global instantiation SCN in Step <a href="instantiation-and-oracle-streams-replication.html#GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__ATTHEDESTINATIONDATABASESETTHEGLOBA-2C65E3BA">22</a>.
                                    </p>
                                 </div>
                              </div>
                           </li>
                           <li class="stepexpand" id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__ATTHEDESTINATIONDATABASECREATEADATA-2C65E0CF"><span>At the destination database, create a database link from the destination database to the source database:</span><div><pre class="oac_no_warn" dir="ltr">CREATE DATABASE LINK dpx1.example.com CONNECT TO strmadmin 
   IDENTIFIED BY <span class="italic">password</span> USING 'dpx1.example.com';
</pre><p>This database link is required because the next step runs the <code class="codeph">SET_GLOBAL_INSTANTIATION_SCN</code> procedure with the recursive parameter set to <code class="codeph">TRUE</code>.
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand" id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__ATTHEDESTINATIONDATABASESETTHEGLOBA-2C65E3BA"><span>At the destination database, set the global instantiation SCN for the source database. The RMAN <code class="codeph">DUPLICATE</code> command duplicates the database up to one less than the SCN value specified in the <code class="codeph">UNTIL</code> <code class="codeph">SCN</code> clause. Therefore, you should subtract one from the until SCN value that you specified when you ran the <code class="codeph">DUPLICATE</code> command in Step <a href="instantiation-and-oracle-streams-replication.html#GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__USETHERMANDUPLICATECOMMANDWITHTHEOP-2C65CFEB">14</a>. In this example, the until SCN was set to <code class="codeph">3050191</code>. Therefore, the instantiation SCN should be set to <code class="codeph">3050191</code> <code class="codeph">-</code> <code class="codeph">1</code>, or&nbsp;<code class="codeph">3050190</code>. </span><div>
                                 <p>For example, to set the global instantiation SCN to <code class="codeph">3050190</code> for the <code class="codeph">dpx1.example.com</code> source database, run the following procedure: 
                                 </p><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_APPLY_ADM.SET_GLOBAL_INSTANTIATION_SCN(
    source_database_name   =&gt;  'dpx1.example.com',
    instantiation_scn      =&gt;  3050190,
    recursive              =&gt;  TRUE);
END;
/
</pre><p>Notice that the <code class="codeph">recursive</code> parameter is set to <code class="codeph">TRUE</code> to set the instantiation SCN for all schemas and tables in the destination database.
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand" id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__ATTHEDESTINATIONDATABASEYOUCANSTART-2C65E67D"><span>At the destination database, you can start any apply processes that you configured.</span></li>
                           <li class="stepexpand" id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__ATTHESOURCEDATABASESTARTTHEPROPAGAT-2C65EA28"><span>At the source database, start the propagation you stopped in Step <a href="instantiation-and-oracle-streams-replication.html#GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__STOPTHEPROPAGATIONYOUCREATEDINSTEP.-2C65B82D">6</a>:</span><div><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_PROPAGATION_ADM.START_PROPAGATION(
    queue_name  =&gt; 'dpx1_to_dpx2');
END;
/</pre></div>
                           </li>
                        </ol>
                        <div class="section">
                           <div class="infoboxnotealso" id="GUID-442D4798-708F-44CB-90EA-6B5DD7F8C71B__GUID-5DCEF144-6E1B-46DE-AC73-F82F040F2501">
                              <p class="notep1">See Also:</p>
                              <p><span class="q">"<a href="comparing-and-converging-data.html#GUID-BE4621F5-4EEC-491C-9141-ABDCCA282D9E">Checking for Consistency After Instantiation</a>"</span></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="STREP347"></a><div class="props_rev_3"><a id="GUID-2E02C473-967C-4FF2-ADCE-6EE0D308F30D" name="GUID-2E02C473-967C-4FF2-ADCE-6EE0D308F30D"></a><h5 id="STREP-GUID-2E02C473-967C-4FF2-ADCE-6EE0D308F30D" class="sect5"><span class="enumeration_section">8.4.2.2 </span>Instantiating an Entire Database on Different Platforms Using RMAN
                     </h5>
                     <div>
                        <div class="section">
                           <p>The example in this section instantiates an entire database using the RMAN <code class="codeph">CONVERT</code> <code class="codeph">DATABASE</code> command. The example makes the following assumptions:
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>You want to capture all of the changes made to a source database named <code class="codeph">cvx1.example.com</code>, propagate these changes to a separate destination database named <code class="codeph">cvx2.example.com</code>, and apply these changes at the destination database. 
                                 </p>
                              </li>
                              <li>
                                 <p>You have configured an Oracle Streams administrator at the source database named <code class="codeph">strmadmin</code>. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-EF5A403D-42E5-426D-B654-456E634F53B0">Configuring an Oracle Streams Administrator on All Databases</a>"</span>.
                                 </p>
                              </li>
                              <li>
                                 <p>The <code class="codeph">cvx1.example.com</code> and <code class="codeph">cvx2.example.com</code> databases run on different platforms, and the platform combination is supported by the RMAN <code class="codeph">CONVERT</code> <code class="codeph">DATABASE</code> command. You can use the <code class="codeph">DBMS_TDB</code> package to determine whether a platform combination is supported.
                                 </p>
                              </li>
                           </ul>
                           <p>The RMAN <code class="codeph">CONVERT</code> <code class="codeph">DATABASE</code> command produces converted data files, an initialization parameter file (PFILE), and a SQL script. The converted data files and PFILE are for use with the destination database, and the SQL script creates the destination database on the destination platform.
                           </p>
                           <div class="infoboxnotealso" id="GUID-2E02C473-967C-4FF2-ADCE-6EE0D308F30D__GUID-23B33D12-5564-4FF4-9F1D-0E6635621B6F">
                              <p class="notep1">See Also:</p>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=BRADV05432"><span class="italic">Oracle Database Backup and Recovery User's Guide</span></a> for instructions about using the RMAN <code class="codeph">CONVERT</code> <code class="codeph">DATABASE</code> command
                              </p>
                           </div>
                           <p>Complete the following steps to instantiate an entire database using RMAN when the source and destination databases run on different platforms:</p>
                           <ol>
                              <li>
                                 <p>Create a backup of the source database if one does not exist. RMAN requires a valid backup. In this example, create a backup of <code class="codeph">cvx1.example.com</code> if one does not exist.
                                 </p>
                              </li>
                              <li>
                                 <p>In SQL*Plus, connect to the source database <code class="codeph">cvx1.example.com</code> as the Oracle Streams administrator.
                                 </p>
                                 <p>See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ADMIN00102"><span class="italic">Oracle Database Administrator's Guide</span></a> for instructions about connecting to a database in SQL*Plus.
                                 </p>
                              </li>
                              <li>
                                 <p>Create an <code class="codeph">ANYDATA</code> queue to stage the changes from the source database if such a queue does not already exist. This queue will stage changes that will be propagated to the destination database after it has been configured.
                                 </p>
                                 <p>For example, the following procedure creates a queue named <code class="codeph">streams_queue</code>:
                                 </p><pre class="oac_no_warn" dir="ltr">EXEC DBMS_STREAMS_ADM.SET_UP_QUEUE();
</pre><p>Remain connected as the Oracle Streams administrator in SQL*Plus at the source database through Step <a href="instantiation-and-oracle-streams-replication.html#GUID-2E02C473-967C-4FF2-ADCE-6EE0D308F30D__BABHHGCB">8</a>.
                                 </p>
                              </li>
                              <li>
                                 <p>Create a database link from <code class="codeph">cvx1.example.com</code> to <code class="codeph">cvx2.example.com</code>:
                                 </p><pre class="oac_no_warn" dir="ltr">CREATE DATABASE LINK cvx2.example.com CONNECT TO strmadmin 
   IDENTIFIED BY <span class="italic">password</span> USING 'cvx2.example.com';
</pre></li>
                              <li id="GUID-2E02C473-967C-4FF2-ADCE-6EE0D308F30D__BABHGGGA">
                                 <p>Create a propagation from the source queue at the source database to the destination queue at the destination database. The destination queue at the destination database does not exist yet, but creating this propagation ensures that logical change records (LCRs) enqueued into the source queue will remain staged there until propagation is possible. In addition to captured LCRs, the source queue will stage internal messages that will populate the Oracle Streams data dictionary at the destination database.</p>
                                 <p>The following procedure creates the <code class="codeph">cvx1_to_cvx2</code> propagation:
                                 </p><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_STREAMS_ADM.ADD_GLOBAL_PROPAGATION_RULES(
    streams_name            =&gt; 'cvx1_to_cvx2', 
    source_queue_name       =&gt; 'strmadmin.streams_queue',
    destination_queue_name  =&gt; 'strmadmin.streams_queue@cvx2.example.com',
    include_dml             =&gt; TRUE,
    include_ddl             =&gt; TRUE,
    source_database         =&gt; 'cvx1.example.com',
    inclusion_rule          =&gt; TRUE,
    queue_to_queue          =&gt; TRUE);
END;
/
</pre></li>
                              <li id="GUID-2E02C473-967C-4FF2-ADCE-6EE0D308F30D__BABCHJGG">
                                 <p>Stop the propagation you created in Step <a href="instantiation-and-oracle-streams-replication.html#GUID-2E02C473-967C-4FF2-ADCE-6EE0D308F30D__BABHGGGA">5</a>.
                                 </p><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_PROPAGATION_ADM.STOP_PROPAGATION(
    propagation_name  =&gt; 'cvx1_to_cvx2');
END;
/
</pre></li>
                              <li id="GUID-2E02C473-967C-4FF2-ADCE-6EE0D308F30D__BABDFIEB">
                                 <p>Prepare the entire source database for instantiation, if it has not been prepared for instantiation previously. See <span class="q">"<a href="instantiation-and-oracle-streams-replication.html#GUID-6832412C-9F6C-4345-A32B-424B9E38C284">Preparing All of the Database Objects in a Database for Instantiation</a>"</span> for instructions.
                                 </p>
                                 <p>If there is no capture process that captures all of the changes to the source database, then create this capture process using the <code class="codeph">ADD_GLOBAL_RULES</code> procedure in the <code class="codeph">DBMS_STREAMS_ADM</code> package. If the capture process is a local capture process or a downstream capture process with a database link to the source database, then running this procedure automatically prepares the entire source database for instantiation. If such a capture process already exists, then ensure that the source database has been prepared for instantiation by querying the <code class="codeph">DBA_CAPTURE_PREPARED_DATABASE</code> data dictionary view.
                                 </p>
                              </li>
                              <li id="GUID-2E02C473-967C-4FF2-ADCE-6EE0D308F30D__BABHHGCB">
                                 <p>If you created a capture process in Step <a href="instantiation-and-oracle-streams-replication.html#GUID-2E02C473-967C-4FF2-ADCE-6EE0D308F30D__BABDFIEB">7</a>, then start the capture process:
                                 </p><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_CAPTURE_ADM.START_CAPTURE(
    capture_name  =&gt; 'capture_db');
END;
/
</pre></li>
                              <li>
                                 <p>In SQL*Plus, connect to the source database as an administrative user.</p>
                                 <p>See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ADMIN00102"><span class="italic">Oracle Database Administrator's Guide</span></a> for instructions about connecting to a database in SQL*Plus.
                                 </p>
                              </li>
                              <li>
                                 <p>Archive the current online redo log:</p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM ARCHIVE LOG CURRENT;
</pre></li>
                              <li>
                                 <p>Prepare your environment for database conversion, which includes opening the source database in read-only mode. Complete the following steps:</p>
                                 <ol type="a">
                                    <li>
                                       <p>If the source database is open, then shut it down and start it in read-only mode.</p>
                                    </li>
                                    <li>
                                       <p>Run the <code class="codeph">CHECK_DB</code> and <code class="codeph">CHECK_EXTERNAL</code> functions in the <code class="codeph">DBMS_TDB</code> package. Check the results to ensure that the conversion is supported by the RMAN <code class="codeph">CONVERT</code> <code class="codeph">DATABASE</code> command.
                                       </p>
                                    </li>
                                 </ol>
                                 <div class="infoboxnotealso" id="GUID-2E02C473-967C-4FF2-ADCE-6EE0D308F30D__GUID-0AEB613C-1C71-4840-81B3-FB0DB386B484">
                                    <p class="notep1">See Also:</p>
                                    <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=BRADV05432"><span class="italic">Oracle Database Backup and Recovery User's Guide </span></a>for more information about these steps
                                    </p>
                                 </div>
                              </li>
                              <li id="GUID-2E02C473-967C-4FF2-ADCE-6EE0D308F30D__BABHCABH">
                                 <p>Determine the current SCN of the source database:</p><pre class="oac_no_warn" dir="ltr">SET SERVEROUTPUT ON SIZE 1000000
DECLARE
  current_scn NUMBER;
BEGIN
  current_scn:= DBMS_FLASHBACK.GET_SYSTEM_CHANGE_NUMBER;
      DBMS_OUTPUT.PUT_LINE('Current SCN: ' || current_scn);
END;
/
</pre><p>Make a note of the SCN value returned. You will use this number in Step <a href="instantiation-and-oracle-streams-replication.html#GUID-2E02C473-967C-4FF2-ADCE-6EE0D308F30D__BABHBCGH">24</a>. For this example, assume that the returned value is&nbsp;<code class="codeph">46931285</code>.
                                 </p>
                              </li>
                              <li>
                                 <p>Start the RMAN client, and connect to the source database <code class="codeph">cvx1.example.com</code> as <code class="codeph">TARGET</code>.
                                 </p>
                                 <p>See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=RCMRF114"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for more information about the RMAN <code class="codeph">CONNECT</code> command.
                                 </p>
                              </li>
                              <li>
                                 <p>Run the <code class="codeph">CONVERT</code> <code class="codeph">DATABASE</code> command.
                                 </p>
                                 <p>Ensure that you use <code class="codeph">NEW</code> <code class="codeph">DATABASE</code> <span class="italic"><code class="codeph">database_name</code></span> in the <code class="codeph">CONVERT</code> <code class="codeph">DATABASE</code> command to specify the name of the destination database. In this example, the destination database name is <code class="codeph">cvx2</code>. Therefore, the <code class="codeph">CONVERT</code> <code class="codeph">DATABASE</code> command for this example includes <code class="codeph">NEW</code> <code class="codeph">DATABASE</code> <code class="codeph">cvx2</code>.
                                 </p>
                                 <p>The following is an example of an RMAN <code class="codeph">CONVERT</code> <code class="codeph">DATABASE</code> command for a destination database that is running on the <code class="codeph">Linux</code> <code class="codeph">IA</code> <code class="codeph">(64-bit)</code> platform:
                                 </p><pre class="oac_no_warn" dir="ltr">CONVERT DATABASE NEW DATABASE 'cvx2'
          TRANSPORT SCRIPT '/tmp/convertdb/transportscript.sql'     
          TO PLATFORM 'Linux IA (64-bit)'
          DB_FILE_NAME_CONVERT '/home/oracle/dbs','/tmp/convertdb';
</pre></li>
                              <li>
                                 <p>Transfer the data files, PFILE, and SQL script produced by the RMAN <code class="codeph">CONVERT</code> <code class="codeph">DATABASE</code> command to the computer system that will run the destination database.
                                 </p>
                              </li>
                              <li>
                                 <p>On the computer system that will run the destination database, modify the SQL script so that the destination database always opens with restricted session enabled.</p>
                                 <p>The following is a sample script with the necessary modifications in bold font:</p><pre class="oac_no_warn" dir="ltr">-- The following commands will create a new control file and use it
-- to open the database.
-- Data used by Recovery Manager will be lost.
-- The contents of online logs will be lost and all backups will
-- be invalidated. Use this only if online logs are damaged.
 
-- After mounting the created controlfile, the following SQL
-- statement will place the database in the appropriate
-- protection mode:
--  ALTER DATABASE SET STANDBY DATABASE TO MAXIMIZE PERFORMANCE
 
STARTUP NOMOUNT PFILE='init_00gd2lak_1_0.ora'
CREATE CONTROLFILE REUSE SET DATABASE "CVX2" RESETLOGS  NOARCHIVELOG
    MAXLOGFILES 32
    MAXLOGMEMBERS 2
    MAXDATAFILES 32
    MAXINSTANCES 1
    MAXLOGHISTORY 226
LOGFILE
  GROUP 1 '/tmp/convertdb/archlog1'  SIZE 25M,
  GROUP 2 '/tmp/convertdb/archlog2'  SIZE 25M
DATAFILE
  '/tmp/convertdb/systemdf',
  '/tmp/convertdb/sysauxdf',
  '/tmp/convertdb/datafile1',
  '/tmp/convertdb/datafile2',
  '/tmp/convertdb/datafile3'
CHARACTER SET WE8DEC
;
 
<span class="bold">-- NOTE: This ALTER SYSTEM statement is added to enable restricted session.</span>

<span class="bold">ALTER SYSTEM ENABLE RESTRICTED SESSION;</span>

-- Database can now be opened zeroing the online logs.
ALTER DATABASE OPEN RESETLOGS;
 
-- No tempfile entries found to add.
--
 
set echo off
prompt ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
prompt * Your database has been created successfully!
prompt * There are many things to think about for the new database. Here
prompt * is a checklist to help you stay on track:
prompt * 1. You may want to redefine the location of the directory objects.
prompt * 2. You may want to change the internal database identifier (DBID) 
prompt *    or the global database name for this database. Use the 
prompt *    NEWDBID Utility (nid).
prompt ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
SHUTDOWN IMMEDIATE 
<span class="bold">-- NOTE: This startup has the UPGRADE parameter.</span>
<span class="bold">-- It already has restricted session enabled, so no change is needed.</span>
STARTUP UPGRADE PFILE='init_00gd2lak_1_0.ora'
@@ ?/rdbms/admin/utlirp.sql 
SHUTDOWN IMMEDIATE 
<span class="bold">-- NOTE: The startup below is generated without the RESTRICT clause.</span>
<span class="bold">-- Add the RESTRICT clause.</span>
STARTUP <span class="bold">RESTRICT</span> PFILE='init_00gd2lak_1_0.ora'
-- The following step will recompile all PL/SQL modules.
-- It may take serveral hours to complete.
@@ ?/rdbms/admin/utlrp.sql 
set feedback 6;
</pre><p>Other changes to the script might be necessary. For example, the data file locations and PFILE location might need to be changed to point to the correct locations on the destination database computer system.</p>
                              </li>
                              <li>
                                 <p>At the destination database, connect as an administrative user in SQL*Plus and run the following procedure:</p>
                                 <div class="infoboxnote" id="GUID-2E02C473-967C-4FF2-ADCE-6EE0D308F30D__GUID-74F73EE2-99DC-4BAA-9A0C-F2EA62438655">
                                    <p class="notep1">Note:</p>
                                    <p>Ensure that you are connected to the destination database, not the source database, when you run this procedure because it removes the local Oracle Streams configuration.</p>
                                 </div><pre class="oac_no_warn" dir="ltr">EXEC DBMS_STREAMS_ADM.REMOVE_STREAMS_CONFIGURATION();
</pre><div class="infoboxnote" id="GUID-2E02C473-967C-4FF2-ADCE-6EE0D308F30D__GUID-5B6A44F6-9530-4E80-82B3-BD020173DC21">
                                    <p class="notep1">Note:</p>
                                    <p>Any supplemental log groups for the tables at the source database are retained at the destination database, and the <code class="codeph">REMOVE_STREAMS_CONFIGURATION</code> procedure does not drop them. You can drop these supplemental log groups if necessary.
                                    </p>
                                 </div>
                                 <div class="infoboxnotealso" id="GUID-2E02C473-967C-4FF2-ADCE-6EE0D308F30D__GUID-800ABEA7-18DA-4235-8B57-2BD771F3DF27">
                                    <p class="notep1">See Also:</p>
                                    <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS508"><span class="italic">Oracle Database PL/SQL Packages and Types Reference </span></a>for more information about the <code class="codeph">REMOVE_STREAMS_CONFIGURATION</code> procedure
                                    </p>
                                 </div>
                              </li>
                              <li>
                                 <p>In SQL*Plus, connect to the destination database <code class="codeph">cvx2.example.com</code> as the Oracle Streams administrator.
                                 </p>
                              </li>
                              <li>
                                 <p>Drop the database link from the source database to the destination database that was cloned from the source database:</p><pre class="oac_no_warn" dir="ltr">DROP DATABASE LINK cvx2.example.com;
</pre></li>
                              <li>
                                 <p>At the destination database, use the <code class="codeph">ALTER</code> <code class="codeph">SYSTEM</code> statement to disable the <code class="codeph">RESTRICTED</code> <code class="codeph">SESSION</code>:
                                 </p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM DISABLE RESTRICTED SESSION;
</pre></li>
                              <li>
                                 <p>At the destination database, create the queue specified in Step <a href="instantiation-and-oracle-streams-replication.html#GUID-2E02C473-967C-4FF2-ADCE-6EE0D308F30D__BABHGGGA">5</a>.
                                 </p>
                                 <p>For example, the following procedure creates a queue named <code class="codeph">streams_queue</code>:
                                 </p><pre class="oac_no_warn" dir="ltr">EXEC DBMS_STREAMS_ADM.SET_UP_QUEUE();
</pre></li>
                              <li>
                                 <p>At the destination database, connect as the Oracle Streams administrator and configure the Oracle Streams environment. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-EF5A403D-42E5-426D-B654-456E634F53B0">Configuring an Oracle Streams Administrator on All Databases</a>"</span>.
                                 </p>
                                 <div class="infoboxnote" id="GUID-2E02C473-967C-4FF2-ADCE-6EE0D308F30D__GUID-18390B20-FC68-4FD2-8944-BBDA7C3615EE">
                                    <p class="notep1">Note:</p>
                                    <p>Do not start any apply processes at the destination database until after you set the global instantiation SCN in Step <a href="instantiation-and-oracle-streams-replication.html#GUID-2E02C473-967C-4FF2-ADCE-6EE0D308F30D__BABHBCGH">24</a>.
                                    </p>
                                 </div>
                              </li>
                              <li>
                                 <p>At the destination database, create a database link to the source database:</p><pre class="oac_no_warn" dir="ltr">CREATE DATABASE LINK cvx1.example.com CONNECT TO strmadmin 
   IDENTIFIED BY <span class="italic">password</span> USING 'cvx1.example.com';
</pre><p>This database link is required because the next step runs the <code class="codeph">SET_GLOBAL_INSTANTIATION_SCN</code> procedure with the recursive parameter set to <code class="codeph">TRUE</code>.
                                 </p>
                              </li>
                              <li id="GUID-2E02C473-967C-4FF2-ADCE-6EE0D308F30D__BABHBCGH">
                                 <p>At the destination database, set the global instantiation SCN for the source database to the SCN value returned in Step <a href="instantiation-and-oracle-streams-replication.html#GUID-2E02C473-967C-4FF2-ADCE-6EE0D308F30D__BABHCABH">12</a>.
                                 </p>
                                 <p>For example, to set the global instantiation SCN to <code class="codeph">46931285</code> for the <code class="codeph">cvx1.example.com</code> source database, run the following procedure: 
                                 </p><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_APPLY_ADM.SET_GLOBAL_INSTANTIATION_SCN(
    source_database_name   =&gt;  'cvx1.example.com',
    instantiation_scn      =&gt;  46931285,
    recursive              =&gt;  TRUE);
END;
/
</pre><p>Notice that the <code class="codeph">recursive</code> parameter is set to <code class="codeph">TRUE</code> to set the instantiation SCN for all schemas and tables in the destination database.
                                 </p>
                              </li>
                              <li>
                                 <p>At the destination database, you can start any apply processes that you configured.</p>
                              </li>
                              <li>
                                 <p>At the source database, start the propagation you stopped in Step <a href="instantiation-and-oracle-streams-replication.html#GUID-2E02C473-967C-4FF2-ADCE-6EE0D308F30D__BABCHJGG">6</a>:
                                 </p><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_PROPAGATION_ADM.START_PROPAGATION(
    propagation_name  =&gt; 'cvx1_to_cvx2');
END;
/</pre></li>
                           </ol>
                           <div class="infoboxnotealso" id="GUID-2E02C473-967C-4FF2-ADCE-6EE0D308F30D__GUID-7F199056-2609-42BA-ACC8-7C57EDEF5D4D">
                              <p class="notep1">See Also:</p>
                              <p><span class="q">"<a href="comparing-and-converging-data.html#GUID-BE4621F5-4EEC-491C-9141-ABDCCA282D9E">Checking for Consistency After Instantiation</a>"</span></p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div><a id="STREP117"></a><div class="props_rev_3"><a id="GUID-35E458F3-6293-47A8-AB12-FA7720E99AC0" name="GUID-35E458F3-6293-47A8-AB12-FA7720E99AC0"></a><h3 id="STREP-GUID-35E458F3-6293-47A8-AB12-FA7720E99AC0" class="sect3"><span class="enumeration_section">8.5 </span>Setting Instantiation SCNs at a Destination Database
               </h3>
               <div>
                  <p>An instantiation system change number (SCN) instructs an apply process at a destination database to apply changes that committed after a specific SCN at a source database. You can set instantiation SCNs in one of the following ways:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p>Export the relevant database objects at the source database and import them at the destination database. In this case, the export/import creates the database objects at the destination database, populates them with the data from the source database, and sets the relevant instantiation SCNs. You can use Data Pump export/import for instantiations. See <span class="q">"<a href="instantiation-and-oracle-streams-replication.html#GUID-478D3B54-1CFC-43DC-8741-6C7F7DF8A68D">Setting Instantiation SCNs Using Export/Import</a>"</span> for information about the instantiation SCNs that are set for different types of export/import operations.
                        </p>
                     </li>
                     <li>
                        <p>Perform a metadata only export/import using Data Pump. If you use Data Pump export/import, then set the <code class="codeph">CONTENT</code> parameter to <code class="codeph">METADATA_ONLY</code> during export at the source database or import at the destination database, or both. Instantiation SCNs are set for the database objects, but no data is imported. See <span class="q">"<a href="instantiation-and-oracle-streams-replication.html#GUID-478D3B54-1CFC-43DC-8741-6C7F7DF8A68D">Setting Instantiation SCNs Using Export/Import</a>"</span> for information about the instantiation SCNs that are set for different types of export/import operations.
                        </p>
                     </li>
                     <li>
                        <p>Use transportable tablespaces to copy the objects in one or more tablespaces from a source database to a destination database. An instantiation SCN is set for each schema in these tablespaces and for each database object in these tablespaces that was prepared for instantiation before the export. See <span class="q">"<a href="instantiation-and-oracle-streams-replication.html#GUID-E74B9C41-8F19-423F-9CC0-9CF8B34569FD">Instantiating Objects in a Tablespace Using Transportable Tablespace or RMAN</a>"</span>.
                        </p>
                     </li>
                     <li>
                        <p>Set the instantiation SCN using the <code class="codeph">SET_TABLE_INSTANTIATION_SCN</code>, <code class="codeph">SET_SCHEMA_INSTANATIATION_SCN</code>, and <code class="codeph">SET_GLOBAL_INSTANTIATION_SCN</code> procedures in the <code class="codeph">DBMS_APPLY_ADM</code> package. See <span class="q">"<a href="instantiation-and-oracle-streams-replication.html#GUID-F612AD02-15B7-4392-815E-1EB05A493633">Setting Instantiation SCNs Using the DBMS_APPLY_ADM Package</a>"</span>.
                        </p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-35E458F3-6293-47A8-AB12-FA7720E99AC0__GUID-BD8400B3-3585-4CD0-ABC6-40B9F7C14F87">
                     <p class="notep1">See Also:</p>
                     <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=STRMS212"><span class="italic">Oracle Streams Concepts and Administration</span></a></p>
                  </div>
               </div><a id="STREP348"></a><div class="props_rev_3"><a id="GUID-478D3B54-1CFC-43DC-8741-6C7F7DF8A68D" name="GUID-478D3B54-1CFC-43DC-8741-6C7F7DF8A68D"></a><h4 id="STREP-GUID-478D3B54-1CFC-43DC-8741-6C7F7DF8A68D" class="sect4"><span class="enumeration_section">8.5.1 </span>Setting Instantiation SCNs Using Export/Import
                  </h4>
                  <div>
                     <p>This section discusses setting instantiation SCNs by performing an export/import. The information in this section applies to both metadata export/import operations and to export/import operations that import rows. You can specify a more stringent degree of consistency by using an export parameter such as <code class="codeph">FLASHBACK_SCN</code> or <code class="codeph">FLASHBACK_TIME</code>.
                     </p>
                     <p>The following sections describe how the instantiation SCNs are set for different types of export/import operations. These sections refer to <span class="bold">prepared tables</span>. Prepared tables are tables that have been prepared for instantiation using the <code class="codeph">PREPARE_TABLE_INSTANTIATION</code> procedure, <code class="codeph">PREPARE_SYNC_INSTANTIATION</code> function, <code class="codeph">PREPARE_SCHEMA_INSTANTIATION</code> procedure, or <code class="codeph">PREPARE_GLOBAL_INSTANTIATION</code> procedure in the <code class="codeph">DBMS_CAPTURE_ADM</code> package. A table must be a prepared table before export in order for an instantiation SCN to be set for it during import. However, the database and schemas do not need to be prepared before the export in order for their instantiation SCNs to be set for them during import.
                     </p>
                  </div><a id="STREP349"></a><div class="props_rev_3"><a id="GUID-280B415A-E06A-4FE3-AF78-8BA4A924063D" name="GUID-280B415A-E06A-4FE3-AF78-8BA4A924063D"></a><h5 id="STREP-GUID-280B415A-E06A-4FE3-AF78-8BA4A924063D" class="sect5"><span class="enumeration_section">8.5.1.1 </span>Full Database Export and Full Database Import
                     </h5>
                     <div>
                        <p>A full database export and full database import sets the following instantiation SCNs at the import database:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The database, or global, instantiation SCN</p>
                           </li>
                           <li>
                              <p>The schema instantiation SCN for each imported user</p>
                           </li>
                           <li>
                              <p>The table instantiation SCN for each prepared table that is imported</p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="STREP350"></a><div class="props_rev_3"><a id="GUID-412F9F82-FBC0-4F4F-BE5C-078142ACF551" name="GUID-412F9F82-FBC0-4F4F-BE5C-078142ACF551"></a><h5 id="STREP-GUID-412F9F82-FBC0-4F4F-BE5C-078142ACF551" class="sect5"><span class="enumeration_section">8.5.1.2 </span>Full Database or User Export and User Import
                     </h5>
                     <div>
                        <p>A full database or user export and user import sets the following instantiation SCNs at the import database:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The schema instantiation SCN for each imported user</p>
                           </li>
                           <li>
                              <p>The table instantiation SCN for each prepared table that is imported</p>
                           </li>
                        </ul>
                     </div>
                  </div><a id="STREP351"></a><div class="props_rev_3"><a id="GUID-8516E3A0-BED8-409E-AF13-03C2CF7E769B" name="GUID-8516E3A0-BED8-409E-AF13-03C2CF7E769B"></a><h5 id="STREP-GUID-8516E3A0-BED8-409E-AF13-03C2CF7E769B" class="sect5"><span class="enumeration_section">8.5.1.3 </span>Full Database, User, or Table Export and Table Import
                     </h5>
                     <div>
                        <p>Any export that includes one or more tables and a table import sets the table instantiation SCN for each prepared table that is imported at the import database.</p>
                        <div class="infoboxnote" id="GUID-8516E3A0-BED8-409E-AF13-03C2CF7E769B__GUID-8123E97B-002C-478B-94B3-5F1A1635F768">
                           <p class="notep1">Note:</p>
                           <p></p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>If a non-<code class="codeph">NULL</code> instantiation SCN already exists for a database object at a destination database that performs an import, then the import updates the instantiation SCN for that database object.
                                 </p>
                              </li>
                              <li>
                                 <p>During an export for an Oracle Streams instantiation, ensure that no data definition language (DDL) changes are made to objects being exported.</p>
                              </li>
                              <li>
                                 <p>Any table supplemental logging specifications for the tables exported from the export database are retained when the tables are imported at the import database.</p>
                              </li>
                           </ul>
                        </div>
                        <div class="infoboxnotealso" id="GUID-8516E3A0-BED8-409E-AF13-03C2CF7E769B__GUID-68DBFC96-7DE7-4679-AAD6-D18B1A83D176">
                           <p class="notep1">See Also:</p>
                           <p></p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="q">"<a href="instantiation-and-oracle-streams-replication.html#GUID-AAB63D95-9728-4142-BB75-83356AE7C899">Oracle Data Pump and Oracle Streams Instantiation</a>"</span> and<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=SUTIL"><span class="italic"> Oracle Database Utilities </span></a>for information about using export/import
                                 </p>
                              </li>
                              <li>
                                 <p><span class="q">"<a href="instantiation-and-oracle-streams-replication.html#GUID-CBDA09E8-D2E0-4E56-B7A7-E87BDC26FC5A">Preparing Database Objects for Instantiation at a Source Database</a>"</span></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="STREP353"></a><a id="STREP352"></a><div class="props_rev_3"><a id="GUID-F612AD02-15B7-4392-815E-1EB05A493633" name="GUID-F612AD02-15B7-4392-815E-1EB05A493633"></a><h4 id="STREP-GUID-F612AD02-15B7-4392-815E-1EB05A493633" class="sect4"><span class="enumeration_section">8.5.2 </span>Setting Instantiation SCNs Using the DBMS_APPLY_ADM Package
                  </h4>
                  <div>
                     <p>You can set an instantiation SCN at a destination database for a specified table, a specified schema, or an entire database using one of the following procedures in the <code class="codeph">DBMS_APPLY_ADM</code> package:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS325"><code class="codeph">SET_TABLE_INSTANTIATION_SCN</code></a></p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS589"><code class="codeph">SET_SCHEMA_INSTANTIATION_SCN</code></a></p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS538"><code class="codeph">SET_GLOBAL_INSTANTIATION_SCN</code></a></p>
                        </li>
                     </ul>
                     <p>If you set the instantiation SCN for a schema using <code class="codeph">SET_SCHEMA_INSTANTIATION_SCN</code>, then you can set the <code class="codeph">recursive</code> parameter to <code class="codeph">TRUE</code> when you run this procedure to set the instantiation SCN for each table in the schema. Similarly, if you set the instantiation SCN for a database using <code class="codeph">SET_GLOBAL_INSTANTIATION_SCN</code>, then you can set the <code class="codeph">recursive</code> parameter to <code class="codeph">TRUE</code> when you run this procedure to set the instantiation SCN for the schemas in the database and for each table owned by these schemas.
                     </p>
                     <div class="infoboxnote" id="GUID-F612AD02-15B7-4392-815E-1EB05A493633__GUID-064AEF82-E4CF-4D4F-9E6B-D0B57D9FED23">
                        <p class="notep1">Note:</p>
                        <p></p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>If you set the <code class="codeph">recursive</code> parameter to <code class="codeph">TRUE</code> in the <code class="codeph">SET_SCHEMA_INSTANTIATION_SCN</code> procedure or the <code class="codeph">SET_GLOBAL_INSTANTIATION_SCN</code> procedure, then a database link from the destination database to the source database is required. This database link must have the same name as the global name of the source database and must be accessible to the user who executes the procedure.
                              </p>
                           </li>
                           <li>
                              <p>When setting an instantiation SCN for a database object, always specify the name of the schema and database object at the source database, even if a rule-based transformation or apply handler is configured to change the schema name or database object name.</p>
                           </li>
                           <li>
                              <p>If a relevant instantiation SCN is not present, then an error is raised during apply.</p>
                           </li>
                           <li>
                              <p>These procedures can set an instantiation SCN for changes captured by capture processes and synchronous captures.</p>
                           </li>
                        </ul>
                     </div>
                     <p><a href="instantiation-and-oracle-streams-replication.html#GUID-F612AD02-15B7-4392-815E-1EB05A493633__g1015725" title="This table lists each set instantiation procedure, what each procedure sets an instaniation SCN for, and examples of SQL statements that are covered by each set instantiation procedure.">Table 8-3</a> lists each procedure and the types of statements for which they set an instantiation SCN.
                     </p>
                     <div class="tblformalwide" id="GUID-F612AD02-15B7-4392-815E-1EB05A493633__g1015725">
                        <p class="titleintable">Table 8-3 Set Instantiation SCN Procedures and the Statements They Cover</p>
                        <table cellpadding="4" cellspacing="0" class="FormalWide" title="Set Instantiation SCN Procedures and the Statements They Cover" summary="This table lists each set instantiation procedure, what each procedure sets an instaniation SCN for, and examples of SQL statements that are covered by each set instantiation procedure." width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="36%" id="d37209e7964">Procedure</th>
                                 <th align="left" valign="bottom" width="32%" id="d37209e7967">Sets Instantiation SCN for</th>
                                 <th align="left" valign="bottom" width="32%" id="d37209e7970">Examples</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="36%" id="d37209e7975" headers="d37209e7964 ">
                                    <p><code class="codeph">SET_TABLE_INSTANTIATION_SCN</code></p>
                                 </td>
                                 <td align="left" valign="top" width="32%" headers="d37209e7975 d37209e7967 ">
                                    <p>DML and DDL statements on tables, except <code class="codeph">CREATE</code> <code class="codeph">TABLE</code></p>
                                    <p>DDL statements on table indexes and table triggers</p>
                                 </td>
                                 <td align="left" valign="top" width="32%" headers="d37209e7975 d37209e7970 ">
                                    <p><code class="codeph">UPDATE</code></p>
                                    <p><code class="codeph">ALTER</code> <code class="codeph">TABLE</code></p>
                                    <p><code class="codeph">DROP</code> <code class="codeph">TABLE</code></p>
                                    <p><code class="codeph">CREATE</code>, <code class="codeph">ALTER</code>, or <code class="codeph">DROP</code> <code class="codeph">INDEX</code> on a table
                                    </p>
                                    <p><code class="codeph">CREATE</code>, <code class="codeph">ALTER</code>, or <code class="codeph">DROP</code> <code class="codeph">TRIGGER</code> on a table
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="36%" id="d37209e8032" headers="d37209e7964 ">
                                    <p><code class="codeph">SET_SCHEMA_INSTANTIATION_SCN</code></p>
                                 </td>
                                 <td align="left" valign="top" width="32%" headers="d37209e8032 d37209e7967 ">
                                    <p>DDL statements on users, except <code class="codeph">CREATE</code> <code class="codeph">USER</code></p>
                                    <p>DDL statements on all database objects that have a non-<code class="codeph">PUBLIC</code> owner, except for those DDL statements handled by a table-level instantiation SCN
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="32%" headers="d37209e8032 d37209e7970 ">
                                    <p><code class="codeph">CREATE</code> <code class="codeph">TABLE</code></p>
                                    <p><code class="codeph">ALTER</code> <code class="codeph">USER</code></p>
                                    <p><code class="codeph">DROP</code> <code class="codeph">USER</code></p>
                                    <p><code class="codeph">CREATE</code> <code class="codeph">PROCEDURE</code></p>
                                    <p></p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="36%" id="d37209e8076" headers="d37209e7964 ">
                                    <p><code class="codeph">SET_GLOBAL_INSTANTIATION_SCN</code></p>
                                 </td>
                                 <td align="left" valign="top" width="32%" headers="d37209e8076 d37209e7967 ">
                                    <p>DDL statements on database objects other than users with no owner</p>
                                    <p>DDL statements on database objects owned by public</p>
                                    <p><code class="codeph">CREATE</code> <code class="codeph">USER</code> statements
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="32%" headers="d37209e8076 d37209e7970 ">
                                    <p><code class="codeph">CREATE</code> <code class="codeph">USER</code></p>
                                    <p><code class="codeph">CREATE</code> <code class="codeph">TABLESPACE</code></p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                  </div><a id="STREP354"></a><div class="props_rev_3"><a id="GUID-6E4DE138-3A06-43B0-9733-E90B1A5B59C2" name="GUID-6E4DE138-3A06-43B0-9733-E90B1A5B59C2"></a><h5 id="STREP-GUID-6E4DE138-3A06-43B0-9733-E90B1A5B59C2" class="sect5"><span class="enumeration_section">8.5.2.1 </span>Setting the Instantiation SCN While Connected to the Source Database
                     </h5>
                     <div>
                        <div class="section">
                           <p>The user who runs the examples in this section must have access to a database link from the source database to the destination database. In these examples, the database link is <code class="codeph">hrdb2.example.com</code>. The following example sets the instantiation SCN for the <code class="codeph">hr.departments</code> table at the <code class="codeph">hrdb2.example.com</code> database to the current SCN by running the following procedure at the source database <code class="codeph">hrdb1.example.com</code>:
                           </p><pre class="oac_no_warn" dir="ltr">DECLARE
  iscn  NUMBER;         -- Variable to hold instantiation SCN value
BEGIN
  iscn := DBMS_FLASHBACK.GET_SYSTEM_CHANGE_NUMBER();
  DBMS_APPLY_ADM.SET_TABLE_INSTANTIATION_SCN@HRDB2.EXAMPLE.COM(
    source_object_name    =&gt; 'hr.departments',
    source_database_name  =&gt; 'hrdb1.example.com',
    instantiation_scn     =&gt; iscn);
END;
/
</pre><p>The following example sets the instantiation SCN for the <code class="codeph">oe</code> schema and all of its objects at the <code class="codeph">hrdb2.example.com</code> database to the current source database SCN by running the following procedure at the source database <code class="codeph">hrdb1.example.com</code>:
                           </p><pre class="oac_no_warn" dir="ltr">DECLARE
  iscn  NUMBER;         -- Variable to hold instantiation SCN value
BEGIN
  iscn := DBMS_FLASHBACK.GET_SYSTEM_CHANGE_NUMBER();
  DBMS_APPLY_ADM.SET_SCHEMA_INSTANTIATION_SCN@HRDB2.EXAMPLE.COM(
    source_schema_name    =&gt; 'oe',
    source_database_name  =&gt; 'hrdb1.example.com',
    instantiation_scn     =&gt; iscn,
    recursive             =&gt; TRUE);
END;
/
</pre><p>Because the <code class="codeph">recursive</code> parameter is set to <code class="codeph">TRUE</code>, running this procedure sets the instantiation SCN for each database object in the <code class="codeph">oe</code> schema.
                           </p>
                           <div class="infoboxnote" id="GUID-6E4DE138-3A06-43B0-9733-E90B1A5B59C2__GUID-356A2DBE-7D53-4CA0-867E-A9877CE2A2F1">
                              <p class="notep1">Note:</p>
                              <p>When you set the <code class="codeph">recursive</code> parameter to <code class="codeph">TRUE</code>, a database link from the destination database to the source database is required, even if you run the procedure while you are connected to the source database. This database link must have the same name as the global name of the source database and must be accessible to the current user.
                              </p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="STREP355"></a><div class="props_rev_3"><a id="GUID-8888F3E1-9F53-4F55-85A2-8D5A6F23B8B0" name="GUID-8888F3E1-9F53-4F55-85A2-8D5A6F23B8B0"></a><h5 id="STREP-GUID-8888F3E1-9F53-4F55-85A2-8D5A6F23B8B0" class="sect5"><span class="enumeration_section">8.5.2.2 </span>Setting the Instantiation SCN While Connected to the Destination Database
                     </h5>
                     <div>
                        <div class="section">
                           <p>The user who runs the examples in this section must have access to a database link from the destination database to the source database. In these examples, the database link is <code class="codeph">hrdb1.example.com</code>. The following example sets the instantiation SCN for the <code class="codeph">hr.departments</code> table at the <code class="codeph">hrdb2.example.com</code> database to the current source database SCN at <code class="codeph">hrdb1.example.com</code> by running the following procedure at the destination database <code class="codeph">hrdb2.example.com</code>:
                           </p><pre class="oac_no_warn" dir="ltr">DECLARE
  iscn  NUMBER;         -- Variable to hold instantiation SCN value
BEGIN
  iscn := DBMS_FLASHBACK.GET_SYSTEM_CHANGE_NUMBER@HRDB1.EXAMPLE.COM;
  DBMS_APPLY_ADM.SET_TABLE_INSTANTIATION_SCN(
    source_object_name    =&gt; 'hr.departments',
    source_database_name  =&gt; 'hrdb1.example.com',
    instantiation_scn     =&gt; iscn);
END;
/
</pre><p>The following example sets the instantiation SCN for the <code class="codeph">oe</code> schema and all of its objects at the <code class="codeph">hrdb2.example.com</code> database to the current source database SCN at <code class="codeph">hrdb1.example.com</code> by running the following procedure at the destination database <code class="codeph">hrdb2.example.com</code>:
                           </p><pre class="oac_no_warn" dir="ltr">DECLARE
  iscn  NUMBER;         -- Variable to hold instantiation SCN value
BEGIN
  iscn := DBMS_FLASHBACK.GET_SYSTEM_CHANGE_NUMBER@HRDB1.EXAMPLE.COM;
  DBMS_APPLY_ADM.SET_SCHEMA_INSTANTIATION_SCN(
    source_schema_name    =&gt; 'oe',
    source_database_name  =&gt; 'hrdb1.example.com',
    instantiation_scn     =&gt; iscn,
    recursive             =&gt; TRUE);
END;
/
</pre><p>Because the <code class="codeph">recursive</code> parameter is set to <code class="codeph">TRUE</code>, running this procedure sets the instantiation SCN for each database object in the <code class="codeph">oe</code> schema.
                           </p>
                           <div class="infoboxnote" id="GUID-8888F3E1-9F53-4F55-85A2-8D5A6F23B8B0__GUID-3D760622-FCAE-4851-AAB6-47DE8243E65D">
                              <p class="notep1">Note:</p>
                              <p>If an apply process applies changes to a remote non-Oracle database, then set the <code class="codeph">apply_database_link</code> parameter to the database link used for remote apply when you set the instantiation&nbsp;SCN.
                              </p>
                           </div>
                           <div class="infoboxnotealso" id="GUID-8888F3E1-9F53-4F55-85A2-8D5A6F23B8B0__GUID-186C54E9-6EF8-4A22-87DA-5DA3E2779AA9">
                              <p class="notep1">See Also:</p>
                              <p></p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=STREX"><span class="italic">Oracle Streams Extended Examples</span></a> for detailed examples that uses the <code class="codeph">SET_TABLE_INSTANTIATION_SCN</code> procedure
                                    </p>
                                 </li>
                                 <li>
                                    <p>The information about the <code class="codeph">DBMS_APPLY_ADM</code> package in the<a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS300"><span class="italic"> Oracle Database PL/SQL Packages and Types Reference </span></a>for more information about which instantiation SCN can be used for a DDL LCR
                                    </p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div>
            </div><a id="STREP160"></a><div class="props_rev_3"><a id="GUID-D03E9B4C-F2CD-4C20-B0A4-19ED3CA5AA61" name="GUID-D03E9B4C-F2CD-4C20-B0A4-19ED3CA5AA61"></a><h3 id="STREP-GUID-D03E9B4C-F2CD-4C20-B0A4-19ED3CA5AA61" class="sect3"><span class="enumeration_section">8.6 </span>Monitoring Instantiation
               </h3>
               <div>
                  <p>The following sections contain queries that you can run to determine which database objects are prepared for instantiation at a source database and the instantiation SCN for database objects at a destination database:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="instantiation-and-oracle-streams-replication.html#GUID-97F9EDD6-CD46-4A05-ACB8-6591E00D0759">Determining Which Database Objects Are Prepared for Instantiation</a></p>
                     </li>
                     <li>
                        <p><a href="instantiation-and-oracle-streams-replication.html#GUID-3F8E989C-465B-48FD-B014-B2243D71967D">Determining the Tables for Which an Instantiation SCN Has Been Set</a></p>
                     </li>
                  </ul>
               </div><a id="STREP356"></a><div class="props_rev_3"><a id="GUID-97F9EDD6-CD46-4A05-ACB8-6591E00D0759" name="GUID-97F9EDD6-CD46-4A05-ACB8-6591E00D0759"></a><h4 id="STREP-GUID-97F9EDD6-CD46-4A05-ACB8-6591E00D0759" class="sect4"><span class="enumeration_section">8.6.1 </span>Determining Which Database Objects Are Prepared for Instantiation
                  </h4>
                  <div>
                     <div class="section">
                        <p>See <span class="q">"<a href="instantiation-and-oracle-streams-replication.html#GUID-49D5B599-16A8-40EB-8A2A-D4425F13682A">Capture Rules and Preparation for Instantiation</a>"</span> for information about preparing database objects for instantiation.
                        </p>
                        <p>To determine which database objects have been prepared for instantiation, query the following data dictionary views:</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">DBA_CAPTURE_PREPARED_TABLES</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">DBA_SYNC_CAPTURE_PREPARED_TABS</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">DBA_CAPTURE_PREPARED_SCHEMAS</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">DBA_CAPTURE_PREPARED_DATABASE</code></p>
                           </li>
                        </ul>
                        <p>For example, to list all of the tables that have been prepared for instantiation by the <code class="codeph">PREPARE_TABLE_INSTANTIATION</code> procedure, the SCN for the time when each table was prepared, and the time when each table was prepared, run the following query:
                        </p><pre class="oac_no_warn" dir="ltr">COLUMN TABLE_OWNER HEADING 'Table Owner' FORMAT A15
COLUMN TABLE_NAME HEADING 'Table Name' FORMAT A15
COLUMN SCN HEADING 'Prepare SCN' FORMAT 99999999999
COLUMN TIMESTAMP HEADING 'Time Ready for|Instantiation'

SELECT TABLE_OWNER, 
       TABLE_NAME, 
       SCN, 
       TO_CHAR(TIMESTAMP, 'HH24:MI:SS MM/DD/YY') TIMESTAMP
  FROM DBA_CAPTURE_PREPARED_TABLES;
</pre><p>Your output looks similar to the following: </p><pre class="oac_no_warn" dir="ltr">                                                  Time Ready for
Table Owner     Table Name            Prepare SCN Instantiation
--------------- --------------- ----------------- -----------------
HR              COUNTRIES                  196655 12:59:30 02/28/02
HR              DEPARTMENTS                196658 12:59:30 02/28/02
HR              EMPLOYEES                  196659 12:59:30 02/28/02
HR              JOBS                       196660 12:59:30 02/28/02
HR              JOB_HISTORY                196661 12:59:30 02/28/02
HR              LOCATIONS                  196662 12:59:30 02/28/02
HR              REGIONS                    196664 12:59:30 02/28/02
</pre><div class="infoboxnotealso" id="GUID-97F9EDD6-CD46-4A05-ACB8-6591E00D0759__GUID-2EE4ADA7-D6AA-4B8F-BBB1-CFE1EB8E29B7">
                           <p class="notep1">See Also:</p>
                           <p><span class="q">"<a href="instantiation-and-oracle-streams-replication.html#GUID-CBDA09E8-D2E0-4E56-B7A7-E87BDC26FC5A">Preparing Database Objects for Instantiation at a Source Database</a>"</span></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="STREP357"></a><div class="props_rev_3"><a id="GUID-3F8E989C-465B-48FD-B014-B2243D71967D" name="GUID-3F8E989C-465B-48FD-B014-B2243D71967D"></a><h4 id="STREP-GUID-3F8E989C-465B-48FD-B014-B2243D71967D" class="sect4"><span class="enumeration_section">8.6.2 </span>Determining the Tables for Which an Instantiation SCN Has Been Set
                  </h4>
                  <div>
                     <div class="section">
                        <p>An instantiation SCN is set at a destination database. It controls which captured logical change records (LCRs) for a database object are ignored by an apply process and which captured LCRs for a database object are applied by an apply process. If the commit SCN of an LCR for a table from a source database is less than or equal to the instantiation SCN for that table at a destination database, then the apply process at the destination database discards the LCR. Otherwise, the apply process applies the LCR. The LCRs can be captured by a capture process or a synchronous capture. See <span class="q">"<a href="instantiation-and-oracle-streams-replication.html#GUID-35E458F3-6293-47A8-AB12-FA7720E99AC0">Setting Instantiation SCNs at a Destination Database</a>"</span>.
                        </p>
                        <p>To determine which database objects have a set instantiation SCN, query the following corresponding data dictionary views:</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><code class="codeph">DBA_APPLY_INSTANTIATED_OBJECTS</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">DBA_APPLY_INSTANTIATED_SCHEMAS</code></p>
                           </li>
                           <li>
                              <p><code class="codeph">DBA_APPLY_INSTANTIATED_GLOBAL</code></p>
                           </li>
                        </ul>
                        <p>The following query lists each table for which an instantiation SCN has been set at a destination database and the instantiation SCN for each table:</p><pre class="oac_no_warn" dir="ltr">COLUMN SOURCE_DATABASE HEADING 'Source Database' FORMAT A20
COLUMN SOURCE_OBJECT_OWNER HEADING 'Object Owner' FORMAT A15
COLUMN SOURCE_OBJECT_NAME HEADING 'Object Name' FORMAT A15
COLUMN INSTANTIATION_SCN HEADING 'Instantiation SCN' FORMAT 99999999999

SELECT SOURCE_DATABASE, 
       SOURCE_OBJECT_OWNER, 
       SOURCE_OBJECT_NAME, 
       INSTANTIATION_SCN 
  FROM DBA_APPLY_INSTANTIATED_OBJECTS
  WHERE APPLY_DATABASE_LINK IS NULL;
</pre><p>Your output looks similar to the following:</p><pre class="oac_no_warn" dir="ltr">Source Database     Object Owner    Object Name     Instantiation SCN
-------------------- --------------- --------------- -----------------
DBS1.EXAMPLE.COM     HR              REGIONS                    196660
DBS1.EXAMPLE.COM     HR              COUNTRIES                  196660
DBS1.EXAMPLE.COM     HR              LOCATIONS                  196660
</pre><div class="infoboxnote" id="GUID-3F8E989C-465B-48FD-B014-B2243D71967D__GUID-24D8CD55-A667-4E91-9E34-704CFAE4C9F6">
                           <p class="notep1">Note:</p>
                           <p>You can also display instantiation SCNs for changes that are applied to remote non-Oracle databases. This query does not display these instantiation SCNs because it lists an instantiation SCN only if the <code class="codeph">APPLY_DATABASE_LINK</code> column is <code class="codeph">NULL</code>.
                           </p>
                        </div>
                        <div class="infoboxnotealso" id="GUID-3F8E989C-465B-48FD-B014-B2243D71967D__GUID-2442E930-3F74-429E-9A12-CBC357042DB1">
                           <p class="notep1">See Also:</p>
                           <p><span class="q">"<a href="instantiation-and-oracle-streams-replication.html#GUID-35E458F3-6293-47A8-AB12-FA7720E99AC0">Setting Instantiation SCNs at a Destination Database</a>"</span></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>