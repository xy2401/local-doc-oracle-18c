<!DOCTYPE html
  SYSTEM "about:legacy-compat">

<!-- saved from url=(0023)https://docs.oracle.com -->

<html xml:lang="en-us" lang="en-us">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Simple Oracle Streams Replication Configuration</title>
      <meta property="og:site_name" content="Oracle Help Center">
      <meta property="og:title" content="Replication Administrator’s Guide ">
      <meta property="og:description" content="">
      <link rel="stylesheet" href="/sp_common/book-template/ohc-book-template/css/book.css">
      <link rel="shortcut icon" href="/sp_common/book-template/ohc-common/img/favicon.ico">
      <meta name="application-name" content="Replication Administrator’s Guide">
      <meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)">
      <meta name="plugin" content="SP_docbuilder HTML plugin release 18.1.1">
      <link rel="alternate" href="streams-replication-administrators-guide.pdf" title="PDF File" type="application/pdf">
      <meta name="robots" content="all">
      <link rel="schema.dcterms" href="http://purl.org/dc/terms/">
      <meta name="dcterms.created" content="2018-01-24T23:25:23-08:00">
      
      <meta name="dcterms.dateCopyrighted" content="2003, 2018">
      <meta name="dcterms.category" content="database">
      <meta name="dcterms.identifier" content="E83780-01">
      
      <meta name="dcterms.product" content="en/database/oracle/oracle-database/18">
      <meta name="dcterms.release" content="Release 18">
      <link rel="prev" href="preparing-for-oracle-streams-replication.html" title="Previous" type="text/html">
      <link rel="next" href="flexible-oracle-streams-replication-configuration.html" title="Next" type="text/html">
      <script>
        document.write('<style type="text/css">');
        document.write('body > .noscript, body > .noscript ~ * { visibility: hidden; }');
        document.write('</style>');
     </script>
      <script data-main="/sp_common/book-template/ohc-book-template/js/book-config" src="/sp_common/book-template/requirejs/require.js"></script>
      <script>
            if (window.require === undefined) {
                document.write('<script data-main="sp_common/book-template/ohc-book-template/js/book-config" src="sp_common/book-template/requirejs/require.js"><\/script>');
                document.write('<link href="sp_common/book-template/ohc-book-template/css/book.css" rel="stylesheet"/>');
            }
        </script>
      <script type="application/json" id="ssot-metadata">{"primary":{"category":{"short_name":"database","element_name":"Database","display_in_url":true},"suite":{"short_name":"oracle","element_name":"Oracle","display_in_url":true},"product_group":{"short_name":"not-applicable","element_name":"Not applicable","display_in_url":false},"product":{"short_name":"oracle-database","element_name":"Oracle Database","display_in_url":true},"release":{"short_name":"18","element_name":"Release 18","display_in_url":true}}}</script>
      
    <meta name="dcterms.title" content="Streams Replication Administrator's Guide">
    <meta name="dcterms.isVersionOf" content="STREP">
  </head>
   <body>
      <div class="noscript alert alert-danger text-center" role="alert">
         <a href="preparing-for-oracle-streams-replication.html" class="pull-left"><span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Previous</a>
         <a href="flexible-oracle-streams-replication-configuration.html" class="pull-right">Next<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span></a>
         <span class="fa fa-exclamation-triangle" aria-hidden="true"></span> JavaScript must be enabled to correctly display this content
        
      </div>
      <article>
         <header>
            <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
               <li property="itemListElement" typeof="ListItem"><a href="index.html" property="item" typeof="WebPage"><span property="name">Replication Administrator’s Guide </span></a></li>
               <li property="itemListElement" typeof="ListItem"><a href="configuring-oracle-streams-replication.html" property="item" typeof="WebPage"><span property="name">    Configuring Oracle Streams Replication </span></a></li>
               <li class="active" property="itemListElement" typeof="ListItem"> Simple Oracle Streams Replication Configuration</li>
            </ol>
            <a id="GUID-19643DBA-4776-4A74-BC66-1979E6903E0A" name="GUID-19643DBA-4776-4A74-BC66-1979E6903E0A"></a><a id="STREP056"></a>
            
            <h2 id="STREP-GUID-19643DBA-4776-4A74-BC66-1979E6903E0A" class="sect2"><span class="enumeration_chapter">2 </span> Simple Oracle Streams Replication Configuration
            </h2>
         </header>
         <div class="ind">
            <div>
               <p><a id="d12046e100" class="indexterm-anchor"></a><a id="d12046e104" class="indexterm-anchor"></a>This chapter describes simple methods for configuring Oracle Streams replication.
               </p>
               <p>This chapter contains these topics:</p>
               <ul style="list-style-type: disc;">
                  <li>
                     <p><a href="simple-oracle-streams-replication-configuration.html#GUID-0C365820-9DCF-4234-B4F2-20DFA29E9E22">Configuring Replication Using the Setup Streams Replication Wizard</a></p>
                  </li>
                  <li>
                     <p><a href="simple-oracle-streams-replication-configuration.html#GUID-8FAAAEF7-0689-4A95-8BD4-D8630CE45FD5">Configuring Replication Using the DBMS_STREAMS_ADM Package</a></p>
                  </li>
               </ul>
            </div><a id="STREP252"></a><div class="props_rev_3"><a id="GUID-0C365820-9DCF-4234-B4F2-20DFA29E9E22" name="GUID-0C365820-9DCF-4234-B4F2-20DFA29E9E22"></a><h3 id="STREP-GUID-0C365820-9DCF-4234-B4F2-20DFA29E9E22" class="sect3"><span class="enumeration_section">2.1 </span>Configuring Replication Using the Setup Streams Replication Wizard
               </h3>
               <div>
                  <div class="section">
                     <p>The Oracle Streams tool in Oracle Enterprise Manager Cloud Control includes a Setup Streams Replication Wizard that configures an Oracle Streams replication environment. Using this wizard, you can configure an Oracle Streams replication environment with any of the following characteristics:</p>
                  </div>
                  <!-- class="section" -->
                  <div class="section">
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Replicate changes to the entire source database, selected schemas in the source database, selected tablespaces in the source database, selected tables in the source database, or subsets of tables in the source database</p>
                        </li>
                        <li>
                           <p>Maintain data manipulation language (DML) changes, data definition language (DDL) changes, or both.</p>
                        </li>
                        <li>
                           <p>One-way or bi-directional replication</p>
                        </li>
                        <li>
                           <p>Local capture or downstream capture</p>
                        </li>
                     </ul>
                     <p>The wizard walks you through the process of configuring your replication environment, and you can run the wizard multiple times to configure a replication environment with more than two databases. There are some limits to the types of replication environments that can be configured with the wizard. For example, the wizard currently cannot configure synchronous capture.</p>
                     <p>You can choose to configure the Oracle Streams replication environment immediately, or you can use the wizard to generate a script. When you generate a script, you can review the script, and edit the script if necessary, before running the script to configure the replication environment.</p>
                     <p>To open the wizard, complete the following steps in Oracle Enterprise Manager Cloud Control:</p>
                  </div>
                  <!-- class="section" -->
                  <ol>
                     <li class="stepexpand"><span>Review the decisions described in <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-C32C3F56-49EF-4964-A984-9CB220DCB5B3">Decisions to Make Before Configuring Oracle Streams Replication</a>"</span>. Make these decisions about the Oracle Streams replication environment before proceeding.</span></li>
                     <li class="stepexpand"><span>Complete the tasks to prepare for the Oracle Streams replication environment. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-BB2E76CA-3645-4469-8750-4B276B8A955B">Tasks to Complete Before Configuring Oracle Streams Replication</a>"</span>.</span><div>
                           <p>The wizard completes some tasks automatically, but you must complete the following tasks manually:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Configure an Oracle Streams administrator at both databases. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-EF5A403D-42E5-426D-B654-456E634F53B0">Configuring an Oracle Streams Administrator on All Databases</a>"</span>. If you have not done so already, you must click the<span class="bold"> Streams Administrator user</span> link after you open the Streams page in Step <a href="simple-oracle-streams-replication-configuration.html#GUID-0C365820-9DCF-4234-B4F2-20DFA29E9E22__CIADJFEB">6</a> to configure the Oracle Streams administrator to manage Oracle Streams using Oracle Enterprise Manager Cloud Control.
                                 </p>
                              </li>
                              <li>
                                 <p>Configure network connectivity between the two databases. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-7867112D-DAC3-4693-811E-B1B1052C7847">Configuring Network Connectivity and Database Links</a>"</span>.
                                 </p>
                              </li>
                              <li>
                                 <p>Ensure that any database that will be a source database is in <code class="codeph">ARCHIVELOG</code> mode. If you are configuring bi-directional replication, then both databases must be in <code class="codeph">ARCHIVELOG</code> mode. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-93BE3DA2-24EC-491A-811C-E32FD80D7809">Ensuring That Each Source Database Is In ARCHIVELOG Mode</a>"</span>.
                                 </p>
                              </li>
                              <li>
                                 <p>Ensure that the initialization parameters are set properly at both databases. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-F16B954D-35E0-422C-A89F-D3E170BD4505">Setting Initialization Parameters Relevant to Oracle Streams</a>"</span>.
                                 </p>
                              </li>
                              <li>
                                 <p>Configure the Oracle Streams pool properly at both databases. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-E572258F-DEB4-4B0B-B29B-D196C7336112">Configuring the Oracle Streams Pool</a>"</span>.
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </li>
                     <li class="stepexpand"><span>In Oracle Enterprise Manager Cloud Control, log in to the database as the Oracle Streams administrator. Log in to a database that will be a source database in the replication environment.</span></li>
                     <li class="stepexpand"><span>Go to the Database Home page.</span></li>
                     <li class="stepexpand"><span>Click <span class="bold">Data Movement</span> to open the Data Movement subpage.</span></li>
                     <li class="stepexpand" id="GUID-0C365820-9DCF-4234-B4F2-20DFA29E9E22__CIADJFEB"><span>Click <span class="bold">Setup</span> in the <span class="bold">Streams</span> section to open the Streams page.</span></li>
                     <li class="stepexpand"><span>In the Setup Streams Replication section, select the option for the type of replication environment you want to configure.</span></li>
                     <li class="stepexpand" id="GUID-0C365820-9DCF-4234-B4F2-20DFA29E9E22__CACBGEIB"><span>In the Host Credentials section, enter the username and password for the host computer that runs the source database.</span></li>
                     <li class="stepexpand"><span>Click Continue to open the Setup Streams Replication wizard.</span></li>
                  </ol>
                  <div class="section">
                     <div class="infoboxnote" id="GUID-0C365820-9DCF-4234-B4F2-20DFA29E9E22__GUID-0067351D-5FD0-4155-9C74-BD4E10BEA7D9">
                        <p class="notep1">Note:</p>
                        <p>By default, the Setup Streams Replication Wizard configures one-way replication. To configure bi-directional replication, open the Advanced Options section on the Replication Options page and select <span class="bold">Setup Bi-directional replication</span>. If bi-directional replication is configured, then conflict resolution might be required.
                        </p>
                     </div>
                     <div class="infoboxnotealso" id="GUID-0C365820-9DCF-4234-B4F2-20DFA29E9E22__GUID-142D5C8D-E11C-4B82-9682-371B258143A3">
                        <p class="notep1">See Also:</p>
                        <p></p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The Oracle Enterprise Manager Cloud Control online help for examples that configure an Oracle Streams replication environment with the wizard</p>
                           </li>
                           <li>
                              <p><span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-9EBD9C47-B328-4740-B1CA-3066B5A9EFD6">Decide Which Type of Replication Environment to Configure</a>"</span></p>
                           </li>
                           <li>
                              <p><a href="oracle-streams-conflict-resolution.html#GUID-5D79AA72-A682-4623-8A0B-4CF84D1FFC86"> Oracle Streams Conflict Resolution</a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <!-- class="section" -->
               </div>
            </div><a id="STREP020"></a><div class="props_rev_3"><a id="GUID-8FAAAEF7-0689-4A95-8BD4-D8630CE45FD5" name="GUID-8FAAAEF7-0689-4A95-8BD4-D8630CE45FD5"></a><h3 id="STREP-GUID-8FAAAEF7-0689-4A95-8BD4-D8630CE45FD5" class="sect3"><span class="enumeration_section">2.2 </span>Configuring Replication Using the DBMS_STREAMS_ADM Package
               </h3>
               <div>
                  <p>You can configure an Oracle Streams replication environment using procedures in the <code class="codeph">DBMS_STREAMS_ADM</code> package.
                  </p>
                  <p>The following sections contain information about these procedures, instructions for preparing to run one of these procedures, and examples that illustrate common scenarios:</p>
                  <ul style="list-style-type: disc;">
                     <li>
                        <p><a href="simple-oracle-streams-replication-configuration.html#GUID-0EC0845E-D1C1-4F79-A6DB-D0DE62564F57">The Oracle Streams Replication Configuration Procedures</a></p>
                     </li>
                     <li>
                        <p><a href="simple-oracle-streams-replication-configuration.html#GUID-B1820CB1-2358-49B4-A02F-F8B74949338C">Important Considerations for the Configuration Procedures</a></p>
                     </li>
                     <li>
                        <p><a href="simple-oracle-streams-replication-configuration.html#GUID-6D874F68-7DE5-4987-8AEC-B0099BF3ED26">Creating the Required Directory Objects</a></p>
                     </li>
                     <li>
                        <p><a href="simple-oracle-streams-replication-configuration.html#GUID-F4C7F1FC-ED63-4D01-B2AC-51F116482903">Examples That Configure Two-Database Replication with Local Capture</a></p>
                     </li>
                     <li>
                        <p><a href="simple-oracle-streams-replication-configuration.html#GUID-F2027D09-D92B-4975-A5CA-4E258AF7B4CC">Examples That Configure Two-Database Replication with Downstream Capture</a></p>
                     </li>
                     <li>
                        <p><a href="simple-oracle-streams-replication-configuration.html#GUID-DE04AAC0-800A-4F94-89C2-80560B32B6AD">Example That Configures Two-Database Replication with Synchronous Captures</a></p>
                     </li>
                     <li>
                        <p><a href="simple-oracle-streams-replication-configuration.html#GUID-91D2F532-471A-493D-83F5-D2B0F1C34848">Example That Configures Hub-and-Spoke Replication</a></p>
                     </li>
                     <li>
                        <p><a href="simple-oracle-streams-replication-configuration.html#GUID-7E1E55C3-95FA-4C6C-94B4-2F16E949D67E">Monitoring Oracle Streams Configuration Progress</a></p>
                     </li>
                  </ul>
                  <div class="infoboxnotealso" id="GUID-8FAAAEF7-0689-4A95-8BD4-D8630CE45FD5__GUID-C078AAF9-3989-4926-857F-9176176A1E16">
                     <p class="notep1">See Also:</p>
                     <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS305"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for more information about these procedures
                     </p>
                  </div>
               </div><a id="STREP607"></a><a id="STREP606"></a><div class="props_rev_3"><a id="GUID-0EC0845E-D1C1-4F79-A6DB-D0DE62564F57" name="GUID-0EC0845E-D1C1-4F79-A6DB-D0DE62564F57"></a><h4 id="STREP-GUID-0EC0845E-D1C1-4F79-A6DB-D0DE62564F57" class="sect4"><span class="enumeration_section">2.2.1 </span>The Oracle Streams Replication Configuration Procedures
                  </h4>
                  <div>
                     <p>The easiest way to configure an Oracle Streams replication environment is by running one of the following configuration procedures in the <code class="codeph">DBMS_STREAMS_ADM</code> package:
                     </p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS825"><code class="codeph">MAINTAIN_GLOBAL</code></a> configures an Oracle Streams environment that replicates changes at the database level between two databases.
                           </p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS826"><code class="codeph">MAINTAIN_SCHEMAS</code></a> configures an Oracle Streams environment that replicates changes to specified schemas between two databases.
                           </p>
                        </li>
                        <li>
                           <p><a href="../arpls/DBMS_STREAMS_ADM.html#ARPLS863"><code class="codeph">MAINTAIN_SIMPLE_TTS</code></a> clones a simple tablespace from a source database at a destination database and uses Oracle Streams to maintain this tablespace at both databases.
                           </p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS827"><code class="codeph">MAINTAIN_TABLES</code></a> configures an Oracle Streams environment that replicates changes to specified tables between two databases.
                           </p>
                        </li>
                        <li>
                           <p><a href="../arpls/DBMS_STREAMS_ADM.html#ARPLS864"><code class="codeph">MAINTAIN_TTS</code></a> clones a set of tablespaces from a source database at a destination database and uses Oracle Streams to maintain these tablespaces at both databases.
                           </p>
                        </li>
                        <li>
                           <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS831"><code class="codeph">PRE_INSTANTIATION_SETUP</code></a> and <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS830"><code class="codeph">POST_INSTANTIATION_SETUP</code></a> configure an Oracle Streams environment that replicates changes either at the database level or to specified tablespaces between two databases. These procedures must be used together, and instantiation actions must be performed manually, to complete the Oracle Streams replication configuration. Typically, these procedures are used to perform database maintenance operations with little or no down time. See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=STRMS165"><span class="italic">Oracle Streams Concepts and Administration</span></a> for more information.
                           </p>
                        </li>
                     </ul>
                     <p>These procedures configure two databases at a time, and they require you to specify one database as the source database and the other database as the destination database. They can configure a replication environment with more than two databases by running them multiple times.</p>
                     <p><a href="simple-oracle-streams-replication-configuration.html#GUID-0EC0845E-D1C1-4F79-A6DB-D0DE62564F57__CIHHABAI" title="This table lists each required parameter, the procedures in which the parameter is required, and a desription of the parameter.">Table 2-1</a> describes the required parameters for these procedures.
                     </p>
                     <div class="tblformalwide" id="GUID-0EC0845E-D1C1-4F79-A6DB-D0DE62564F57__CIHHABAI">
                        <p class="titleintable">Table 2-1 Required Parameters for the Oracle Streams Replication Configuration Procedures</p>
                        <table cellpadding="4" cellspacing="0" class="FormalWide" title="Required Parameters for the Oracle Streams Replication Configuration Procedures" summary="This table lists each required parameter, the procedures in which the parameter is required, and a desription of the parameter." width="100%" frame="hsides" border="1" rules="rows">
                           <thead>
                              <tr align="left" valign="top">
                                 <th align="left" valign="bottom" width="34%" id="d12046e740">Parameter</th>
                                 <th align="left" valign="bottom" width="28%" id="d12046e743">Procedure</th>
                                 <th align="left" valign="bottom" width="38%" id="d12046e746">Description</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="34%" id="d12046e751" headers="d12046e740 ">
                                    <p><code class="codeph">source_directory_object</code></p>
                                 </td>
                                 <td align="left" valign="top" width="28%" headers="d12046e751 d12046e743 ">
                                    <p>All procedures</p>
                                 </td>
                                 <td align="left" valign="top" width="38%" headers="d12046e751 d12046e746 ">
                                    <p>The directory object for the directory on the computer system running the source database into which the generated Data Pump export dump file is placed.</p>
                                    <p><span class="bold">Note:</span> The specified directory object cannot point to an Automatic Storage Management (ASM) disk group.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="34%" id="d12046e766" headers="d12046e740 ">
                                    <p><code class="codeph">destination_directory_object</code></p>
                                 </td>
                                 <td align="left" valign="top" width="28%" headers="d12046e766 d12046e743 ">
                                    <p>All procedures</p>
                                 </td>
                                 <td align="left" valign="top" width="38%" headers="d12046e766 d12046e746 ">
                                    <p>The directory object for the directory on the computer system running the destination database into which the generated Data Pump export dump file is transferred. The dump file is used to instantiate the replicated database objects at the destination database.</p>
                                    <p><span class="bold">Note:</span> The specified directory object cannot point to an Automatic Storage Management (ASM) disk group.
                                    </p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="34%" id="d12046e781" headers="d12046e740 ">
                                    <p><code class="codeph">source_database</code></p>
                                 </td>
                                 <td align="left" valign="top" width="28%" headers="d12046e781 d12046e743 ">
                                    <p>All procedures</p>
                                 </td>
                                 <td align="left" valign="top" width="38%" headers="d12046e781 d12046e746 ">
                                    <p>The global name of the source database. The specified database must contain the database objects to be replicated.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="34%" id="d12046e792" headers="d12046e740 ">
                                    <p><code class="codeph">destination_database</code></p>
                                 </td>
                                 <td align="left" valign="top" width="28%" headers="d12046e792 d12046e743 ">
                                    <p>All procedures</p>
                                 </td>
                                 <td align="left" valign="top" width="38%" headers="d12046e792 d12046e746 ">
                                    <p>The global name of the destination database. The database objects to be replicated are optional at the destination database. If they do not exist at the destination database, then they are instantiated by Data Pump export/import.</p>
                                    <p>If the local database is not the destination database, then a database link from the local database to the destination database, with the same name as the global name of the destination database, must exist and must be accessible to the user who runs the procedure.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="34%" id="d12046e805" headers="d12046e740 ">
                                    <p><code class="codeph">schema_names</code></p>
                                 </td>
                                 <td align="left" valign="top" width="28%" headers="d12046e805 d12046e743 ">
                                    <p><code class="codeph">MAINTAIN_SCHEMAS</code> only
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="38%" headers="d12046e805 d12046e746 ">
                                    <p>The schemas to be configured for replication.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="34%" id="d12046e818" headers="d12046e740 ">
                                    <p><code class="codeph">tablespace_name</code></p>
                                 </td>
                                 <td align="left" valign="top" width="28%" headers="d12046e818 d12046e743 ">
                                    <p><code class="codeph">MAINTAIN_SIMPLE_TTS</code> only
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="38%" headers="d12046e818 d12046e746 ">
                                    <p>The tablespace to be configured for replication.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="34%" id="d12046e831" headers="d12046e740 ">
                                    <p><code class="codeph">table_names</code></p>
                                 </td>
                                 <td align="left" valign="top" width="28%" headers="d12046e831 d12046e743 ">
                                    <p><code class="codeph">MAINTAIN_TABLES</code> only
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="38%" headers="d12046e831 d12046e746 ">
                                    <p>The tables to be configured for replication.</p>
                                 </td>
                              </tr>
                              <tr align="left" valign="top">
                                 <td align="left" valign="top" width="34%" id="d12046e844" headers="d12046e740 ">
                                    <p><code class="codeph">tablespace_names</code></p>
                                 </td>
                                 <td align="left" valign="top" width="28%" headers="d12046e844 d12046e743 ">
                                    <p><code class="codeph">MAINTAIN_TTS</code> only
                                    </p>
                                 </td>
                                 <td align="left" valign="top" width="38%" headers="d12046e844 d12046e746 ">
                                    <p>The tablespaces to be configured for replication.</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </div>
                     <!-- class="inftblhruleinformal" -->
                     <p>In addition, each of these procedures has several optional parameters. The <code class="codeph">bi_directional</code> parameter is an important optional parameter. If you want changes to the replicated database objects to be captured at each database and sent to the other database, then the <code class="codeph">bi_directional</code> parameter must be set to <code class="codeph">TRUE</code>. The default setting for this parameter is <code class="codeph">FALSE</code>. When the <code class="codeph">bi_directional</code> parameter is set to <code class="codeph">FALSE</code>, the procedures configure a one-way replication environment, where the changes made at the destination database are not captured.
                     </p>
                     <p>These procedures perform several tasks to configure an Oracle Streams replication environment. These tasks include:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>Configure supplemental logging for the replicated database objects at the source database.</p>
                        </li>
                        <li>
                           <p>If the <code class="codeph">bi_directional</code> parameter is set to <code class="codeph">TRUE</code>, then configure supplemental logging for the replicated database objects at the destination database.
                           </p>
                        </li>
                        <li>
                           <p>Instantiate the database objects at the destination database. If the database objects do not exist at the destination database, then the procedures use Data Pump export/import to instantiate them at the destination database.</p>
                        </li>
                        <li>
                           <p>Configure a capture process to capture changes to the replicated database objects at the source database. This capture process can be a local capture process or a downstream capture process. If the procedure is run at the database specified in the <code class="codeph">source_database</code> parameter, then the procedure configures a local capture process on this database. If the procedure is run at a database other than the database specified in the <code class="codeph">source_database</code> parameter, then the procedure configures a downstream capture process on the database that runs the procedure.
                           </p>
                        </li>
                        <li>
                           <p>If the <code class="codeph">bi_directional</code> parameter is set to <code class="codeph">TRUE</code>, then configure a capture process to capture changes to the replicated database objects at the destination database. This capture process must be a local capture process.
                           </p>
                        </li>
                        <li>
                           <p>Configure one or more queues at each database to store captured changes.</p>
                        </li>
                        <li>
                           <p>Configure a propagation to send changes made to the database objects at the source database to the destination database.</p>
                        </li>
                        <li>
                           <p>If the <code class="codeph">bi_directional</code> parameter is set to <code class="codeph">TRUE</code>, then configure a propagation to send changes made to the database objects at the destination database to the source database
                           </p>
                        </li>
                        <li>
                           <p>Configure an apply process at the destination database to apply changes from the source database.</p>
                        </li>
                        <li>
                           <p>If the <code class="codeph">bi_directional</code> parameter is set to <code class="codeph">TRUE</code>, then configure an apply process at the source database to apply changes from the destination database.
                           </p>
                        </li>
                        <li>
                           <p>Configure rule sets and rules for each capture process, propagation, and apply process. The rules instruct the Oracle Streams clients to replicate changes to the specified database objects.</p>
                        </li>
                        <li>
                           <p>Set the instantiation SCN for the replicated database objects at the destination database.</p>
                        </li>
                        <li>
                           <p>If the <code class="codeph">bi_directional</code> parameter is set to <code class="codeph">TRUE</code>, then set the instantiation SCN for the replicated database objects at the source database.
                           </p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-0EC0845E-D1C1-4F79-A6DB-D0DE62564F57__GUID-86E2C2C2-0A9D-491E-BE4E-D6606638B39F">
                        <p class="notep1">Tip:</p>
                        <p>To view all of the actions performed by one of these procedures in detail, use the procedure to generate a script, and view the script in a text editor. You can use the <code class="codeph">perform_actions</code>, <code class="codeph">script_name</code>, and <code class="codeph">script_directory_object</code> parameters to generate a script.
                        </p>
                     </div>
                     <p>These procedures always configure tags for a hub-and-spoke replication environment. The following are important considerations about these procedures and tags:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p>If you are configuring a two-database replication environment, then you can use these procedures to configure it. These procedures configure tags in a two-database environment to avoid change cycling. If you plan to expand the replication environment beyond two databases in the future, then it is important to understand how the tags are configured. If the expanded database environment is not a hub-and-spoke environment, then you might need to modify the tags to avoid change cycling.</p>
                        </li>
                        <li>
                           <p>If you are configuring a replication environment that involves three or more databases, then these procedures can only be used to configure a hub-and-spoke replication environment. These procedures configure tags in a hub-and-spoke environment to avoid change cycling.</p>
                        </li>
                        <li>
                           <p>If you are configuring an n-way replication environment, then do not use these procedures to configure it. Change cycling might result if you do so.</p>
                        </li>
                     </ul>
                     <div class="infoboxnote" id="GUID-0EC0845E-D1C1-4F79-A6DB-D0DE62564F57__GUID-E53AA473-1433-4DFC-81DE-7EB797DE5456">
                        <p class="notep1">Note:</p>
                        <p>Currently, these configuration procedures configure only capture processes to capture changes. You cannot use these procedures to configure a replication environment that uses synchronous captures. You can configure a synchronous capture using the <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS308"><code class="codeph">ADD_TABLE_RULES</code></a> and <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS329"><code class="codeph">ADD_SUBSET_RULES</code></a> procedures in the <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS305"><code class="codeph">DBMS_STREAMS_ADM</code></a> package.
                        </p>
                     </div>
                     <div class="infoboxnotealso" id="GUID-0EC0845E-D1C1-4F79-A6DB-D0DE62564F57__GUID-D88F0B0C-7FB0-40B9-9BDA-EFE3644AD76A">
                        <p class="notep1">See Also:</p>
                        <p></p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS878"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for more information about the procedures in the <code class="codeph">DBMS_STREAMS_ADM</code> package
                              </p>
                           </li>
                           <li>
                              <p><a href="oracle-streams-tags.html#GUID-9339D29B-65F3-450B-B3CD-A7B4ADCA4AAF"> Oracle Streams Tags</a></p>
                           </li>
                           <li>
                              <p><span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-9EBD9C47-B328-4740-B1CA-3066B5A9EFD6">Decide Which Type of Replication Environment to Configure</a>"</span></p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=STRMS"><span class="italic">Oracle Streams Concepts and Administration</span></a></p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div><a id="STREP258"></a><div class="props_rev_3"><a id="GUID-B1820CB1-2358-49B4-A02F-F8B74949338C" name="GUID-B1820CB1-2358-49B4-A02F-F8B74949338C"></a><h4 id="STREP-GUID-B1820CB1-2358-49B4-A02F-F8B74949338C" class="sect4"><span class="enumeration_section">2.2.2 </span>Important Considerations for the Configuration Procedures
                  </h4>
                  <div>
                     <p>This section describes important considerations for the configuration procedures. It also discusses several procedure parameters related to these considerations.</p>
                     <p>This section contains these topics:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="simple-oracle-streams-replication-configuration.html#GUID-5D6659BD-CADE-42B0-87D8-F3A44B11A9F7">Local or Downstream Capture for the Source Database</a></p>
                        </li>
                        <li>
                           <p><a href="simple-oracle-streams-replication-configuration.html#GUID-D784A5C1-CF24-45B9-A372-0DDE4D57E804">Perform Configuration Actions Directly or With a Script</a></p>
                        </li>
                        <li>
                           <p><a href="simple-oracle-streams-replication-configuration.html#GUID-8F719EEC-0848-41AF-AA04-3073E8AEBE33">Oracle Streams Components Configured by These Procedures</a></p>
                        </li>
                        <li>
                           <p><a href="simple-oracle-streams-replication-configuration.html#GUID-3BC4A108-17E7-481C-B309-683B2FEB172E">One-Way or Bi-Directional Replication</a></p>
                        </li>
                        <li>
                           <p><a href="simple-oracle-streams-replication-configuration.html#GUID-6873B325-4D12-460E-9565-4B0B0C29DEE0">Data Definition Language (DDL) Changes</a></p>
                        </li>
                        <li>
                           <p><a href="simple-oracle-streams-replication-configuration.html#GUID-0249E6A9-33CE-4729-8020-2D4E6D85DBBB">Instantiation</a></p>
                        </li>
                     </ul>
                     <div class="infoboxnotealso" id="GUID-B1820CB1-2358-49B4-A02F-F8B74949338C__GUID-5CB867B4-A65D-4908-BE7E-C936266DC40C">
                        <p class="notep1">See Also:</p>
                        <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS305"><span class="italic">Oracle Database PL/SQL Packages and Types Reference</span></a> for information about all of the parameters in these procedures
                        </p>
                     </div>
                  </div><a id="STREP259"></a><div class="props_rev_3"><a id="GUID-5D6659BD-CADE-42B0-87D8-F3A44B11A9F7" name="GUID-5D6659BD-CADE-42B0-87D8-F3A44B11A9F7"></a><h5 id="STREP-GUID-5D6659BD-CADE-42B0-87D8-F3A44B11A9F7" class="sect5"><span class="enumeration_section">2.2.2.1 </span>Local or Downstream Capture for the Source Database
                     </h5>
                     <div>
                        <p>These procedures can either configure local capture or downstream capture for the database specified in the <code class="codeph">source_database</code> parameter. The database that captures changes made to the source database is called the capture database. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-413B5DE9-FB2A-48BE-B5A0-815DE614E502">Decide Whether to Configure Local or Downstream Capture for the Source Database</a>"</span> for more information.
                        </p>
                        <p>The database on which the procedure is run is configured as the capture database for changes made to the source database. Therefore, to configure local capture at the source database, run the procedure at the source database. To configure downstream capture at the destination database, run the procedure at the database specified in the <code class="codeph">destination_database</code> parameter. To configure downstream capture at the at a third database, run the procedure at a database that is not specified in the <code class="codeph">source_database</code> or <code class="codeph">destination_database</code> parameter.
                        </p>
                        <p>If the source database or a third database is the capture database, then these procedures configure a propagation to send changes from the capture database to the destination database. If the destination database is the capture database and you are not configuring bi-directional replication, then this propagation between databases is not needed. In this case, the propagation is not configured if the <code class="codeph">capture_queue_name</code> and <code class="codeph">apply_queue_name</code> parameters have the same value. If these values are different, then a propagation is configured between the two queues within the destination database.
                        </p>
                        <div class="infoboxnote" id="GUID-5D6659BD-CADE-42B0-87D8-F3A44B11A9F7__GUID-F0422860-AA2D-49D4-919C-BDC85EFA5221">
                           <p class="notep1">Note:</p>
                           <p></p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>When these procedures configure downstream capture, they always configure archived-log downstream capture. These procedures do not configure real-time downstream capture. However, you can configure redo transport services for real-time downstream capture before running a procedure, and then set the <code class="codeph">downstream_real_time_mine</code> capture process parameter to <code class="codeph">Y</code> after the procedure completes. You can also modify the scripts generated by these procedures to configure real-time downstream capture.
                                 </p>
                              </li>
                              <li>
                                 <p>If these procedures configure bi-directional replication, then the capture process for the destination database always is a local capture process. That is, these procedures always configure the capture process for changes made to the destination database to run on the destination database.</p>
                              </li>
                              <li>
                                 <p>Synchronous capture cannot be configured with the configuration procedures.</p>
                              </li>
                           </ul>
                        </div>
                        <div class="infoboxnotealso" id="GUID-5D6659BD-CADE-42B0-87D8-F3A44B11A9F7__GUID-6C109A8C-F2C0-414F-A877-05930D5B3E81">
                           <p class="notep1">See Also:</p>
                           <p></p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-F691796A-514C-4821-8B7B-BAB0FA45C04E">Decide Whether Changes Are Allowed at One Database or at Multiple Databases</a>"</span> and <span class="q">"<a href="simple-oracle-streams-replication-configuration.html#GUID-3BC4A108-17E7-481C-B309-683B2FEB172E">One-Way or Bi-Directional Replication</a>"</span> for more information about bi-directional replication
                                 </p>
                              </li>
                              <li>
                                 <p><span class="q">"<a href="simple-oracle-streams-replication-configuration.html#GUID-8F719EEC-0848-41AF-AA04-3073E8AEBE33">Oracle Streams Components Configured by These Procedures</a>"</span></p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=STRMS129"><span class="italic">Oracle Streams Concepts and Administration</span></a> for information about local capture and downstream capture
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="STREP260"></a><div class="props_rev_3"><a id="GUID-D784A5C1-CF24-45B9-A372-0DDE4D57E804" name="GUID-D784A5C1-CF24-45B9-A372-0DDE4D57E804"></a><h5 id="STREP-GUID-D784A5C1-CF24-45B9-A372-0DDE4D57E804" class="sect5"><span class="enumeration_section">2.2.2.2 </span>Perform Configuration Actions Directly or With a Script
                     </h5>
                     <div>
                        <p>These procedures can configure the Oracle Streams replication environment directly, or they can generate a script that configures the environment. Using a procedure to configure replication directly is simpler than running a script, and the environment is configured immediately. However, you might choose to generate a script for the following reasons:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>You want to review the actions performed by the procedure before configuring the environment.</p>
                           </li>
                           <li>
                              <p>You want to modify the script to customize the configuration.</p>
                           </li>
                        </ul>
                        <p>For example, you might want an apply process to use apply handlers for customized processing of the changes to certain tables before applying these changes. In this case, you can use the procedure to generate a script and modify the script to add the apply handlers.</p>
                        <p>You also might want to maintain DML changes for several tables, but you might want to maintain DDL changes for a subset of these tables. In this case, you can generate a script by running the <code class="codeph">MAINTAIN_TABLES</code> procedure with the <code class="codeph">include_ddl</code> parameter set to <code class="codeph">FALSE</code>. You can modify the script to maintain DDL changes for the appropriate tables.
                        </p>
                        <p>The <code class="codeph">perform_actions</code> parameter controls whether the procedure configures the replication environment directly:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>To configure an Oracle Streams replication environment directly when you run one of these procedures, set the <code class="codeph">perform_actions</code> parameter to <code class="codeph">TRUE</code>. The default value for this parameter is <code class="codeph">TRUE</code>.
                              </p>
                           </li>
                           <li>
                              <p>To generate a configuration script when you run one of these procedures, set the <code class="codeph">perform_actions</code> parameter to <code class="codeph">FALSE</code>, and use the <code class="codeph">script_name</code> and <code class="codeph">script_directory_object</code> parameters to specify the name and location of the configuration script.
                              </p>
                           </li>
                        </ul>
                        <div class="infoboxnote" id="GUID-D784A5C1-CF24-45B9-A372-0DDE4D57E804__GUID-97780EDA-347B-4321-9BB7-AF5D4C0E7BD5">
                           <p class="notep1">Note:</p>
                           <p>The <code class="codeph">script_directory_object</code> parameter cannot point to an Automatic Storage Management (ASM) disk group.
                           </p>
                        </div>
                        <div class="infoboxnotealso" id="GUID-D784A5C1-CF24-45B9-A372-0DDE4D57E804__GUID-65703F40-3702-4630-A726-70E9BE5AC28F">
                           <p class="notep1">See Also:</p>
                           <p></p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-7078844B-E2BE-48F5-8117-69B4F999FA73">Decide Whether the Replication Environment Will Use Apply Handlers</a>"</span></p>
                              </li>
                              <li>
                                 <p><span class="q">"<a href="simple-oracle-streams-replication-configuration.html#GUID-6873B325-4D12-460E-9565-4B0B0C29DEE0">Data Definition Language (DDL) Changes</a>"</span></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="STREP210"></a><div class="props_rev_3"><a id="GUID-8F719EEC-0848-41AF-AA04-3073E8AEBE33" name="GUID-8F719EEC-0848-41AF-AA04-3073E8AEBE33"></a><h5 id="STREP-GUID-8F719EEC-0848-41AF-AA04-3073E8AEBE33" class="sect5"><span class="enumeration_section">2.2.2.3 </span>Oracle Streams Components Configured by These Procedures
                     </h5>
                     <div>
                        <p>These procedures configure the following Oracle Streams clients:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>These procedures configure a capture process that captures changes to the source database. If bi-directional replication is configured, then these procedures also configure a capture process that captures changes to the destination database.</p>
                           </li>
                           <li>
                              <p>If the capture database and the destination database are different databases, then these procedures configure a propagation that sends changes from the capture database to the destination database.</p>
                           </li>
                           <li>
                              <p>If the capture database and the destination database are the same database, then the queue names determine whether a propagation is created:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>If the <code class="codeph">capture_queue_name</code> and <code class="codeph">apply_queue_name</code> parameters specify different queue names, then a propagation is created between the two queues within the destination database.
                                    </p>
                                 </li>
                                 <li>
                                    <p>If the <code class="codeph">capture_queue_name</code> and <code class="codeph">apply_queue_name</code> parameters specify the same queue name, then a propagation is not created, and the downstream capture process and the apply process use the same queue. This configuration is possible only if the <code class="codeph">bi_directional</code> parameter is set to <code class="codeph">FALSE</code> to configure a single source replication environment.
                                    </p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>If bi-directional replication is configured, then these procedures configure a propagation that sends changes from the destination database to the source database.</p>
                           </li>
                           <li>
                              <p>These procedures configure an apply process that applies changes at the destination database. These changes originated at the source database. If bi-directional replication is configured, then these procedures also configure an apply process that applies changes to the source database. These changes originated at the destination database.</p>
                           </li>
                        </ul>
                        <p>By default, the <code class="codeph">capture_queue_name</code> and <code class="codeph">apply_queue_name</code> parameters are set to <code class="codeph">NULL</code>. When these parameters are set to <code class="codeph">NULL</code>, these procedures configure a separate queue for each capture process and apply process. The Oracle Streams replication environment might operate more efficiently if each Oracle Streams client has its own separate queue.
                        </p>
                        <p>However, two Oracle Streams clients share a queue in the following configurations:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The configuration described previously in this section in which the downstream capture process and the apply process at the destination database share a queue.</p>
                           </li>
                           <li>
                              <p>A configuration in which all of the following conditions are met:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>The capture database is the source database or a third database.</p>
                                 </li>
                                 <li>
                                    <p>The <code class="codeph">bi_directional</code> parameter is set to <code class="codeph">TRUE</code>.
                                    </p>
                                 </li>
                                 <li>
                                    <p>The same queue name is specified for the <code class="codeph">capture_queue_name</code> and <code class="codeph">apply_queue_name</code> parameters.
                                    </p>
                                 </li>
                              </ul>
                              <p>In this case, the local capture process and the apply process at the destination database share the same queue. If the source database is the capture database, then the local capture process and the apply process at the source database also share the same queue.</p>
                           </li>
                        </ul>
                        <p>Also, the <code class="codeph">capture_name</code> and <code class="codeph">capture_queue_name</code> parameters must be set to <code class="codeph">NULL</code> when both of the following conditions are met:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>The destination database is the capture database.</p>
                           </li>
                           <li>
                              <p>The <code class="codeph">bi_directional</code> parameter is set to <code class="codeph">TRUE</code>.
                              </p>
                           </li>
                        </ul>
                        <p>When both of these conditions are met, these procedure configure two capture processes at the destination database, and these capture processes must have different names. One capture process is the downstream capture process for the source database, while the other capture process is the local capture process that captures changes made to the destination database. When the <code class="codeph">capture_name</code> and <code class="codeph">capture_queue_name</code> parameters are set to <code class="codeph">NULL</code>, the system generates a different name for the capture processes. These procedures raise an error if both conditions are met and either the <code class="codeph">capture_name</code> parameter or the <code class="codeph">capture_queue_name</code> parameter is set to a non-<code class="codeph">NULL</code> value.
                        </p>
                        <div class="infoboxnotealso" id="GUID-8F719EEC-0848-41AF-AA04-3073E8AEBE33__GUID-0EF43AA6-3B79-4E2A-A61B-873C2A4BD6C2">
                           <p class="notep1">See Also:</p>
                           <p></p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="q">"<a href="simple-oracle-streams-replication-configuration.html#GUID-3BC4A108-17E7-481C-B309-683B2FEB172E">One-Way or Bi-Directional Replication</a>"</span></p>
                              </li>
                              <li>
                                 <p><span class="q">"<a href="simple-oracle-streams-replication-configuration.html#GUID-5D6659BD-CADE-42B0-87D8-F3A44B11A9F7">Local or Downstream Capture for the Source Database</a>"</span></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div><a id="STREP261"></a><div class="props_rev_3"><a id="GUID-3BC4A108-17E7-481C-B309-683B2FEB172E" name="GUID-3BC4A108-17E7-481C-B309-683B2FEB172E"></a><h5 id="STREP-GUID-3BC4A108-17E7-481C-B309-683B2FEB172E" class="sect5"><span class="enumeration_section">2.2.2.4 </span>One-Way or Bi-Directional Replication
                     </h5>
                     <div>
                        <p>These procedures set up either a one-way (or single-source) Oracle Streams configuration with the database specified in the <code class="codeph">source_database</code> parameter as the source database, or a bi-directional Oracle Streams configuration with both databases acting as source and destination databases. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-F691796A-514C-4821-8B7B-BAB0FA45C04E">Decide Whether Changes Are Allowed at One Database or at Multiple Databases</a>"</span> for more information.
                        </p>
                        <p>The <code class="codeph">bi_directional</code> parameter in each procedure controls whether the Oracle Streams configuration is single source or bi-directional:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>If the <code class="codeph">bi_directional</code> parameter is <code class="codeph">FALSE</code>, then a capture process captures changes made to the source database and an apply process at the destination database applies these changes. If the destination database is not the capture database, then a propagation sends the captured changes to the destination database. The default value for this parameter is <code class="codeph">FALSE</code>. 
                              </p>
                           </li>
                           <li>
                              <p>If the <code class="codeph">bi_directional</code> parameter is <code class="codeph">TRUE</code>, then a separate capture process captures changes made to each database, propagations send these changes to the other database, and each database applies changes from the other database.
                              </p>
                           </li>
                        </ul>
                        <p>When a replication environment is not bi-directional, and no changes are allowed at the destination database, Oracle Streams keeps the shared database objects synchronized at the databases. However, when a replication environment is not bi-directional, and independent changes are allowed at the destination database, the shared database objects might diverge between the databases. Independent changes can be made by users, by applications, or by replication with a third database.</p>
                        <div class="infoboxnote" id="GUID-3BC4A108-17E7-481C-B309-683B2FEB172E__GUID-FEB12EC5-A888-4FAA-B9CA-1C9125007ADB">
                           <p class="notep1">Note:</p>
                           <p></p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>You might need to configure conflict resolution if bi-directional replication is configured.</p>
                              </li>
                              <li>
                                 <p>If you set the <code class="codeph">bi_directional</code> parameter to <code class="codeph">TRUE</code> when you run one of these procedures, then do not allow data manipulation language (DML) or data definition language (DDL) changes to the shared database objects at the destination database while the procedure, or the script generated by the procedure, is running. This restriction does not apply if a procedure is configuring a single-source replication environment.
                                 </p>
                              </li>
                              <li>
                                 <p>These procedures do not configure the replicated tables to be read-only at the destination database. If you set the <code class="codeph">bi_directional</code> parameter to <code class="codeph">FALSE</code> when you run one of these procedures, and the replicated tables should be read only at the destination database, then configure privileges at the destination databases accordingly. However, the apply user for the apply process must be able to make DML changes to the replicated database objects. See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=DBSEG004"><span class="italic">Oracle Database Security Guide</span></a> for information about configuring privileges.
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <div class="infoboxnotealso" id="GUID-3BC4A108-17E7-481C-B309-683B2FEB172E__GUID-238E0E73-4629-44A2-A5FD-94ACE533E9E5">
                           <p class="notep1">See Also:</p>
                           <p></p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="oracle-streams-conflict-resolution.html#GUID-5D79AA72-A682-4623-8A0B-4CF84D1FFC86"> Oracle Streams Conflict Resolution</a></p>
                              </li>
                              <li>
                                 <p><span class="q">"<a href="simple-oracle-streams-replication-configuration.html#GUID-8F719EEC-0848-41AF-AA04-3073E8AEBE33">Oracle Streams Components Configured by These Procedures</a>"</span></p>
                              </li>
                           </ul>
                        </div>
                     </div><a id="STREP262"></a><div class="props_rev_3"><a id="GUID-AD9A0588-A09F-422C-8C84-A2C1AA187A37" name="GUID-AD9A0588-A09F-422C-8C84-A2C1AA187A37"></a><h6 id="STREP-GUID-AD9A0588-A09F-422C-8C84-A2C1AA187A37" class="sect6"><span class="enumeration_section">2.2.2.4.1 </span>Change Cycling and Tags
                        </h6>
                        <div>
                           <p>Change cycling happens when a change is sent back to the database where it originated. Typically, change cycling should be avoided because it can result in each change going through endless loops back to the database where it originated. Such loops can result in unintended data in the database and tax the networking and computer resources of an environment.</p>
                           <p>If the <code class="codeph">bi_directional</code> parameter is set to <code class="codeph">TRUE</code>, then these procedures configure bi-directional replication. To prevent change cycling in a bi-directional Oracle Streams replication environment, these procedures configure the environment in the following way:
                           </p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>The apply process at each database applies each change with an apply tag that is unique to the environment. An apply tag is an Oracle Streams tag that is part of each redo record created by the apply process. For example, if a procedure configures databases <code class="codeph">sfdb.net</code> and <code class="codeph">nydb.net</code> for bi-directional replication, then the apply tag for the apply process at <code class="codeph">sfdb.net</code> might be the hexidecimal equivalent of <code class="codeph">'1'</code>, and the apply tag for the apply process at <code class="codeph">nydb.net</code> might be the hexidecimal equivalent of <code class="codeph">'2'</code>. In this case, an applied change with a tag that is the hexidecimal equivalent of <code class="codeph">'1'</code> originated at the <code class="codeph">nydb.net</code> database, while an applied change with a tag that is the hexidecimal equivalent of <code class="codeph">'2'</code> originated at the <code class="codeph">sfdb.net</code> database.
                                 </p>
                              </li>
                              <li>
                                 <p>The capture process at each database captures all changes to the shared database objects, regardless of tags in the redo records for the changes to these database objects.</p>
                              </li>
                              <li>
                                 <p>Each propagation sends all changes made to the shared database objects to the other database in the bi-directional replication environment, except for changes that originated at the other database. Continuing the example, the propagation at <code class="codeph">sfdb.net</code> sends all changes to <code class="codeph">nydb.net</code>, except for changes with a tag value that is the hexidecimal equivalent of <code class="codeph">'1'</code>, because these changes originated at <code class="codeph">nydb.net</code>. Similarly, the propagation at <code class="codeph">nydb.net</code> sends all changes to <code class="codeph">sfdb.net</code>, except for changes with a tag value that is the hexidecimal equivalent of <code class="codeph">'2'</code>. A change that is not propagated because of its tag value is discarded.
                                 </p>
                              </li>
                           </ul>
                           <p>These procedures cannot be used to configure multi-directional replication where changes can be cycled back to a source database by a third database in the environment. For example, these procedures cannot be used to configure an Oracle Streams replication environment with three databases where each database shares changes with the other two databases in the environment. Such an environment is sometimes called an "n-way" replication environment. If these procedures were used to configure this type of a three way replication environment, then changes made at a source database would be cycled back to the same source database. In a valid three way replication environment, a particular change is made only once at each database.</p>
                           <p>These procedures can configure an Oracle Streams replication environment that includes more than two databases, if changes made at a source database cannot cycle back to the same source database. For example, a procedure can be run multiple times to configure an environment in which a primary database shares changes with multiple secondary databases. Such an environment is sometimes called a "hub-and-spoke" replication environment.</p>
                           <p>You can configure the Oracle Streams environment manually to replicate changes in a multiple source environment where each source database shares changes with the other source databases, or you can modify generated scripts to achieve this.</p>
                           <div class="infoboxnotealso" id="GUID-AD9A0588-A09F-422C-8C84-A2C1AA187A37__GUID-64D12BD4-E687-4B0C-80D6-259BE039B91A">
                              <p class="notep1">See Also:</p>
                              <p></p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><a href="oracle-streams-tags.html#GUID-9339D29B-65F3-450B-B3CD-A7B4ADCA4AAF"> Oracle Streams Tags</a></p>
                                 </li>
                                 <li>
                                    <p><span class="q">"<a href="simple-oracle-streams-replication-configuration.html#GUID-91D2F532-471A-493D-83F5-D2B0F1C34848">Example That Configures Hub-and-Spoke Replication</a>"</span> for an example that configures a hub-and-spoke replication environment
                                    </p>
                                 </li>
                                 <li>
                                    <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=STREX004"><span class="italic">Oracle Streams Extended Examples</span></a></p>
                                 </li>
                              </ul>
                           </div>
                        </div>
                     </div>
                  </div><a id="STREP263"></a><div class="props_rev_3"><a id="GUID-6873B325-4D12-460E-9565-4B0B0C29DEE0" name="GUID-6873B325-4D12-460E-9565-4B0B0C29DEE0"></a><h5 id="STREP-GUID-6873B325-4D12-460E-9565-4B0B0C29DEE0" class="sect5"><span class="enumeration_section">2.2.2.5 </span>Data Definition Language (DDL) Changes
                     </h5>
                     <div>
                        <p>The <code class="codeph">include_ddl</code> parameter controls whether the procedure configures Oracle Streams replication to maintain DDL changes:
                        </p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>To configure an Oracle Streams replication environment that does not maintain DDL changes, set the <code class="codeph">include_ddl</code> parameter to <code class="codeph">FALSE</code> when you run one of these procedures. The default value for this parameter is <code class="codeph">FALSE</code>.
                              </p>
                           </li>
                           <li>
                              <p>To configure an Oracle Streams replication environment that maintains DDL changes, set the <code class="codeph">include_ddl</code> parameter to <code class="codeph">TRUE</code> when you run one of these procedures.
                              </p>
                           </li>
                        </ul>
                        <div class="infoboxnote" id="GUID-6873B325-4D12-460E-9565-4B0B0C29DEE0__GUID-71547453-DE9F-42EA-919D-50A3CC60159B">
                           <p class="notep1">Note:</p>
                           <p>The <code class="codeph">MAINTAIN_SIMPLE_TTS</code> procedure does not include the <code class="codeph">include_ddl</code> parameter. An Oracle Streams replication environment configured by the <code class="codeph">MAINTAIN_SIMPLE_TTS</code> procedure only maintains DML changes.
                           </p>
                        </div>
                        <div class="infoboxnotealso" id="GUID-6873B325-4D12-460E-9565-4B0B0C29DEE0__GUID-29B33721-C07A-42C4-994D-FAAD78503C82">
                           <p class="notep1">See Also:</p>
                           <p><span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-A9E8F02F-F101-4A22-A252-C6A9DC400CE8">Decide Whether to Maintain DDL Changes</a>"</span></p>
                        </div>
                     </div>
                  </div><a id="STREP264"></a><div class="props_rev_3"><a id="GUID-0249E6A9-33CE-4729-8020-2D4E6D85DBBB" name="GUID-0249E6A9-33CE-4729-8020-2D4E6D85DBBB"></a><h5 id="STREP-GUID-0249E6A9-33CE-4729-8020-2D4E6D85DBBB" class="sect5"><span class="enumeration_section">2.2.2.6 </span>Instantiation
                     </h5>
                     <div>
                        <p>The <code class="codeph">MAINTAIN_GLOBAL</code>, <code class="codeph">MAINTAIN_SCHEMAS</code>, and <code class="codeph">MAINTAIN_TABLES</code> procedures provide options for instantiation. Instantiation is the process of preparing database objects for instantiation at a source database, optionally copying the database objects from a source database to a destination database, and setting the instantiation SCN for each instantiated database object.
                        </p>
                        <p>When you run one of these three procedures, you can choose to perform the instantiation in one of the following ways:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><span class="bold">Data Pump Export Dump File Instantiation:</span> This option performs a Data Pump export of the shared database objects at the source database and a Data Pump import of the export dump file at the destination database. The instantiation SCN is set for each shared database object during import.
                              </p>
                              <p>To specify this instantiation option, set the <code class="codeph">instantiation</code> parameter to one of the following values:
                              </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><code class="codeph">DBMS_STREAMS_ADM.INSTANTIATION_FULL</code> if you run the <code class="codeph">MAINTAIN_GLOBAL</code> procedure
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">DBMS_STREAMS_ADM.INSTANTIATION_SCHEMA</code> if you run the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">DBMS_STREAMS_ADM.INSTANTIATION_TABLE</code> if you run the <code class="codeph">MAINTAIN_TABLES</code> procedure
                                    </p>
                                 </li>
                              </ul>
                              <p>If the <code class="codeph">bi_directional</code> parameter is set to <code class="codeph">TRUE</code>, then the procedure also sets the instantiation SCN for each shared database object at the source database.
                              </p>
                              <p>When you use this option, you must create directory objects to hold the Data Pump files. See <span class="q">"<a href="simple-oracle-streams-replication-configuration.html#GUID-6D874F68-7DE5-4987-8AEC-B0099BF3ED26">Creating the Required Directory Objects</a>"</span>.
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">Data Pump Network Import Instantiation:</span> This option performs a network Data Pump import of the shared database objects. A network import means that Data Pump performs the import without using an export dump file. Therefore, directory objects do not need to be created for instantiation purposes when you use this option. The instantiation SCN is set for each shared database object during import.
                              </p>
                              <p>To specify this instantiation option, set the <code class="codeph">instantiation</code> parameter to one of the following values:
                              </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p><code class="codeph">DBMS_STREAMS_ADM.INSTANTIATION_FULL_NETWORK</code> if you run the <code class="codeph">MAINTAIN_GLOBAL</code> procedure
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">DBMS_STREAMS_ADM.INSTANTIATION_SCHEMA_NETWORK</code> if you run the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure
                                    </p>
                                 </li>
                                 <li>
                                    <p><code class="codeph">DBMS_STREAMS_ADM.INSTANTIATION_TABLE_NETWORK</code> if you run the <code class="codeph">MAINTAIN_TABLES</code> procedure
                                    </p>
                                 </li>
                              </ul>
                              <p>If the <code class="codeph">bi_directional</code> parameter is set to <code class="codeph">TRUE</code>, then the procedure also sets the instantiation SCN for each shared database object at the source database.
                              </p>
                           </li>
                           <li>
                              <p><span class="bold">Generate a Configuration Script with No Instantiation Specified:</span> This option does not perform an instantiation. This setting is valid only if the <code class="codeph">perform_actions</code> parameter is set to <code class="codeph">FALSE</code>, and the procedure generates a configuration script. In this case, the configuration script does not perform an instantiation and does not set the instantiation SCN for each shared database object. Instead, you must perform the instantiation and ensure that instantiation SCN values are set properly.
                              </p>
                              <p>To specify this instantiation option, set the <code class="codeph">instantiation</code> parameter to <code class="codeph">DBMS_STREAMS_ADM.INSTANTIATION_NONE</code> in each procedure.
                              </p>
                           </li>
                        </ul>
                        <p>When one of these procedures performs a table instantiation, the tablespace that contains the table must exist at the destination database. When one of these procedures performs a schema instantiation, the tablespace that contains the schema must exist at the destination database.</p>
                        <p>When these procedures perform a dump file or network instantiation and an instantiated database object does not exist at the destination database, the database object is imported at the destination database, including its supplemental logging specifications from the source database and its supporting database objects, such as indexes and triggers. However, if the database object already exists at the destination database before instantiation, then it is not imported at the destination database. Therefore, the supplemental logging specifications from the source database are not specified for the database object at the destination database, and the supporting database objects are not imported.</p>
                        <p>The <code class="codeph">PRE_INSTANTIATION_SETUP</code> and <code class="codeph">POST_INSTANTIATION_SETUP</code> procedures do not perform an instantiation. You must perform any required instantiation actions manually after running <code class="codeph">PRE_INSTANTIATION_SETUP</code> and before running <code class="codeph">POST_INSTANTIATION_SETUP</code>. You also must perform any required instantiation actions manually if you use the <code class="codeph">MAINTAIN_GLOBAL</code>, <code class="codeph">MAINTAIN_SCHEMAS</code>, and <code class="codeph">MAINTAIN_TABLES</code> procedures and set the <code class="codeph">instantiation</code> parameter to <code class="codeph">DBMS_STREAMS_ADM.INSTANTIATION_NONE</code>.
                        </p>
                        <p>In these cases, you can use any instantiation method. For example, you can use Recovery Manager (RMAN) to perform a database instantiation using the RMAN <code class="codeph">DUPLICATE</code> or <code class="codeph">CONVERT</code> <code class="codeph">DATABASE</code> command or a tablespace instantiation using the RMAN <code class="codeph">TRANSPORT</code> <code class="codeph">TABLESPACE</code> command. If the <code class="codeph">bi_directional</code> parameter is set to <code class="codeph">TRUE</code>, then ensure that the instantiation SCN values are set properly at the source database and the destination database.
                        </p>
                        <div class="infoboxnote" id="GUID-0249E6A9-33CE-4729-8020-2D4E6D85DBBB__GUID-A93F9C14-AC09-48A2-B9C4-F171CEDB5F83">
                           <p class="notep1">Note:</p>
                           <p></p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>The <code class="codeph">MAINTAIN_SIMPLE_TTS</code> and <code class="codeph">MAINTAIN_TTS</code> procedures do not provide these instantiation options. These procedures always perform an instantiation by cloning the tablespace or tablespace set, transferring the files required for instantiation to the destination database, and attaching the tablespace or tablespace set at the destination database.
                                 </p>
                              </li>
                              <li>
                                 <p>If one of these procedures performs an instantiation, then the database objects, tablespace, or tablespaces set being configured for replication must exist at the source database.</p>
                              </li>
                              <li>
                                 <p>If the RMAN <code class="codeph">DUPLICATE</code> or <code class="codeph">CONVERT</code> <code class="codeph">DATABASE</code> command is used for database instantiation, then the destination database cannot be the capture database.
                                 </p>
                              </li>
                              <li>
                                 <p>When the <code class="codeph">MAINTAIN_TABLES</code> procedure performs a dump file or network instantiation and the instantiated table already exist at the destination database before instantiation, the procedure does not set the instantiation SCN for the table. In this case, you must set the instantiation SCN for the table manually after the procedure completes.
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <div class="infoboxnotealso" id="GUID-0249E6A9-33CE-4729-8020-2D4E6D85DBBB__GUID-6E67C3DF-AB31-4E88-9C3C-E6FC800A7BCF">
                           <p class="notep1">See Also:</p>
                           <p></p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="instantiation-and-oracle-streams-replication.html#GUID-003967CE-08B9-439C-902F-45E7B7C37371"> Instantiation and Oracle Streams Replication</a></p>
                              </li>
                              <li>
                                 <p><span class="q">"<a href="simple-oracle-streams-replication-configuration.html#GUID-D784A5C1-CF24-45B9-A372-0DDE4D57E804">Perform Configuration Actions Directly or With a Script</a>"</span></p>
                              </li>
                              <li>
                                 <p><span class="q">"<a href="simple-oracle-streams-replication-configuration.html#GUID-3BC4A108-17E7-481C-B309-683B2FEB172E">One-Way or Bi-Directional Replication</a>"</span></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div><a id="STREP265"></a><div class="props_rev_3"><a id="GUID-6D874F68-7DE5-4987-8AEC-B0099BF3ED26" name="GUID-6D874F68-7DE5-4987-8AEC-B0099BF3ED26"></a><h4 id="STREP-GUID-6D874F68-7DE5-4987-8AEC-B0099BF3ED26" class="sect4"><span class="enumeration_section">2.2.3 </span>Creating the Required Directory Objects
                  </h4>
                  <div>
                     <div class="section">
                        <p>A directory object is similar to an alias for a directory on a file system. The following directory objects might be required when you run one of these procedures:</p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>A script directory object is required if you decided to generate a configuration script. The configuration script is placed in this directory on the computer system where the procedure is run. Use the <code class="codeph">script_directory_object</code> parameter when you run one of these procedures to specify the script directory object.
                              </p>
                           </li>
                           <li>
                              <p>A source directory object is required if you decided to perform a Data Pump export dump file instantiation, and you will use one of the following procedures: <code class="codeph">MAINTAIN_GLOBAL</code>, <code class="codeph">MAINTAIN_SCHEMAS</code>, <code class="codeph">MAINTAIN_SIMPLE_TTS</code>, <code class="codeph">MAINTAIN_TABLES</code>, or <code class="codeph">MAINTAIN_TTS</code>. The Data Pump export dump file and log file are placed in this directory on the computer system running the source database. Use the <code class="codeph">source_directory_object</code> parameter when you run one of these procedures to specify the source directory object. This directory object is not required if you will use the <code class="codeph">PRE_INSTANTIATION_SETUP</code> and <code class="codeph">POST_INSTANTIATION_SETUP</code> procedures.
                              </p>
                           </li>
                           <li>
                              <p>A destination directory object is required if you decided to perform a Data Pump export dump file instantiation, and you will use one of the following procedures: <code class="codeph">MAINTAIN_GLOBAL</code>, <code class="codeph">MAINTAIN_SCHEMAS</code>, <code class="codeph">MAINTAIN_SIMPLE_TTS</code>, <code class="codeph">MAINTAIN_TABLES</code>, or <code class="codeph">MAINTAIN_TTS</code>. The Data Pump export dump file is transferred from the computer system running the source database to the computer system running the destination database and placed in this directory on the computer system running the destination database. Use the <code class="codeph">destination_directory_object</code> parameter when you run one of these procedures to specify the destination directory object. This directory object is not required if you will use the <code class="codeph">PRE_INSTANTIATION_SETUP</code> and <code class="codeph">POST_INSTANTIATION_SETUP</code> procedures.
                              </p>
                           </li>
                        </ul>
                        <p>Each directory object must be created using the SQL statement <code class="codeph">CREATE</code> <code class="codeph">DIRECTORY</code>, and the user who invokes one of the procedures must have <code class="codeph">READ</code> and <code class="codeph">WRITE</code> privilege on each directory object. 
                        </p>
                        <p>For example, complete the following steps to create a directory object named <code class="codeph">db_dir</code> that corresponds to the <code class="codeph">/usr/db_files</code> directory:
                        </p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>In SQL*Plus, connect to the database as the Oracle Streams administrator.</span><div>
                              <p>See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ADMIN00102"><span class="italic">Oracle Database Administrator's Guide</span></a> for instructions about connecting to a database in SQL*Plus.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>Create the directory object:</span><div><pre class="oac_no_warn" dir="ltr">CREATE DIRECTORY db_dir AS '/usr/db_files';
</pre></div>
                        </li>
                     </ol>
                     <div class="section">
                        <p>The user who creates the directory object automatically has <code class="codeph">READ</code> and <code class="codeph">WRITE</code> privilege on the directory object. When you are configuring an Oracle Streams replication environment, typically the Oracle Streams administrator creates the directory objects.
                        </p>
                        <div class="infoboxnote" id="GUID-6D874F68-7DE5-4987-8AEC-B0099BF3ED26__GUID-753F4DAB-3001-48B8-9B7D-025649B0BB0A">
                           <p class="notep1">Note:</p>
                           <p>The directory objects cannot point to an Automatic Storage Management (ASM) disk group.</p>
                        </div>
                        <div class="infoboxnotealso" id="GUID-6D874F68-7DE5-4987-8AEC-B0099BF3ED26__GUID-CB537EC4-EBAB-4CAD-8E51-2B68F17266EA">
                           <p class="notep1">See Also:</p>
                           <p></p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><span class="q">"<a href="simple-oracle-streams-replication-configuration.html#GUID-D784A5C1-CF24-45B9-A372-0DDE4D57E804">Perform Configuration Actions Directly or With a Script</a>"</span></p>
                              </li>
                              <li>
                                 <p><span class="q">"<a href="simple-oracle-streams-replication-configuration.html#GUID-0249E6A9-33CE-4729-8020-2D4E6D85DBBB">Instantiation</a>"</span></p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="STREP598"></a><div class="props_rev_3"><a id="GUID-F4C7F1FC-ED63-4D01-B2AC-51F116482903" name="GUID-F4C7F1FC-ED63-4D01-B2AC-51F116482903"></a><h4 id="STREP-GUID-F4C7F1FC-ED63-4D01-B2AC-51F116482903" class="sect4"><span class="enumeration_section">2.2.4 </span>Examples That Configure Two-Database Replication with Local Capture
                  </h4>
                  <div>
                     <p>Each of the following examples configures a two-database replication environment that uses one or more local capture processes:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="simple-oracle-streams-replication-configuration.html#GUID-55241DE7-C460-4069-A75A-4B898543E3DC">Configuring Two-Database Global Replication with Local Capture</a></p>
                        </li>
                        <li>
                           <p><a href="simple-oracle-streams-replication-configuration.html#GUID-D5D0E352-A3B0-4E39-8788-4ED78DB954D7">Configuring Two-Database Schema Replication with Local Capture</a></p>
                        </li>
                        <li>
                           <p><a href="simple-oracle-streams-replication-configuration.html#GUID-8B059D8D-E68A-44C9-AEBE-597FEEB488EC">Configuring Two-Database Table Replication with Local Capture</a></p>
                        </li>
                     </ul>
                  </div><a id="STREP266"></a><a id="STREP138"></a><div class="props_rev_3"><a id="GUID-55241DE7-C460-4069-A75A-4B898543E3DC" name="GUID-55241DE7-C460-4069-A75A-4B898543E3DC"></a><h5 id="STREP-GUID-55241DE7-C460-4069-A75A-4B898543E3DC" class="sect5"><span class="enumeration_section">2.2.4.1 </span>Configuring Two-Database Global Replication with Local Capture
                     </h5>
                     <div>
                        <div class="section">
                           <p>You can use the following procedures in the <code class="codeph">DBMS_STREAMS_ADM</code> package to configure replication at the database level:
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS825"><code class="codeph">MAINTAIN_GLOBAL</code></a></p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS831"><code class="codeph">PRE_INSTANTIATION_SETUP</code></a> and <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS830"><code class="codeph">POST_INSTANTIATION_SETUP</code></a></p>
                              </li>
                           </ul>
                           <p>The <code class="codeph">MAINTAIN_GLOBAL</code> procedure automatically excludes database objects that are not supported by Oracle Streams from the replication environment. The <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS831"><code class="codeph">PRE_INSTANTIATION_SETUP</code></a> and <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS830"><code class="codeph">POST_INSTANTIATION_SETUP</code></a> procedures do not automatically exclude database objects. Instead, these procedures enable you to specify which database objects to exclude from the replication environment. Query the <code class="codeph">DBA_STREAMS_UNSUPPORTED</code> data dictionary view to determine which database objects are not supported by Oracle Streams. If unsupported database objects are not excluded, then capture errors will result.
                           </p>
                           <p>The following table lists the decisions that were made about the Oracle Streams replication environment configured in this example.</p>
                           <div class="tblformal" id="GUID-55241DE7-C460-4069-A75A-4B898543E3DC__GUID-A454E672-B2F6-41AB-845D-83F4897498AE">
                              <table cellpadding="4" cellspacing="0" class="Formal" title="" summary="This table lists the decision made for the example in this section." width="100%" frame="hsides" border="1" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" width="50%" id="d12046e3251">Decision</th>
                                       <th align="left" valign="bottom" width="50%" id="d12046e3254">Assumption for This Example</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e3259" headers="d12046e3251 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-9EBD9C47-B328-4740-B1CA-3066B5A9EFD6">Decide Which Type of Replication Environment to Configure</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e3259 d12046e3254 ">
                                          <p>This example configures bi-directional replication in a two database environment where both databases are read/write.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e3268" headers="d12046e3251 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-413B5DE9-FB2A-48BE-B5A0-815DE614E502">Decide Whether to Configure Local or Downstream Capture for the Source Database</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e3268 d12046e3254 ">
                                          <p>This example configures local capture for each source database.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e3277" headers="d12046e3251 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-F691796A-514C-4821-8B7B-BAB0FA45C04E">Decide Whether Changes Are Allowed at One Database or at Multiple Databases</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e3277 d12046e3254 ">
                                          <p>This example allows changes to the replicate database objects at both databases.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e3286" headers="d12046e3251 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-B51FFB8D-AB92-4B36-9648-F58262282F9B">Decide Whether the Replication Environment Will Have Nonidentical Replicas</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e3286 d12046e3254 ">
                                          <p>This example configures identical shared database objects at the databases.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e3295" headers="d12046e3251 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-7078844B-E2BE-48F5-8117-69B4F999FA73">Decide Whether the Replication Environment Will Use Apply Handlers</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e3295 d12046e3254 ">
                                          <p>This example does not configure apply handlers.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e3304" headers="d12046e3251 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-A9E8F02F-F101-4A22-A252-C6A9DC400CE8">Decide Whether to Maintain DDL Changes</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e3304 d12046e3254 ">
                                          <p>This example maintains DDL changes.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e3313" headers="d12046e3251 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-0C7BB255-A828-4089-B624-41201F1E18D0">Decide How to Configure the Replication Environment</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e3313 d12046e3254 ">
                                          <p>This example uses the <code class="codeph">PRE_INSTANTIATION_SETUP</code> and <code class="codeph">POST_INSTANTIATION_SETUP</code> procedures to configure the environment.
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                           <p>In this example, the procedures will configure the replication environment directly. Configuration scripts will not be generated. An RMAN database instantiation will be performed.</p>
                           <p>As noted in the previous table, this example uses the <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS831"><code class="codeph">PRE_INSTANTIATION_SETUP</code></a> and <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS830"><code class="codeph">POST_INSTANTIATION_SETUP</code></a> procedures to configure database replication. The replication configuration will exclude all database objects that are not supported by Oracle Streams. In this example, the source database is <code class="codeph">dbs1.example.com</code>, and the destination database is <code class="codeph">dbs2.example.com</code>.
                           </p>
                           <p><a href="simple-oracle-streams-replication-configuration.html#GUID-55241DE7-C460-4069-A75A-4B898543E3DC__CIACBDEB">Figure 2-1</a> provides an overview of the replication environment created in this example.
                           </p>
                           <div class="figure" id="GUID-55241DE7-C460-4069-A75A-4B898543E3DC__CIACBDEB">
                              <p class="titleinfigure">Figure 2-1 Sample Oracle Streams Environment That Replicates an Entire Database</p><img width="445" src="img/strep048.gif" alt="Description of Figure 2-1 follows" title="Description of Figure 2-1 follows" longdesc="img_text/strep048.html"><br><a href="img_text/strep048.html">Description of "Figure 2-1 Sample Oracle Streams Environment That Replicates an Entire Database"</a></div>
                           <!-- class="figure" -->
                           <div class="infoboxnote" id="GUID-55241DE7-C460-4069-A75A-4B898543E3DC__GUID-B7D76CDA-2C69-4DC0-B42D-B0618A0A034A">
                              <p class="notep1">Note:</p>
                              <p>A capture process never captures changes in the <code class="codeph">SYS</code>, <code class="codeph">SYSTEM</code>, or <code class="codeph">CTXSYS</code> schemas. Changes to these schemas are not maintained by Oracle Streams in the replication configuration described in this section.
                              </p>
                           </div>
                           <div class="infoboxnotealso" id="GUID-55241DE7-C460-4069-A75A-4B898543E3DC__GUID-9B5C707F-77CE-4508-A8AF-14B14894560C">
                              <p class="notep1">See Also:</p>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=STRMS172"><span class="italic">Oracle Streams Concepts and Administration</span></a> for instructions on determining which database objects are not supported by Oracle Streams
                              </p>
                           </div>
                           <p>Complete the following steps to use the <code class="codeph">PRE_INSTANTIATION_SETUP</code> and <code class="codeph">POST_INSTANTIATION_SETUP</code> procedures to configure the replication environment:
                           </p>
                           <ol>
                              <li id="GUID-55241DE7-C460-4069-A75A-4B898543E3DC__CACFIABG">
                                 <p>Complete the required tasks before running the <code class="codeph">PRE_INSTANTIATION_SETUP</code> procedure. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-BB2E76CA-3645-4469-8750-4B276B8A955B">Tasks to Complete Before Configuring Oracle Streams Replication</a>"</span> for instructions.
                                 </p>
                                 <p>For this configuration, the following tasks must be completed:</p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Configure an Oracle Streams administrator at both databases. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-EF5A403D-42E5-426D-B654-456E634F53B0">Configuring an Oracle Streams Administrator on All Databases</a>"</span>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Configure network connectivity and database links:</p>
                                       <ul style="list-style-type: disc;">
                                          <li>
                                             <p>Configure network connectivity between the source database <code class="codeph">dbs1.example.com</code> and the destination database <code class="codeph">dbs2.example.com</code>.
                                             </p>
                                          </li>
                                          <li>
                                             <p>Create a database link from the source database <code class="codeph">dbs1.example.com</code> to the destination database <code class="codeph">dbs2.example.com</code>.
                                             </p>
                                          </li>
                                       </ul>
                                       <p>See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-7867112D-DAC3-4693-811E-B1B1052C7847">Configuring Network Connectivity and Database Links</a>"</span>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Ensure that both databases are in <code class="codeph">ARCHIVELOG</code> mode. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-93BE3DA2-24EC-491A-811C-E32FD80D7809">Ensuring That Each Source Database Is In ARCHIVELOG Mode</a>"</span>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Ensure that the initialization parameters are set properly at both databases. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-F16B954D-35E0-422C-A89F-D3E170BD4505">Setting Initialization Parameters Relevant to Oracle Streams</a>"</span>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Configure the Oracle Streams pool properly at both databases. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-E572258F-DEB4-4B0B-B29B-D196C7336112">Configuring the Oracle Streams Pool</a>"</span>.
                                       </p>
                                    </li>
                                 </ul>
                                 <p>A database link is required from the destination database to the source database. However, because RMAN will be used for database instantiation, this database link must be created after instantiation. This database link is required because the replication environment will be bi-directional and because RMAN will be used for database instantiation.</p>
                              </li>
                              <li>
                                 <p>In SQL*Plus, connect to the source database <code class="codeph">dbs1.example.com</code> as the Oracle Streams administrator.
                                 </p>
                                 <p>See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ADMIN00102"><span class="italic">Oracle Database Administrator's Guide</span></a> for instructions about connecting to a database in SQL*Plus.
                                 </p>
                              </li>
                              <li>
                                 <p>Run the <code class="codeph">PRE_INSTANTIATION_SETUP</code> procedure:
                                 </p><pre class="oac_no_warn" dir="ltr">DECLARE
  empty_tbs  DBMS_STREAMS_TABLESPACE_ADM.TABLESPACE_SET; 
BEGIN
  DBMS_STREAMS_ADM.PRE_INSTANTIATION_SETUP(
    maintain_mode        =&gt; 'GLOBAL',
    tablespace_names     =&gt; empty_tbs,
    source_database      =&gt; 'dbs1.example.com',
    destination_database =&gt; 'dbs2.example.com',
    perform_actions      =&gt; TRUE,
    bi_directional       =&gt; TRUE,
    include_ddl          =&gt; TRUE,
    start_processes      =&gt; TRUE,
    exclude_schemas      =&gt; '*',
    exclude_flags        =&gt; DBMS_STREAMS_ADM.EXCLUDE_FLAGS_UNSUPPORTED + 
                            DBMS_STREAMS_ADM.EXCLUDE_FLAGS_DML + 
                            DBMS_STREAMS_ADM.EXCLUDE_FLAGS_DDL);
END;
/
</pre><p>Notice that the <code class="codeph">start_processes</code> parameter is set to <code class="codeph">TRUE</code>. Therefore, each capture process and apply process created during the configuration is started automatically.
                                 </p>
                                 <p>Also, notice the values specified for the <code class="codeph">exclude_schemas</code> and <code class="codeph">exclude_flags</code> parameters. The asterisk (<code class="codeph">*</code>) specified for <code class="codeph">exclude_schemas</code> indicates that certain database objects in every schema in the database might be excluded from the replication environment. The value specified for the <code class="codeph">exclude_flags</code> parameter indicates that DML and DDL changes for all unsupported database objects are excluded from the replication environment. Rules are placed in the negative rule sets for the capture processes to exclude these database objects.
                                 </p>
                                 <p>Because the procedure is run at the source database, local capture is configured at the source database.</p>
                                 <p>Because this procedure configures a bi-directional replication environment, do not allow DML or DDL changes to the shared database objects at the destination database while the procedure is running.</p>
                                 <p>The procedure does not specify the <code class="codeph">apply_name</code> parameter. Therefore, the default, <code class="codeph">NULL</code>, is specified for this parameter. When the <code class="codeph">apply_name</code> parameter is set to <code class="codeph">NULL</code>, no apply process that applies changes from the source database can exist on the destination database. If an apply process that applies changes from the source database exists at the destination database, then specify a non-<code class="codeph">NULL</code> value for the <code class="codeph">apply_name</code> parameter.
                                 </p>
                                 <p>To monitor the progress of the configuration operation, follow the instructions in <span class="q">"<a href="simple-oracle-streams-replication-configuration.html#GUID-7E1E55C3-95FA-4C6C-94B4-2F16E949D67E">Monitoring Oracle Streams Configuration Progress</a>"</span>.
                                 </p>
                                 <p>If this procedure encounters an error and stops, then see <span class="q">"<a href="managing-oracle-streams-replication.html#GUID-52B85E39-2264-47E2-981A-63CA23C7380A">Recovering from Operation Errors</a>"</span> for information about either recovering from the error or rolling back the configuration operation.
                                 </p>
                              </li>
                              <li id="GUID-55241DE7-C460-4069-A75A-4B898543E3DC__CACHEAHC">
                                 <p>Perform the instantiation. You can use any of the methods described in <a href="instantiation-and-oracle-streams-replication.html#GUID-003967CE-08B9-439C-902F-45E7B7C37371"> Instantiation and Oracle Streams Replication</a> to complete the instantiation. This example uses the RMAN <code class="codeph">DUPLICATE</code> command to perform the instantiation by performing the following steps:
                                 </p>
                                 <ol type="a">
                                    <li>
                                       <p>Create a backup of the source database if one does not exist. RMAN requires a valid backup for duplication. In this example, create a backup of <code class="codeph">dbs1.example.com</code> if one does not exist.
                                       </p>
                                       <div class="infoboxnote" id="GUID-55241DE7-C460-4069-A75A-4B898543E3DC__GUID-9A7DA983-987A-4F89-8319-0A11792A7138">
                                          <p class="notep1">Note:</p>
                                          <p>A backup of the source database is not necessary if you use the <code class="codeph">FROM</code> <code class="codeph">ACTIVE</code> <code class="codeph">DATABASE</code> option when you run the RMAN <code class="codeph">DUPLICATE</code> command. For large databases, the <code class="codeph">FROM</code> <code class="codeph">ACTIVE</code> <code class="codeph">DATABASE</code> option requires significant network resources. This example does not use this option.
                                          </p>
                                       </div>
                                    </li>
                                    <li>
                                       <p>In SQL*Plus, connect to the source database <code class="codeph">dbs1.example.com</code> as the Oracle Streams administrator.
                                       </p>
                                       <p>See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ADMIN00102"><span class="italic">Oracle Database Administrator's Guide</span></a> for instructions about connecting to a database in SQL*Plus.
                                       </p>
                                    </li>
                                    <li id="GUID-55241DE7-C460-4069-A75A-4B898543E3DC__CACCGFAF">
                                       <p>Determine the until SCN for the RMAN <code class="codeph">DUPLICATE</code> command:
                                       </p><pre class="oac_no_warn" dir="ltr">SET SERVEROUTPUT ON SIZE 1000000
DECLARE
  until_scn NUMBER;
BEGIN
  until_scn:= DBMS_FLASHBACK.GET_SYSTEM_CHANGE_NUMBER;
      DBMS_OUTPUT.PUT_LINE('Until SCN: ' || until_scn);
END;
/
</pre><p>Make a note of the until SCN returned. You will use this number in Step <a href="simple-oracle-streams-replication-configuration.html#GUID-55241DE7-C460-4069-A75A-4B898543E3DC__CACJGAFD">4.h</a>. For this example, assume that the returned until SCN is&nbsp;<code class="codeph">45442631</code>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>In SQL*Plus, connect to the source database <code class="codeph">dbs1.example.com</code> as an administrative user.
                                       </p>
                                    </li>
                                    <li id="GUID-55241DE7-C460-4069-A75A-4B898543E3DC__CACEDHCC">
                                       <p>Archive the current online redo log:</p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM ARCHIVE LOG CURRENT;
</pre></li>
                                    <li>
                                       <p>Prepare your environment for database duplication, which includes preparing the destination database as an auxiliary instance for duplication. See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=BRADV010"><span class="italic">Oracle Database Backup and Recovery User's Guide </span></a>for instructions.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Start the RMAN client, and connect to the source database <code class="codeph">dbs1.example.com</code> as <code class="codeph">TARGET</code> and to the destination database <code class="codeph">dbs2.example.com</code> as <code class="codeph">AUXILIARY</code>.
                                       </p>
                                       <div class="infoboxnotealso" id="GUID-55241DE7-C460-4069-A75A-4B898543E3DC__GUID-B8908A53-8A9A-4760-A40E-63C2E651D20D">
                                          <p class="notep1">See Also:</p>
                                          <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=RCMRF114"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for more information about the RMAN <code class="codeph">CONNECT</code> command
                                          </p>
                                       </div>
                                    </li>
                                    <li id="GUID-55241DE7-C460-4069-A75A-4B898543E3DC__CACJGAFD">
                                       <p>Use the RMAN <code class="codeph">DUPLICATE</code> command with the <code class="codeph">OPEN</code> <code class="codeph">RESTRICTED</code> option to instantiate the source database at the destination database. The <code class="codeph">OPEN</code> <code class="codeph">RESTRICTED</code> option is required. This option enables a restricted session in the duplicate database by issuing the following SQL statement: <code class="codeph">ALTER</code> <code class="codeph">SYSTEM</code> <code class="codeph">ENABLE</code> <code class="codeph">RESTRICTED</code> <code class="codeph">SESSION</code>. RMAN issues this statement immediately before the duplicate database is opened.
                                       </p>
                                       <p>You can use the <code class="codeph">UNTIL</code> <code class="codeph">SCN</code> clause to specify an SCN for the duplication. Use the until SCN determined in Step <a href="simple-oracle-streams-replication-configuration.html#GUID-55241DE7-C460-4069-A75A-4B898543E3DC__CACCGFAF">4.c</a> for this clause. Archived redo logs must be available for the until SCN specified and for higher SCN values. Therefore, Step <a href="simple-oracle-streams-replication-configuration.html#GUID-55241DE7-C460-4069-A75A-4B898543E3DC__CACEDHCC">4.e</a> archived the redo log containing the until SCN.
                                       </p>
                                       <p>Ensure that you use <code class="codeph">TO</code> <span class="italic"><code class="codeph">database_name</code></span> in the <code class="codeph">DUPLICATE</code> command to specify the name of the duplicate database. In this example, the duplicate database is <code class="codeph">dbs2.example.com</code>. Therefore, the <code class="codeph">DUPLICATE</code> command for this example includes <code class="codeph">TO</code> <code class="codeph">dbs2.example.com</code>.
                                       </p>
                                       <p>The following is an example of an RMAN <code class="codeph">DUPLICATE</code> command:
                                       </p><pre class="oac_no_warn" dir="ltr">RMAN&gt; RUN
      { 
        SET UNTIL SCN 45442631;
        ALLOCATE AUXILIARY CHANNEL dbs2 DEVICE TYPE sbt; 
        DUPLICATE TARGET DATABASE TO dbs2 
        NOFILENAMECHECK
        OPEN RESTRICTED;
      }
</pre><div class="infoboxnotealso" id="GUID-55241DE7-C460-4069-A75A-4B898543E3DC__GUID-1FC54F8B-3885-4F6A-902A-083D6686F627">
                                          <p class="notep1">See Also:</p>
                                          <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=RCMRF126"><span class="italic">Oracle Database Backup and Recovery Reference</span></a> for more information about the RMAN <code class="codeph">DUPLICATE</code> command
                                          </p>
                                       </div>
                                    </li>
                                    <li>
                                       <p>In SQL*Plus, connect to the destination database as an administrative user.</p>
                                    </li>
                                    <li>
                                       <p>Rename the global name. After an RMAN database instantiation, the destination database has the same global name as the source database. Rename the global name of the destination database back to its original name with the following statement:</p><pre class="oac_no_warn" dir="ltr">ALTER DATABASE RENAME GLOBAL_NAME TO dbs2.example.com;
</pre></li>
                                    <li>
                                       <p>In SQL*Plus, connect to the destination database <code class="codeph">dbs2.example.com</code> as the Oracle Streams administrator.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Drop the database link from the source database to the destination database that was cloned from the source database:</p><pre class="oac_no_warn" dir="ltr">DROP DATABASE LINK dbs2.example.com;
</pre></li>
                                 </ol>
                              </li>
                              <li>
                                 <p>While still connected to the destination database as the Oracle Streams administrator, create a database link from the destination database to the source database:</p><pre class="oac_no_warn" dir="ltr">CREATE DATABASE LINK dbs1.example.com CONNECT TO strmadmin 
  IDENTIFIED BY <span class="italic">password</span> USING 'dbs1.example.com';
</pre><p>See Step <a href="simple-oracle-streams-replication-configuration.html#GUID-55241DE7-C460-4069-A75A-4B898543E3DC__CACFIABG">1</a> for information about why this database link is required.
                                 </p>
                              </li>
                              <li>
                                 <p>In SQL*Plus, connect to the source database <code class="codeph">dbs1.example.com</code> as the Oracle Streams administrator.
                                 </p>
                              </li>
                              <li>
                                 <p>Run the <code class="codeph">POST_INSTANTIATION_SETUP</code> procedure:
                                 </p><pre class="oac_no_warn" dir="ltr">DECLARE
  empty_tbs  DBMS_STREAMS_TABLESPACE_ADM.TABLESPACE_SET; 
BEGIN
  DBMS_STREAMS_ADM.POST_INSTANTIATION_SETUP(
    maintain_mode        =&gt; 'GLOBAL',
    tablespace_names     =&gt; empty_tbs,
    source_database      =&gt; 'dbs1.example.com',
    destination_database =&gt; 'dbs2.example.com',
    perform_actions      =&gt; TRUE,
    bi_directional       =&gt; TRUE,
    include_ddl          =&gt; TRUE,
    start_processes      =&gt; TRUE,
    instantiation_scn    =&gt; 45442630,
    exclude_schemas      =&gt; '*',
    exclude_flags        =&gt; DBMS_STREAMS_ADM.EXCLUDE_FLAGS_UNSUPPORTED + 
                            DBMS_STREAMS_ADM.EXCLUDE_FLAGS_DML + 
                            DBMS_STREAMS_ADM.EXCLUDE_FLAGS_DDL);
END;
/
</pre><p>The parameter values specified in both the <code class="codeph">PRE_INSTANTIATION_SETUP</code> and <code class="codeph">POST_INSTANTIATION_SETUP</code> procedures must match, except for the values of the following parameters: <code class="codeph">perform_actions</code>, <code class="codeph">script_name</code>, <code class="codeph">script_directory_object</code>, and <code class="codeph">start_processes</code>.
                                 </p>
                                 <p>Also, notice that the <code class="codeph">instantiation_scn</code> parameter is set to <code class="codeph">45442630</code>. The RMAN <code class="codeph">DUPLICATE</code> command duplicates the database up to one less than the SCN value specified in the <code class="codeph">UNTIL</code> <code class="codeph">SCN</code> clause. Therefore, you should subtract one from the until SCN value that you specified when you ran the <code class="codeph">DUPLICATE</code> command in Step <a href="simple-oracle-streams-replication-configuration.html#GUID-55241DE7-C460-4069-A75A-4B898543E3DC__CACHEAHC">4</a><a href="simple-oracle-streams-replication-configuration.html#GUID-55241DE7-C460-4069-A75A-4B898543E3DC__CACJGAFD">4.h</a>. In this example, the until SCN was set to <code class="codeph">45442631</code>. Therefore, the <code class="codeph">instantiation_scn</code> parameter should be set to 45442631 - 1, or <code class="codeph">45442630</code>.
                                 </p>
                                 <p>If the instantiation SCN was set for the shared database objects at the destination database during instantiation, then the <code class="codeph">instantiation_scn</code> parameter should be set to <code class="codeph">NULL</code>. For example, the instantiation SCN might be set during a full database export/import.
                                 </p>
                                 <p>Because this procedure configures a bi-directional replication environment, do not allow DML or DDL changes to the shared database objects at the destination database while the procedure is running.</p>
                                 <p>To monitor the progress of the configuration operation, follow the instructions in <span class="q">"<a href="simple-oracle-streams-replication-configuration.html#GUID-7E1E55C3-95FA-4C6C-94B4-2F16E949D67E">Monitoring Oracle Streams Configuration Progress</a>"</span>.
                                 </p>
                                 <p>If this procedure encounters an error and stops, then see <span class="q">"<a href="managing-oracle-streams-replication.html#GUID-52B85E39-2264-47E2-981A-63CA23C7380A">Recovering from Operation Errors</a>"</span> for information about either recovering from the error or rolling back the configuration operation.
                                 </p>
                              </li>
                              <li>
                                 <p>At the destination database, connect as an administrative user in SQL*Plus and use the <code class="codeph">ALTER</code> <code class="codeph">SYSTEM</code> statement to disable the <code class="codeph">RESTRICTED</code> <code class="codeph">SESSION</code>:
                                 </p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM DISABLE RESTRICTED SESSION;
</pre></li>
                              <li>
                                 <p>Configure conflict resolution for the shared database objects if necessary.</p>
                                 <p>Typically, conflicts are possible in a bi-directional replication environment. If conflicts are possible in the environment created by the <code class="codeph">PRE_INSTANTIATION_SETUP</code> and <code class="codeph">POST_INSTANTIATION_SETUP</code> procedures, then configure conflict resolution before you allow users to make changes to the shared database objects.
                                 </p>
                                 <p>See <a href="oracle-streams-conflict-resolution.html#GUID-5D79AA72-A682-4623-8A0B-4CF84D1FFC86"> Oracle Streams Conflict Resolution</a> for more information.
                                 </p>
                              </li>
                           </ol>
                           <p>The bi-directional replication environment configured in this example has the following characteristics:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Database supplemental logging is configured at both databases.</p>
                              </li>
                              <li>
                                 <p>The <code class="codeph">dbs1.example.com</code> database has two queues and queue tables with system-generated names. One queue is for the local capture process, and one queue is for the apply process.
                                 </p>
                              </li>
                              <li>
                                 <p>The <code class="codeph">dbs2.example.com</code> database has two queues and queue tables with system-generated names. One queue is for the local capture process, and one queue is for the apply process.
                                 </p>
                              </li>
                              <li>
                                 <p>At the <code class="codeph">dbs1.example.com</code> database, a capture process with a system-generated name captures DML and DDL changes to all of the database objects in the database that are supported by Oracle Streams.
                                 </p>
                              </li>
                              <li>
                                 <p>At the <code class="codeph">dbs2.example.com</code> database, a capture process with a system-generated name captures DML and DDL changes to all of the database objects in the database that are supported by Oracle Streams.
                                 </p>
                              </li>
                              <li>
                                 <p>A propagation running on the <code class="codeph">dbs1.example.com</code> database with a system-generated name sends the captured changes from a queue at the <code class="codeph">dbs1.example.com</code> database to a queue at the <code class="codeph">dbs2.example.com</code> database.
                                 </p>
                              </li>
                              <li>
                                 <p>A propagation running on the <code class="codeph">dbs2.example.com</code> database with a system-generated name sends the captured changes from a queue at the <code class="codeph">dbs2.example.com</code> database to a queue at the <code class="codeph">dbs1.example.com</code> database.
                                 </p>
                              </li>
                              <li>
                                 <p>At the <code class="codeph">dbs1.example.com</code> database, an apply process with a system-generated name dequeues the changes from its queue and applies them to the database objects.
                                 </p>
                              </li>
                              <li>
                                 <p>At the <code class="codeph">dbs2.example.com</code> database, an apply process with a system-generated name dequeues the changes from its queue and applies them to the database objects.
                                 </p>
                              </li>
                              <li>
                                 <p>Tags are used to avoid change cycling. Specifically, each apply process uses an apply tag so that redo records for changes applied by the apply process include the tag. Each apply process uses an apply tag that is unique in the replication environment. Each propagation discards changes that have the tag of the apply process running on the same database. See <span class="q">"<a href="simple-oracle-streams-replication-configuration.html#GUID-AD9A0588-A09F-422C-8C84-A2C1AA187A37">Change Cycling and Tags</a>"</span> for more information.
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="STREP608"></a><a id="STREP599"></a><div class="props_rev_3"><a id="GUID-D5D0E352-A3B0-4E39-8788-4ED78DB954D7" name="GUID-D5D0E352-A3B0-4E39-8788-4ED78DB954D7"></a><h5 id="STREP-GUID-D5D0E352-A3B0-4E39-8788-4ED78DB954D7" class="sect5"><span class="enumeration_section">2.2.4.2 </span>Configuring Two-Database Schema Replication with Local Capture
                     </h5>
                     <div>
                        <div class="section">
                           <p>This example configures an Oracle Streams replication environment that replicates data manipulation language (DML) changes to all of the tables in the <code class="codeph">hr</code> schema. This example configures a two-database replication environment with local capture processes to capture changes. This example uses the global database names <code class="codeph">db1.example.com</code> and <code class="codeph">db2.example.com</code>. However, you can substitute databases in your environment to complete the example.
                           </p>
                           <p>The following table lists the decisions that were made about the Oracle Streams replication environment configured in this example.</p>
                           <div class="tblformal" id="GUID-D5D0E352-A3B0-4E39-8788-4ED78DB954D7__GUID-6D4FF96D-6DFD-4191-ACB3-E4863A4124FB">
                              <table cellpadding="4" cellspacing="0" class="Formal" title="" summary="This table lists the decision made for the example in this section." width="100%" frame="hsides" border="1" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" width="50%" id="d12046e4124">Decision</th>
                                       <th align="left" valign="bottom" width="50%" id="d12046e4127">Assumption for This Example</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e4132" headers="d12046e4124 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-9EBD9C47-B328-4740-B1CA-3066B5A9EFD6">Decide Which Type of Replication Environment to Configure</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e4132 d12046e4127 ">
                                          <p>This example provides instructions for configuring either one-way or bi-directional replication. To configure bi-directional replication, you must complete additional steps and set the <code class="codeph">bi_directional</code> parameter to <code class="codeph">TRUE</code> when you run the configuration procedure.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e4147" headers="d12046e4124 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-413B5DE9-FB2A-48BE-B5A0-815DE614E502">Decide Whether to Configure Local or Downstream Capture for the Source Database</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e4147 d12046e4127 ">
                                          <p>This example configures local capture for the source database.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e4156" headers="d12046e4124 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-F691796A-514C-4821-8B7B-BAB0FA45C04E">Decide Whether Changes Are Allowed at One Database or at Multiple Databases</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e4156 d12046e4127 ">
                                          <p>This example lets you choose whether to allow changes at one database or both databases.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e4165" headers="d12046e4124 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-B51FFB8D-AB92-4B36-9648-F58262282F9B">Decide Whether the Replication Environment Will Have Nonidentical Replicas</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e4165 d12046e4127 ">
                                          <p>This example configures identical shared database objects at the databases.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e4174" headers="d12046e4124 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-7078844B-E2BE-48F5-8117-69B4F999FA73">Decide Whether the Replication Environment Will Use Apply Handlers</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e4174 d12046e4127 ">
                                          <p>This example does not configure apply handlers.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e4183" headers="d12046e4124 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-A9E8F02F-F101-4A22-A252-C6A9DC400CE8">Decide Whether to Maintain DDL Changes</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e4183 d12046e4127 ">
                                          <p>This example maintains DDL changes.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e4192" headers="d12046e4124 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-0C7BB255-A828-4089-B624-41201F1E18D0">Decide How to Configure the Replication Environment</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e4192 d12046e4127 ">
                                          <p>This example uses the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure to configure the environment.
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                           <p>The database objects being configured for replication might or might not exist at the destination database when you run the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure. If the database objects do not exist at the destination database, then the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure instantiates them at the destination database using a Data Pump export/import. During instantiation, the instantiation SCN is set for these database objects. If the database objects already exist at the destination database, then the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure retains the existing database objects and sets the instantiation SCN for them. In this example, the <code class="codeph">hr</code> schema exists at both the <code class="codeph">db1.example.com</code> database and the <code class="codeph">db2.example.com</code> database before the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure is run.
                           </p>
                           <p>In this example, the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure will configure the replication environment directly. A configuration script will not be generated. A Data Pump export dump file instantiation will be performed.
                           </p>
                           <p><a href="simple-oracle-streams-replication-configuration.html#GUID-D5D0E352-A3B0-4E39-8788-4ED78DB954D7__CIAIDHEG">Figure 2-2</a> provides an overview of the environment created in this example. The additional components required for bi-directional replication are shown in gray, and their actions are indicated by dashed lines.
                           </p>
                           <div class="figure" id="GUID-D5D0E352-A3B0-4E39-8788-4ED78DB954D7__CIAIDHEG">
                              <p class="titleinfigure">Figure 2-2 Two-Database Replication Environment with Local Capture Processes</p><img width="583" src="img/strep509.gif" alt="Description of Figure 2-2 follows" title="Description of Figure 2-2 follows" longdesc="img_text/strep509.html"><br><a href="img_text/strep509.html">Description of "Figure 2-2 Two-Database Replication Environment with Local Capture Processes"</a></div>
                           <!-- class="figure" -->
                           <p>Complete the following steps to use the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure to configure the environment:
                           </p>
                           <ol>
                              <li>
                                 <p>Complete the following tasks to prepare for the two-database replication environment:</p>
                                 <ol type="a">
                                    <li>
                                       <p>Configure network connectivity so that the <code class="codeph">db1.example.com</code> database can communicate with the <code class="codeph">db2.example.com</code> database.
                                       </p>
                                       <p>See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ADMQS004"><span class="italic">Oracle Database 2 Day DBA</span></a> for information about configuring network connectivity between databases.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Configure an Oracle Streams administrator at each database that will participate in the replication environment. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-EF5A403D-42E5-426D-B654-456E634F53B0">Configuring an Oracle Streams Administrator on All Databases</a>"</span> for instructions. This example assumes that the Oracle Streams administrator is <code class="codeph">strmadmin</code>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Create a database link from the <code class="codeph">db1.example.com</code> database to the <code class="codeph">db2.example.com</code> database.
                                       </p>
                                       <p>The database link should be created in the Oracle Streams administrator's schema. Also, the database link should connect to the Oracle Streams administrator at the other database. Both the name and the service name of the database link must be <code class="codeph">db2.example.com</code>. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-7867112D-DAC3-4693-811E-B1B1052C7847">Configuring Network Connectivity and Database Links</a>"</span> for instructions.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Configure the <code class="codeph">db1.example.com</code> database to run in <code class="codeph">ARCHIVELOG</code> mode. For a capture process to capture changes generated at a source database, the source database must be running in <code class="codeph">ARCHIVELOG</code> mode. See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ADMIN008"><span class="italic">Oracle Database Administrator's Guide</span></a> for information about configuring a database to run in <code class="codeph">ARCHIVELOG</code> mode.
                                       </p>
                                    </li>
                                 </ol>
                              </li>
                              <li>
                                 <p>To configure a bi-directional replication environment, complete the following steps. If you are configuring a one-way replication environment, then these steps are not required, and you can move on to Step <a href="simple-oracle-streams-replication-configuration.html#GUID-D5D0E352-A3B0-4E39-8788-4ED78DB954D7__CIAGDJBF">3</a>.
                                 </p>
                                 <ol type="a">
                                    <li>
                                       <p>Create a database link from the <code class="codeph">db2.example.com</code> database to the <code class="codeph">db1.example.com</code> database.
                                       </p>
                                       <p>The database link should be created in the Oracle Streams administrator's schema. Also, the database link should connect to the Oracle Streams administrator at the other database. Both the name and the service name of the database link must be <code class="codeph">db1.example.com</code>. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-7867112D-DAC3-4693-811E-B1B1052C7847">Configuring Network Connectivity and Database Links</a>"</span> for instructions.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Configure the <code class="codeph">db2.example.com</code> database to run in <code class="codeph">ARCHIVELOG</code> mode. For a capture process to capture changes generated at a source database, the source database must be running in <code class="codeph">ARCHIVELOG</code> mode. See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ADMIN008"><span class="italic">Oracle Database Administrator's Guide</span></a> for information about configuring a database to run in <code class="codeph">ARCHIVELOG</code> mode.
                                       </p>
                                    </li>
                                 </ol>
                              </li>
                              <li id="GUID-D5D0E352-A3B0-4E39-8788-4ED78DB954D7__CIAGDJBF">
                                 <p>Set initialization parameters properly at each database that will participate in the Oracle Streams replication environment. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-F16B954D-35E0-422C-A89F-D3E170BD4505">Setting Initialization Parameters Relevant to Oracle Streams</a>"</span><span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-F16B954D-35E0-422C-A89F-D3E170BD4505">Setting Initialization Parameters Relevant to Oracle Streams</a>"</span> for instructions.
                                 </p>
                              </li>
                              <li>
                                 <p>Create the following required directory objects:</p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>A source directory object at the source database. This example assumes that this directory object is <code class="codeph">source_directory</code>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>A destination directory object at the destination database. This example assumes that this directory object is <code class="codeph">dest_directory</code>.
                                       </p>
                                    </li>
                                 </ul>
                                 <p>See <span class="q">"<a href="simple-oracle-streams-replication-configuration.html#GUID-6D874F68-7DE5-4987-8AEC-B0099BF3ED26">Creating the Required Directory Objects</a>"</span> for instructions.
                                 </p>
                              </li>
                              <li>
                                 <p>In SQL*Plus, connect to the <code class="codeph">db1.example.com</code> database as the Oracle Streams administrator.
                                 </p>
                                 <p>See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ADMIN00102"><span class="italic">Oracle Database Administrator's Guide</span></a> for information about connecting to a database in SQL*Plus.
                                 </p>
                              </li>
                              <li>
                                 <p>Run the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure to configure replication of the <code class="codeph">hr</code> schema between the <code class="codeph">db1.example.com</code> database and the <code class="codeph">db2.example.com</code> database.
                                 </p>
                                 <p>Ensure that the <code class="codeph">bi_directional</code> parameter is set properly for the replication environment that you are configuring. Either set this parameter to <code class="codeph">FALSE</code> for one-way replication, or set it to <code class="codeph">TRUE</code> for bi-directional replication.
                                 </p><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_STREAMS_ADM.MAINTAIN_SCHEMAS(
    schema_names                 =&gt; 'hr',
    source_directory_object      =&gt; 'source_directory',
    destination_directory_object =&gt; 'dest_directory',
    source_database              =&gt; 'db1.example.com',
    destination_database         =&gt; 'db2.example.com',
    bi_directional               =&gt; FALSE); -- Set to TRUE for bi-directional
END;
/
</pre><p>The <code class="codeph">MAINTAIN_SCHEMAS</code> procedure can take some time to run because it is performing many configuration tasks. Do not allow data manipulation language (DML) or data definition language (DDL) changes to the replicated database objects at the destination database while the procedure is running.
                                 </p>
                                 <p>When a configuration procedure is run, information about its progress is recorded in the following data dictionary views: <code class="codeph">DBA_RECOVERABLE_SCRIPT</code>, <code class="codeph">DBA_RECOVERABLE_SCRIPT_PARAMS</code>, <code class="codeph">DBA_RECOVERABLE_SCRIPT_BLOCKS</code>, and <code class="codeph">DBA_RECOVERABLE_SCRIPT_ERRORS</code>. If the procedure stops because it encounters an error, then see <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=STREP149"><span class="italic">Oracle Streams Replication Administrator's Guide</span></a> for instructions about using the <code class="codeph">RECOVER_OPERATION</code> procedure in the <code class="codeph">DBMS_STREAMS_ADM</code> package to recover from these errors.
                                 </p>
                              </li>
                              <li>
                                 <p>If you configured bi-directional replication, then configure latest time conflict resolution for all of the tables in the <code class="codeph">hr</code> schema at both databases. This schema includes the <code class="codeph">countries</code>, <code class="codeph">departments</code>, <code class="codeph">employees</code>, <code class="codeph">jobs</code>, <code class="codeph">job_history</code>, <code class="codeph">locations</code>, and <code class="codeph">regions</code> tables. See <a href="oracle-streams-conflict-resolution.html#GUID-5D79AA72-A682-4623-8A0B-4CF84D1FFC86"> Oracle Streams Conflict Resolution</a> for instructions.
                                 </p>
                              </li>
                           </ol>
                           <div class="infoboxnotealso" id="GUID-D5D0E352-A3B0-4E39-8788-4ED78DB954D7__GUID-3F305D1D-74D4-46F4-830C-8B9B82BB724F">
                              <p class="notep1">See Also:</p>
                              <p>The Oracle Enterprise Manager Cloud Control online help for an example that configures this replication environment using Oracle Enterprise Manager Cloud Control</p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="STREP272"></a><a id="STREP271"></a><div class="props_rev_3"><a id="GUID-8B059D8D-E68A-44C9-AEBE-597FEEB488EC" name="GUID-8B059D8D-E68A-44C9-AEBE-597FEEB488EC"></a><h5 id="STREP-GUID-8B059D8D-E68A-44C9-AEBE-597FEEB488EC" class="sect5"><span class="enumeration_section">2.2.4.3 </span>Configuring Two-Database Table Replication with Local Capture
                     </h5>
                     <div>
                        <div class="section">
                           <p>You can use the <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS827"><code class="codeph">MAINTAIN_TABLES</code></a> procedure in the <code class="codeph">DBMS_STREAMS_ADM</code> package to configure table replication. The example in this section uses this procedure to configure an Oracle Streams replication environment that maintains specific tables in the <code class="codeph">hr</code> schema. The source database is <code class="codeph">dbs1.example.com</code>, and the destination database is <code class="codeph">dbs2.example.com</code>.
                           </p>
                           <p>The following table lists the decisions that were made about the Oracle Streams replication environment configured in this example.</p>
                           <div class="tblformal" id="GUID-8B059D8D-E68A-44C9-AEBE-597FEEB488EC__GUID-7EC187B3-0F56-41BF-816D-DDFDD1E55981">
                              <table cellpadding="4" cellspacing="0" class="Formal" title="" summary="This table lists the decision made for the example in this section." width="100%" frame="hsides" border="1" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" width="50%" id="d12046e4648">Decision</th>
                                       <th align="left" valign="bottom" width="50%" id="d12046e4651">Assumption for This Example</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e4656" headers="d12046e4648 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-9EBD9C47-B328-4740-B1CA-3066B5A9EFD6">Decide Which Type of Replication Environment to Configure</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e4656 d12046e4651 ">
                                          <p>This example configures one-way replication in a two database environment where the source database is read/write and the destination database is read-only.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e4665" headers="d12046e4648 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-413B5DE9-FB2A-48BE-B5A0-815DE614E502">Decide Whether to Configure Local or Downstream Capture for the Source Database</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e4665 d12046e4651 ">
                                          <p>This example configures local capture for the source database.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e4674" headers="d12046e4648 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-F691796A-514C-4821-8B7B-BAB0FA45C04E">Decide Whether Changes Are Allowed at One Database or at Multiple Databases</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e4674 d12046e4651 ">
                                          <p>This example configures a replication environment that allows changes only at the source database.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e4683" headers="d12046e4648 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-B51FFB8D-AB92-4B36-9648-F58262282F9B">Decide Whether the Replication Environment Will Have Nonidentical Replicas</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e4683 d12046e4651 ">
                                          <p>This example configures identical shared database objects at the databases.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e4692" headers="d12046e4648 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-7078844B-E2BE-48F5-8117-69B4F999FA73">Decide Whether the Replication Environment Will Use Apply Handlers</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e4692 d12046e4651 ">
                                          <p>This example does not configure apply handlers.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e4701" headers="d12046e4648 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-A9E8F02F-F101-4A22-A252-C6A9DC400CE8">Decide Whether to Maintain DDL Changes</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e4701 d12046e4651 ">
                                          <p>This example maintains DDL changes for a subset of the shared database objects.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e4710" headers="d12046e4648 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-0C7BB255-A828-4089-B624-41201F1E18D0">Decide How to Configure the Replication Environment</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e4710 d12046e4651 ">
                                          <p>This example uses the <code class="codeph">MAINTAIN_TABLES</code> procedure to configure the environment.
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                           <p>The replication environment maintains the following DML and DDL changes for the shared database objects:</p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>The replication environment will maintain DML changes to the following tables in the <code class="codeph">hr</code> schema:
                                 </p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p><code class="codeph">departments</code></p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">employees</code></p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">countries</code></p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">regions</code></p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">locations</code></p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">jobs</code></p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">job_history</code></p>
                                    </li>
                                 </ul>
                              </li>
                              <li>
                                 <p>The replication environment will maintain DDL changes to the following tables in the <code class="codeph">hr</code> schema:
                                 </p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p><code class="codeph">departments</code></p>
                                    </li>
                                    <li>
                                       <p><code class="codeph">employees</code></p>
                                    </li>
                                 </ul>
                              </li>
                           </ul>
                           <p>The replication environment does not maintain DDL changes to the following tables in the <code class="codeph">hr</code> schema:
                           </p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><code class="codeph">countries</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">regions</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">locations</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">jobs</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">job_history</code></p>
                              </li>
                           </ul>
                           <p>In this example, the <code class="codeph">MAINTAIN_TABLES</code> procedure will not configure the replication environment directly. Instead, a configuration script will be generated, and this script will be modified so that DDL changes to the following tables are maintained: <code class="codeph">departments</code> and <code class="codeph">employees</code>. A Data Pump network import instantiation will be performed.
                           </p>
                           <p>Ensure that you do not try to replicate tables that are not supported by Oracle Streams.</p>
                           <p><a href="simple-oracle-streams-replication-configuration.html#GUID-8B059D8D-E68A-44C9-AEBE-597FEEB488EC__CIAJDEBI">Figure 2-3</a> provides an overview of the replication environment created in this example.
                           </p>
                           <div class="figure" id="GUID-8B059D8D-E68A-44C9-AEBE-597FEEB488EC__CIAJDEBI">
                              <p class="titleinfigure">Figure 2-3 Sample Oracle Streams Environment That Replicates Tables</p><img width="428" src="img/strep051.gif" alt="Description of Figure 2-3 follows" title="Description of Figure 2-3 follows" longdesc="img_text/strep051.html"><br><a href="img_text/strep051.html">Description of "Figure 2-3 Sample Oracle Streams Environment That Replicates Tables"</a></div>
                           <!-- class="figure" -->
                           <div class="infoboxnotealso" id="GUID-8B059D8D-E68A-44C9-AEBE-597FEEB488EC__GUID-6A1A1210-EF64-4813-9671-5DD1E9809C4B">
                              <p class="notep1">See Also:</p>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=STRMS172"><span class="italic">Oracle Streams Concepts and Administration</span></a> for instructions on determining which database objects are not supported by Oracle Streams
                              </p>
                           </div>
                           <p>Complete the following steps to use the <code class="codeph">MAINTAIN_TABLES</code> procedure to configure the environment:
                           </p>
                           <ol>
                              <li>
                                 <p>Complete the required tasks before running the <code class="codeph">MAINTAIN_TABLES</code> procedure. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-BB2E76CA-3645-4469-8750-4B276B8A955B">Tasks to Complete Before Configuring Oracle Streams Replication</a>"</span> for instructions.
                                 </p>
                                 <p>For this configuration, the following tasks must be completed:</p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Configure an Oracle Streams administrator at both databases. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-EF5A403D-42E5-426D-B654-456E634F53B0">Configuring an Oracle Streams Administrator on All Databases</a>"</span>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Configure network connectivity and database links:</p>
                                       <ul style="list-style-type: disc;">
                                          <li>
                                             <p>Configure network connectivity between the source database <code class="codeph">dbs1.example.com</code> and the destination database <code class="codeph">dbs2.example.com</code>.
                                             </p>
                                          </li>
                                          <li>
                                             <p>Create a database link from the source database <code class="codeph">dbs1.example.com</code> to the destination database <code class="codeph">dbs2.example.com</code>.
                                             </p>
                                          </li>
                                          <li>
                                             <p>Because the <code class="codeph">MAINTAIN_TABLES</code> procedure will perform a Data Pump network import instantiation, create a database link from the destination database <code class="codeph">dbs2.example.com</code> to the source database <code class="codeph">dbs1.example.com</code>.
                                             </p>
                                          </li>
                                       </ul>
                                       <p> See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-7867112D-DAC3-4693-811E-B1B1052C7847">Configuring Network Connectivity and Database Links</a>"</span>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Ensure that the source database <code class="codeph">dbs1.example.com</code> is in <code class="codeph">ARCHIVELOG</code> mode. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-93BE3DA2-24EC-491A-811C-E32FD80D7809">Ensuring That Each Source Database Is In ARCHIVELOG Mode</a>"</span>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Ensure that the initialization parameters are set properly at both databases. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-F16B954D-35E0-422C-A89F-D3E170BD4505">Setting Initialization Parameters Relevant to Oracle Streams</a>"</span>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Configure the Oracle Streams pool properly at both databases. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-E572258F-DEB4-4B0B-B29B-D196C7336112">Configuring the Oracle Streams Pool</a>"</span>.
                                       </p>
                                    </li>
                                 </ul>
                              </li>
                              <li>
                                 <p>Create a script directory object at the source database. This example assumes that this directory object is <code class="codeph">script_directory</code>.
                                 </p>
                                 <p>See <span class="q">"<a href="simple-oracle-streams-replication-configuration.html#GUID-6D874F68-7DE5-4987-8AEC-B0099BF3ED26">Creating the Required Directory Objects</a>"</span> for instructions.
                                 </p>
                              </li>
                              <li>
                                 <p>In SQL*Plus, connect to the source database <code class="codeph">dbs1.example.com</code> as the Oracle Streams administrator.
                                 </p>
                                 <p>See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ADMIN00102"><span class="italic">Oracle Database Administrator's Guide</span></a> for instructions about connecting to a database in SQL*Plus.
                                 </p>
                              </li>
                              <li>
                                 <p>Run the <code class="codeph">MAINTAIN_TABLES</code> procedure:
                                 </p><pre class="oac_no_warn" dir="ltr">DECLARE
  tables DBMS_UTILITY.UNCL_ARRAY;
  BEGIN
    tables(1) := 'hr.departments';
    tables(2) := 'hr.employees';
    tables(3) := 'hr.countries';
    tables(4) := 'hr.regions';
    tables(5) := 'hr.locations';
    tables(6) := 'hr.jobs';
    tables(7) := 'hr.job_history';
    DBMS_STREAMS_ADM.MAINTAIN_TABLES(
      table_names                  =&gt; tables,
      source_directory_object      =&gt; NULL,
      destination_directory_object =&gt; NULL,
      source_database              =&gt; 'dbs1.example.com',
      destination_database         =&gt; 'dbs2.example.com',
      perform_actions              =&gt; FALSE,
      script_name                  =&gt; 'configure_rep.sql',
      script_directory_object      =&gt; 'script_directory',
      bi_directional               =&gt; FALSE,
      include_ddl                  =&gt; FALSE,
      instantiation      =&gt; DBMS_STREAMS_ADM.INSTANTIATION_TABLE_NETWORK);
END;
/
</pre><p>The <code class="codeph">configure_rep.sql</code> script generated by the procedure uses default values for the parameters that are not specified in the procedure call. The script uses system-generated names for the <code class="codeph">ANYDATA</code> queues, queue tables, capture process, propagation, and apply process it creates. You can specify different names by using additional parameters available in the <code class="codeph">MAINTAIN_TABLES</code> procedure. Notice that the <code class="codeph">include_ddl</code> parameter is set to <code class="codeph">FALSE</code>. Therefore, the script does not configure the replication environment to maintain DDL changes to the tables.
                                 </p>
                                 <p>The procedure does not specify the <code class="codeph">apply_name</code> parameter. Therefore, the default, <code class="codeph">NULL</code>, is specified for this parameter. When the <code class="codeph">apply_name</code> parameter is set to <code class="codeph">NULL</code>, no apply process that applies changes from the source database can exist on the destination database. If an apply process that applies changes from the source database exists at the destination database, then specify a non-<code class="codeph">NULL</code> value for the <code class="codeph">apply_name</code> parameter.
                                 </p>
                              </li>
                              <li>
                                 <p>Modify the <code class="codeph">configure_rep.sql</code> script:
                                 </p>
                                 <ol type="a">
                                    <li>
                                       <p>Navigate to the directory that corresponds with the <code class="codeph">script_directory</code> directory object on the computer system running the source database.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Open the <code class="codeph">configure_rep.sql</code> script in a text editor. Consider making a backup of this script before modifying it.
                                       </p>
                                    </li>
                                    <li id="GUID-8B059D8D-E68A-44C9-AEBE-597FEEB488EC__CACIHCBI">
                                       <p>In the script, find the <code class="codeph">ADD_TABLE_RULES</code> and <code class="codeph">ADD_TABLE_PROPAGATION_RULES</code> procedure calls that create the table rules for the <code class="codeph">hr.departments</code> and <code class="codeph">hr.employees</code> tables. For example, the procedure calls for the capture process look similar to the following:
                                       </p><pre class="oac_no_warn" dir="ltr">dbms_streams_adm.add_table_rules(
    table_name =&gt; '"HR"."DEPARTMENTS"', 
    streams_type =&gt; 'CAPTURE', 
    streams_name =&gt; '"DBS1$CAP"', 
    queue_name =&gt; '"STRMADMIN"."DBS1$CAPQ"', 
    include_dml =&gt; TRUE,
    <span class="bold">include_ddl =&gt; FALSE,</span>
    include_tagged_lcr =&gt; TRUE,
    source_database =&gt; 'DBS1.EXAMPLE.COM', 
    inclusion_rule =&gt; TRUE,
    and_condition =&gt; get_compatible);

dbms_streams_adm.add_table_rules(
    table_name =&gt; '"HR"."EMPLOYEES"', 
    streams_type =&gt; 'CAPTURE', 
    streams_name =&gt; '"DBS1$CAP"', 
    queue_name =&gt; '"STRMADMIN"."DBS1$CAPQ"', 
    include_dml =&gt; TRUE,
    <span class="bold">include_ddl =&gt; FALSE,</span>
    include_tagged_lcr =&gt; TRUE,
    source_database =&gt; 'DBS1.EXAMPLE.COM', 
    inclusion_rule =&gt; TRUE,
    and_condition =&gt; get_compatible);
</pre></li>
                                    <li>
                                       <p>In the procedure calls that you found in Step <a href="simple-oracle-streams-replication-configuration.html#GUID-8B059D8D-E68A-44C9-AEBE-597FEEB488EC__CACIHCBI">5.c</a>, change the setting of the <code class="codeph">include_ddl</code> parameter to <code class="codeph">TRUE</code>. For example, the procedure calls for the capture process should look similar to the following after the modification:
                                       </p><pre class="oac_no_warn" dir="ltr">dbms_streams_adm.add_table_rules(
    table_name =&gt; '"HR"."DEPARTMENTS"', 
    streams_type =&gt; 'CAPTURE', 
    streams_name =&gt; '"DBS1$CAP"', 
    queue_name =&gt; '"STRMADMIN"."DBS1$CAPQ"', 
    include_dml =&gt; TRUE,
    <span class="bold">include_ddl =&gt; TRUE,</span>
    include_tagged_lcr =&gt; TRUE,
    source_database =&gt; 'DBS1.EXAMPLE.COM', 
    inclusion_rule =&gt; TRUE,
    and_condition =&gt; get_compatible);

dbms_streams_adm.add_table_rules(
    table_name =&gt; '"HR"."EMPLOYEES"', 
    streams_type =&gt; 'CAPTURE', 
    streams_name =&gt; '"DBS1$CAP"', 
    queue_name =&gt; '"STRMADMIN"."DBS1$CAPQ"', 
    include_dml =&gt; TRUE,
    <span class="bold">include_ddl =&gt; TRUE,</span>
    include_tagged_lcr =&gt; TRUE,
    source_database =&gt; 'DBS1.EXAMPLE.COM', 
    inclusion_rule =&gt; TRUE,
    and_condition =&gt; get_compatible);
</pre><p>Remember to change the procedure calls for all capture processes, propagations, and apply processes.</p>
                                    </li>
                                    <li>
                                       <p>Save and close the <code class="codeph">configure_rep.sql</code> script.
                                       </p>
                                    </li>
                                 </ol>
                              </li>
                              <li>
                                 <p>In SQL*Plus, connect to the source database <code class="codeph">dbs1.example.com</code> as the Oracle Streams administrator.
                                 </p>
                              </li>
                              <li>
                                 <p>At the source database, run the configuration script:</p><pre class="oac_no_warn" dir="ltr">SET ECHO ON
SPOOL configure_rep.out
@configure_rep.sql
</pre><p>The script prompts you to supply information about the database names and the Oracle Streams administrators. When this configuration script completes, the Oracle Streams single-source replication environment is configured. The script also starts the queues, capture process, propagations, and apply process.</p>
                              </li>
                           </ol>
                           <p>The resulting single-source replication environment has the following characteristics:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>At the source database, supplemental logging is configured for the shared database objects.</p>
                              </li>
                              <li>
                                 <p>The source database <code class="codeph">dbs1.example.com</code> has a queue and queue table with system-generated names.
                                 </p>
                              </li>
                              <li>
                                 <p>The destination database <code class="codeph">dbs2.example.com</code> has a queue and queue table with system-generated names.
                                 </p>
                              </li>
                              <li>
                                 <p>At the source database, a capture process with a system-generated name captures DML changes to all of the tables in the <code class="codeph">hr</code> schema and DDL changes to the <code class="codeph">hr.departments</code> and <code class="codeph">hr.employees</code> tables.
                                 </p>
                              </li>
                              <li>
                                 <p>A propagation running on the source database with a system-generated name sends the captured changes from the queue at the source database to the queue at the destination database.</p>
                              </li>
                              <li>
                                 <p>At the destination database, an apply process with a system-generated name dequeues the changes from the queue and applies them to the tables at the destination database.</p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="STREP601"></a><div class="props_rev_3"><a id="GUID-F2027D09-D92B-4975-A5CA-4E258AF7B4CC" name="GUID-F2027D09-D92B-4975-A5CA-4E258AF7B4CC"></a><h4 id="STREP-GUID-F2027D09-D92B-4975-A5CA-4E258AF7B4CC" class="sect4"><span class="enumeration_section">2.2.5 </span>Examples That Configure Two-Database Replication with Downstream Capture
                  </h4>
                  <div>
                     <p>Each of the following examples configures a two-database replication environment that uses a downstream capture process:</p>
                     <ul style="list-style-type: disc;">
                        <li>
                           <p><a href="simple-oracle-streams-replication-configuration.html#GUID-000236AE-CD25-4ED8-BA07-E9D545C5A17D">Configuring Tablespace Replication with Downstream Capture at Destination</a></p>
                        </li>
                        <li>
                           <p><a href="simple-oracle-streams-replication-configuration.html#GUID-C871DAC3-F840-48DC-83C4-EA11CE4A220D">Configuring Schema Replication with Downstream Capture at Destination</a></p>
                        </li>
                        <li>
                           <p><a href="simple-oracle-streams-replication-configuration.html#GUID-59E31770-9AA5-41E1-B1EB-CA92ADA85E6C">Configuring Schema Replication with Downstream Capture at Third Database</a></p>
                        </li>
                     </ul>
                  </div><a id="STREP268"></a><a id="STREP267"></a><div class="props_rev_3"><a id="GUID-000236AE-CD25-4ED8-BA07-E9D545C5A17D" name="GUID-000236AE-CD25-4ED8-BA07-E9D545C5A17D"></a><h5 id="STREP-GUID-000236AE-CD25-4ED8-BA07-E9D545C5A17D" class="sect5"><span class="enumeration_section">2.2.5.1 </span>Configuring Tablespace Replication with Downstream Capture at Destination
                     </h5>
                     <div>
                        <div class="section">
                           <p>You can use the following procedures in the <code class="codeph">DBMS_STREAMS_ADM</code> package to configure tablespace replication:
                           </p>
                        </div>
                        <!-- class="section" -->
                        <div class="section">
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS863"><code class="codeph">MAINTAIN_SIMPLE_TTS</code></a></p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS864"><code class="codeph">MAINTAIN_TTS</code></a></p>
                              </li>
                              <li>
                                 <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS831"><code class="codeph">PRE_INSTANTIATION_SETUP</code></a> and <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS830"><code class="codeph">POST_INSTANTIATION_SETUP</code></a></p>
                              </li>
                           </ul>
                           <p>You can use the <code class="codeph">MAINTAIN_SIMPLE_TTS</code> procedure to configure Oracle Streams replication for a simple tablespace, and you can use the <code class="codeph">MAINTAIN_TTS</code> procedure to configure Oracle Streams replication for a set of self-contained tablespaces. These procedures use transportable tablespaces, Data Pump, the <code class="codeph">DBMS_STREAMS_TABLESPACE_ADM</code> package, and the <code class="codeph">DBMS_FILE_TRANSFER</code> package to configure the environment.
                           </p>
                           <p>A self-contained tablespace has no references from the tablespace pointing outside of the tablespace. For example, if an index in the tablespace is for a table in a different tablespace, then the tablespace is not self-contained. A simple tablespace is a self-contained tablespace that uses only one data file. When there are multiple tablespaces in a tablespace set, a self-contained tablespace set has no references from inside the set of tablespaces pointing outside of the set of tablespaces.</p>
                           <p>These procedures clone the tablespace or tablespaces being configured for replication from the source database to the destination database. The <code class="codeph">MAINTAIN_SIMPLE_TTS</code> procedure uses the <code class="codeph">CLONE_SIMPLE_TABLESPACE</code> procedure in the <code class="codeph">DBMS_STREAMS_TABLESPACE_ADM</code> package, and the <code class="codeph">MAINTAIN_TTS</code> procedure uses the <code class="codeph">CLONE_TABLESPACES</code> procedure in the <code class="codeph">DBMS_STREAMS_TABLESPACE_ADM</code> package. When a tablespace is cloned, it is made read-only automatically until the clone operation is complete.
                           </p>
                           <p>The example in this section uses the <code class="codeph">MAINTAIN_TTS</code> procedure to configure an Oracle Streams replication environment that maintains the following tablespaces using Oracle Streams:
                           </p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p><code class="codeph">tbs1</code></p>
                              </li>
                              <li>
                                 <p><code class="codeph">tbs2</code></p>
                              </li>
                           </ul>
                           <p>The source database is <code class="codeph">dbs1.example.com</code>, and the destination database is <code class="codeph">dbs2.example.com</code>.
                           </p>
                           <p>The following table lists the decisions that were made about the Oracle Streams replication environment configured in this example.</p>
                           <div class="tblformal" id="GUID-000236AE-CD25-4ED8-BA07-E9D545C5A17D__GUID-71B54628-EDE0-4FCD-9EB5-1E3475BCFE6F">
                              <table cellpadding="4" cellspacing="0" class="Formal" title="" summary="This table lists the decision made for the example in this section." width="100%" frame="hsides" border="1" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" width="50%" id="d12046e5484">Decision</th>
                                       <th align="left" valign="bottom" width="50%" id="d12046e5487">Assumption for This Example</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e5492" headers="d12046e5484 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-9EBD9C47-B328-4740-B1CA-3066B5A9EFD6">Decide Which Type of Replication Environment to Configure</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e5492 d12046e5487 ">
                                          <p>This example configures one-way replication in a two database environment where the source database is read/write and the destination database is read-only.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e5501" headers="d12046e5484 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-413B5DE9-FB2A-48BE-B5A0-815DE614E502">Decide Whether to Configure Local or Downstream Capture for the Source Database</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e5501 d12046e5487 ">
                                          <p>This example configures a downstream capture process running on the destination database (<code class="codeph">dbs2.example.com</code>) that captures changes made to the source database (<code class="codeph">dbs1.example.com</code>). The downstream capture process will be an archived-log downstream capture process.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e5516" headers="d12046e5484 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-F691796A-514C-4821-8B7B-BAB0FA45C04E">Decide Whether Changes Are Allowed at One Database or at Multiple Databases</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e5516 d12046e5487 ">
                                          <p>This example configures a replication environment that allows changes only at the source database.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e5525" headers="d12046e5484 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-B51FFB8D-AB92-4B36-9648-F58262282F9B">Decide Whether the Replication Environment Will Have Nonidentical Replicas</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e5525 d12046e5487 ">
                                          <p>This example configures identical shared database objects at the databases.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e5534" headers="d12046e5484 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-7078844B-E2BE-48F5-8117-69B4F999FA73">Decide Whether the Replication Environment Will Use Apply Handlers</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e5534 d12046e5487 ">
                                          <p>This example does not configure apply handlers.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e5543" headers="d12046e5484 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-A9E8F02F-F101-4A22-A252-C6A9DC400CE8">Decide Whether to Maintain DDL Changes</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e5543 d12046e5487 ">
                                          <p>This example maintains DDL changes to the tablespaces and the database objects in the tablespaces.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e5552" headers="d12046e5484 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-0C7BB255-A828-4089-B624-41201F1E18D0">Decide How to Configure the Replication Environment</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e5552 d12046e5487 ">
                                          <p>This example uses the <code class="codeph">MAINTAIN_TTS</code> procedure to configure the environment.
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                           <p>In this example, the <code class="codeph">MAINTAIN_TTS</code> procedure will configure the replication environment directly. A configuration script will not be generated. In addition, this example makes the following assumptions:
                           </p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>The tablespaces <code class="codeph">tbs1</code> and <code class="codeph">tbs2</code> make a self-contained tablespace set at the source database <code class="codeph">dbs1.example.com</code>.
                                 </p>
                              </li>
                              <li>
                                 <p>The data files for the tablespace set are both in the <code class="codeph">/orc/dbs</code> directory at the source database <code class="codeph">dbs1.example.com</code>.
                                 </p>
                              </li>
                              <li>
                                 <p>The <code class="codeph">dbs2.example.com</code> database does not contain the tablespace set currently.
                                 </p>
                              </li>
                           </ul>
                           <p>The <code class="codeph">MAINTAIN_SIMPLE_TTS</code> and <code class="codeph">MAINTAIN_TTS</code> procedures automatically exclude database objects that are not supported by Oracle Streams from the replication environment by adding rules to the negative rule set of each capture and apply process. The <code class="codeph">PRE_INSTANTIATION_SETUP</code> and <code class="codeph">POST_INSTANTIATION_SETUP</code> procedures enable you to specify which database objects to exclude from the replication environment.
                           </p>
                           <p>Query the <code class="codeph">DBA_STREAMS_UNSUPPORTED</code> data dictionary view to determine which database objects are not supported by Oracle Streams. If unsupported database objects are not excluded, then capture errors will result.
                           </p>
                           <p><a href="simple-oracle-streams-replication-configuration.html#GUID-000236AE-CD25-4ED8-BA07-E9D545C5A17D__CIACHFGI">Figure 2-4</a> provides an overview of the replication environment created in this example.
                           </p>
                           <div class="figure" id="GUID-000236AE-CD25-4ED8-BA07-E9D545C5A17D__CIACHFGI">
                              <p class="titleinfigure">Figure 2-4 Sample Oracle Streams Environment That Replicates Tablespaces</p><img width="445" src="img/strep049.gif" alt="Description of Figure 2-4 follows" title="Description of Figure 2-4 follows" longdesc="img_text/strep049.html"><br><a href="img_text/strep049.html">Description of "Figure 2-4 Sample Oracle Streams Environment That Replicates Tablespaces"</a></div>
                           <!-- class="figure" -->
                           <div class="infoboxnotealso" id="GUID-000236AE-CD25-4ED8-BA07-E9D545C5A17D__GUID-E9E70198-7260-4D15-A1CF-085BA27DBE4D">
                              <p class="notep1">See Also:</p>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=STRMS172"><span class="italic">Oracle Streams Concepts and Administration</span></a> for instructions on determining which database objects are not supported by Oracle Streams
                              </p>
                           </div>
                           <p>Complete the following steps to use the <code class="codeph">MAINTAIN_TTS</code> procedure to configure the environment:
                           </p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Complete the required tasks before running the <code class="codeph">MAINTAIN_TTS</code> procedure. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-BB2E76CA-3645-4469-8750-4B276B8A955B">Tasks to Complete Before Configuring Oracle Streams Replication</a>"</span> for instructions.</span><div>
                                 <p>For this configuration, the following tasks must be completed:</p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Configure an Oracle Streams administrator at both databases. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-EF5A403D-42E5-426D-B654-456E634F53B0">Configuring an Oracle Streams Administrator on All Databases</a>"</span>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Configure network connectivity and database links:</p>
                                       <ul style="list-style-type: disc;">
                                          <li>
                                             <p>Configure network connectivity between the source database <code class="codeph">dbs1.example.com</code> and the destination database <code class="codeph">dbs2.example.com</code>.
                                             </p>
                                          </li>
                                          <li>
                                             <p>Create a database link from the source database <code class="codeph">dbs1.example.com</code> to the destination database <code class="codeph">dbs2.example.com</code>.
                                             </p>
                                          </li>
                                          <li>
                                             <p>Because downstream capture will be configured at the destination database, create a database link from the destination database <code class="codeph">dbs2.example.com</code> to the source database <code class="codeph">dbs1.example.com</code>.
                                             </p>
                                          </li>
                                       </ul>
                                       <p>See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-7867112D-DAC3-4693-811E-B1B1052C7847">Configuring Network Connectivity and Database Links</a>"</span>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Ensure that both databases are in <code class="codeph">ARCHIVELOG</code> mode. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-93BE3DA2-24EC-491A-811C-E32FD80D7809">Ensuring That Each Source Database Is In ARCHIVELOG Mode</a>"</span>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Ensure that the initialization parameters are set properly at both databases. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-F16B954D-35E0-422C-A89F-D3E170BD4505">Setting Initialization Parameters Relevant to Oracle Streams</a>"</span>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Configure the Oracle Streams pool properly at both databases. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-E572258F-DEB4-4B0B-B29B-D196C7336112">Configuring the Oracle Streams Pool</a>"</span>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Because the destination database will be the capture database for changes made to the source database, configure log file copying from the source database <code class="codeph">dbs1.example.com</code> to the destination database <code class="codeph">dbs2.example.com</code>. The capture process will be an archived-log downstream capture process. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-CD6DB455-4D52-4CEF-B680-5A324E36BC5A">Configuring Log File Transfer to a Downstream Capture Database</a>"</span>.
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Create the following required directory objects:</span><div>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>A source directory object at the source database. This example assumes that this directory object is <code class="codeph">source_directory</code>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>A destination directory object at the destination database. This example assumes that this directory object is <code class="codeph">dest_directory</code>.
                                       </p>
                                    </li>
                                 </ul>
                                 <p>See <span class="q">"<a href="simple-oracle-streams-replication-configuration.html#GUID-6D874F68-7DE5-4987-8AEC-B0099BF3ED26">Creating the Required Directory Objects</a>"</span> for instructions.
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>In SQL*Plus, connect to the database that contains the tablespace set as the Oracle Streams administrator. In this example, connect to the <code class="codeph">dbs1.example.com</code> database.</span><div>
                                 <p>See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ADMIN00102"><span class="italic">Oracle Database Administrator's Guide</span></a> for instructions about connecting to a database in SQL*Plus.
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Create a directory object for the directory that contains the data files for the tablespaces in the tablespace set. For example, the following statement creates a directory object named <code class="codeph">tbs_directory</code> that corresponds to the <code class="codeph">/orc/dbs</code> directory:</span><div><pre class="oac_no_warn" dir="ltr">CREATE DIRECTORY tbs_directory AS '/orc/dbs';
</pre><p>If the data files are in multiple directories, then a directory object must exist for each of these directories, and the user who runs the <code class="codeph">MAINTAIN_TTS</code> procedure in Step <a href="simple-oracle-streams-replication-configuration.html#GUID-000236AE-CD25-4ED8-BA07-E9D545C5A17D__i1017815">6</a> must have <code class="codeph">READ</code> privilege on these directory objects. In this example, the Oracle Streams administrator has this privilege because this user creates the directory object.
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>In SQL*Plus, connect to the destination database <code class="codeph">dbs2.example.com</code> as the Oracle Streams administrator.</span></li>
                           <li class="stepexpand" id="GUID-000236AE-CD25-4ED8-BA07-E9D545C5A17D__i1017815"><span>Run the <code class="codeph">MAINTAIN_TTS</code> procedure:</span><div><pre class="oac_no_warn" dir="ltr">DECLARE
  t_names  DBMS_STREAMS_TABLESPACE_ADM.TABLESPACE_SET;
BEGIN
  -- Tablespace names
  t_names(1) := 'TBS1';
  t_names(2) := 'TBS2';
  DBMS_STREAMS_ADM.MAINTAIN_TTS(
     tablespace_names             =&gt; t_names,
     source_directory_object      =&gt; 'source_directory',
     destination_directory_object =&gt; 'dest_directory',
     source_database              =&gt; 'dbs1.example.com',
     destination_database         =&gt; 'dbs2.example.com',
     perform_actions              =&gt; TRUE,
     capture_name                 =&gt; 'capture_tts',
     capture_queue_table          =&gt; 'streams_queue_table',
     capture_queue_name           =&gt; 'streams_queue',
     apply_name                   =&gt; 'apply_tts',
     apply_queue_table            =&gt; 'streams_queue_table',
     apply_queue_name             =&gt; 'streams_queue');
     bi_directional               =&gt; FALSE,
     include_ddl                  =&gt; TRUE);
END;
/
</pre><p>When this procedure completes, the Oracle Streams single-source replication environment is configured.</p>
                                 <p>Because the procedure is run at the destination database, downstream capture is configured at the destination database for changes to the source database. When you use a configuration procedure to configure downstream capture, the parameters that specify the queue and queue table names are important. In such a configuration, it is more efficient for the capture process and apply process to use the same queue at the downstream capture database to avoid propagating changes between queues. To improve efficiency in this sample configuration, notice that <code class="codeph">streams_queue</code> is specified for both the <code class="codeph">capture_queue_name</code> and <code class="codeph">apply_queue_name</code> parameters. Also, <code class="codeph">streams_queue_table</code> is specified for both the <code class="codeph">capture_queue_table</code> and <code class="codeph">apply_queue_table</code> parameters.
                                 </p>
                                 <p>To monitor the progress of the configuration operation, follow the instructions in <span class="q">"<a href="simple-oracle-streams-replication-configuration.html#GUID-7E1E55C3-95FA-4C6C-94B4-2F16E949D67E">Monitoring Oracle Streams Configuration Progress</a>"</span>.
                                 </p>
                                 <p>If this procedure encounters an error and stops, then see <span class="q">"<a href="managing-oracle-streams-replication.html#GUID-52B85E39-2264-47E2-981A-63CA23C7380A">Recovering from Operation Errors</a>"</span> for information about either recovering from the error or rolling back the configuration operation.
                                 </p>
                              </div>
                           </li>
                        </ol>
                        <div class="section">
                           <p>The resulting single-source replication environment has the following characteristics:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Supplemental logging is configured for the shared database objects at the source database <code class="codeph">dbs1.example.com</code>.
                                 </p>
                              </li>
                              <li>
                                 <p>The <code class="codeph">dbs1.example.com</code> database has a queue named <code class="codeph">streams_queue</code> which uses a queue table named <code class="codeph">streams_queue_table</code>. This queue is for the apply process.
                                 </p>
                              </li>
                              <li>
                                 <p>The <code class="codeph">dbs2.example.com</code> database has a queue named <code class="codeph">streams_queue</code> which uses a queue table named <code class="codeph">streams_queue_table</code>. This queue is shared by the downstream capture process and the apply process.
                                 </p>
                              </li>
                              <li>
                                 <p>At the <code class="codeph">dbs2.example.com</code> database, an archived-log downstream capture process named <code class="codeph">capture_tts</code> captures changes made to the source database. Specifically, this downstream capture process captures DML changes made to the tables in the <code class="codeph">tbs1</code> and <code class="codeph">tbs2</code> tablespaces and DDL changes to these tablespaces and the database objects in them.
                                 </p>
                                 <p>If the capture process is not enabled after an inordinately long time, then check the alert log for errors. See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=STRMS1036"><span class="italic">Oracle Streams Concepts and Administration</span></a> for more information.
                                 </p>
                              </li>
                              <li>
                                 <p>At the <code class="codeph">dbs2.example.com</code> database, an apply process named <code class="codeph">apply_tts</code> dequeues the changes from its queue and applies them to the shared database objects.
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="STREP609"></a><a id="STREP602"></a><div class="props_rev_3"><a id="GUID-C871DAC3-F840-48DC-83C4-EA11CE4A220D" name="GUID-C871DAC3-F840-48DC-83C4-EA11CE4A220D"></a><h5 id="STREP-GUID-C871DAC3-F840-48DC-83C4-EA11CE4A220D" class="sect5"><span class="enumeration_section">2.2.5.2 </span>Configuring Schema Replication with Downstream Capture at Destination
                     </h5>
                     <div>
                        <div class="section">
                           <p>This example configures an Oracle Streams replication environment that replicates data manipulation language (DML) changes to all of the tables in the <code class="codeph">hr</code> schema. This example configures a two-database replication environment with a downstream capture process at the destination database. This example uses the global database names <code class="codeph">src.example.com</code> and <code class="codeph">dest.example.com</code>. However, you can substitute databases in your environment to complete the example. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-9EBD9C47-B328-4740-B1CA-3066B5A9EFD6">Decide Which Type of Replication Environment to Configure</a>"</span> for more information about two-database replication environments.
                           </p>
                           <p>In this example, the downstream capture process runs on the destination database <code class="codeph">dest.example.com</code>. Therefore, the resources required to capture changes are freed at the source database <code class="codeph">src.example.com</code>. This example configures a real-time downstream capture process, not an archived-log downstream capture process. The advantage of real-time downstream capture is that it reduces the amount of time required to capture the changes made at the source database. The time is reduced because the real-time downstream capture process does not need to wait for the redo log file to be archived before it can capture data from it.
                           </p>
                           <p>The following table lists the decisions that were made about the Oracle Streams replication environment configured in this example.</p>
                           <div class="tblformal" id="GUID-C871DAC3-F840-48DC-83C4-EA11CE4A220D__GUID-D1C190E1-3046-416B-A25E-2527AA06DFFE">
                              <table cellpadding="4" cellspacing="0" class="Formal" title="" summary="This table lists the decision made for the example in this section." width="100%" frame="hsides" border="1" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" width="50%" id="d12046e6065">Decision</th>
                                       <th align="left" valign="bottom" width="50%" id="d12046e6068">Assumption for This Example</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e6073" headers="d12046e6065 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-9EBD9C47-B328-4740-B1CA-3066B5A9EFD6">Decide Which Type of Replication Environment to Configure</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e6073 d12046e6068 ">
                                          <p>This example configures one-way replication in a two database environment where the source database is read/write and the destination database is read-only.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e6082" headers="d12046e6065 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-413B5DE9-FB2A-48BE-B5A0-815DE614E502">Decide Whether to Configure Local or Downstream Capture for the Source Database</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e6082 d12046e6068 ">
                                          <p>This example configures a downstream capture process running on the destination database (<code class="codeph">dest.example.com</code>) that captures changes made to the source database (<code class="codeph">src.example.com</code>). The downstream capture process will be a real-time downstream capture process.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e6097" headers="d12046e6065 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-F691796A-514C-4821-8B7B-BAB0FA45C04E">Decide Whether Changes Are Allowed at One Database or at Multiple Databases</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e6097 d12046e6068 ">
                                          <p>This example configures a replication environment that allows changes only at the source database.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e6106" headers="d12046e6065 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-B51FFB8D-AB92-4B36-9648-F58262282F9B">Decide Whether the Replication Environment Will Have Nonidentical Replicas</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e6106 d12046e6068 ">
                                          <p>This example configures identical shared database objects at the databases.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e6115" headers="d12046e6065 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-7078844B-E2BE-48F5-8117-69B4F999FA73">Decide Whether the Replication Environment Will Use Apply Handlers</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e6115 d12046e6068 ">
                                          <p>This example does not configure apply handlers.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e6124" headers="d12046e6065 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-A9E8F02F-F101-4A22-A252-C6A9DC400CE8">Decide Whether to Maintain DDL Changes</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e6124 d12046e6068 ">
                                          <p>This example maintains DDL changes to the tablespaces and the database objects in the tablespaces.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e6133" headers="d12046e6065 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-0C7BB255-A828-4089-B624-41201F1E18D0">Decide How to Configure the Replication Environment</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e6133 d12046e6068 ">
                                          <p>This example uses the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure to configure the environment.
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                           <p>The database objects being configured for replication might or might not exist at the destination database when you run the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure. If the database objects do not exist at the destination database, then the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure instantiates them at the destination database using a Data Pump export/import. During instantiation, the instantiation SCN is set for these database objects. If the database objects already exist at the destination database, then the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure retains the existing database objects and sets the instantiation SCN for them. In this example, the <code class="codeph">hr</code> schema exists at both the <code class="codeph">src.example.com</code> database and the <code class="codeph">dest.example.com</code> database before the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure is run.
                           </p>
                           <p>In this example, the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure will configure the replication environment directly. A configuration script will not be generated. A Data Pump export dump file instantiation will be performed.
                           </p>
                           <p><a href="simple-oracle-streams-replication-configuration.html#GUID-C871DAC3-F840-48DC-83C4-EA11CE4A220D__CIAEAAEE">Figure 2-5</a> provides an overview of the environment created in this example.
                           </p>
                           <div class="figure" id="GUID-C871DAC3-F840-48DC-83C4-EA11CE4A220D__CIAEAAEE">
                              <p class="titleinfigure">Figure 2-5 Two-Database Replication Environment with a Downstream Capture Process</p><img width="447" src="img/strep506.gif" alt="Description of Figure 2-5 follows" title="Description of Figure 2-5 follows" longdesc="img_text/strep506.html"><br><a href="img_text/strep506.html">Description of "Figure 2-5 Two-Database Replication Environment with a Downstream Capture Process"</a></div>
                           <!-- class="figure" -->
                           <p>Complete the following steps to use the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure to configure the environment:
                           </p>
                           <ol>
                              <li>
                                 <p>Complete the following tasks to prepare for the two-database replication environment:</p>
                                 <ol type="a">
                                    <li>
                                       <p>Configure network connectivity so that the <code class="codeph">src.example.com</code> database and the <code class="codeph">dest.example.com</code> database can communicate with each other.
                                       </p>
                                       <p>See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ADMQS004"><span class="italic">Oracle Database 2 Day DBA</span></a> for information about configuring network connectivity between databases.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Configure an Oracle Streams administrator at each database that will participate in the replication environment. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-EF5A403D-42E5-426D-B654-456E634F53B0">Configuring an Oracle Streams Administrator on All Databases</a>"</span> for instructions. This example assumes that the Oracle Streams administrator is <code class="codeph">strmadmin</code>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Create a database link from the source database to the destination database and from the destination database to the source database. In this example, create the following database links:</p>
                                       <ul style="list-style-type: disc;">
                                          <li>
                                             <p>From the <code class="codeph">src.example.com</code> database to the <code class="codeph">dest.example.com</code> database. Both the name and the service name of the database link must be <code class="codeph">dest.example.com</code>.
                                             </p>
                                          </li>
                                          <li>
                                             <p>From the <code class="codeph">dest.example.com</code> database to the <code class="codeph">src.example.com</code> database. Both the name and the service name of the database link must be <code class="codeph">src.example.com</code>.
                                             </p>
                                          </li>
                                       </ul>
                                       <p>The database link from the <code class="codeph">dest.example.com</code> database to the <code class="codeph">src.example.com</code> database is necessary because the <code class="codeph">src.example.com</code> database is the source database for the downstream capture process at the <code class="codeph">dest.example.com</code> database. This database link simplifies the creation and configuration of the capture process.
                                       </p>
                                       <p>Each database link should be created in the Oracle Streams administrator's schema. Also, each database link should connect to the Oracle Streams administrator at the other database. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-7867112D-DAC3-4693-811E-B1B1052C7847">Configuring Network Connectivity and Database Links</a>"</span> for instructions.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Set initialization parameters properly at each database that will participate in the Oracle Streams replication environment. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-F16B954D-35E0-422C-A89F-D3E170BD4505">Setting Initialization Parameters Relevant to Oracle Streams</a>"</span> for instructions.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Configure both databases to run in <code class="codeph">ARCHIVELOG</code> mode. For a downstream capture process to capture changes generated at a source database, both the source database and the downstream capture database must be running in <code class="codeph">ARCHIVELOG</code> mode. In this example, the <code class="codeph">src.example.com</code> and <code class="codeph">dest.example.com</code> databases must be running in <code class="codeph">ARCHIVELOG</code> mode. See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ADMIN008"><span class="italic">Oracle Database Administrator's Guide</span></a> for information about configuring a database to run in <code class="codeph">ARCHIVELOG</code> mode.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Because the destination database (<code class="codeph">dest.example.com</code>) will be the capture database for changes made to the source database, configure log file copying from the source database <code class="codeph">src.example.com</code> to the destination database <code class="codeph">dest.example.com</code>. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-CD6DB455-4D52-4CEF-B680-5A324E36BC5A">Configuring Log File Transfer to a Downstream Capture Database</a>"</span>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Because this example configures a real-time downstream capture process, add standby redo logs at the downstream database. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-4330E6AC-490D-438C-8A9D-D49DC7321BEE">Adding Standby Redo Logs for Real-Time Downstream Capture</a>"</span>.
                                       </p>
                                    </li>
                                 </ol>
                              </li>
                              <li>
                                 <p>Create the following required directory objects:</p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>A source directory object at the source database. This example assumes that this directory object is <code class="codeph">source_directory</code>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>A destination directory object at the destination database. This example assumes that this directory object is <code class="codeph">dest_directory</code>.
                                       </p>
                                    </li>
                                 </ul>
                                 <p>See <span class="q">"<a href="simple-oracle-streams-replication-configuration.html#GUID-6D874F68-7DE5-4987-8AEC-B0099BF3ED26">Creating the Required Directory Objects</a>"</span> for instructions.
                                 </p>
                              </li>
                              <li>
                                 <p>In SQL*Plus, connect to the <code class="codeph">dest.example.com</code> database as the Oracle Streams administrator.
                                 </p>
                                 <p>See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ADMIN00102"><span class="italic">Oracle Database Administrator's Guide</span></a> for information about connecting to a database in SQL*Plus.
                                 </p>
                              </li>
                              <li>
                                 <p>While still connected to the <code class="codeph">dest.example.com</code> database as the Oracle Streams administrator, run the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure to configure replication between the <code class="codeph">src.example.com</code> database and the <code class="codeph">dest.example.com</code> database:
                                 </p><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_STREAMS_ADM.MAINTAIN_SCHEMAS(
    schema_names                 =&gt; 'hr',
    source_directory_object      =&gt; 'source_directory',
    destination_directory_object =&gt; 'dest_directory',
    source_database              =&gt; 'src.example.com',
    destination_database         =&gt; 'dest.example.com',
    capture_name                 =&gt; 'capture',
    capture_queue_table          =&gt; 'streams_queue_qt',
    capture_queue_name           =&gt; 'streams_queue',
    apply_name                   =&gt; 'apply',
    apply_queue_table            =&gt; 'streams_queue_qt',
    apply_queue_name             =&gt; 'streams_queue');
END;
/
</pre><p>The <code class="codeph">MAINTAIN_SCHEMAS</code> procedure can take some time to run because it is performing many configuration tasks. Do not allow data manipulation language (DML) or data definition language (DDL) changes to the replicated database objects at the destination database while the procedure is running. 
                                 </p>
                                 <p>In the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure, only the following parameters are required: <code class="codeph">schema_names</code>, <code class="codeph">source_directory_object</code>, <code class="codeph">destination_directory_object</code>, <code class="codeph">source_database</code>, and <code class="codeph">destination_database</code>.
                                 </p>
                                 <p>This example specifies the other parameters to show that you can choose the name for the capture process, capture process's queue table, capture process's queue, apply process, apply process's queue table, and apply process's queue. If you do not specify these parameters, then system-generated names are used. </p>
                                 <p>When you use a configuration procedure to configure downstream capture, the parameters that specify the queue and queue table names are important. In such a configuration, it is more efficient for the capture process and apply process to use the same queue at the downstream capture database to avoid propagating changes between queues. To improve efficiency in this sample configuration, notice that <code class="codeph">streams_queue</code> is specified for both the <code class="codeph">capture_queue_name</code> and <code class="codeph">apply_queue_name</code> parameters. Also, <code class="codeph">streams_queue_qt</code> is specified for both the <code class="codeph">capture_queue_table</code> and <code class="codeph">apply_queue_table</code> parameters.
                                 </p>
                                 <p>When a configuration procedure is run, information about its progress is recorded in the following data dictionary views: <code class="codeph">DBA_RECOVERABLE_SCRIPT</code>, <code class="codeph">DBA_RECOVERABLE_SCRIPT_PARAMS</code>, <code class="codeph">DBA_RECOVERABLE_SCRIPT_BLOCKS</code>, and <code class="codeph">DBA_RECOVERABLE_SCRIPT_ERRORS</code>. If the procedure stops because it encounters an error, then see <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=STREP149"><span class="italic">Oracle Streams Replication Administrator's Guide</span></a> for instructions about using the <code class="codeph">RECOVER_OPERATION</code> procedure in the <code class="codeph">DBMS_STREAMS_ADM</code> package to recover from these errors.
                                 </p>
                                 <p>Wait until the procedure completes successfully before proceeding to the next step.</p>
                              </li>
                              <li>
                                 <p>While still connected to the <code class="codeph">dest.example.com</code> database as the Oracle Streams administrator, set the <code class="codeph">downstream_real_time_mine</code> capture process parameter to <code class="codeph">Y</code>:
                                 </p><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_CAPTURE_ADM.SET_PARAMETER(
    capture_name =&gt; 'capture',
    parameter    =&gt; 'downstream_real_time_mine',
    value        =&gt; 'Y');
END;
/
</pre></li>
                              <li>
                                 <p>In SQL*Plus, connect to the source database <code class="codeph">src.example.com</code> as an administrative user.
                                 </p>
                              </li>
                              <li>
                                 <p>Archive the current log file at the source database:</p><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM ARCHIVE LOG CURRENT;
</pre><p>Archiving the current log file at the source database starts real-time mining of the source database redo log.</p>
                                 <p>If the capture process appears to be waiting for redo data for an inordinately long time, then check the alert log for errors. See <a href="../strms/troubleshooting-implicit-capture.html#STRMS1036"><span class="italic">Oracle Streams Concepts and Administration</span></a> for more information.
                                 </p>
                              </li>
                           </ol>
                           <div class="infoboxnotealso" id="GUID-C871DAC3-F840-48DC-83C4-EA11CE4A220D__GUID-DD79C828-8FA1-4EFB-96AA-E0D18C5F66AC">
                              <p class="notep1">See Also:</p>
                              <p>The Oracle Enterprise Manager Cloud Control online help for an example that configures this replication environment using Oracle Enterprise Manager Cloud Control</p>
                           </div>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div><a id="STREP270"></a><a id="STREP269"></a><div class="props_rev_3"><a id="GUID-59E31770-9AA5-41E1-B1EB-CA92ADA85E6C" name="GUID-59E31770-9AA5-41E1-B1EB-CA92ADA85E6C"></a><h5 id="STREP-GUID-59E31770-9AA5-41E1-B1EB-CA92ADA85E6C" class="sect5"><span class="enumeration_section">2.2.5.3 </span>Configuring Schema Replication with Downstream Capture at Third Database
                     </h5>
                     <div>
                        <div class="section">
                           <p>You can use the <a href="../arpls/DBMS_STREAMS_ADM.html#ARPLS826"><code class="codeph">MAINTAIN_SCHEMAS</code></a> procedure in the <code class="codeph">DBMS_STREAMS_ADM</code> package to configure schema replication. The example in this section uses this procedure to configure an Oracle Streams replication environment that maintains the <code class="codeph">hr</code> schema. The source database is <code class="codeph">dbs1.example.com</code>, and the destination database is <code class="codeph">dbs3.example.com</code>.
                           </p>
                           <p>The following table lists the decisions that were made about the Oracle Streams replication environment configured in this example.</p>
                           <div class="tblformal" id="GUID-59E31770-9AA5-41E1-B1EB-CA92ADA85E6C__GUID-1C942392-7190-48A3-A41F-8D1E1232C52F">
                              <table cellpadding="4" cellspacing="0" class="Formal" title="" summary="This table lists the decision made for the example in this section." width="100%" frame="hsides" border="1" rules="rows">
                                 <thead>
                                    <tr align="left" valign="top">
                                       <th align="left" valign="bottom" width="50%" id="d12046e6638">Decision</th>
                                       <th align="left" valign="bottom" width="50%" id="d12046e6641">Assumption for This Example</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e6646" headers="d12046e6638 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-9EBD9C47-B328-4740-B1CA-3066B5A9EFD6">Decide Which Type of Replication Environment to Configure</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e6646 d12046e6641 ">
                                          <p>This example configures bi-directional replication in a two database environment where both databases are read/write.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e6655" headers="d12046e6638 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-413B5DE9-FB2A-48BE-B5A0-815DE614E502">Decide Whether to Configure Local or Downstream Capture for the Source Database</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e6655 d12046e6641 ">
                                          <p>This example configures a downstream capture process running on a third database named <code class="codeph">dbs2.example.com</code> that captures changes made to the source database (<code class="codeph">dbs1.example.com</code>), and a propagation at <code class="codeph">dbs2.example.com</code> will propagate these captured changes to the destination database (<code class="codeph">dbs3.example.com</code>). The downstream capture process will be a real-time downstream capture process.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e6676" headers="d12046e6638 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-F691796A-514C-4821-8B7B-BAB0FA45C04E">Decide Whether Changes Are Allowed at One Database or at Multiple Databases</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e6676 d12046e6641 ">
                                          <p>This example configures a replication environment that allows changes to the replicated database objects at both databases.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e6685" headers="d12046e6638 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-B51FFB8D-AB92-4B36-9648-F58262282F9B">Decide Whether the Replication Environment Will Have Nonidentical Replicas</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e6685 d12046e6641 ">
                                          <p>This example configures identical shared database objects at the databases.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e6694" headers="d12046e6638 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-7078844B-E2BE-48F5-8117-69B4F999FA73">Decide Whether the Replication Environment Will Use Apply Handlers</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e6694 d12046e6641 ">
                                          <p>This example does not configure apply handlers.</p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e6703" headers="d12046e6638 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-A9E8F02F-F101-4A22-A252-C6A9DC400CE8">Decide Whether to Maintain DDL Changes</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e6703 d12046e6641 ">
                                          <p>This example maintains DDL changes to <code class="codeph">hr</code> schema and the database objects in the <code class="codeph">hr</code> schema will be maintained.
                                          </p>
                                       </td>
                                    </tr>
                                    <tr align="left" valign="top">
                                       <td align="left" valign="top" width="50%" id="d12046e6718" headers="d12046e6638 ">
                                          <p><a href="preparing-for-oracle-streams-replication.html#GUID-0C7BB255-A828-4089-B624-41201F1E18D0">Decide How to Configure the Replication Environment</a></p>
                                       </td>
                                       <td align="left" valign="top" width="50%" headers="d12046e6718 d12046e6641 ">
                                          <p>This example uses the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure to configure the environment.
                                          </p>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <!-- class="inftblhruleinformal" -->
                           <p>In this example, the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure will configure the replication environment directly. A configuration script will not be generated. A Data Pump export dump file instantiation will be performed.
                           </p>
                           <p>The <code class="codeph">MAINTAIN_SCHEMAS</code> procedure automatically excludes database objects that are not supported by Oracle Streams from the replication environment by adding rules to the negative rule set of each capture and apply process. Query the <code class="codeph">DBA_STREAMS_UNSUPPORTED</code> data dictionary view to determine which database objects are not supported by Oracle Streams. If unsupported database objects are not excluded, then capture errors will result.
                           </p>
                           <p><a href="simple-oracle-streams-replication-configuration.html#GUID-59E31770-9AA5-41E1-B1EB-CA92ADA85E6C__CIADIDHH">Figure 2-6</a> provides an overview of the replication environment created in this example.
                           </p>
                           <div class="figure" id="GUID-59E31770-9AA5-41E1-B1EB-CA92ADA85E6C__CIADIDHH">
                              <p class="titleinfigure">Figure 2-6 Sample Oracle Streams Environment That Replicates a Schema</p><img width="589" src="img/strep050.png" alt="Description of Figure 2-6 follows" title="Description of Figure 2-6 follows" longdesc="img_text/strep050.html"><br><a href="img_text/strep050.html">Description of "Figure 2-6 Sample Oracle Streams Environment That Replicates a Schema"</a></div>
                           <!-- class="figure" -->
                           <div class="infoboxnotealso" id="GUID-59E31770-9AA5-41E1-B1EB-CA92ADA85E6C__GUID-51F09CA3-BED2-47AD-A3FE-B1A801D29C18">
                              <p class="notep1">See Also:</p>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=STRMS172"><span class="italic">Oracle Streams Concepts and Administration</span></a> for instructions on determining which database objects are not supported by Oracle Streams
                              </p>
                           </div>
                           <p>Complete the following steps to use the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure to configure the environment:
                           </p>
                        </div>
                        <!-- class="section" -->
                        <ol>
                           <li class="stepexpand"><span>Complete the required tasks before running the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-BB2E76CA-3645-4469-8750-4B276B8A955B">Tasks to Complete Before Configuring Oracle Streams Replication</a>"</span> for instructions.</span><div>
                                 <p>For this configuration, the following tasks must be completed:</p>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>Configure an Oracle Streams administrator at all three databases. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-EF5A403D-42E5-426D-B654-456E634F53B0">Configuring an Oracle Streams Administrator on All Databases</a>"</span>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Configure network connectivity and database links:</p>
                                       <ul style="list-style-type: disc;">
                                          <li>
                                             <p>Configure network connectivity between all three databases: the source database <code class="codeph">dbs1.example.com</code>, the destination database <code class="codeph">dbs3.example.com</code>, and the third database <code class="codeph">dbs2.example.com</code>.
                                             </p>
                                          </li>
                                          <li>
                                             <p>Create a database link from the source database <code class="codeph">dbs1.example.com</code> to the destination database <code class="codeph">dbs3.example.com</code>.
                                             </p>
                                          </li>
                                          <li>
                                             <p>Because downstream capture will be configured at the third database, create a database link from the third database <code class="codeph">dbs2.example.com</code> to the source database <code class="codeph">dbs1.example.com</code>.
                                             </p>
                                          </li>
                                          <li>
                                             <p>Because downstream capture will be configured at the third database, create a database link from the third database <code class="codeph">dbs2.example.com</code> to the destination database <code class="codeph">dbs3.example.com</code>.
                                             </p>
                                          </li>
                                          <li>
                                             <p>Because the replication environment will be bi-directional, create a database link from the destination database <code class="codeph">dbs3.example.com</code> to the source database <code class="codeph">dbs1.example.com</code>.
                                             </p>
                                          </li>
                                       </ul>
                                       <p> See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-7867112D-DAC3-4693-811E-B1B1052C7847">Configuring Network Connectivity and Database Links</a>"</span>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Ensure that the source database, the destination databases, and the third database are in <code class="codeph">ARCHIVELOG</code> mode. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-93BE3DA2-24EC-491A-811C-E32FD80D7809">Ensuring That Each Source Database Is In ARCHIVELOG Mode</a>"</span>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Ensure that the initialization parameters are set properly at all databases. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-F16B954D-35E0-422C-A89F-D3E170BD4505">Setting Initialization Parameters Relevant to Oracle Streams</a>"</span>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Configure the Oracle Streams pool properly at both databases. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-E572258F-DEB4-4B0B-B29B-D196C7336112">Configuring the Oracle Streams Pool</a>"</span>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Because a third database (<code class="codeph">dbs2.example.com</code>) will be the capture database for changes made to the source database, configure log file copying from the source database <code class="codeph">dbs1.example.com</code> to the third database <code class="codeph">dbs2.example.com</code>. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-CD6DB455-4D52-4CEF-B680-5A324E36BC5A">Configuring Log File Transfer to a Downstream Capture Database</a>"</span>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>Because this example configures a real-time downstream capture process, add standby redo logs at the downstream database (<code class="codeph">dbs2.example.com</code>). See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-4330E6AC-490D-438C-8A9D-D49DC7321BEE">Adding Standby Redo Logs for Real-Time Downstream Capture</a>"</span>.
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Create the following required directory objects:</span><div>
                                 <ul style="list-style-type: disc;">
                                    <li>
                                       <p>A source directory object at the source database. This example assumes that this directory object is <code class="codeph">source_directory</code>.
                                       </p>
                                    </li>
                                    <li>
                                       <p>A destination directory object at the destination database. This example assumes that this directory object is <code class="codeph">dest_directory</code>.
                                       </p>
                                    </li>
                                 </ul>
                                 <p>See <span class="q">"<a href="simple-oracle-streams-replication-configuration.html#GUID-6D874F68-7DE5-4987-8AEC-B0099BF3ED26">Creating the Required Directory Objects</a>"</span> for instructions.
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>In SQL*Plus, connect to the third database <code class="codeph">dbs2.example.com</code> as the Oracle Streams administrator.</span><div>
                                 <p>See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ADMIN00102"><span class="italic">Oracle Database Administrator's Guide</span></a> for instructions about connecting to a database in SQL*Plus.
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Run the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure:</span><div><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_STREAMS_ADM.MAINTAIN_SCHEMAS(
    schema_names                 =&gt; 'hr',
    source_directory_object      =&gt; 'source_directory',
    destination_directory_object =&gt; 'dest_directory',
    source_database              =&gt; 'dbs1.example.com',
    destination_database         =&gt; 'dbs3.example.com',
    perform_actions              =&gt; TRUE,
    dump_file_name               =&gt; 'export_hr.dmp',
    capture_queue_table          =&gt; 'rep_capture_queue_table',
    capture_queue_name           =&gt; 'rep_capture_queue',
    capture_queue_user           =&gt; NULL,
    apply_queue_table            =&gt; 'rep_dest_queue_table',
    apply_queue_name             =&gt; 'rep_dest_queue',
    apply_queue_user             =&gt; NULL,
    capture_name                 =&gt; 'capture_hr',
    propagation_name             =&gt; 'prop_hr',
    apply_name                   =&gt; 'apply_hr',
    log_file                     =&gt; 'export_hr.clg',
    bi_directional               =&gt; TRUE,
    include_ddl                  =&gt; TRUE,
    instantiation                =&gt; DBMS_STREAMS_ADM.INSTANTIATION_SCHEMA);
END;
/
</pre><p>Because this procedure configures a bi-directional replication environment, do not allow DML or DDL changes to the shared database objects at the destination database while the procedure is running.</p>
                                 <p>Because the procedure is run at the third database, downstream capture is configured at the third database for changes to the source database.</p>
                                 <p>To monitor the progress of the configuration operation, follow the instructions in <span class="q">"<a href="simple-oracle-streams-replication-configuration.html#GUID-7E1E55C3-95FA-4C6C-94B4-2F16E949D67E">Monitoring Oracle Streams Configuration Progress</a>"</span>.
                                 </p>
                                 <p>If this procedure encounters an error and stops, then see <span class="q">"<a href="managing-oracle-streams-replication.html#GUID-52B85E39-2264-47E2-981A-63CA23C7380A">Recovering from Operation Errors</a>"</span> for information about either recovering from the error or rolling back the configuration operation.
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Set the <code class="codeph">downstream_real_time_mine</code> capture process parameter to <code class="codeph">Y</code>:</span><div><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_CAPTURE_ADM.SET_PARAMETER(
    capture_name =&gt; 'capture_hr',
    parameter    =&gt; 'downstream_real_time_mine',
    value        =&gt; 'Y');
END;
/
</pre></div>
                           </li>
                           <li class="stepexpand"><span>Connect to the source database <code class="codeph">dbs1.example.com</code> as an administrative user with the necessary privileges to switch log files.</span></li>
                           <li class="stepexpand"><span>Archive the current log file at the source database:</span><div><pre class="oac_no_warn" dir="ltr">ALTER SYSTEM ARCHIVE LOG CURRENT;
</pre><p>Archiving the current log file at the source database starts real time mining of the source database redo log.</p>
                                 <p>If the capture process appears to be waiting for redo data for an inordinately long time, then check the alert log for errors. See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=STRMS1036"><span class="italic">Oracle Streams Concepts and Administration</span></a> for more information.
                                 </p>
                              </div>
                           </li>
                           <li class="stepexpand"><span>Configure conflict resolution for the shared database objects if necessary. </span><div>
                                 <p>Typically, conflicts are possible in a bi-directional replication environment. If conflicts are possible in the environment created by the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure, then configure conflict resolution before you allow users to make changes to the shared database objects. 
                                 </p>
                                 <p>See <a href="oracle-streams-conflict-resolution.html#GUID-5D79AA72-A682-4623-8A0B-4CF84D1FFC86"> Oracle Streams Conflict Resolution</a> for information.
                                 </p>
                              </div>
                           </li>
                        </ol>
                        <div class="section">
                           <p>The bi-directional replication environment configured in this example has the following characteristics:</p>
                           <ul style="list-style-type: disc;">
                              <li>
                                 <p>Supplemental logging is configured for the shared database objects at the source and destination databases.</p>
                              </li>
                              <li>
                                 <p>The <code class="codeph">dbs1.example.com</code> database has a queue named <code class="codeph">rep_dest_queue</code> which uses a queue table named <code class="codeph">rep_dest_queue_table</code>. This queue is for the apply process.
                                 </p>
                              </li>
                              <li>
                                 <p>The <code class="codeph">dbs3.example.com</code> database has a queue named <code class="codeph">rep_capture_queue</code> which uses a queue table named <code class="codeph">rep_capture_queue_table</code>. This queue is for the local capture process.
                                 </p>
                              </li>
                              <li>
                                 <p>The <code class="codeph">dbs3.example.com</code> database has a queue named <code class="codeph">rep_dest_queue</code> which uses a queue table named <code class="codeph">rep_dest_queue_table</code>. This queue is for the apply process.
                                 </p>
                              </li>
                              <li>
                                 <p>The <code class="codeph">dbs2.example.com</code> database has a queue named <code class="codeph">rep_capture_queue</code> which uses a queue table named <code class="codeph">rep_capture_queue_table</code>. This queue is for the downstream capture process.
                                 </p>
                              </li>
                              <li>
                                 <p>At the <code class="codeph">dbs2.example.com</code> database, a real-time downstream capture process named <code class="codeph">capture_hr</code> captures DML and DDL changes to the <code class="codeph">hr</code> schema and the database objects in the schema at the source database.
                                 </p>
                              </li>
                              <li>
                                 <p>At the <code class="codeph">dbs3.example.com</code> database, a local capture process named <code class="codeph">capture_hr</code> captures DML and DDL changes to the <code class="codeph">hr</code> schema and the database objects in the schema at the destination database.
                                 </p>
                              </li>
                              <li>
                                 <p>A propagation running on the <code class="codeph">dbs2.example.com</code> database named <code class="codeph">prop_hr</code> sends the captured changes from the queue in the <code class="codeph">dbs2.example.com</code> database to the queue in the <code class="codeph">dbs3.example.com</code> database.
                                 </p>
                              </li>
                              <li>
                                 <p>A propagation running on the <code class="codeph">dbs3.example.com</code> database named <code class="codeph">prop_hr</code> sends the captured changes from the queue in the <code class="codeph">dbs3.example.com</code> database to the queue in the <code class="codeph">dbs1.example.com</code> database.
                                 </p>
                              </li>
                              <li>
                                 <p>At the <code class="codeph">dbs1.example.com</code> database, an apply process named <code class="codeph">apply_hr</code> dequeues the changes from <code class="codeph">rep_dest_queue</code> and applies them to the database objects.
                                 </p>
                              </li>
                              <li>
                                 <p>At the <code class="codeph">dbs3.example.com</code> database, an apply process named <code class="codeph">apply_hr</code> dequeues the changes from <code class="codeph">rep_dest_queue</code> and applies them to the database objects.
                                 </p>
                              </li>
                              <li>
                                 <p>Tags are used to avoid change cycling. Specifically, each apply process uses an apply tag so that redo records for changes applied by the apply process include the tag. Each apply process uses an apply tag that is unique in the replication environment. Each propagation discards changes that have the tag of the apply process running on the same database. See <span class="q">"<a href="simple-oracle-streams-replication-configuration.html#GUID-AD9A0588-A09F-422C-8C84-A2C1AA187A37">Change Cycling and Tags</a>"</span> for more information.
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <!-- class="section" -->
                     </div>
                  </div>
               </div><a id="STREP642"></a><a id="STREP641"></a><div class="props_rev_3"><a id="GUID-DE04AAC0-800A-4F94-89C2-80560B32B6AD" name="GUID-DE04AAC0-800A-4F94-89C2-80560B32B6AD"></a><h4 id="STREP-GUID-DE04AAC0-800A-4F94-89C2-80560B32B6AD" class="sect4"><span class="enumeration_section">2.2.6 </span>Example That Configures Two-Database Replication with Synchronous Captures
                  </h4>
                  <div>
                     <div class="section">
                        <p>This example configures an Oracle Streams replication environment that replicates data manipulation language (DML) changes to two tables in the <code class="codeph">hr</code> schema. This example uses a synchronous capture at each database to capture these changes. In this example, the global names of the databases in the Oracle Streams replication environment are <code class="codeph">sync1.example.com</code> and <code class="codeph">sync2.example.com</code>. However, you can substitute any two databases in your environment to complete the example.
                        </p>
                        <p>Specifically, this example configures a two-database Oracle Streams replication environment that shares the <code class="codeph">hr.employees</code> and <code class="codeph">hr.departments</code> tables at the <code class="codeph">sync1.example.com</code> and <code class="codeph">sync2.example.com</code> databases. The two databases replicate all of the DML changes to these tables.
                        </p>
                        <div class="infoboxnote" id="GUID-DE04AAC0-800A-4F94-89C2-80560B32B6AD__GUID-74B4EB74-A1CA-46FF-B93F-3C57C93483BD">
                           <p class="notep1">Note:</p>
                           <p>A synchronous capture can only capture changes at the table level. It cannot capture changes at the schema or database level. You can configure a synchronous capture using the <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS308"><code class="codeph">ADD_TABLE_RULES</code></a> and <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS329"><code class="codeph">ADD_SUBSET_RULES</code></a> procedures in the <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS305"><code class="codeph">DBMS_STREAMS_ADM</code></a> package.
                           </p>
                        </div>
                        <p><a href="simple-oracle-streams-replication-configuration.html#GUID-DE04AAC0-800A-4F94-89C2-80560B32B6AD__CACJHGAB">Figure 2-7</a> provides an overview of the environment created in this example.
                        </p>
                        <div class="figure" id="GUID-DE04AAC0-800A-4F94-89C2-80560B32B6AD__CACJHGAB">
                           <p class="titleinfigure">Figure 2-7 Two-Database Replication Environment with Synchronous Captures</p><img src="img/strep505.gif" width="450" alt="Description of Figure 2-7 follows" title="Description of Figure 2-7 follows" longdesc="img_text/strep505.html"><br><a href="img_text/strep505.html">Description of "Figure 2-7 Two-Database Replication Environment with Synchronous Captures"</a></div>
                        <!-- class="figure" -->
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3">To configure this replication environment with synchronous captures:</p>
                        <ol>
                           <li>
                              <p>Complete the following tasks to prepare for the two-database replication environment:</p>
                              <ol type="a">
                                 <li>
                                    <p>Configure network connectivity so that the two databases can communicate with each other. See <a href="preparing-for-oracle-streams-replication.html#GUID-7867112D-DAC3-4693-811E-B1B1052C7847">Configuring Network Connectivity and Database Links</a> for information.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Configure an Oracle Streams administrator at each database that will participate in the replication environment. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-EF5A403D-42E5-426D-B654-456E634F53B0">Configuring an Oracle Streams Administrator on All Databases</a>"</span> for more information. This example assumes that the Oracle Streams administrator is <code class="codeph">strmadmin</code>.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Set initialization parameters properly at each database that will participate in the Oracle Streams replication environment. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-9110C1DA-8450-42A5-BA4B-2C0117DB8BFC"> Preparing for Oracle Streams Replication</a>"</span> for more information.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Ensure that the <code class="codeph">hr.employees</code> and <code class="codeph">hr.departments</code> tables exist at the two databases and are consistent at these databases. If the database objects exist at only one database, then you can use export/import to create and populate them at the other database. See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=SUTIL"><span class="italic">Oracle Database Utilities</span></a> for information about export/import.
                                    </p>
                                 </li>
                              </ol>
                           </li>
                           <li>
                              <p>Create two <code class="codeph">ANYDATA</code> queues at each database. For this example, create the following two queues at each database:
                              </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>A queue named <code class="codeph">capture_queue</code> owned by the Oracle Streams administrator <code class="codeph">strmadmin</code>. This queue will be used by the synchronous capture at the database.
                                    </p>
                                 </li>
                                 <li>
                                    <p>A queue named <code class="codeph">apply_queue</code> owned by the Oracle Streams administrator <code class="codeph">strmadmin</code>. This queue will be used by the apply process at the database.
                                    </p>
                                 </li>
                              </ul>
                              <p>See <span class="q">"<a href="configuring-queues-and-propagations.html#GUID-ACF52296-CE1F-40E1-B63E-5A6EB6A284A1">Creating an ANYDATA Queue</a>"</span> for more information.
                              </p>
                           </li>
                           <li>
                              <p>Create a database link from each database to the other database:</p>
                              <ol type="a">
                                 <li>
                                    <p>Create a database link from the <code class="codeph">sync1.example.com</code> database to the <code class="codeph">sync2.example.com</code> database. The database link should be created in the Oracle Streams administrator's schema. Also, the database link should connect to the Oracle Streams administrator at the <code class="codeph">sync2.example.com</code> database. Both the name and the service name of the database link must be <code class="codeph">sync2.example.com</code>.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Create a database link from the <code class="codeph">sync2.example.com</code> database to the <code class="codeph">sync1.example.com</code> database. The database link should be created in the Oracle Streams administrator's schema. Also, the database link should connect to the Oracle Streams administrator at the <code class="codeph">sync1.example.com</code> database. Both the name and the service name of the database link must be <code class="codeph">sync1.example.com</code>.
                                    </p>
                                 </li>
                              </ol>
                              <p>See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-7867112D-DAC3-4693-811E-B1B1052C7847">Configuring Network Connectivity and Database Links</a>"</span> for more information.
                              </p>
                           </li>
                           <li>
                              <p><a id="d12046e7464" class="indexterm-anchor"></a><a id="d12046e7466" class="indexterm-anchor"></a><a id="d12046e7468" class="indexterm-anchor"></a>Configure an apply process at the <code class="codeph">sync1.example.com</code> database. This apply process will apply changes to the shared tables that were captured at the <code class="codeph">sync2.example.com</code> database and propagated to the <code class="codeph">sync1.example.com</code> database.
                              </p>
                              <ol type="a">
                                 <li>
                                    <p>Open SQL*Plus and connect to the <code class="codeph">sync1.example.com</code> database as the Oracle Streams administrator.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Create the apply process:</p><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_APPLY_ADM.CREATE_APPLY(
    queue_name     =&gt; 'strmadmin.apply_queue',
    apply_name     =&gt; 'apply_emp_dep',
    apply_captured =&gt; FALSE);
END;
/
</pre><p>The <code class="codeph">apply_captured</code> parameter is set to <code class="codeph">FALSE</code> because the apply process applies changes in the persistent queue. These are changes that were captured by a synchronous capture. The <code class="codeph">apply_captured</code> parameter should be set to <code class="codeph">TRUE</code> only when the apply process applies changes captured by a capture process.
                                    </p>
                                    <p>Do not start the apply process.</p>
                                 </li>
                                 <li>
                                    <p>Add a rule to the apply process rule set:</p><pre class="oac_no_warn" dir="ltr">BEGIN 
  DBMS_STREAMS_ADM.ADD_TABLE_RULES(
    table_name      =&gt; 'hr.employees',
    streams_type    =&gt; 'apply',
    streams_name    =&gt; 'apply_emp_dep',
    queue_name      =&gt; 'strmadmin.apply_queue',
    source_database =&gt; 'sync2.example.com');
END;
/
</pre><p>This rule instructs the apply process <code class="codeph">apply_emp_dep</code> to apply all DML changes to the <code class="codeph">hr.employees</code> table that appear in the <code class="codeph">apply_queue</code> queue. The rule also specifies that the apply process applies only changes that were captured at the <code class="codeph">sync2.example.com</code> source database.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Add an additional rule to the apply process rule set:</p><pre class="oac_no_warn" dir="ltr">BEGIN 
  DBMS_STREAMS_ADM.ADD_TABLE_RULES(
    table_name      =&gt; 'hr.departments',
    streams_type    =&gt; 'apply',
    streams_name    =&gt; 'apply_emp_dep',
    queue_name      =&gt; 'strmadmin.apply_queue',
    source_database =&gt; 'sync2.example.com');
END;
/
</pre><p>This rule instructs the apply process <code class="codeph">apply_emp_dep</code> to apply all DML changes to the <code class="codeph">hr.departments</code> table that appear in the <code class="codeph">apply_queue</code> queue. The rule also specifies that the apply process applies only changes that were captured at the <code class="codeph">sync2.example.com</code> source database.
                                    </p>
                                 </li>
                              </ol>
                           </li>
                           <li>
                              <p>Configure an apply process at the <code class="codeph">sync2.example.com</code> database. This apply process will apply changes that were captured at the <code class="codeph">sync1.example.com</code> database and propagated to the <code class="codeph">sync2.example.com</code> database.
                              </p>
                              <ol type="a">
                                 <li>
                                    <p>In SQL*Plus, connect to the <code class="codeph">sync2.example.com</code> database as the Oracle Streams administrator.
                                    </p>
                                    <p>See <a href="../admin/index.html"><span class="italic">Oracle Database Administrator's Guide</span></a> for information about connecting to a database in SQL*Plus.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Create the apply process:</p><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_APPLY_ADM.CREATE_APPLY(
    queue_name     =&gt; 'strmadmin.apply_queue',
    apply_name     =&gt; 'apply_emp_dep',
    apply_captured =&gt; FALSE);
END;
/
</pre><p>The <code class="codeph">apply_captured</code> parameter is set to <code class="codeph">FALSE</code> because the apply process applies changes in the persistent queue. These changes were captured by a synchronous capture. The <code class="codeph">apply_captured</code> parameter should be set to <code class="codeph">TRUE</code> only when the apply process applies changes captured by a capture process.
                                    </p>
                                    <p>Do not start the apply process.</p>
                                 </li>
                                 <li>
                                    <p>Add a rule to the apply process rule set:</p><pre class="oac_no_warn" dir="ltr">BEGIN 
  DBMS_STREAMS_ADM.ADD_TABLE_RULES(
    table_name      =&gt; 'hr.employees',
    streams_type    =&gt; 'apply',
    streams_name    =&gt; 'apply_emp_dep',
    queue_name      =&gt; 'strmadmin.apply_queue',
    source_database =&gt; 'sync1.example.com');
END;
/
</pre><p>This rule instructs the apply process <code class="codeph">apply_emp_dep</code> to apply all DML changes that appear in the <code class="codeph">apply_queue</code> queue to the <code class="codeph">hr.employees</code> table. The rule also specifies that the apply process applies only changes that were captured at the <code class="codeph">sync1.example.com</code> source database.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Add an additional rule to the apply process rule set:</p><pre class="oac_no_warn" dir="ltr">BEGIN 
  DBMS_STREAMS_ADM.ADD_TABLE_RULES(
    table_name      =&gt; 'hr.departments',
    streams_type    =&gt; 'apply',
    streams_name    =&gt; 'apply_emp_dep',
    queue_name      =&gt; 'strmadmin.apply_queue',
    source_database =&gt; 'sync1.example.com');
END;
/
</pre><p>This rule instructs the apply process <code class="codeph">apply_emp_dep</code> to apply all DML changes that appear in the <code class="codeph">apply_queue</code> queue to the <code class="codeph">hr.departments</code> table. The rule also specifies that the apply process applies only changes that were captured at the <code class="codeph">sync1.example.com</code> source database.
                                    </p>
                                 </li>
                              </ol>
                           </li>
                           <li>
                              <p><a id="d12046e7633" class="indexterm-anchor"></a>Create a propagation to send changes from a queue at the <code class="codeph">sync1.example.com</code> database to a queue at the <code class="codeph">sync2.example.com</code> database:
                              </p>
                              <ol type="a">
                                 <li>
                                    <p>In SQL*Plus, connect to the <code class="codeph">sync1.example.com</code> database as the Oracle Streams administrator.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Create the propagation that sends changes to the <code class="codeph">sync2.example.com</code> database:
                                    </p><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_STREAMS_ADM.ADD_TABLE_PROPAGATION_RULES(
    table_name              =&gt; 'hr.employees',
    streams_name            =&gt; 'send_emp_dep',
    source_queue_name       =&gt; 'strmadmin.capture_queue',
    destination_queue_name  =&gt; 'strmadmin.apply_queue@sync2.example.com',
    source_database         =&gt; 'sync1.example.com',
    queue_to_queue          =&gt; TRUE);
END;
/
</pre><p>The <code class="codeph">ADD_TABLE_PROPAGATION_RULES</code> procedure creates the propagation and its positive rule set. This procedure also adds a rule to the propagation rule set that instructs it to send DML changes to the <code class="codeph">hr.employees</code> table to the <code class="codeph">apply_queue</code> queue in the <code class="codeph">sync2.example.com</code> database.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Add an additional rule to the propagation rule set:</p><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_STREAMS_ADM.ADD_TABLE_PROPAGATION_RULES(
    table_name              =&gt; 'hr.departments',
    streams_name            =&gt; 'send_emp_dep',
    source_queue_name       =&gt; 'strmadmin.capture_queue',
    destination_queue_name  =&gt; 'strmadmin.apply_queue@sync2.example.com',
    source_database         =&gt; 'sync1.example.com',
    queue_to_queue          =&gt; TRUE);
END;
/
</pre><p>The <code class="codeph">ADD_TABLE_PROPAGATION_RULES</code> procedure adds a rule to the propagation rule set that instructs it to send DML changes to the <code class="codeph">hr.departments</code> table to the <code class="codeph">apply_queue</code> queue in the <code class="codeph">sync2.example.com</code> database.
                                    </p>
                                 </li>
                              </ol>
                           </li>
                           <li>
                              <p>Create a propagation to send changes from a queue at the <code class="codeph">sync2.example.com</code> database to a queue at the <code class="codeph">sync1.example.com</code> database:
                              </p>
                              <ol type="a">
                                 <li>
                                    <p>In SQL*Plus, connect to the <code class="codeph">sync2.example.com</code> database as the Oracle Streams administrator.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Create the propagation that sends changes to the <code class="codeph">sync1.example.com</code> database:
                                    </p><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_STREAMS_ADM.ADD_TABLE_PROPAGATION_RULES(
    table_name              =&gt; 'hr.employees',
    streams_name            =&gt; 'send_emp_dep',
    source_queue_name       =&gt; 'strmadmin.capture_queue',
    destination_queue_name  =&gt; 'strmadmin.apply_queue@sync1.example.com',
    source_database         =&gt; 'sync2.example.com',
    queue_to_queue          =&gt; TRUE);
END;
/
</pre><p>The <code class="codeph">ADD_TABLE_PROPAGATION_RULES</code> procedure creates the propagation and its positive rule set. This procedure also adds a rule to the propagation rule set that instructs it to send DML changes to the <code class="codeph">hr.employees</code> table to the <code class="codeph">apply_queue</code> queue in the <code class="codeph">sync1.example.com</code> database.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Add an additional rule to the propagation rule set:</p><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_STREAMS_ADM.ADD_TABLE_PROPAGATION_RULES(
    table_name              =&gt; 'hr.departments',
    streams_name            =&gt; 'send_emp_dep',
    source_queue_name       =&gt; 'strmadmin.capture_queue',
    destination_queue_name  =&gt; 'strmadmin.apply_queue@sync1.example.com',
    source_database         =&gt; 'sync2.example.com',
    queue_to_queue          =&gt; TRUE);
END;
/
</pre><p>The <code class="codeph">ADD_TABLE_PROPAGATION_RULES</code> procedure adds a rule to the propagation rule set that instructs it to send DML changes to the <code class="codeph">hr.departments</code> table to the <code class="codeph">apply_queue</code> queue in the <code class="codeph">sync1.example.com</code> database.
                                    </p>
                                 </li>
                              </ol>
                           </li>
                           <li>
                              <p><a id="d12046e7749" class="indexterm-anchor"></a>Configure a synchronous capture at the <code class="codeph">sync1.example.com</code> database:
                              </p>
                              <ol type="a">
                                 <li>
                                    <p>In SQL*Plus, connect to the <code class="codeph">sync1.example.com</code> database as the Oracle Streams administrator.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Run the <code class="codeph">ADD_TABLE_RULES</code> procedure to create the synchronous capture and add a rule to instruct it to capture changes to the <code class="codeph">hr.employees</code> table:
                                    </p><pre class="oac_no_warn" dir="ltr">BEGIN 
  DBMS_STREAMS_ADM.ADD_TABLE_RULES(
    table_name    =&gt; 'hr.employees',
    streams_type  =&gt; 'sync_capture',
    streams_name  =&gt; 'sync_capture',
    queue_name    =&gt; 'strmadmin.capture_queue');
END;
/
</pre></li>
                                 <li>
                                    <p>Add an additional rule to the synchronous capture rule set:</p><pre class="oac_no_warn" dir="ltr">BEGIN 
  DBMS_STREAMS_ADM.ADD_TABLE_RULES(
    table_name    =&gt; 'hr.departments',
    streams_type  =&gt; 'sync_capture',
    streams_name  =&gt; 'sync_capture',
    queue_name    =&gt; 'strmadmin.capture_queue');
END;
/
</pre></li>
                              </ol>
                              <p>Running these procedures performs the following actions:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>Creates a synchronous capture named <code class="codeph">sync_capture</code> at the current database. A synchronous capture with the same name must not exist.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Enables the synchronous capture. A synchronous capture cannot be disabled.</p>
                                 </li>
                                 <li>
                                    <p>Associates the synchronous capture with an existing queue named <code class="codeph">capture_queue</code> owned by <code class="codeph">strmadmin</code>.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Creates a positive rule set for synchronous capture <code class="codeph">sync_capture</code>. The rule set has a system-generated name.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Creates a rule that captures DML changes to the <code class="codeph">hr.employees</code> table and adds the rule to the positive rule set for the synchronous capture. The rule has a system-generated name.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Prepares the <code class="codeph">hr.employees</code> table for instantiation by running the <code class="codeph">DBMS_CAPTURE_ADM.PREPARE_SYNC_INSTANTIATION</code> function for the table automatically.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Creates a rule that captures DML changes to the <code class="codeph">hr.departments</code> table and adds the rule to the positive rule set for the synchronous capture. The rule has a system-generated name.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Prepares the <code class="codeph">hr.departments</code> table for instantiation by running the <code class="codeph">DBMS_CAPTURE_ADM.PREPARE_SYNC_INSTANTIATION</code> function for the table automatically.
                                    </p>
                                 </li>
                              </ul>
                           </li>
                           <li>
                              <p>Configure a synchronous capture at the <code class="codeph">sync2.example.com</code> database:
                              </p>
                              <ol type="a">
                                 <li>
                                    <p>In SQL*Plus, connect to the <code class="codeph">sync2.example.com</code> database as the Oracle Streams administrator.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Run the <code class="codeph">ADD_TABLE_RULES</code> procedure to create the synchronous capture and add a rule to instruct it to capture changes to the <code class="codeph">hr.employees</code> table:
                                    </p><pre class="oac_no_warn" dir="ltr">BEGIN 
  DBMS_STREAMS_ADM.ADD_TABLE_RULES(
    table_name    =&gt; 'hr.employees',
    streams_type  =&gt; 'sync_capture',
    streams_name  =&gt; 'sync_capture',
    queue_name    =&gt; 'strmadmin.capture_queue');
END;
/
</pre></li>
                                 <li>
                                    <p>Add an additional rule to the synchronous capture rule set:</p><pre class="oac_no_warn" dir="ltr">BEGIN 
  DBMS_STREAMS_ADM.ADD_TABLE_RULES(
    table_name    =&gt; 'hr.departments',
    streams_type  =&gt; 'sync_capture',
    streams_name  =&gt; 'sync_capture',
    queue_name    =&gt; 'strmadmin.capture_queue');
END;
/
</pre></li>
                              </ol>
                              <p>Step <a href="simple-oracle-streams-replication-configuration.html#GUID-0C365820-9DCF-4234-B4F2-20DFA29E9E22__CACBGEIB">8</a> describes the actions performed by these procedures at the current database.
                              </p>
                           </li>
                           <li>
                              <p>Set the instantiation SCN for the tables at the <code class="codeph">sync2.example.com</code> database:
                              </p>
                              <ol type="a">
                                 <li>
                                    <p>In SQL*Plus, connect to the <code class="codeph">sync1.example.com</code> database as the Oracle Streams administrator.
                                    </p>
                                 </li>
                                 <li>
                                    <p><a id="d12046e7884" class="indexterm-anchor"></a><a id="d12046e7886" class="indexterm-anchor"></a>Set the instantiation SCN for the <code class="codeph">hr.employees</code> table at the <code class="codeph">sync2.example.com</code> database:
                                    </p><pre class="oac_no_warn" dir="ltr">DECLARE
  iscn  NUMBER;    -- Variable to hold instantiation SCN value
BEGIN
  iscn := DBMS_FLASHBACK.GET_SYSTEM_CHANGE_NUMBER();
  DBMS_APPLY_ADM.SET_TABLE_INSTANTIATION_SCN@sync2.example.com(
    source_object_name    =&gt; 'hr.employees',
    source_database_name  =&gt; 'sync1.example.com',
    instantiation_scn     =&gt; iscn);
END;
/
</pre></li>
                                 <li>
                                    <p>Set the instantiation SCN for the <code class="codeph">hr.departments</code> table at the <code class="codeph">sync2.example.com</code> database:
                                    </p><pre class="oac_no_warn" dir="ltr">DECLARE
  iscn  NUMBER;    -- Variable to hold instantiation SCN value
BEGIN
  iscn := DBMS_FLASHBACK.GET_SYSTEM_CHANGE_NUMBER();
  DBMS_APPLY_ADM.SET_TABLE_INSTANTIATION_SCN@sync2.example.com(
    source_object_name    =&gt; 'hr.departments',
    source_database_name  =&gt; 'sync1.example.com',
    instantiation_scn     =&gt; iscn);
END;
/
</pre></li>
                              </ol>
                              <p>An instantiation SCN is the lowest SCN for which an apply process can apply changes to a table. Before the apply process can apply changes to the shared tables at the <code class="codeph">sync2.example.com</code> database, an instantiation SCN must be set for each table.
                              </p>
                           </li>
                           <li>
                              <p>Set the instantiation SCN for the tables at the <code class="codeph">sync1.example.com</code> database:
                              </p>
                              <ol type="a">
                                 <li>
                                    <p>In SQL*Plus, connect to the <code class="codeph">sync2.example.com</code> database as the Oracle Streams administrator.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Set the instantiation SCN for the <code class="codeph">hr.employees</code> table at the <code class="codeph">sync1.example.com</code> database:
                                    </p><pre class="oac_no_warn" dir="ltr">DECLARE
  iscn  NUMBER;    -- Variable to hold instantiation SCN value
BEGIN
  iscn := DBMS_FLASHBACK.GET_SYSTEM_CHANGE_NUMBER();
  DBMS_APPLY_ADM.SET_TABLE_INSTANTIATION_SCN@sync1.example.com(
    source_object_name    =&gt; 'hr.employees',
    source_database_name  =&gt; 'sync2.example.com',
    instantiation_scn     =&gt; iscn);
END;
/
</pre></li>
                                 <li>
                                    <p>Set the instantiation SCN for the <code class="codeph">hr.departments</code> table at the <code class="codeph">sync2.example.com</code> database:
                                    </p><pre class="oac_no_warn" dir="ltr">DECLARE
  iscn  NUMBER;    -- Variable to hold instantiation SCN value
BEGIN
  iscn := DBMS_FLASHBACK.GET_SYSTEM_CHANGE_NUMBER();
  DBMS_APPLY_ADM.SET_TABLE_INSTANTIATION_SCN@sync1.example.com(
    source_object_name    =&gt; 'hr.departments',
    source_database_name  =&gt; 'sync2.example.com',
    instantiation_scn     =&gt; iscn);
END;
/
</pre></li>
                              </ol>
                           </li>
                           <li>
                              <p><a id="d12046e7953" class="indexterm-anchor"></a>Start the apply process at each database:
                              </p>
                              <ol type="a">
                                 <li>
                                    <p>In SQL*Plus, connect to the <code class="codeph">sync1.example.com</code> database as the Oracle Streams administrator.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Start the apply process:</p><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_APPLY_ADM.START_APPLY(
    apply_name =&gt; 'apply_emp_dep');
END;
/
</pre></li>
                                 <li>
                                    <p>In SQL*Plus, connect to the <code class="codeph">sync2.example.com</code> database as the Oracle Streams administrator.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Start the apply process:</p><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_APPLY_ADM.START_APPLY(
    apply_name =&gt; 'apply_emp_dep');
END;
/
</pre></li>
                              </ol>
                           </li>
                           <li>
                              <p>Configure latest time conflict resolution for the <code class="codeph">hr.departments</code> and <code class="codeph">hr.employees</code> tables at the <code class="codeph">sync1.example.com</code> and <code class="codeph">sync2.example.com</code> databases. See <span class="q">"<a href="oracle-streams-conflict-resolution.html#GUID-3D424F00-2100-41F1-B7A0-61273CD464C9">Prebuilt Update Conflict Handlers</a>"</span> for more information.
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p>A two-database replication environment with the following characteristics is configured:</p>
                        <ul style="list-style-type: disc;">
                           <li>
                              <p>Each database has a synchronous capture named <code class="codeph">sync_capture</code>. The synchronous capture captures all DML changes to the <code class="codeph">hr.employees</code> <code class="codeph">hr.departments</code> tables.
                              </p>
                           </li>
                           <li>
                              <p>Each database has a queue named <code class="codeph">capture_queue</code>. This queue is for the synchronous capture at the database.
                              </p>
                           </li>
                           <li>
                              <p>Each database has an apply process named <code class="codeph">apply_emp_dep</code>. The apply process applies all DML changes to the <code class="codeph">hr.employees</code> table and <code class="codeph">hr.departments</code> tables.
                              </p>
                           </li>
                           <li>
                              <p>Each database has a queue named <code class="codeph">apply_queue</code>. This queue is for the apply process at the database.
                              </p>
                           </li>
                           <li>
                              <p>Each database has a propagation named <code class="codeph">send_emp_dep</code>. The propagation sends changes from the <code class="codeph">capture_queue</code> in the local database to the <code class="codeph">apply_queue</code> in the other database. The propagation sends all DML changes to the <code class="codeph">hr.employees</code> and <code class="codeph">hr.departments</code> tables.
                              </p>
                           </li>
                           <li>
                              <p><a id="d12046e8059" class="indexterm-anchor"></a>Tags are used to avoid change cycling in the following way:
                              </p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>Each apply process uses the default apply tag. The default apply tag is the hexadecimal equivalent of <code class="codeph">'00'</code> (double zero).
                                    </p>
                                 </li>
                                 <li>
                                    <p>Each synchronous capture only captures changes in a session with a <code class="codeph">NULL</code> tag. Therefore, neither synchronous capture captures the changes that are being applied by the local apply process. The synchronous capture rules instruct the synchronous capture not to capture these changes.
                                    </p>
                                 </li>
                              </ul>
                              <p>See <span class="q">"<a href="simple-oracle-streams-replication-configuration.html#GUID-AD9A0588-A09F-422C-8C84-A2C1AA187A37">Change Cycling and Tags</a>"</span> for more information about how the replication environment avoids change cycling.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3">To check the Oracle Streams replication configuration:</p>
                        <ol>
                           <li>
                              <p>At each database, complete the following steps to ensure that synchronous capture is configured:</p>
                              <ol type="a">
                                 <li>
                                    <p>Start SQL*Plus and connect to the database as the Oracle Streams administrator.</p>
                                    <p>See <a href="../admqs/getting-started-with-database-administration.html#ADMQS0361"><span class="italic">Oracle Database 2 Day DBA</span></a> for more information about starting SQL*Plus.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Query the <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=REFRN20572"><code class="codeph">ALL_SYNC_CAPTURE</code></a> data dictionary view:
                                    </p><pre class="oac_no_warn" dir="ltr">SELECT CAPTURE_NAME FROM ALL_SYNC_CAPTURE;
</pre><p>Ensure that a synchronous capture named <code class="codeph">sync_capture</code> exists at each database.
                                    </p>
                                 </li>
                              </ol>
                           </li>
                           <li>
                              <p>At each database, ensure that the propagation is enabled. To do so, query the <code class="codeph">STATUS</code> column in the <code class="codeph">DBA_PROPAGATION</code> view.
                              </p>
                           </li>
                           <li>
                              <p>At each database, ensure that the apply process is enabled. To do so, query the <code class="codeph">STATUS</code> column in the <code class="codeph">DBA_APPLY</code> view.
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <p class="subhead3">To replicate changes:</p>
                        <ol>
                           <li>
                              <p>At one of the databases, make DML changes to the <code class="codeph">hr.employees</code> table or <code class="codeph">hr.departments</code> table.
                              </p>
                           </li>
                           <li>
                              <p>After some time has passed to allow for replication of the changes, use SQL*Plus to query the <code class="codeph">hr.employees</code> or <code class="codeph">hr.departments</code> table at the other database to view the changes.
                              </p>
                           </li>
                        </ol>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="STREP605"></a><a id="STREP604"></a><div class="props_rev_3"><a id="GUID-91D2F532-471A-493D-83F5-D2B0F1C34848" name="GUID-91D2F532-471A-493D-83F5-D2B0F1C34848"></a><h4 id="STREP-GUID-91D2F532-471A-493D-83F5-D2B0F1C34848" class="sect4"><span class="enumeration_section">2.2.7 </span>Example That Configures Hub-and-Spoke Replication
                  </h4>
                  <div>
                     <div class="section">
                        <p>This example configures an Oracle Streams hub-and-spoke replication environment that replicates data manipulation language (DML) changes to all of the tables in the <code class="codeph">hr</code> schema. This example uses a capture process at each database to capture these changes. Hub-and-spoke replication means that a central hub database replicates changes with one or more spoke databases. The spoke databases do not communicate with each other directly. In this sample configuration, the hub database sends changes generated at one spoke database to the other spoke database. 
                        </p>
                        <p>In this example, the global name of the hub database is <code class="codeph">hub.example.com</code>, and the global names of the spoke databases are <code class="codeph">spoke1.example.com</code> and <code class="codeph">spoke2.example.com</code>. However, you can substitute databases in your environment to complete the example.
                        </p>
                        <p>The following table lists the decisions that were made about the Oracle Streams replication environment configured in this example.</p>
                        <div class="tblformal" id="GUID-91D2F532-471A-493D-83F5-D2B0F1C34848__GUID-901E45BC-42B2-41E0-9EF9-9469A1705265">
                           <table cellpadding="4" cellspacing="0" class="Formal" title="" summary="This table lists the decision made for the example in this section." width="100%" frame="hsides" border="1" rules="rows">
                              <thead>
                                 <tr align="left" valign="top">
                                    <th align="left" valign="bottom" width="50%" id="d12046e8307">Decision</th>
                                    <th align="left" valign="bottom" width="50%" id="d12046e8310">Assumption for This Example</th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="50%" id="d12046e8315" headers="d12046e8307 ">
                                       <p><a href="preparing-for-oracle-streams-replication.html#GUID-9EBD9C47-B328-4740-B1CA-3066B5A9EFD6">Decide Which Type of Replication Environment to Configure</a></p>
                                    </td>
                                    <td align="left" valign="top" width="50%" headers="d12046e8315 d12046e8310 ">
                                       <p>This example configures a hub-and-spoke replication environment in which the global name of the hub database is <code class="codeph">hub.example.com</code>, and the global names of the spoke databases are <code class="codeph">spoke1.example.com</code> and <code class="codeph">spoke2.example.com</code>. All of the databases in the environment are read/write.
                                       </p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="50%" id="d12046e8333" headers="d12046e8307 ">
                                       <p><a href="preparing-for-oracle-streams-replication.html#GUID-413B5DE9-FB2A-48BE-B5A0-815DE614E502">Decide Whether to Configure Local or Downstream Capture for the Source Database</a></p>
                                    </td>
                                    <td align="left" valign="top" width="50%" headers="d12046e8333 d12046e8310 ">
                                       <p>This example configures local capture at each database.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="50%" id="d12046e8342" headers="d12046e8307 ">
                                       <p><a href="preparing-for-oracle-streams-replication.html#GUID-F691796A-514C-4821-8B7B-BAB0FA45C04E">Decide Whether Changes Are Allowed at One Database or at Multiple Databases</a></p>
                                    </td>
                                    <td align="left" valign="top" width="50%" headers="d12046e8342 d12046e8310 ">
                                       <p>This example configures a replication environment that allows changes to the replicated database objects at all three databases.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="50%" id="d12046e8351" headers="d12046e8307 ">
                                       <p><a href="preparing-for-oracle-streams-replication.html#GUID-B51FFB8D-AB92-4B36-9648-F58262282F9B">Decide Whether the Replication Environment Will Have Nonidentical Replicas</a></p>
                                    </td>
                                    <td align="left" valign="top" width="50%" headers="d12046e8351 d12046e8310 ">
                                       <p>This example configures identical shared database objects at the databases.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="50%" id="d12046e8360" headers="d12046e8307 ">
                                       <p><a href="preparing-for-oracle-streams-replication.html#GUID-7078844B-E2BE-48F5-8117-69B4F999FA73">Decide Whether the Replication Environment Will Use Apply Handlers</a></p>
                                    </td>
                                    <td align="left" valign="top" width="50%" headers="d12046e8360 d12046e8310 ">
                                       <p>This example does not configure apply handlers.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="50%" id="d12046e8369" headers="d12046e8307 ">
                                       <p><a href="preparing-for-oracle-streams-replication.html#GUID-A9E8F02F-F101-4A22-A252-C6A9DC400CE8">Decide Whether to Maintain DDL Changes</a></p>
                                    </td>
                                    <td align="left" valign="top" width="50%" headers="d12046e8369 d12046e8310 ">
                                       <p>This example does not maintain DDL changes to the shared database objects.</p>
                                    </td>
                                 </tr>
                                 <tr align="left" valign="top">
                                    <td align="left" valign="top" width="50%" id="d12046e8378" headers="d12046e8307 ">
                                       <p><a href="preparing-for-oracle-streams-replication.html#GUID-0C7BB255-A828-4089-B624-41201F1E18D0">Decide How to Configure the Replication Environment</a></p>
                                    </td>
                                    <td align="left" valign="top" width="50%" headers="d12046e8378 d12046e8310 ">
                                       <p>This example uses the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure to configure the environment.
                                       </p>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                        <!-- class="inftblhruleinformal" -->
                        <p>In this example, the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure will configure the replication environment directly. A configuration script will not be generated. A Data Pump export dump file instantiation will be performed.
                        </p>
                        <p>The <code class="codeph">MAINTAIN_SCHEMAS</code> procedure automatically excludes database objects that are not supported by Oracle Streams from the replication environment by adding rules to the negative rule set of each capture and apply process. Query the <code class="codeph">DBA_STREAMS_UNSUPPORTED</code> data dictionary view to determine which database objects are not supported by Oracle Streams. If unsupported database objects are not excluded, then capture errors will result.
                        </p>
                        <p>The database objects being configured for replication might or might not exist at the destination databases when you run the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure. If the database objects do not exist at a destination database, then the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure instantiates them at the destination database using a Data Pump export/import. During instantiation, the instantiation SCN is set for these database objects. If the database objects already exist at a destination database, then the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure retains the existing database objects and sets the instantiation SCN for them. In this example, the <code class="codeph">hr</code> schema exists at each database before the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure is run.
                        </p>
                        <p><a href="simple-oracle-streams-replication-configuration.html#GUID-91D2F532-471A-493D-83F5-D2B0F1C34848__CIADBGGE">Figure 2-8</a> provides an overview of the environment created in this example.
                        </p>
                        <div class="figure" id="GUID-91D2F532-471A-493D-83F5-D2B0F1C34848__CIADBGGE">
                           <p class="titleinfigure">Figure 2-8 Hub-and-Spoke Environment with Capture Processes and Read/Write Spokes</p><img width="594" src="img/strep504.gif" alt="Description of Figure 2-8 follows" title="Description of Figure 2-8 follows" longdesc="img_text/strep504.html"><br><a href="img_text/strep504.html">Description of "Figure 2-8 Hub-and-Spoke Environment with Capture Processes and Read/Write Spokes"</a></div>
                        <!-- class="figure" -->
                        <p>Complete the following steps to use the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure to configure the environment:
                        </p>
                        <ol>
                           <li>
                              <p>Complete the following tasks to prepare for the hub-and-spoke replication environment:</p>
                              <ol type="a">
                                 <li>
                                    <p>Configure network connectivity so that the following databases can communicate with each other:</p>
                                    <ul style="list-style-type: disc;">
                                       <li>
                                          <p>The <code class="codeph">hub.example.com</code> database and the <code class="codeph">spoke1.example.com</code> database
                                          </p>
                                       </li>
                                       <li>
                                          <p>The <code class="codeph">hub.example.com</code> database and the <code class="codeph">spoke2.example.com</code> database
                                          </p>
                                       </li>
                                    </ul>
                                    <p>See <a href="../admqs/configuring-the-network-environment.html#ADMQS004"><span class="italic">Oracle Database 2 Day DBA</span></a> for information about configuring network connectivity between databases.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Configure an Oracle Streams administrator at each database that will participate in the replication environment. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-EF5A403D-42E5-426D-B654-456E634F53B0">Configuring an Oracle Streams Administrator on All Databases</a>"</span> for instructions. This example assumes that the Oracle Streams administrator is <code class="codeph">strmadmin</code>.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Create a database link from the hub database to each spoke database and from each spoke database to the hub database. In this example, create the following database links:</p>
                                    <ul style="list-style-type: disc;">
                                       <li>
                                          <p>From the <code class="codeph">hub.example.com</code> database to the <code class="codeph">spoke1.example.com</code> database. Both the name and the service name of the database link must be <code class="codeph">spoke1.example.com</code>.
                                          </p>
                                       </li>
                                       <li>
                                          <p>From the <code class="codeph">hub.example.com</code> database to the <code class="codeph">spoke2.example.com</code> database. Both the name and the service name of the database link must be <code class="codeph">spoke2.example.com</code>.
                                          </p>
                                       </li>
                                       <li>
                                          <p>From the <code class="codeph">spoke1.example.com</code> database to the <code class="codeph">hub.example.com</code> database. Both the name and the service name of the database link must be <code class="codeph">hub.example.com</code>.
                                          </p>
                                       </li>
                                       <li>
                                          <p>From the <code class="codeph">spoke2.example.com</code> database to the <code class="codeph">hub.example.com</code> database. Both the name and the service name of the database link must be <code class="codeph">hub.example.com</code>.
                                          </p>
                                       </li>
                                    </ul>
                                    <p>Each database link should be created in the Oracle Streams administrator's schema. Also, each database link should connect to the Oracle Streams administrator at the destination database. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-7867112D-DAC3-4693-811E-B1B1052C7847">Configuring Network Connectivity and Database Links</a>"</span> for instructions.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Set initialization parameters properly at each database that will participate in the Oracle Streams replication environment. See <span class="q">"<a href="preparing-for-oracle-streams-replication.html#GUID-F16B954D-35E0-422C-A89F-D3E170BD4505">Setting Initialization Parameters Relevant to Oracle Streams</a>"</span> for instructions.
                                    </p>
                                 </li>
                                 <li>
                                    <p>Configure each source database to run in <code class="codeph">ARCHIVELOG</code> mode. For a capture process to capture changes generated at a source database, the source database must be running in <code class="codeph">ARCHIVELOG</code> mode. In this example, all databases must be running in <code class="codeph">ARCHIVELOG</code> mode. See <a href="../admin/managing-archived-redo-log-files.html#ADMIN008"><span class="italic">Oracle Database Administrator's Guide</span></a> for information about configuring a database to run in <code class="codeph">ARCHIVELOG</code> mode.
                                    </p>
                                 </li>
                              </ol>
                           </li>
                           <li>
                              <p>Create the following required directory objects:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>A directory object at the hub database <code class="codeph">hub.example.com</code>. This example assumes that this directory object is <code class="codeph">hub_directory</code>.
                                    </p>
                                 </li>
                                 <li>
                                    <p>A directory object at the spoke database <code class="codeph">spoke1.example.com</code>. This example assumes that this directory object is <code class="codeph">spoke1_directory</code>.
                                    </p>
                                 </li>
                                 <li>
                                    <p>A directory object at the spoke database <code class="codeph">spoke2.example.com</code>. This example assumes that this directory object is <code class="codeph">spoke2_directory</code>.
                                    </p>
                                 </li>
                              </ul>
                              <p>See <span class="q">"<a href="simple-oracle-streams-replication-configuration.html#GUID-6D874F68-7DE5-4987-8AEC-B0099BF3ED26">Creating the Required Directory Objects</a>"</span> for instructions.
                              </p>
                           </li>
                           <li>
                              <p>In SQL*Plus, connect to the <code class="codeph">hub.example.com</code> database as the Oracle Streams administrator.
                              </p>
                              <p>See <a href="../admqs/getting-started-with-database-administration.html#ADMQS0361"><span class="italic">Oracle Database 2 Day DBA</span></a> for more information about starting SQL*Plus.
                              </p>
                           </li>
                           <li>
                              <p>Run the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure to configure replication between the <code class="codeph">hub.example.com</code> database and the <code class="codeph">spoke1.example.com</code> database:
                              </p><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_STREAMS_ADM.MAINTAIN_SCHEMAS(
    schema_names                 =&gt; 'hr',
    source_directory_object      =&gt; 'hub_directory',
    destination_directory_object =&gt; 'spoke1_directory',
    source_database              =&gt; 'hub.example.com',
    destination_database         =&gt; 'spoke1.example.com',
    capture_name                 =&gt; 'capture_hns',
    capture_queue_table          =&gt; 'source_hns_qt',
    capture_queue_name           =&gt; 'source_hns',
    propagation_name             =&gt; 'propagation_spoke1',
    apply_name                   =&gt; 'apply_spoke1',
    apply_queue_table            =&gt; 'destination_spoke1_qt',
    apply_queue_name             =&gt; 'destination_spoke1',
    bi_directional               =&gt; TRUE);
END;
/
</pre><p>The <code class="codeph">MAINTAIN_SCHEMAS</code> procedure can take some time to run because it is performing many configuration tasks. Do not allow data manipulation language (DML) or data definition language (DDL) changes to the replicated database objects at the destination database while the procedure is running.
                              </p>
                              <p>In the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure, only the following parameters are required: <code class="codeph">schema_names</code>, <code class="codeph">source_directory_object</code>, <code class="codeph">destination_directory_object</code>, <code class="codeph">source_database</code>, and <code class="codeph">destination_database</code>. Also, when you use a configuration procedure to configure bi-directional replication, the <code class="codeph">bi_directional</code> parameter must be set to <code class="codeph">TRUE</code>.
                              </p>
                              <p>This example specifies the other parameters to show that you can choose the name for the capture process, capture process's queue table, capture process's queue, propagation, apply process, apply process's queue table, and apply process's queue. If you do not specify these parameters, then system-generated names are used. </p>
                              <p>When a configuration procedure is run, information about its progress is recorded in the following data dictionary views: <code class="codeph">DBA_RECOVERABLE_SCRIPT</code>, <code class="codeph">DBA_RECOVERABLE_SCRIPT_PARAMS</code>, <code class="codeph">DBA_RECOVERABLE_SCRIPT_BLOCKS</code>, and <code class="codeph">DBA_RECOVERABLE_SCRIPT_ERRORS</code>. If the procedure stops because it encounters an error, then see <a href="managing-oracle-streams-replication.html#STREP149"><span class="italic">Oracle Streams Replication Administrator's Guide</span></a> for instructions about using the <code class="codeph">RECOVER_OPERATION</code> procedure in the <code class="codeph">DBMS_STREAMS_ADM</code> package to recover from these errors.
                              </p>
                           </li>
                           <li>
                              <p>While still connected in SQL*Plus to the <code class="codeph">hub.example.com</code> database as the Oracle Streams administrator, run the <code class="codeph">MAINTAIN_SCHEMAS</code> procedure to configure replication between the <code class="codeph">hub.example.com</code> database and the <code class="codeph">spoke2.example.com</code> database:
                              </p><pre class="oac_no_warn" dir="ltr">BEGIN
  DBMS_STREAMS_ADM.MAINTAIN_SCHEMAS(
    schema_names                 =&gt; 'hr',
    source_directory_object      =&gt; 'hub_directory',
    destination_directory_object =&gt; 'spoke2_directory',
    source_database              =&gt; 'hub.example.com',
    destination_database         =&gt; 'spoke2.example.com',
    capture_name                 =&gt; 'capture_hns',
    capture_queue_table          =&gt; 'source_hns_qt',
    capture_queue_name           =&gt; 'source_hns',
    propagation_name             =&gt; 'propagation_spoke2',
    apply_name                   =&gt; 'apply_spoke2',
    apply_queue_table            =&gt; 'destination_spoke2_qt',
    apply_queue_name             =&gt; 'destination_spoke2',
    bi_directional               =&gt; TRUE);
END;
/
</pre></li>
                           <li>
                              <p>Configure latest time conflict resolution for all of the tables in the <code class="codeph">hr</code> schema at the <code class="codeph">hub.example.com</code>, <code class="codeph">spoke1.example.com</code>, and <code class="codeph">spoke2.example.com</code> databases. This schema includes the <code class="codeph">countries</code>, <code class="codeph">departments</code>, <code class="codeph">employees</code>, <code class="codeph">jobs</code>, <code class="codeph">job_history</code>, <code class="codeph">locations</code>, and <code class="codeph">regions</code> tables. See <a href="oracle-streams-conflict-resolution.html#GUID-5D79AA72-A682-4623-8A0B-4CF84D1FFC86"> Oracle Streams Conflict Resolution</a> for instructions.
                              </p>
                           </li>
                        </ol>
                        <div class="infoboxnotealso" id="GUID-91D2F532-471A-493D-83F5-D2B0F1C34848__GUID-89894445-21B0-4A33-8C48-585CC07E3EF1">
                           <p class="notep1">See Also:</p>
                           <p>The Oracle Enterprise Manager Cloud Control online help for an example that configures this replication environment using Oracle Enterprise Manager Cloud Control</p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div><a id="STREP596"></a><div class="props_rev_3"><a id="GUID-7E1E55C3-95FA-4C6C-94B4-2F16E949D67E" name="GUID-7E1E55C3-95FA-4C6C-94B4-2F16E949D67E"></a><h4 id="STREP-GUID-7E1E55C3-95FA-4C6C-94B4-2F16E949D67E" class="sect4"><span class="enumeration_section">2.2.8 </span>Monitoring Oracle Streams Configuration Progress
                  </h4>
                  <div>
                     <div class="section">
                        <p>The following procedures in the <code class="codeph">DBMS_STREAMS_ADM</code> package configure a replication environment that is maintained by Oracle Streams:
                        </p>
                     </div>
                     <!-- class="section" -->
                     <div class="section">
                        <ul style="list-style-type: disc;">
                           <li>
                              <p><a href="../arpls/DBMS_STREAMS_ADM.html#ARPLS825"><code class="codeph">MAINTAIN_GLOBAL</code></a></p>
                           </li>
                           <li>
                              <p><a href="../arpls/DBMS_STREAMS_ADM.html#ARPLS826"><code class="codeph">MAINTAIN_SCHEMAS</code></a></p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS863"><code class="codeph">MAINTAIN_SIMPLE_TTS</code></a></p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS827"><code class="codeph">MAINTAIN_TABLES</code></a></p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS864"><code class="codeph">MAINTAIN_TTS</code></a></p>
                           </li>
                           <li>
                              <p><a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS831"><code class="codeph">PRE_INSTANTIATION_SETUP</code></a> and <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ARPLS830"><code class="codeph">POST_INSTANTIATION_SETUP</code></a></p>
                           </li>
                        </ul>
                        <p>While one of these procedures configures the replication environment directly (with the <code class="codeph">perform_actions</code> parameter is set to <code class="codeph">TRUE</code>), you can monitor the progress of the configuration in a separate terminal window.
                        </p>
                        <p>Complete the following steps to monitor the progress of the Oracle Stream configuration:</p>
                     </div>
                     <!-- class="section" -->
                     <ol>
                        <li class="stepexpand"><span>In SQL*Plus, connect to the capture database as the Oracle Streams administrator. Use a different terminal window than the one that is running the configuration procedure.</span><div>
                              <p>See <a href="https://www.oracle.com/pls/topic/lookup?ctx=en/database/oracle/oracle-database/18/strep&amp;id=ADMIN00102"><span class="italic">Oracle Database Administrator's Guide</span></a> for instructions about connecting to a database in SQL*Plus.
                              </p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>For basic information about the configuration operation, run the following query:</span><div><pre class="oac_no_warn" dir="ltr">COLUMN SCRIPT_ID      HEADING 'Script ID'      FORMAT A40
COLUMN CREATION_TIME  HEADING 'Creation|Time'  FORMAT A20

SELECT SCRIPT_ID,
  TO_CHAR(CREATION_TIME,'HH24:Mi:SS MM/DD/YY') CREATION_TIME
  FROM DBA_RECOVERABLE_SCRIPT;
</pre><p>Your output is similar to the following:</p><pre class="oac_no_warn" dir="ltr">                                         Creation
Script ID                                Time
---------------------------------------- --------------------
64EE0DFCC374CE7EE040578C89174D3E         07:46:54 03/12/09
</pre><p>This output shows the script ID for the configuration operation and the time when the operation started.</p>
                           </div>
                        </li>
                        <li class="stepexpand"><span>For detailed information about the progress of the configuration operation, run the following query:</span><div><pre class="oac_no_warn" dir="ltr">COLUMN STATUS           HEADING 'Status'          FORMAT A12
COLUMN PROGRESS         HEADING 'Steps|Completed' FORMAT A10
COLUMN ELAPSED_SECONDS  HEADING 'Elapsed|Seconds' FORMAT A10
COLUMN CURRENT_STEP     HEADING 'Current Step'    FORMAT A20
COLUMN PROCEDURE        HEADING 'Procedure'       FORMAT A20

SELECT  rs.STATUS,
    rs.DONE_BLOCK_NUM||' of '||rs.TOTAL_BLOCKS PROGRESS,
    TO_CHAR(TO_NUMBER(SYSDATE-rs.CREATION_TIME)*86400,9999.99) ELAPSED_SECONDS,
    SUBSTR(TO_CHAR(rsb.FORWARD_BLOCK),1,100) CURRENT_STEP,
    rs.INVOKING_PACKAGE||'.'||rs.INVOKING_PROCEDURE PROCEDURE
  FROM DBA_RECOVERABLE_SCRIPT rs, DBA_RECOVERABLE_SCRIPT_BLOCKS rsb
  WHERE rs.SCRIPT_ID  = rsb.SCRIPT_ID AND 
        rsb.BLOCK_NUM = rs.DONE_BLOCK_NUM + 1;
</pre><p>Your output is similar to the following:</p><pre class="oac_no_warn" dir="ltr">             Steps      Elapsed
Status       Completed  Seconds    Current Step         Procedure
------------ ---------- ---------- -------------------- --------------------
EXECUTING    7 of 39    132        --                   DBMS_STREAMS_ADM.MAI
                                   -- Set up queue "STR NTAIN_SCHEMAS
                                   MADMIN"."PROD$APPQ"
                                   --
                                   BEGIN
                                     dbms_streams_adm.s
                                   et_up_queue(
                                       queue_ta
</pre><p>This output shows the following information about the configuration operation:</p>
                              <ul style="list-style-type: disc;">
                                 <li>
                                    <p>The current status of the configuration operation, either <code class="codeph">GENERATING</code>, <code class="codeph">NOT</code> <code class="codeph">EXECUTED</code>, <code class="codeph">EXECUTING</code>, <code class="codeph">EXECUTED</code>, or <code class="codeph">ERROR</code></p>
                                 </li>
                                 <li>
                                    <p>The number of steps completed and the total number of steps required to complete the operation</p>
                                 </li>
                                 <li>
                                    <p>The amount of time, in seconds, that the configuration operation has been running</p>
                                 </li>
                                 <li>
                                    <p>The operation being performed by the current step</p>
                                 </li>
                                 <li>
                                    <p>The PL/SQL procedure being executed in the current step</p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                     </ol>
                     <div class="section">
                        <div class="infoboxnotealso" id="GUID-7E1E55C3-95FA-4C6C-94B4-2F16E949D67E__GUID-607749A1-D2D7-47B6-B268-8EF910EC3363">
                           <p class="notep1">See Also:</p>
                           <p><span class="q">"<a href="managing-oracle-streams-replication.html#GUID-52B85E39-2264-47E2-981A-63CA23C7380A">Recovering from Operation Errors</a>"</span></p>
                        </div>
                     </div>
                     <!-- class="section" -->
                  </div>
               </div>
            </div>
         </div>
      </article>
   </body>
</html>